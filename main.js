import{a as xt,b as jn,e as bs}from"./chunk-FDERIQAA.js";var l0=null;var Ub=1,Ru=Symbol("SIGNAL");function Ne(n){let e=l0;return l0=n,e}function u0(){return l0}var d0={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function zb(n){if(!(g0(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Ub)){if(!n.producerMustRecompute(n)&&!h0(n)){c0(n);return}n.producerRecomputeValue(n),c0(n)}}function c0(n){n.dirty=!1,n.lastCleanEpoch=Ub}function f0(n){return n&&(n.nextProducerIndex=0),Ne(n)}function $b(n,e){if(Ne(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(g0(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)m0(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function h0(n){y0(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(zb(t),r!==t.version))return!0}return!1}function p0(n){if(y0(n),g0(n))for(let e=0;e<n.producerNode.length;e++)m0(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function m0(n,e){if(NF(n),n.liveConsumerNode.length===1&&OF(n))for(let r=0;r<n.producerNode.length;r++)m0(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];y0(i),i.producerIndexOfThis[r]=e}}function g0(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function y0(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function NF(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function OF(n){return n.producerNode!==void 0}function FF(){throw new Error}var LF=FF;function v0(n){LF=n}function _0(n){let e=Ne(null);try{return n()}finally{Ne(e)}}var x0;function Au(){return x0}function Ro(n){let e=x0;return x0=n,e}var sh=Symbol("NotFound");function ye(n){return typeof n=="function"}function ah(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var lh=ah(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ca(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var pn=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ye(r))try{r()}catch(o){e=o instanceof lh?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{Hb(o)}catch(s){e=e??[],s instanceof lh?e=[...e,...s.errors]:e.push(s)}}if(e)throw new lh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Hb(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ca(t,e)}remove(e){let{_finalizers:t}=this;t&&Ca(t,e),e instanceof n&&e._removeParent(this)}};pn.EMPTY=(()=>{let n=new pn;return n.closed=!0,n})();var E0=pn.EMPTY;function ch(n){return n instanceof pn||n&&"closed"in n&&ye(n.remove)&&ye(n.add)&&ye(n.unsubscribe)}function Hb(n){ye(n)?n():n.unsubscribe()}var ui={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Rl={setTimeout(n,e,...t){let{delegate:r}=Rl;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Rl;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function uh(n){Rl.setTimeout(()=>{let{onUnhandledError:e}=ui;if(e)e(n);else throw n})}function w0(){}var qb=C0("C",void 0,void 0);function Wb(n){return C0("E",void 0,n)}function Xb(n){return C0("N",n,void 0)}function C0(n,e,t){return{kind:n,value:e,error:t}}var ba=null;function Al(n){if(ui.useDeprecatedSynchronousErrorHandling){let e=!ba;if(e&&(ba={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=ba;if(ba=null,t)throw r}}else n()}function Zb(n){ui.useDeprecatedSynchronousErrorHandling&&ba&&(ba.errorThrown=!0,ba.error=n)}var Ma=class extends pn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,ch(e)&&e.add(this)):this.destination=XF}static create(e,t,r){return new Ao(e,t,r)}next(e){this.isStopped?M0(Xb(e),this):this._next(e)}error(e){this.isStopped?M0(Wb(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?M0(qb,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},qF=Function.prototype.bind;function b0(n,e){return qF.call(n,e)}var T0=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){dh(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){dh(r)}else dh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){dh(t)}}},Ao=class extends Ma{constructor(e,t,r){super();let i;if(ye(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&ui.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&b0(e.next,o),error:e.error&&b0(e.error,o),complete:e.complete&&b0(e.complete,o)}):i=e}this.destination=new T0(i)}};function dh(n){ui.useDeprecatedSynchronousErrorHandling?Zb(n):uh(n)}function WF(n){throw n}function M0(n,e){let{onStoppedNotification:t}=ui;t&&Rl.setTimeout(()=>t(n,e))}var XF={closed:!0,next:w0,error:WF,complete:w0};var Pl=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ms(n){return n}function Yb(n){return n.length===0?Ms:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Xe=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=YF(t)?t:new Ao(t,r,i);return Al(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=Kb(r),new r((i,o)=>{let s=new Ao({next:a=>{try{t(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Pl](){return this}pipe(...t){return Yb(t)(this)}toPromise(t){return t=Kb(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function Kb(n){var e;return(e=n??ui.Promise)!==null&&e!==void 0?e:Promise}function ZF(n){return n&&ye(n.next)&&ye(n.error)&&ye(n.complete)}function YF(n){return n&&n instanceof Ma||ZF(n)&&ch(n)}function KF(n){return ye(n?.lift)}function mt(n){return e=>{if(KF(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function kt(n,e,t,r,i){return new S0(n,e,t,r,i)}var S0=class extends Ma{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var Jb=ah(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var wr=(()=>{class n extends Xe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new fh(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new Jb}next(t){Al(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Al(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Al(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?E0:(this.currentObservers=null,o.push(t),new pn(()=>{this.currentObservers=null,Ca(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new Xe;return t.source=this,t}}return n.create=(e,t)=>new fh(e,t),n})(),fh=class extends wr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:E0}};var Ta=class extends wr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Pu={now(){return(Pu.delegate||Date).now()},delegate:void 0};var Sa=class extends wr{constructor(e=1/0,t=1/0,r=Pu){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:o,_windowTime:s}=this;t||(r.push(e),!i&&r.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,o=i.slice();for(let s=0;s<o.length&&!e.closed;s+=r?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,o=(i?1:2)*e;if(e<1/0&&o<r.length&&r.splice(0,r.length-o),!i){let s=t.now(),a=0;for(let l=1;l<r.length&&r[l]<=s;l+=2)a=l;a&&r.splice(0,a+1)}}};var hh=class extends pn{constructor(e,t){super()}schedule(e,t=0){return this}};var Nu={setInterval(n,e,...t){let{delegate:r}=Nu;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Nu;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var ph=class extends hh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Nu.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Nu.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ca(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Nl=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Nl.now=Pu.now;var mh=class extends Nl{constructor(e,t=Nl.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var JF=new mh(ph),Qb=JF;var gh=new Xe(n=>n.complete());function yh(n){return n&&ye(n.schedule)}function eM(n){return n[n.length-1]}function vh(n){return yh(eM(n))?n.pop():void 0}function tM(n,e){return typeof eM(n)=="number"?n.pop():e}function rM(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})}function nM(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ia(n){return this instanceof Ia?(this.v=n,this):new Ia(n)}function iM(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(h){return function(p){return Promise.resolve(p).then(h,d)}}function a(h,p){r[h]&&(i[h]=function(m){return new Promise(function(g,y){o.push([h,m,g,y])>1||l(h,m)})},p&&(i[h]=p(i[h])))}function l(h,p){try{c(r[h](p))}catch(m){f(o[0][3],m)}}function c(h){h.value instanceof Ia?Promise.resolve(h.value.v).then(u,d):f(o[0][2],h)}function u(h){l("next",h)}function d(h){l("throw",h)}function f(h,p){h(p),o.shift(),o.length&&l(o[0][0],o[0][1])}}function oM(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof nM=="function"?nM(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var _h=n=>n&&typeof n.length=="number"&&typeof n!="function";function xh(n){return ye(n?.then)}function Eh(n){return ye(n[Pl])}function wh(n){return Symbol.asyncIterator&&ye(n?.[Symbol.asyncIterator])}function Ch(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function QF(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var bh=QF();function Mh(n){return ye(n?.[bh])}function Th(n){return iM(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Ia(t.read());if(i)return yield Ia(void 0);yield yield Ia(r)}}finally{t.releaseLock()}})}function Sh(n){return ye(n?.getReader)}function jt(n){if(n instanceof Xe)return n;if(n!=null){if(Eh(n))return eL(n);if(_h(n))return tL(n);if(xh(n))return nL(n);if(wh(n))return sM(n);if(Mh(n))return rL(n);if(Sh(n))return iL(n)}throw Ch(n)}function eL(n){return new Xe(e=>{let t=n[Pl]();if(ye(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function tL(n){return new Xe(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function nL(n){return new Xe(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,uh)})}function rL(n){return new Xe(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function sM(n){return new Xe(e=>{oL(n,e).catch(t=>e.error(t))})}function iL(n){return sM(Th(n))}function oL(n,e){var t,r,i,o;return rM(this,void 0,void 0,function*(){try{for(t=oM(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function jr(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function Ih(n,e=0){return mt((t,r)=>{t.subscribe(kt(r,i=>jr(r,n,()=>r.next(i),e),()=>jr(r,n,()=>r.complete(),e),i=>jr(r,n,()=>r.error(i),e)))})}function Dh(n,e=0){return mt((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function aM(n,e){return jt(n).pipe(Dh(e),Ih(e))}function lM(n,e){return jt(n).pipe(Dh(e),Ih(e))}function cM(n,e){return new Xe(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function uM(n,e){return new Xe(t=>{let r;return jr(t,e,()=>{r=n[bh](),jr(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>ye(r?.return)&&r.return()})}function Rh(n,e){if(!n)throw new Error("Iterable cannot be null");return new Xe(t=>{jr(t,e,()=>{let r=n[Symbol.asyncIterator]();jr(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function dM(n,e){return Rh(Th(n),e)}function fM(n,e){if(n!=null){if(Eh(n))return aM(n,e);if(_h(n))return cM(n,e);if(xh(n))return lM(n,e);if(wh(n))return Rh(n,e);if(Mh(n))return uM(n,e);if(Sh(n))return dM(n,e)}throw Ch(n)}function Da(n,e){return e?fM(n,e):jt(n)}function tr(...n){let e=vh(n);return Da(n,e)}function I0(n,e){let t=ye(n)?n:()=>n,r=i=>i.error(t());return new Xe(e?i=>e.schedule(r,0,i):r)}function D0(n){return!!n&&(n instanceof Xe||ye(n.lift)&&ye(n.subscribe))}function hM(n){return n instanceof Date&&!isNaN(n)}function ue(n,e){return mt((t,r)=>{let i=0;t.subscribe(kt(r,o=>{r.next(n.call(e,o,i++))}))})}function pM(n,e,t,r,i,o,s,a){let l=[],c=0,u=0,d=!1,f=()=>{d&&!l.length&&!c&&e.complete()},h=m=>c<r?p(m):l.push(m),p=m=>{o&&e.next(m),c++;let g=!1;jt(t(m,u++)).subscribe(kt(e,y=>{i?.(y),o?h(y):e.next(y)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<r;){let y=l.shift();s?jr(e,s,()=>p(y)):p(y)}f()}catch(y){e.error(y)}}))};return n.subscribe(kt(e,h,()=>{d=!0,f()})),()=>{a?.()}}function Ol(n,e,t=1/0){return ye(e)?Ol((r,i)=>ue((o,s)=>e(r,o,i,s))(jt(n(r,i))),t):(typeof e=="number"&&(t=e),mt((r,i)=>pM(r,i,n,t)))}function mM(n=1/0){return Ol(Ms,n)}function Ou(n=0,e,t=Qb){let r=-1;return e!=null&&(yh(e)?t=e:r=e),new Xe(i=>{let o=hM(n)?+n-t.now():n;o<0&&(o=0);let s=0;return t.schedule(function(){i.closed||(i.next(s++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function R0(...n){let e=vh(n),t=tM(n,1/0),r=n;return r.length?r.length===1?jt(r[0]):mM(t)(Da(r,e)):gh}function tt(n,e){return mt((t,r)=>{let i=0;t.subscribe(kt(r,o=>n.call(e,o,i++)&&r.next(o)))})}function Ts(n){return mt((e,t)=>{let r=null,i=!1,o;r=e.subscribe(kt(t,void 0,void 0,s=>{o=jt(n(s,Ts(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function Fu(n,e){return ye(e)?Ol(n,e,1):Ol(n,1)}function Fl(n){return n<=0?()=>gh:mt((e,t)=>{let r=0;e.subscribe(kt(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function A0(n){return mt((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function P0(n=1/0){let e;n&&typeof n=="object"?e=n:e={count:n};let{count:t=1/0,delay:r,resetOnSuccess:i=!1}=e;return t<=0?Ms:mt((o,s)=>{let a=0,l,c=()=>{let u=!1;l=o.subscribe(kt(s,d=>{i&&(a=0),s.next(d)},void 0,d=>{if(a++<t){let f=()=>{l?(l.unsubscribe(),l=null,c()):u=!0};if(r!=null){let h=typeof r=="number"?Ou(r):jt(r(d,a)),p=kt(s,()=>{p.unsubscribe(),f()},()=>{s.complete()});h.subscribe(p)}else f()}else s.error(d)})),u&&(l.unsubscribe(),l=null,c())};c()})}function gM(n={}){let{connector:e=()=>new wr,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return o=>{let s,a,l,c=0,u=!1,d=!1,f=()=>{a?.unsubscribe(),a=void 0},h=()=>{f(),s=l=void 0,u=d=!1},p=()=>{let m=s;h(),m?.unsubscribe()};return mt((m,g)=>{c++,!d&&!u&&f();let y=l=l??e();g.add(()=>{c--,c===0&&!d&&!u&&(a=N0(p,i))}),y.subscribe(g),!s&&c>0&&(s=new Ao({next:v=>y.next(v),error:v=>{d=!0,f(),a=N0(h,t,v),y.error(v)},complete:()=>{u=!0,f(),a=N0(h,r),y.complete()}}),jt(m).subscribe(s))})(o)}}function N0(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new Ao({next:()=>{r.unsubscribe(),n()}});return jt(e(...t)).subscribe(r)}function Ah(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,gM({connector:()=>new Sa(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Lu(n,e){return mt((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(kt(r,l=>{i?.unsubscribe();let c=0,u=o++;jt(n(l,u)).subscribe(i=kt(r,d=>r.next(e?e(l,d,u,c++):d),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function O0(n,e,t){let r=ye(n)||e||t?{next:n,error:e,complete:t}:n;return r?mt((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(kt(o,l=>{var c;(c=r.next)===null||c===void 0||c.call(r,l),o.next(l)},()=>{var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),o.complete()},l=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),o.error(l)},()=>{var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):Ms}var uT="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",Q=class extends Error{code;constructor(e,t){super(dT(e,t)),this.code=e}};function sL(n){return`NG0${Math.abs(n)}`}function dT(n,e){return`${sL(n)}${e?": "+e:""}`}function gp(n){return{toString:n}.toString()}var Ph="__parameters__";function aL(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function fT(n,e,t){return gp(()=>{let r=aL(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(l,c,u){let d=l.hasOwnProperty(Ph)?l[Ph]:Object.defineProperty(l,Ph,{value:[]})[Ph];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(s),l}}return i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var sn=globalThis;function nt(n){for(let e in n)if(n[e]===nt)return e;throw Error("Could not find renamed property on target object.")}function ir(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(ir).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function yM(n,e){return n?e?`${n} ${e}`:n:e||""}var lL=nt({__forward_ref__:nt});function hT(n){return n.__forward_ref__=hT,n.toString=function(){return ir(this())},n}function rr(n){return cL(n)?n():n}function cL(n){return typeof n=="function"&&n.hasOwnProperty(lL)&&n.__forward_ref__===hT}function Y(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function pi(n){return{providers:n.providers||[],imports:n.imports||[]}}function Bv(n){return vM(n,pT)||vM(n,mT)}function vM(n,e){return n.hasOwnProperty(e)?n[e]:null}function uL(n){let e=n&&(n[pT]||n[mT]);return e||null}function _M(n){return n&&(n.hasOwnProperty(xM)||n.hasOwnProperty(dL))?n[xM]:null}var pT=nt({\u0275prov:nt}),xM=nt({\u0275inj:nt}),mT=nt({ngInjectableDef:nt}),dL=nt({ngInjectorDef:nt}),oe=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Y({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function gT(n){return n&&!!n.\u0275providers}var fL=nt({\u0275cmp:nt}),hL=nt({\u0275dir:nt}),pL=nt({\u0275pipe:nt}),mL=nt({\u0275mod:nt}),EM=nt({\u0275fac:nt}),Bu=nt({__NG_ELEMENT_ID__:nt}),wM=nt({__NG_ENV_ID__:nt});function Uu(n){return typeof n=="string"?n:n==null?"":String(n)}function gL(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Uu(n)}function yT(n,e){throw new Q(-200,n)}function Gv(n,e){throw new Q(-201,!1)}var De=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(De||{}),Z0;function vT(){return Z0}function nr(n){let e=Z0;return Z0=n,e}function _T(n,e,t){let r=Bv(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&De.Optional)return null;if(e!==void 0)return e;Gv(n,"Injector")}var yL={},Aa=yL,Y0="__NG_DI_FLAG__",Uh=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=t;return this.injector.get(e,r.optional?sh:Aa,r)}},zh="ngTempTokenPath",vL="ngTokenPath",_L=/\n/gm,xL="\u0275",CM="__source";function EL(n,e=De.Default){if(Au()===void 0)throw new Q(-203,!1);if(Au()===null)return _T(n,void 0,e);{let t=Au(),r;return t instanceof Uh?r=t.injector:r=t,r.get(n,e&De.Optional?null:void 0,e)}}function U(n,e=De.Default){return(vT()||EL)(rr(n),e)}function Se(n,e=De.Default){return U(n,yp(e))}function yp(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function K0(n){let e=[];for(let t=0;t<n.length;t++){let r=rr(n[t]);if(Array.isArray(r)){if(r.length===0)throw new Q(900,!1);let i,o=De.Default;for(let s=0;s<r.length;s++){let a=r[s],l=wL(a);typeof l=="number"?l===-1?i=a.token:o|=l:i=a}e.push(U(i,o))}else e.push(U(r))}return e}function xT(n,e){return n[Y0]=e,n.prototype[Y0]=e,n}function wL(n){return n[Y0]}function CL(n,e,t,r){let i=n[zh];throw e[CM]&&i.unshift(e[CM]),n.message=bL(`
`+n.message,i,t,r),n[vL]=i,n[zh]=null,n}function bL(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==xL?n.slice(2):n;let i=ir(e);if(Array.isArray(e))i=e.map(ir).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):ir(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(_L,`
  `)}`}var ET=xT(fT("Optional"),8);var ML=xT(fT("SkipSelf"),4);function Bl(n,e){let t=n.hasOwnProperty(EM);return t?n[EM]:null}function Uv(n,e){n.forEach(t=>Array.isArray(t)?Uv(t,e):e(t))}function wT(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function $h(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function TL(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function SL(n,e,t){let r=Zu(n,e);return r>=0?n[r|1]=t:(r=~r,TL(n,r,e,t)),r}function F0(n,e){let t=Zu(n,e);if(t>=0)return n[t|1]}function Zu(n,e){return IL(n,e,1)}function IL(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var Gl={},fi=[],zu=new oe(""),CT=new oe("",-1),bT=new oe(""),Hh=class{get(e,t=Aa){if(t===Aa){let r=new Error(`NullInjectorError: No provider for ${ir(e)}!`);throw r.name="NullInjectorError",r}return t}};function DL(n,e){let t=n[mL]||null;if(!t&&e===!0)throw new Error(`Type ${ir(n)} does not have '\u0275mod' property.`);return t}function $u(n){return n[fL]||null}function RL(n){return n[hL]||null}function AL(n){return n[pL]||null}function zv(n){return{\u0275providers:n}}function PL(...n){return{\u0275providers:MT(!0,n),\u0275fromNgModule:!0}}function MT(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return Uv(e,s=>{let a=s;J0(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&TT(i,o),t}function TT(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];$v(i,o=>{e(o,r)})}}function J0(n,e,t,r){if(n=rr(n),!n)return!1;let i=null,o=_M(n),s=!o&&$u(n);if(!o&&!s){let l=n.ngModule;if(o=_M(l),o)i=l;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)J0(c,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let c;try{Uv(o.imports,u=>{J0(u,e,t,r)&&(c||=[],c.push(u))})}finally{}c!==void 0&&TT(c,e)}if(!a){let c=Bl(i)||(()=>new i);e({provide:i,useFactory:c,deps:fi},i),e({provide:bT,useValue:i,multi:!0},i),e({provide:zu,useValue:()=>U(i),multi:!0},i)}let l=o.providers;if(l!=null&&!a){let c=n;$v(l,u=>{e(u,c)})}}else return!1;return i!==n&&n.providers!==void 0}function $v(n,e){for(let t of n)gT(t)&&(t=t.\u0275providers),Array.isArray(t)?$v(t,e):e(t)}var NL=nt({provide:String,useValue:nt});function ST(n){return n!==null&&typeof n=="object"&&NL in n}function OL(n){return!!(n&&n.useExisting)}function FL(n){return!!(n&&n.useFactory)}function Ul(n){return typeof n=="function"}function LL(n){return!!n.useClass}var vp=new oe(""),jh={},bM={},L0;function Hv(){return L0===void 0&&(L0=new Hh),L0}var Hi=class{},Hu=class extends Hi{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,ev(e,s=>this.processProvider(s)),this.records.set(CT,Ll(void 0,this)),i.has("environment")&&this.records.set(Hi,Ll(void 0,this));let o=this.records.get(vp);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(bT,fi,De.Self))}retrieve(e,t){let r=t;return this.get(e,r.optional?sh:Aa,r)}destroy(){ju(this),this._destroyed=!0;let e=Ne(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ne(e)}}onDestroy(e){return ju(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){ju(this);let t=Ro(this),r=nr(void 0),i;try{return e()}finally{Ro(t),nr(r)}}get(e,t=Aa,r=De.Default){if(ju(this),e.hasOwnProperty(wM))return e[wM](this);r=yp(r);let i,o=Ro(this),s=nr(void 0);try{if(!(r&De.SkipSelf)){let l=this.records.get(e);if(l===void 0){let c=GL(e)&&Bv(e);c&&this.injectableDefInScope(c)?l=Ll(Q0(e),jh):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=r&De.Self?Hv():this.parent;return t=r&De.Optional&&t===Aa?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[zh]=a[zh]||[]).unshift(ir(e)),o)throw a;return CL(a,e,"R3InjectorError",this.source)}else throw a}finally{nr(s),Ro(o)}}resolveInjectorInitializers(){let e=Ne(null),t=Ro(this),r=nr(void 0),i;try{let o=this.get(zu,fi,De.Self);for(let s of o)s()}finally{Ro(t),nr(r),Ne(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(ir(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=rr(e);let t=Ul(e)?e:rr(e&&e.provide),r=jL(e);if(!Ul(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Ll(void 0,jh,!0),i.factory=()=>K0(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Ne(null);try{return t.value===bM?yT(ir(e)):t.value===jh&&(t.value=bM,t.value=t.factory()),typeof t.value=="object"&&t.value&&BL(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ne(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=rr(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Q0(n){let e=Bv(n),t=e!==null?e.factory:Bl(n);if(t!==null)return t;if(n instanceof oe)throw new Q(204,!1);if(n instanceof Function)return kL(n);throw new Q(204,!1)}function kL(n){if(n.length>0)throw new Q(204,!1);let t=uL(n);return t!==null?()=>t.factory(n):()=>new n}function jL(n){if(ST(n))return Ll(void 0,n.useValue);{let e=IT(n);return Ll(e,jh)}}function IT(n,e,t){let r;if(Ul(n)){let i=rr(n);return Bl(i)||Q0(i)}else if(ST(n))r=()=>rr(n.useValue);else if(FL(n))r=()=>n.useFactory(...K0(n.deps||[]));else if(OL(n))r=()=>U(rr(n.useExisting));else{let i=rr(n&&(n.useClass||n.provide));if(VL(n))r=()=>new i(...K0(n.deps));else return Bl(i)||Q0(i)}return r}function ju(n){if(n.destroyed)throw new Q(205,!1)}function Ll(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function VL(n){return!!n.deps}function BL(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function GL(n){return typeof n=="function"||typeof n=="object"&&n instanceof oe}function ev(n,e){for(let t of n)Array.isArray(t)?ev(t,e):t&&gT(t)?ev(t.\u0275providers,e):e(t)}function _p(n,e){let t;n instanceof Hu?(ju(n),t=n):t=new Uh(n);let r,i=Ro(t),o=nr(void 0);try{return e()}finally{Ro(i),nr(o)}}function UL(){return vT()!==void 0||Au()!=null}function zL(n){let e=sn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function $L(n){return typeof n=="function"}var ko=0,Oe=1,de=2,Vn=3,hi=4,mi=5,qh=6,Wh=7,or=8,zl=9,Po=10,an=11,qu=12,MM=13,Kl=14,qi=15,$l=16,kl=17,Hl=18,xp=19,DT=20,Ss=21,k0=22,Xh=23,Vr=24,j0=25,Gr=26,RT=1;var Oa=7,Zh=8,Yh=9,Br=10;function Pa(n){return Array.isArray(n)&&typeof n[RT]=="object"}function jo(n){return Array.isArray(n)&&n[RT]===!0}function qv(n){return(n.flags&4)!==0}function Jl(n){return n.componentOffset>-1}function Ep(n){return(n.flags&1)===1}function Is(n){return!!n.template}function Kh(n){return(n[de]&512)!==0}function Yu(n){return(n[de]&256)===256}var tv=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function AT(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var Ba=(()=>{let n=()=>PT;return n.ngInherit=!0,n})();function PT(n){return n.type.prototype.ngOnChanges&&(n.setInput=qL),HL}function HL(){let n=OT(this),e=n?.current;if(e){let t=n.previous;if(t===Gl)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function qL(n,e,t,r,i){let o=this.declaredInputs[r],s=OT(n)||WL(n,{previous:Gl,current:null}),a=s.current||(s.current={}),l=s.previous,c=l[o];a[o]=new tv(c&&c.currentValue,t,l===Gl),AT(n,e,i,t)}var NT="__ngSimpleChanges__";function OT(n){return n[NT]||null}function WL(n,e){return n[NT]=e}var TM=null;var gt=function(n,e=null,t){TM?.(n,e,t)},FT="svg",XL="math";function Wi(n){for(;Array.isArray(n);)n=n[ko];return n}function LT(n,e){return Wi(e[n])}function Vo(n,e){return Wi(e[n.index])}function kT(n,e){return n.data[e]}function ZL(n,e){return n[e]}function No(n,e){let t=e[n];return Pa(t)?t:t[ko]}function Wv(n){return(n[de]&128)===128}function YL(n){return jo(n[Vn])}function ql(n,e){return e==null?null:n[e]}function jT(n){n[kl]=0}function Xv(n){n[de]&1024||(n[de]|=1024,Wv(n)&&wp(n))}function KL(n,e){for(;n>0;)e=e[Kl],n--;return e}function Ku(n){return!!(n[de]&9216||n[Vr]?.dirty)}function nv(n){n[Po].changeDetectionScheduler?.notify(8),n[de]&64&&(n[de]|=1024),Ku(n)&&wp(n)}function wp(n){n[Po].changeDetectionScheduler?.notify(0);let e=Fa(n);for(;e!==null&&!(e[de]&8192||(e[de]|=8192,!Wv(e)));)e=Fa(e)}function VT(n,e){if(Yu(n))throw new Q(911,!1);n[Ss]===null&&(n[Ss]=[]),n[Ss].push(e)}function JL(n,e){if(n[Ss]===null)return;let t=n[Ss].indexOf(e);t!==-1&&n[Ss].splice(t,1)}function Fa(n){let e=n[Vn];return jo(e)?e[Vn]:e}function BT(n){return n[Wh]??=[]}function GT(n){return n.cleanup??=[]}var Ce={lFrame:YT(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var rv=!1;function QL(){return Ce.lFrame.elementDepthCount}function ek(){Ce.lFrame.elementDepthCount++}function tk(){Ce.lFrame.elementDepthCount--}function Zv(){return Ce.bindingsEnabled}function nk(){return Ce.skipHydrationRootTNode!==null}function rk(n){return Ce.skipHydrationRootTNode===n}function ik(){Ce.skipHydrationRootTNode=null}function ct(){return Ce.lFrame.lView}function Bn(){return Ce.lFrame.tView}function Ds(n){return Ce.lFrame.contextLView=n,n[or]}function Rs(n){return Ce.lFrame.contextLView=null,n}function gi(){let n=UT();for(;n!==null&&n.type===64;)n=n.parent;return n}function UT(){return Ce.lFrame.currentTNode}function ok(){let n=Ce.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Ga(n,e){let t=Ce.lFrame;t.currentTNode=n,t.isParent=e}function Yv(){return Ce.lFrame.isParent}function zT(){Ce.lFrame.isParent=!1}function $T(){return rv}function SM(n){let e=rv;return rv=n,e}function sk(){let n=Ce.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function ak(){return Ce.lFrame.bindingIndex}function lk(n){return Ce.lFrame.bindingIndex=n}function HT(){return Ce.lFrame.bindingIndex++}function qT(n){let e=Ce.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function ck(){return Ce.lFrame.inI18n}function uk(n,e){let t=Ce.lFrame;t.bindingIndex=t.bindingRootIndex=n,iv(e)}function dk(){return Ce.lFrame.currentDirectiveIndex}function iv(n){Ce.lFrame.currentDirectiveIndex=n}function fk(n){let e=Ce.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function WT(n){Ce.lFrame.currentQueryIndex=n}function hk(n){let e=n[Oe];return e.type===2?e.declTNode:e.type===1?n[mi]:null}function XT(n,e,t){if(t&De.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&De.Host);)if(i=hk(o),i===null||(o=o[Kl],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=Ce.lFrame=ZT();return r.currentTNode=e,r.lView=n,!0}function Kv(n){let e=ZT(),t=n[Oe];Ce.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function ZT(){let n=Ce.lFrame,e=n===null?null:n.child;return e===null?YT(n):e}function YT(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function KT(){let n=Ce.lFrame;return Ce.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var JT=KT;function Jv(){let n=KT();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function pk(n){return(Ce.lFrame.contextLView=KL(n,Ce.lFrame.contextLView))[or]}function Ql(){return Ce.lFrame.selectedIndex}function La(n){Ce.lFrame.selectedIndex=n}function Qv(){let n=Ce.lFrame;return kT(n.tView,n.selectedIndex)}function QT(){Ce.lFrame.currentNamespace=FT}function mk(){return Ce.lFrame.currentNamespace}var eS=!0;function Cp(){return eS}function bp(n){eS=n}function gk(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=PT(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function e_(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),u!=null&&(n.destroyHooks??=[]).push(t,u)}}function Vh(n,e,t){tS(n,e,3,t)}function Bh(n,e,t,r){(n[de]&3)===t&&tS(n,e,t,r)}function V0(n,e){let t=n[de];(t&3)===e&&(t&=16383,t+=1,n[de]=t)}function tS(n,e,t,r){let i=r!==void 0?n[kl]&65535:0,o=r??-1,s=e.length-1,a=0;for(let l=i;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],r!=null&&a>=r)break}else e[l]<0&&(n[kl]+=65536),(a<o||o==-1)&&(yk(n,t,e,l),n[kl]=(n[kl]&4294901760)+l+2),l++}function IM(n,e){gt(4,n,e);let t=Ne(null);try{e.call(n)}finally{Ne(t),gt(5,n,e)}}function yk(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[de]>>14<n[kl]>>16&&(n[de]&3)===e&&(n[de]+=16384,IM(a,o)):IM(a,o)}var Vl=-1,ka=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}};function vk(n){return(n.flags&8)!==0}function _k(n){return(n.flags&16)!==0}function xk(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];wk(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function Ek(n){return n===3||n===4||n===6}function wk(n){return n.charCodeAt(0)===64}function Mp(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?DM(n,t,i,null,e[++r]):DM(n,t,i,null,null))}}return n}function DM(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){i!==null&&(n[o+1]=i);return}o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),i!==null&&n.splice(o++,0,i)}function nS(n){return n!==Vl}function Jh(n){return n&32767}function Ck(n){return n>>16}function Qh(n,e){let t=Ck(n),r=e;for(;t>0;)r=r[Kl],t--;return r}var ov=!0;function ep(n){let e=ov;return ov=n,e}var bk=256,rS=bk-1,iS=5,Mk=0,$i={};function Tk(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Bu)&&(r=t[Bu]),r==null&&(r=t[Bu]=Mk++);let i=r&rS,o=1<<i;e.data[n+(i>>iS)]|=o}function tp(n,e){let t=oS(n,e);if(t!==-1)return t;let r=e[Oe];r.firstCreatePass&&(n.injectorIndex=e.length,B0(r.data,n),B0(e,null),B0(r.blueprint,null));let i=t_(n,e),o=n.injectorIndex;if(nS(i)){let s=Jh(i),a=Qh(i,e),l=a[Oe].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=i,o}function B0(n,e){n.push(0,0,0,0,0,0,0,0,e)}function oS(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function t_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=uS(i),r===null)return Vl;if(t++,i=i[Kl],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Vl}function sv(n,e,t){Tk(n,e,t)}function sS(n,e,t){if(t&De.Optional||n!==void 0)return n;Gv(e,"NodeInjector")}function aS(n,e,t,r){if(t&De.Optional&&r===void 0&&(r=null),(t&(De.Self|De.Host))===0){let i=n[zl],o=nr(void 0);try{return i?i.get(e,r,t&De.Optional):_T(e,r,t&De.Optional)}finally{nr(o)}}return sS(r,e,t)}function lS(n,e,t,r=De.Default,i){if(n!==null){if(e[de]&2048&&!(r&De.Self)){let s=Ak(n,e,t,r,$i);if(s!==$i)return s}let o=cS(n,e,t,r,$i);if(o!==$i)return o}return aS(e,t,r,i)}function cS(n,e,t,r,i){let o=Dk(t);if(typeof o=="function"){if(!XT(e,n,r))return r&De.Host?sS(i,t,r):aS(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&De.Optional))Gv(t);else return s}finally{JT()}}else if(typeof o=="number"){let s=null,a=oS(n,e),l=Vl,c=r&De.Host?e[qi][mi]:null;for((a===-1||r&De.SkipSelf)&&(l=a===-1?t_(n,e):e[a+8],l===Vl||!AM(r,!1)?a=-1:(s=e[Oe],a=Jh(l),e=Qh(l,e)));a!==-1;){let u=e[Oe];if(RM(o,a,u.data)){let d=Sk(a,e,t,s,r,c);if(d!==$i)return d}l=e[a+8],l!==Vl&&AM(r,e[Oe].data[a+8]===c)&&RM(o,a,e)?(s=u,a=Jh(l),e=Qh(l,e)):a=-1}}return i}function Sk(n,e,t,r,i,o){let s=e[Oe],a=s.data[n+8],l=r==null?Jl(a)&&ov:r!=s&&(a.type&3)!==0,c=i&De.Host&&o===a,u=Ik(a,s,t,l,c);return u!==null?np(e,s,u,a):$i}function Ik(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,l=n.directiveStart,c=n.directiveEnd,u=o>>20,d=r?a:a+u,f=i?a+u:c;for(let h=d;h<f;h++){let p=s[h];if(h<l&&t===p||h>=l&&p.type===t)return h}if(i){let h=s[l];if(h&&Is(h)&&h.type===t)return l}return null}function np(n,e,t,r){let i=n[t],o=e.data;if(i instanceof ka){let s=i;s.resolving&&yT(gL(o[t]));let a=ep(s.canSeeViewProviders);s.resolving=!0;let l,c=s.injectImpl?nr(s.injectImpl):null,u=XT(n,r,De.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&gk(t,o[t],e)}finally{c!==null&&nr(c),ep(a),s.resolving=!1,JT()}}return i}function Dk(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Bu)?n[Bu]:void 0;return typeof e=="number"?e>=0?e&rS:Rk:e}function RM(n,e,t){let r=1<<n;return!!(t[e+(n>>iS)]&r)}function AM(n,e){return!(n&De.Self)&&!(n&De.Host&&e)}var Na=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return lS(this._tNode,this._lView,e,yp(r),t)}};function Rk(){return new Na(gi(),ct())}function Ak(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[de]&2048&&!Kh(s);){let a=cS(o,s,t,r|De.Self,$i);if(a!==$i)return a;let l=o.parent;if(!l){let c=s[DT];if(c){let u=c.get(t,$i,r);if(u!==$i)return u}l=uS(s),s=s[Kl]}o=l}return i}function uS(n){let e=n[Oe],t=e.type;return t===2?e.declTNode:t===1?n[mi]:null}function PM(n,e=null,t=null,r){let i=dS(n,e,t,r);return i.resolveInjectorInitializers(),i}function dS(n,e=null,t=null,r,i=new Set){let o=[t||fi,PL(n)];return r=r||(typeof n=="object"?void 0:ir(n)),new Hu(o,e||Hv(),r||null,i)}var Cr=class n{static THROW_IF_NOT_FOUND=Aa;static NULL=new Hh;static create(e,t){if(Array.isArray(e))return PM({name:""},t,e,"");{let r=e.name??"";return PM({name:r},e.parent,e.providers,r)}}static \u0275prov=Y({token:n,providedIn:"any",factory:()=>U(CT)});static __NG_ELEMENT_ID__=-1};var Pk=new oe("");Pk.__NG_ELEMENT_ID__=n=>{let e=gi();if(e===null)throw new Q(204,!1);if(e.type&2)return e.value;if(n&De.Optional)return null;throw new Q(204,!1)};var fS=!1,hS=(()=>{class n{static __NG_ELEMENT_ID__=Nk;static __NG_ENV_ID__=t=>t}return n})(),av=class extends hS{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return VT(this._lView,e),()=>JL(this._lView,e)}};function Nk(){return new av(ct())}var ja=class{},n_=new oe("",{providedIn:"root",factory:()=>!1});var pS=new oe(""),mS=new oe(""),ec=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Ta(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}return n})();var lv=class extends wr{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,UL()&&(this.destroyRef=Se(hS,{optional:!0})??void 0,this.pendingTasks=Se(ec,{optional:!0})??void 0)}emit(e){let t=Ne(null);try{super.next(e)}finally{Ne(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let l=e;i=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof pn&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Rt=lv;function rp(...n){}function gS(n){let e,t;function r(){n=rp;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function NM(n){return queueMicrotask(()=>n()),()=>{n=rp}}var r_="isAngularZone",ip=r_+"_ID",Ok=0,st=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Rt(!1);onMicrotaskEmpty=new Rt(!1);onStable=new Rt(!1);onError=new Rt(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=fS}=e;if(typeof Zone>"u")throw new Q(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,kk(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(r_)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Q(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Q(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,Fk,rp,rp);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},Fk={};function i_(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Lk(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){gS(()=>{n.callbackScheduled=!1,cv(n),n.isCheckStableRunning=!0,i_(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),cv(n)}function kk(n){let e=()=>{Lk(n)},t=Ok++;n._inner=n._inner.fork({name:"angular",properties:{[r_]:!0,[ip]:t,[ip+t]:!0},onInvokeTask:(r,i,o,s,a,l)=>{if(jk(l))return r.invokeTask(o,s,a,l);try{return OM(n),r.invokeTask(o,s,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),FM(n)}},onInvoke:(r,i,o,s,a,l,c)=>{try{return OM(n),r.invoke(o,s,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!Vk(l)&&e(),FM(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,cv(n),i_(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function cv(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function OM(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function FM(n){n._nesting--,i_(n)}var op=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Rt;onMicrotaskEmpty=new Rt;onStable=new Rt;onError=new Rt;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function jk(n){return yS(n,"__ignore_ng_zone__")}function Vk(n){return yS(n,"__scheduler_tick__")}function yS(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}function Bk(n="zone.js",e){return n==="noop"?new op:n==="zone.js"?new st(e):n}var br=class{_console=console;handleError(e){this._console.error("ERROR",e)}},Gk=new oe("",{providedIn:"root",factory:()=>{let n=Se(st),e=Se(br);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function Uk(){return Tp(gi(),ct())}function Tp(n,e){return new Zi(Vo(n,e))}var Zi=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=Uk}return n})();function vS(n){return(n.flags&128)===128}var _S=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(_S||{}),xS=new Map,zk=0;function $k(){return zk++}function Hk(n){xS.set(n[xp],n)}function uv(n){xS.delete(n[xp])}var LM="__ngContext__";function tc(n,e){Pa(e)?(n[LM]=e[xp],Hk(e)):n[LM]=e}function ES(n){return CS(n[qu])}function wS(n){return CS(n[hi])}function CS(n){for(;n!==null&&!jo(n);)n=n[hi];return n}var dv;function bS(n){dv=n}function MS(){if(dv!==void 0)return dv;if(typeof document<"u")return document;throw new Q(210,!1)}var o_=new oe("",{providedIn:"root",factory:()=>qk}),qk="ng",s_=new oe(""),Bo=new oe("",{providedIn:"platform",factory:()=>"unknown"});var a_=new oe("",{providedIn:"root",factory:()=>MS().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Wk="h",Xk="b";var TS=!1,Zk=new oe("",{providedIn:"root",factory:()=>TS});var SS=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(SS||{}),Sp=new oe(""),kM=new Set;function Yk(n){kM.has(n)||(kM.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var Kk=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=Y({token:n,providedIn:"root",factory:()=>new n})}return n})();var Jk=()=>null;function IS(n,e,t=!1){return Jk(n,e,t)}function DS(n,e){let t=n.contentQueries;if(t!==null){let r=Ne(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];WT(o),a.contentQueries(2,e[s],s)}}}finally{Ne(r)}}}function fv(n,e,t){WT(0);let r=Ne(null);try{e(n,t)}finally{Ne(r)}}function l_(n,e,t){if(qv(e)){let r=Ne(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let l=t[s];a.contentQueries(1,l,s)}}}finally{Ne(r)}}}var Xi=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Xi||{}),Nh;function Qk(){if(Nh===void 0&&(Nh=null,sn.trustedTypes))try{Nh=sn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Nh}function Ip(n){return Qk()?.createHTML(n)||n}var Oh;function ej(){if(Oh===void 0&&(Oh=null,sn.trustedTypes))try{Oh=sn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Oh}function jM(n){return ej()?.createHTML(n)||n}var Oo=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${uT})`}},hv=class extends Oo{getTypeName(){return"HTML"}},pv=class extends Oo{getTypeName(){return"Style"}},mv=class extends Oo{getTypeName(){return"Script"}},gv=class extends Oo{getTypeName(){return"URL"}},yv=class extends Oo{getTypeName(){return"ResourceURL"}};function As(n){return n instanceof Oo?n.changingThisBreaksApplicationSecurity:n}function Ua(n,e){let t=tj(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${uT})`)}return t===e}function tj(n){return n instanceof Oo&&n.getTypeName()||null}function RS(n){return new hv(n)}function AS(n){return new pv(n)}function PS(n){return new mv(n)}function NS(n){return new gv(n)}function OS(n){return new yv(n)}function nj(n){let e=new _v(n);return rj()?new vv(e):e}var vv=class{inertDocumentHelper;constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let t=new window.DOMParser().parseFromString(Ip(e),"text/html").body;return t===null?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}},_v=class{defaultDoc;inertDocument;constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let t=this.inertDocument.createElement("template");return t.innerHTML=Ip(e),t}};function rj(){try{return!!new window.DOMParser().parseFromString(Ip(""),"text/html")}catch{return!1}}var ij=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function c_(n){return n=String(n),n.match(ij)?n:"unsafe:"+n}function Go(n){let e={};for(let t of n.split(","))e[t]=!0;return e}function Ju(...n){let e={};for(let t of n)for(let r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}var FS=Go("area,br,col,hr,img,wbr"),LS=Go("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),kS=Go("rp,rt"),oj=Ju(kS,LS),sj=Ju(LS,Go("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),aj=Ju(kS,Go("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),VM=Ju(FS,sj,aj,oj),jS=Go("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),lj=Go("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),cj=Go("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),uj=Ju(jS,lj,cj),dj=Go("script,style,template"),xv=class{sanitizedSomething=!1;buf=[];sanitizeChildren(e){let t=e.firstChild,r=!0,i=[];for(;t;){if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild){i.push(t),t=pj(t);continue}for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let o=hj(t);if(o){t=o;break}t=i.pop()}}return this.buf.join("")}startElement(e){let t=BM(e).toLowerCase();if(!VM.hasOwnProperty(t))return this.sanitizedSomething=!0,!dj.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);let r=e.attributes;for(let i=0;i<r.length;i++){let o=r.item(i),s=o.name,a=s.toLowerCase();if(!uj.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=o.value;jS[a]&&(l=c_(l)),this.buf.push(" ",s,'="',GM(l),'"')}return this.buf.push(">"),!0}endElement(e){let t=BM(e).toLowerCase();VM.hasOwnProperty(t)&&!FS.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(GM(e))}};function fj(n,e){return(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function hj(n){let e=n.nextSibling;if(e&&n!==e.previousSibling)throw VS(e);return e}function pj(n){let e=n.firstChild;if(e&&fj(n,e))throw VS(e);return e}function BM(n){let e=n.nodeName;return typeof e=="string"?e:"FORM"}function VS(n){return new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`)}var mj=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,gj=/([^\#-~ |!])/g;function GM(n){return n.replace(/&/g,"&amp;").replace(mj,function(e){let t=e.charCodeAt(0),r=e.charCodeAt(1);return"&#"+((t-55296)*1024+(r-56320)+65536)+";"}).replace(gj,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Fh;function u_(n,e){let t=null;try{Fh=Fh||nj(n);let r=e?String(e):"";t=Fh.getInertBodyElement(r);let i=5,o=r;do{if(i===0)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=t.innerHTML,t=Fh.getInertBodyElement(r)}while(r!==o);let a=new xv().sanitizeChildren(UM(t)||t);return Ip(a)}finally{if(t){let r=UM(t)||t;for(;r.firstChild;)r.firstChild.remove()}}}function UM(n){return"content"in n&&yj(n)?n.content:null}function yj(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName==="TEMPLATE"}var Uo=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Uo||{});function BS(n){let e=vj();return e?jM(e.sanitize(Uo.HTML,n)||""):Ua(n,"HTML")?jM(As(n)):u_(MS(),Uu(n))}function vj(){let n=ct();return n&&n[Po].sanitizer}var _j=/^>|^->|<!--|-->|--!>|<!-$/g,xj=/(<|>)/g,Ej="\u200B$1\u200B";function wj(n){return n.replace(_j,e=>e.replace(xj,Ej))}function Cj(n){return n instanceof Function?n():n}function bj(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var GS="ng-template";function Mj(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&bj(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(d_(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function d_(n){return n.type===4&&n.value!==GS}function Tj(n,e,t){let r=n.type===4&&!t?GS:n.value;return e===r}function Sj(n,e,t){let r=4,i=n.attrs,o=i!==null?Rj(i):0,s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!di(r)&&!di(l))return!1;if(s&&di(l))continue;s=!1,r=l|r&1;continue}if(!s)if(r&4){if(r=2|r&1,l!==""&&!Tj(n,l,t)||l===""&&e.length===1){if(di(r))return!1;s=!0}}else if(r&8){if(i===null||!Mj(n,i,l,t)){if(di(r))return!1;s=!0}}else{let c=e[++a],u=Ij(l,i,d_(n),t);if(u===-1){if(di(r))return!1;s=!0;continue}if(c!==""){let d;if(u>o?d="":d=i[u+1].toLowerCase(),r&2&&c!==d){if(di(r))return!1;s=!0}}}}return di(r)||s}function di(n){return(n&1)===0}function Ij(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return Aj(e,n)}function Dj(n,e,t=!1){for(let r=0;r<e.length;r++)if(Sj(n,e[r],t))return!0;return!1}function Rj(n){for(let e=0;e<n.length;e++){let t=n[e];if(Ek(t))return e}return n.length}function Aj(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function zM(n,e){return n?":not("+e.trim()+")":e}function Pj(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!di(s)&&(e+=zM(o,i),i=""),r=s,o=o||!di(r);t++}return i!==""&&(e+=zM(o,i)),e}function Nj(n){return n.map(Pj).join(",")}function Oj(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!di(i))break;i=o}r++}return t.length&&e.push(1,...t),e}var Yi={};function Fj(n,e){return n.createText(e)}function Lj(n,e,t){n.setValue(e,t)}function kj(n,e){return n.createComment(wj(e))}function US(n,e,t){return n.createElement(e,t)}function sp(n,e,t,r,i){n.insertBefore(e,t,r,i)}function zS(n,e,t){n.appendChild(e,t)}function $M(n,e,t,r,i){r!==null?sp(n,e,t,r,i):zS(n,e,t)}function jj(n,e,t){n.removeChild(null,e,t)}function Vj(n,e,t){n.setAttribute(e,"style",t)}function Bj(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function $S(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&xk(n,e,r),i!==null&&Bj(n,e,i),o!==null&&Vj(n,e,o)}function f_(n,e,t,r,i,o,s,a,l,c,u){let d=Gr+r,f=d+i,h=Gj(d,f),p=typeof c=="function"?c():c;return h[Oe]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}function Gj(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Yi);return t}function Uj(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=f_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function h_(n,e,t,r,i,o,s,a,l,c,u){let d=e.blueprint.slice();return d[ko]=i,d[de]=r|4|128|8|64|1024,(c!==null||n&&n[de]&2048)&&(d[de]|=2048),jT(d),d[Vn]=d[Kl]=n,d[or]=t,d[Po]=s||n&&n[Po],d[an]=a||n&&n[an],d[zl]=l||n&&n[zl]||null,d[mi]=o,d[xp]=$k(),d[qh]=u,d[DT]=c,d[qi]=e.type==2?n[qi]:d,d}function zj(n,e,t){let r=Vo(e,n),i=Uj(t),o=n[Po].rendererFactory,s=p_(n,h_(n,i,null,HS(t),r,e,null,o.createRenderer(r,t),null,null,null));return n[e.index]=s}function HS(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function qS(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function p_(n,e){return n[qu]?n[MM][hi]=e:n[qu]=e,n[MM]=e,e}function Ze(n=1){WS(Bn(),ct(),Ql()+n,!1)}function WS(n,e,t,r){if(!r)if((e[de]&3)===3){let o=n.preOrderCheckHooks;o!==null&&Vh(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Bh(e,o,0,t)}La(t)}var Dp=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Dp||{});function Ev(n,e,t,r){let i=Ne(null);try{let[o,s,a]=n.inputs[t],l=null;(s&Dp.SignalBased)!==0&&(l=e[o][Ru]),l!==null&&l.transformFn!==void 0?r=l.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,l,r,t,o):AT(e,l,o,r)}finally{Ne(i)}}function XS(n,e,t,r,i){let o=Ql(),s=r&2;try{La(-1),s&&e.length>Gr&&WS(n,e,Gr,!1),gt(s?2:0,i),t(r,i)}finally{La(o),gt(s?3:1,i)}}function Rp(n,e,t){Zj(n,e,t),(t.flags&64)===64&&Yj(n,e,t)}function m_(n,e,t=Vo){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function $j(n,e,t,r){let o=r.get(Zk,TS)||t===Xi.ShadowDom,s=n.selectRootElement(e,o);return Hj(s),s}function Hj(n){qj(n)}var qj=()=>null;function Wj(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function g_(n,e,t,r,i,o,s,a){if(!a&&v_(e,n,t,r,i)){Jl(e)&&Xj(t,e.index);return}if(e.type&3){let l=Vo(e,t);r=Wj(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(l,r,i)}else e.type&12}function Xj(n,e){let t=No(e,n);t[de]&16||(t[de]|=64)}function Zj(n,e,t){let r=t.directiveStart,i=t.directiveEnd;Jl(t)&&zj(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||tp(t,e);let o=t.initialInputs;for(let s=r;s<i;s++){let a=n.data[s],l=np(e,n,s,t);if(tc(l,e),o!==null&&Jj(e,s-r,l,a,t,o),Is(a)){let c=No(t.index,e);c[or]=np(e,n,s,t)}}}function Yj(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=dk();try{La(o);for(let a=r;a<i;a++){let l=n.data[a],c=e[a];iv(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&Kj(l,c)}}finally{La(-1),iv(s)}}function Kj(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function y_(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let o=t[i];Dj(e,o.selectors,!1)&&(r??=[],Is(o)?r.unshift(o):r.push(o))}return r}function Jj(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let l=s[a],c=s[a+1];Ev(r,t,l,c)}}function Qj(n,e){let t=n[zl],r=t?t.get(br,null):null;r&&r.handleError(e)}function v_(n,e,t,r,i){let o=n.inputs?.[r],s=n.hostDirectiveInputs?.[r],a=!1;if(s)for(let l=0;l<s.length;l+=2){let c=s[l],u=s[l+1],d=e.data[c];Ev(d,t[c],u,i),a=!0}if(o)for(let l of o){let c=t[l],u=e.data[l];Ev(u,c,r,i),a=!0}return a}function e3(n,e){let t=No(e,n),r=t[Oe];t3(r,t);let i=t[ko];i!==null&&t[qh]===null&&(t[qh]=IS(i,t[zl])),gt(18),__(r,t,t[or]),gt(19,t[or])}function t3(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function __(n,e,t){Kv(e);try{let r=n.viewQuery;r!==null&&fv(1,r,t);let i=n.template;i!==null&&XS(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Hl]?.finishViewCreation(n),n.staticContentQueries&&DS(n,e),n.staticViewQueries&&fv(2,n.viewQuery,t);let o=n.components;o!==null&&n3(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[de]&=-5,Jv()}}function n3(n,e){for(let t=0;t<e.length;t++)e3(n,e[t])}function r3(n,e,t,r){let i=Ne(null);try{let o=e.tView,a=n[de]&4096?4096:16,l=h_(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),c=n[e.index];l[$l]=c;let u=n[Hl];return u!==null&&(l[Hl]=u.createEmbeddedView(o)),__(o,l,t),l}finally{Ne(i)}}function HM(n,e){return!e||e.firstChild===null||vS(n)}var i3;function x_(n,e){return i3(n,e)}var Fo=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Fo||{});function ZS(n){return(n.flags&32)===32}function jl(n,e,t,r,i){if(r!=null){let o,s=!1;jo(r)?o=r:Pa(r)&&(s=!0,r=r[ko]);let a=Wi(r);n===0&&t!==null?i==null?zS(e,t,a):sp(e,t,a,i||null,!0):n===1&&t!==null?sp(e,t,a,i||null,!0):n===2?jj(e,a,s):n===3&&e.destroyNode(a),o!=null&&g3(e,n,o,t,i)}}function o3(n,e){YS(n,e),e[ko]=null,e[mi]=null}function s3(n,e,t,r,i,o){r[ko]=i,r[mi]=e,Pp(n,r,t,1,i,o)}function YS(n,e){e[Po].changeDetectionScheduler?.notify(9),Pp(n,e,e[an],2,null,null)}function a3(n){let e=n[qu];if(!e)return G0(n[Oe],n);for(;e;){let t=null;if(Pa(e))t=e[qu];else{let r=e[Br];r&&(t=r)}if(!t){for(;e&&!e[hi]&&e!==n;)Pa(e)&&G0(e[Oe],e),e=e[Vn];e===null&&(e=n),Pa(e)&&G0(e[Oe],e),t=e&&e[hi]}e=t}}function E_(n,e){let t=n[Yh],r=t.indexOf(e);t.splice(r,1)}function KS(n,e){if(Yu(e))return;let t=e[an];t.destroyNode&&Pp(n,e,t,3,null,null),a3(e)}function G0(n,e){if(Yu(e))return;let t=Ne(null);try{e[de]&=-129,e[de]|=256,e[Vr]&&p0(e[Vr]),c3(n,e),l3(n,e),e[Oe].type===1&&e[an].destroy();let r=e[$l];if(r!==null&&jo(e[Vn])){r!==e[Vn]&&E_(r,e);let i=e[Hl];i!==null&&i.detachView(n)}uv(e)}finally{Ne(t)}}function l3(n,e){let t=n.cleanup,r=e[Wh];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[Wh]=null);let i=e[Ss];if(i!==null){e[Ss]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[Xh];if(o!==null){e[Xh]=null;for(let s of o)s.destroy()}}function c3(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof ka)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],l=o[s+1];gt(4,a,l);try{l.call(a)}finally{gt(5,a,l)}}else{gt(4,i,o);try{o.call(i)}finally{gt(5,i,o)}}}}}function u3(n,e,t){return d3(n,e.parent,t)}function d3(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[ko];if(Jl(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===Xi.None||i===Xi.Emulated)return null}return Vo(r,t)}function f3(n,e,t){return p3(n,e,t)}function h3(n,e,t){return n.type&40?Vo(n,t):null}var p3=h3,qM;function Ap(n,e,t,r){let i=u3(n,r,e),o=e[an],s=r.parent||e[mi],a=f3(s,r,e);if(i!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)$M(o,i,t[l],a,!1);else $M(o,i,t,a,!1);qM!==void 0&&qM(o,r,e,t,i)}function Vu(n,e){if(e!==null){let t=e.type;if(t&3)return Vo(e,n);if(t&4)return wv(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Vu(n,r);{let i=n[e.index];return jo(i)?wv(-1,i):Wi(i)}}else{if(t&128)return Vu(n,e.next);if(t&32)return x_(e,n)()||Wi(n[e.index]);{let r=JS(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Fa(n[qi]);return Vu(i,r)}else return Vu(n,e.next)}}}return null}function JS(n,e){if(e!==null){let r=n[qi][mi],i=e.projection;return r.projection[i]}return null}function wv(n,e){let t=Br+n+1;if(t<e.length){let r=e[t],i=r[Oe].firstChild;if(i!==null)return Vu(r,i)}return e[Oa]}function w_(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],l=t.type;if(s&&e===0&&(a&&tc(Wi(a),r),t.flags|=2),!ZS(t))if(l&8)w_(n,e,t.child,r,i,o,!1),jl(e,n,i,a,o);else if(l&32){let c=x_(t,r),u;for(;u=c();)jl(e,n,i,u,o);jl(e,n,i,a,o)}else l&16?m3(n,e,r,t,i,o):jl(e,n,i,a,o);t=s?t.projectionNext:t.next}}function Pp(n,e,t,r,i,o){w_(t,r,n.firstChild,e,i,o,!1)}function m3(n,e,t,r,i,o){let s=t[qi],l=s[mi].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];jl(e,n,i,u,o)}else{let c=l,u=s[Vn];vS(r)&&(c.flags|=128),w_(n,e,c,u,i,o,!0)}}function g3(n,e,t,r,i){let o=t[Oa],s=Wi(t);o!==s&&jl(e,n,r,o,i);for(let a=Br;a<t.length;a++){let l=t[a];Pp(l[Oe],l,n,e,r,o)}}function y3(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:Fo.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Fo.Important),n.setStyle(t,r,i,o))}}function ap(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(Wi(o)),jo(o)&&v3(o,r);let s=t.type;if(s&8)ap(n,e,t.child,r);else if(s&32){let a=x_(t,e),l;for(;l=a();)r.push(l)}else if(s&16){let a=JS(e,t);if(Array.isArray(a))r.push(...a);else{let l=Fa(e[qi]);ap(l[Oe],l,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function v3(n,e){for(let t=Br;t<n.length;t++){let r=n[t],i=r[Oe].firstChild;i!==null&&ap(r[Oe],r,i,e)}n[Oa]!==n[ko]&&e.push(n[Oa])}function QS(n){if(n[j0]!==null){for(let e of n[j0])e.impl.addSequence(e);n[j0].length=0}}var eI=[];function _3(n){return n[Vr]??x3(n)}function x3(n){let e=eI.pop()??Object.create(w3);return e.lView=n,e}function E3(n){n.lView[Vr]!==n&&(n.lView=null,eI.push(n))}var w3=jn(xt({},d0),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{wp(n.lView)},consumerOnSignalRead(){this.lView[Vr]=this}});function C3(n){let e=n[Vr]??Object.create(b3);return e.lView=n,e}var b3=jn(xt({},d0),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Fa(n.lView);for(;e&&!tI(e[Oe]);)e=Fa(e);e&&Xv(e)},consumerOnSignalRead(){this.lView[Vr]=this}});function tI(n){return n.type!==2}function nI(n){if(n[Xh]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[Xh])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[de]&8192)}}var M3=100;function rI(n,e=!0,t=0){let i=n[Po].rendererFactory,o=!1;o||i.begin?.();try{T3(n,t)}catch(s){throw e&&Qj(n,s),s}finally{o||i.end?.()}}function T3(n,e){let t=$T();try{SM(!0),Cv(n,e);let r=0;for(;Ku(n);){if(r===M3)throw new Q(103,!1);r++,Cv(n,1)}}finally{SM(t)}}function S3(n,e,t,r){if(Yu(e))return;let i=e[de],o=!1,s=!1;Kv(e);let a=!0,l=null,c=null;o||(tI(n)?(c=_3(e),l=f0(c)):u0()===null?(a=!1,c=C3(e),l=f0(c)):e[Vr]&&(p0(e[Vr]),e[Vr]=null));try{jT(e),lk(n.bindingStartIndex),t!==null&&XS(n,e,t,2,r);let u=(i&3)===3;if(!o)if(u){let h=n.preOrderCheckHooks;h!==null&&Vh(e,h,null)}else{let h=n.preOrderHooks;h!==null&&Bh(e,h,0,null),V0(e,0)}if(s||I3(e),nI(e),iI(e,0),n.contentQueries!==null&&DS(n,e),!o)if(u){let h=n.contentCheckHooks;h!==null&&Vh(e,h)}else{let h=n.contentHooks;h!==null&&Bh(e,h,1),V0(e,1)}R3(n,e);let d=n.components;d!==null&&sI(e,d,0);let f=n.viewQuery;if(f!==null&&fv(2,f,r),!o)if(u){let h=n.viewCheckHooks;h!==null&&Vh(e,h)}else{let h=n.viewHooks;h!==null&&Bh(e,h,2),V0(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[k0]){for(let h of e[k0])h();e[k0]=null}o||(QS(e),e[de]&=-73)}catch(u){throw o||wp(e),u}finally{c!==null&&($b(c,l),a&&E3(c)),Jv()}}function iI(n,e){for(let t=ES(n);t!==null;t=wS(t))for(let r=Br;r<t.length;r++){let i=t[r];oI(i,e)}}function I3(n){for(let e=ES(n);e!==null;e=wS(e)){if(!(e[de]&2))continue;let t=e[Yh];for(let r=0;r<t.length;r++){let i=t[r];Xv(i)}}}function D3(n,e,t){gt(18);let r=No(e,n);oI(r,t),gt(19,r[or])}function oI(n,e){Wv(n)&&Cv(n,e)}function Cv(n,e){let r=n[Oe],i=n[de],o=n[Vr],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&h0(o)),s||=!1,o&&(o.dirty=!1),n[de]&=-9217,s)S3(r,n,r.template,n[or]);else if(i&8192){nI(n),iI(n,1);let a=r.components;a!==null&&sI(n,a,1),QS(n)}}function sI(n,e,t){for(let r=0;r<e.length;r++)D3(n,e[r],t)}function R3(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)La(~i);else{let o=i,s=t[++r],a=t[++r];uk(s,o);let l=e[o];gt(24,l),a(2,l),gt(25,l)}}}finally{La(-1)}}function C_(n,e){let t=$T()?64:1088;for(n[Po].changeDetectionScheduler?.notify(e);n;){n[de]|=t;let r=Fa(n);if(Kh(n)&&!r)return n;n=r}return null}function aI(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function A3(n,e,t,r=!0){let i=e[Oe];if(P3(i,e,n,t),r){let s=wv(t,n),a=e[an],l=a.parentNode(n[Oa]);l!==null&&s3(i,n[mi],a,e,l,s)}let o=e[qh];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function bv(n,e){if(n.length<=Br)return;let t=Br+e,r=n[t];if(r){let i=r[$l];i!==null&&i!==n&&E_(i,r),e>0&&(n[t-1][hi]=r[hi]);let o=$h(n,Br+e);o3(r[Oe],r);let s=o[Hl];s!==null&&s.detachView(o[Oe]),r[Vn]=null,r[hi]=null,r[de]&=-129}return r}function P3(n,e,t,r){let i=Br+r,o=t.length;r>0&&(t[i-1][hi]=e),r<o-Br?(e[hi]=t[i],wT(t,Br+r,e)):(t.push(e),e[hi]=null),e[Vn]=t;let s=e[$l];s!==null&&t!==s&&lI(s,e);let a=e[Hl];a!==null&&a.insertView(n),nv(e),e[de]|=128}function lI(n,e){let t=n[Yh],r=e[Vn];if(Pa(r))n[de]|=2;else{let i=r[Vn][qi];e[qi]!==i&&(n[de]|=2)}t===null?n[Yh]=[e]:t.push(e)}var Wu=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,t=e[Oe];return ap(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r}get context(){return this._lView[or]}set context(e){this._lView[or]=e}get destroyed(){return Yu(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Vn];if(jo(e)){let t=e[Zh],r=t?t.indexOf(this):-1;r>-1&&(bv(e,r),$h(t,r))}this._attachedToViewContainer=!1}KS(this._lView[Oe],this._lView)}onDestroy(e){VT(this._lView,e)}markForCheck(){C_(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[de]&=-129}reattach(){nv(this._lView),this._lView[de]|=128}detectChanges(){this._lView[de]|=1024,rI(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Q(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Kh(this._lView),t=this._lView[$l];t!==null&&!e&&E_(t,this._lView),YS(this._lView[Oe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Q(902,!1);this._appRef=e;let t=Kh(this._lView),r=this._lView[$l];r!==null&&!t&&lI(r,this._lView),nv(this._lView)}};function cI(n){return Ku(n._lView)||!!(n._lView[de]&64)}function uI(n){Xv(n._cdRefInjectingView||n._lView)}var Np=(()=>{class n{static __NG_ELEMENT_ID__=F3}return n})(),N3=Np,O3=class extends N3{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=r3(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Wu(i)}};function F3(){return L3(gi(),ct())}function L3(n,e){return n.type&4?new O3(e,n,Tp(n,e)):null}function Op(n,e,t,r,i){let o=n.data[e];if(o===null)o=k3(n,e,t,r,i),ck()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=ok();o.injectorIndex=s===null?-1:s.injectorIndex}return Ga(o,!0),o}function k3(n,e,t,r,i){let o=UT(),s=Yv(),a=s?o:o&&o.parent,l=n.data[e]=V3(n,a,t,e,r,i);return j3(n,l,o,s),l}function j3(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function V3(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return nk()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var KK=new RegExp(`^(\\d+)*(${Xk}|${Wk})*(.*)`);var B3=()=>null;function WM(n,e){return B3(n,e)}var G3=class{},dI=class{},Mv=class{resolveComponentFactory(e){throw Error(`No component factory found for ${ir(e)}.`)}},za=class{static NULL=new Mv},Wl=class{};var U3=(()=>{class n{static \u0275prov=Y({token:n,providedIn:"root",factory:()=>null})}return n})();var U0={},Tv=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=yp(r);let i=this.injector.get(e,U0,r);return i!==U0||t===U0?i:this.parentInjector.get(e,t,r)}};function Sv(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=yM(i,a);else if(o==2){let l=a,c=e[++s];r=yM(r,l+": "+c+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function pe(n,e=De.Default){let t=ct();if(t===null)return U(n,e);let r=gi();return lS(r,t,rr(n),e)}function b_(n,e,t,r,i){let o=r===null?null:{"":-1},s=i(n,t);if(s!==null){let a,l=null,c=null,u=$3(s);u===null?a=s:[a,l,c]=u,W3(n,e,t,a,o,l,c)}o!==null&&r!==null&&z3(t,r,o)}function z3(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new Q(-301,!1);r.push(e[i],o)}}function $3(n){let e=null,t=!1;for(let s=0;s<n.length;s++){let a=n[s];if(s===0&&Is(a)&&(e=a),a.findHostDirectiveDefs!==null){t=!0;break}}if(!t)return null;let r=null,i=null,o=null;for(let s of n)s.findHostDirectiveDefs!==null&&(r??=[],i??=new Map,o??=new Map,H3(s,r,o,i)),s===e&&(r??=[],r.push(s));return r!==null?(r.push(...e===null?n:n.slice(1)),[r,i,o]):null}function H3(n,e,t,r){let i=e.length;n.findHostDirectiveDefs(n,e,r),t.set(n,[i,e.length-1])}function q3(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function W3(n,e,t,r,i,o,s){let a=r.length,l=!1;for(let f=0;f<a;f++){let h=r[f];!l&&Is(h)&&(l=!0,q3(n,t,f)),sv(tp(t,e),n,h.type)}Q3(t,n.data.length,a);for(let f=0;f<a;f++){let h=r[f];h.providersResolver&&h.providersResolver(h)}let c=!1,u=!1,d=qS(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let f=0;f<a;f++){let h=r[f];if(t.mergedAttrs=Mp(t.mergedAttrs,h.hostAttrs),Z3(n,t,e,d,h),J3(d,h,i),s!==null&&s.has(h)){let[m,g]=s.get(h);t.directiveToIndex.set(h.type,[d,m+t.directiveStart,g+t.directiveStart])}else(o===null||!o.has(h))&&t.directiveToIndex.set(h.type,d);h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let p=h.type.prototype;!c&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),c=!0),!u&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),u=!0),d++}X3(n,t,o)}function X3(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))XM(0,e,i,r),XM(1,e,i,r),YM(e,r,!1);else{let o=t.get(i);ZM(0,e,o,r),ZM(1,e,o,r),YM(e,r,!0)}}}function XM(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(r),fI(e,o)}}function ZM(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,o),fI(e,s)}}function fI(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function YM(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:o}=n;if(r===null||!t&&i===null||t&&o===null||d_(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let l=r[a];if(l===0){a+=4;continue}else if(l===5){a+=2;continue}else if(typeof l=="number")break;if(!t&&i.hasOwnProperty(l)){let c=i[l];for(let u of c)if(u===e){s??=[],s.push(l,r[a+1]);break}}else if(t&&o.hasOwnProperty(l)){let c=o[l];for(let u=0;u<c.length;u+=2)if(c[u]===e){s??=[],s.push(c[u+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function Z3(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=Bl(i.type,!0)),s=new ka(o,Is(i),pe);n.blueprint[r]=s,t[r]=s,Y3(n,e,r,qS(n,t,i.hostVars,Yi),i)}function Y3(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;K3(s)!=a&&s.push(a),s.push(t,r,o)}}function K3(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function J3(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Is(e)&&(t[""]=n)}}function Q3(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function hI(n,e,t,r,i,o,s,a){let l=e.consts,c=ql(l,s),u=Op(e,n,2,r,c);return o&&b_(e,t,u,ql(l,a),i),u.mergedAttrs=Mp(u.mergedAttrs,u.attrs),u.attrs!==null&&Sv(u,u.attrs,!1),u.mergedAttrs!==null&&Sv(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function pI(n,e){e_(n,e),qv(e)&&n.queries.elementEnd(e)}var lp=class extends za{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=$u(e);return new cp(t,this.ngModule)}};function e5(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],o={propName:t,templateName:e,isSignal:(r&Dp.SignalBased)!==0};return i&&(o.transform=i),o})}function t5(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function n5(n,e,t){let r=e instanceof Hi?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new Tv(t,r):t}function r5(n){let e=n.get(Wl,null);if(e===null)throw new Q(407,!1);let t=n.get(U3,null),r=n.get(ja,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r}}function i5(n,e){let t=(n.selectors[0][0]||"div").toLowerCase();return US(e,t,t==="svg"?FT:t==="math"?XL:null)}var cp=class extends dI{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=e5(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=t5(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Nj(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i){gt(22);let o=Ne(null);try{let s=this.componentDef,a=r?["ng-version","19.2.6"]:Oj(this.componentDef.selectors[0]),l=f_(0,null,null,1,0,null,null,null,null,[a],null),c=n5(s,i||this.ngModule,e),u=r5(c),d=u.rendererFactory.createRenderer(null,s),f=r?$j(d,r,s.encapsulation,c):i5(s,d),h=h_(null,l,null,512|HS(s),null,null,u,d,c,null,IS(f,c,!0));h[Gr]=f,Kv(h);let p=null;try{let m=hI(Gr,l,h,"#host",()=>[this.componentDef],!0,0);f&&($S(d,f,m),tc(f,h)),Rp(l,h,m),l_(l,m,h),pI(l,m),t!==void 0&&o5(m,this.ngContentSelectors,t),p=No(m.index,h),h[or]=p[or],__(l,h,null)}catch(m){throw p!==null&&uv(p),uv(h),m}finally{gt(23),Jv()}return new Iv(this.componentType,h)}finally{Ne(o)}}},Iv=class extends G3{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t){super(),this._rootLView=t,this._tNode=kT(t[Oe],Gr),this.location=Tp(this._tNode,t),this.instance=No(this._tNode.index,t)[or],this.hostView=this.changeDetectorRef=new Wu(t,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,o=v_(r,i[Oe],i,e,t);this.previousInputValues.set(e,t);let s=No(r.index,i);C_(s,1)}get injector(){return new Na(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function o5(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}var Fp=(()=>{class n{static __NG_ELEMENT_ID__=s5}return n})();function s5(){let n=gi();return l5(n,ct())}var a5=Fp,mI=class extends a5{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Tp(this._hostTNode,this._hostLView)}get injector(){return new Na(this._hostTNode,this._hostLView)}get parentInjector(){let e=t_(this._hostTNode,this._hostLView);if(nS(e)){let t=Qh(e,this._hostLView),r=Jh(e),i=t[Oe].data[r+8];return new Na(i,t)}else return new Na(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=KM(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Br}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=WM(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,HM(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!$L(e),a;if(s)a=t;else{let p=t||{};a=p.index,r=p.injector,i=p.projectableNodes,o=p.environmentInjector||p.ngModuleRef}let l=s?e:new cp($u(e)),c=r||this.parentInjector;if(!o&&l.ngModule==null){let m=(s?c:this.parentInjector).get(Hi,null);m&&(o=m)}let u=$u(l.componentType??{}),d=WM(this._lContainer,u?.id??null),f=d?.firstChild??null,h=l.create(c,i,f,o);return this.insertImpl(h.hostView,a,HM(this._hostTNode,d)),h}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(YL(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=i[Vn],c=new mI(l,l[mi],l[Vn]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return A3(s,i,o,r),e.attachToViewContainerRef(),wT(z0(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=KM(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=bv(this._lContainer,t);r&&($h(z0(this._lContainer),t),KS(r[Oe],r))}detach(e){let t=this._adjustIndex(e,-1),r=bv(this._lContainer,t);return r&&$h(z0(this._lContainer),t)!=null?new Wu(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function KM(n){return n[Zh]}function z0(n){return n[Zh]||(n[Zh]=[])}function l5(n,e){let t,r=e[n.index];return jo(r)?t=r:(t=aI(r,e,null,n),e[n.index]=t,p_(e,t)),u5(t,e,n,r),new mI(t,n,e)}function c5(n,e){let t=n[an],r=t.createComment(""),i=Vo(e,n),o=t.parentNode(i);return sp(t,o,r,t.nextSibling(i),!1),r}var u5=h5,d5=()=>!1;function f5(n,e,t){return d5(n,e,t)}function h5(n,e,t,r){if(n[Oa])return;let i;t.type&8?i=Wi(r):i=c5(e,t),n[Oa]=i}function p5(n){let e=[],t=new Map;function r(i){let o=t.get(i);if(!o){let s=n(i);t.set(i,o=s.then(v5))}return o}return up.forEach((i,o)=>{let s=[];i.templateUrl&&s.push(r(i.templateUrl).then(c=>{i.template=c}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let c=i.styles.length,u=i.styleUrls;i.styleUrls.forEach((d,f)=>{a.push(""),s.push(r(d).then(h=>{a[c+f]=h,u.splice(u.indexOf(d),1),u.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&s.push(r(i.styleUrl).then(c=>{a.push(c),i.styleUrl=void 0}));let l=Promise.all(s).then(()=>_5(o));e.push(l)}),g5(),Promise.all(e).then(()=>{})}var up=new Map,m5=new Set;function g5(){let n=up;return up=new Map,n}function y5(){return up.size===0}function v5(n){return typeof n=="string"?n:n.text()}function _5(n){m5.delete(n)}var Xl=class{},x5=class{};var dp=class extends Xl{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new lp(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=DL(e);this._bootstrapComponents=Cj(o.bootstrap),this._r3Injector=dS(e,t,[{provide:Xl,useValue:this},{provide:za,useValue:this.componentFactoryResolver},...r],ir(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Dv=class extends x5{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new dp(this.moduleType,e,[])}};function E5(n,e,t){return new dp(n,e,t,!1)}var Rv=class extends Xl{injector;componentFactoryResolver=new lp(this);instance=null;constructor(e){super();let t=new Hu([...e.providers,{provide:Xl,useValue:this},{provide:za,useValue:this.componentFactoryResolver}],e.parent||Hv(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function w5(n,e,t=null){return new Rv({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var C5=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=MT(!1,t.type),i=r.length>0?w5([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Y({token:n,providedIn:"environment",factory:()=>new n(U(Hi))})}return n})();function bn(n){return gp(()=>{let e=gI(n),t=jn(xt({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===_S.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(C5).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Xi.Emulated,styles:n.styles||fi,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Yk("NgStandalone"),yI(t);let r=n.dependencies;return t.directiveDefs=JM(r,!1),t.pipeDefs=JM(r,!0),t.id=I5(t),t})}function b5(n){return $u(n)||RL(n)}function M5(n){return n!==null}function yi(n){return gp(()=>({type:n.type,bootstrap:n.bootstrap||fi,declarations:n.declarations||fi,imports:n.imports||fi,exports:n.exports||fi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function T5(n,e){if(n==null)return Gl;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a,l;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o,l=i[3]||null):(o=i,s=i,a=Dp.None,l=null),t[o]=[r,a,l],e[o]=s}return t}function S5(n){if(n==null)return Gl;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function M_(n){return gp(()=>{let e=gI(n);return yI(e),e})}function Qu(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function gI(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Gl,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||fi,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:T5(n.inputs,e),outputs:S5(n.outputs),debugInfo:null}}function yI(n){n.features?.forEach(e=>e(n))}function JM(n,e){if(!n)return null;let t=e?AL:b5;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(M5)}function I5(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function vI(n){return R5(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function D5(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function R5(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function A5(n,e,t){return n[e]=t}function Zl(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function P5(n,e,t,r){let i=Zl(n,e,t);return Zl(n,e+1,r)||i}function N5(n,e,t,r,i,o,s,a,l){let c=e.consts,u=Op(e,n,4,s||null,a||null);Zv()&&b_(e,t,u,ql(c,l),y_),u.mergedAttrs=Mp(u.mergedAttrs,u.attrs),e_(e,u);let d=u.tView=f_(2,u,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function O5(n,e,t,r,i,o,s,a,l,c){let u=t+Gr,d=e.firstCreatePass?N5(u,e,n,r,i,o,s,a,l):e.data[u];Ga(d,!1);let f=F5(e,n,d,t);Cp()&&Ap(e,n,f,d),tc(f,n);let h=aI(f,n,f,d);return n[u]=h,p_(n,h),f5(h,d,n),Ep(d)&&Rp(e,n,d),l!=null&&m_(n,d,c),d}function Mn(n,e,t,r,i,o,s,a){let l=ct(),c=Bn(),u=ql(c.consts,o);return O5(l,c,n,e,t,r,i,u,s,a),Mn}var F5=L5;function L5(n,e,t,r){return bp(!0),e[an].createComment("")}var T_=new oe(""),ed=new oe(""),Lp=(()=>{class n{_ngZone;registry;_isZoneStable=!0;_callbacks=[];taskTrackingZone=null;constructor(t,r,i){this._ngZone=t,this.registry=r,S_||(k5(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{st.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(t)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),t()},r)),this._callbacks.push({doneCb:t,timeoutId:o,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static \u0275fac=function(r){return new(r||n)(U(st),U(kp),U(ed))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),kp=(()=>{class n{_applications=new Map;registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return S_?.findTestabilityInTree(this,t,r)??null}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function k5(n){S_=n}var S_,j5=(()=>{class n{static \u0275prov=Y({token:n,providedIn:"root",factory:()=>new Av})}return n})(),Av=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}};function jp(n){return!!n&&typeof n.then=="function"}function I_(n){return!!n&&typeof n.subscribe=="function"}var V5=new oe("");var _I=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=Se(V5,{optional:!0})??[];injector=Se(Cr);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=_p(this.injector,i);if(jp(o))t.push(o);else if(I_(o)){let s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),B5=new oe("");function G5(){v0(()=>{throw new Q(600,!1)})}function U5(n){return n.isBoundToModule}var z5=10;function xI(n,e){return Array.isArray(e)?e.reduce(xI,n):xt(xt({},n),e)}var Lo=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=Se(Gk);afterRenderManager=Se(Kk);zonelessEnabled=Se(n_);rootEffectScheduler=Se(j5);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new wr;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=Se(ec).hasPendingTasks.pipe(ue(t=>!t));constructor(){Se(Sp,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=Se(Hi);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=Cr.NULL){gt(10);let o=t instanceof dI;if(!this._injector.get(_I).done){let h="";throw new Q(405,h)}let a;o?a=t:a=this._injector.get(za).resolveComponentFactory(t),this.componentTypes.push(a.componentType);let l=U5(a)?void 0:this._injector.get(Xl),c=r||a.selector,u=a.create(i,[],c,l),d=u.location.nativeElement,f=u.injector.get(T_,null);return f?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),Gh(this.components,u),f?.unregisterApplication(d)}),this._loadComponent(u),gt(11,u),u}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){gt(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(SS.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Q(101,!1);let t=Ne(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Ne(t),this.afterTick.next(),gt(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Wl,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<z5;)gt(14),this.synchronizeOnce(),gt(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let t=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)$5(r,i,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Ku(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Gh(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(B5,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Gh(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Q(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Gh(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function $5(n,e,t,r){if(!t&&!Ku(n))return;rI(n,e,t&&!r?0:1)}function EI(n,e,t,r){return Zl(n,HT(),t)?e+Uu(t)+r:Yi}function H5(n,e,t,r,i,o){let s=ak(),a=P5(n,s,t,i);return qT(2),a?e+Uu(t)+r+Uu(i)+o:Yi}function Lh(n,e){return n<<17|e<<2}function Va(n){return n>>17&32767}function q5(n){return(n&2)==2}function W5(n,e){return n&131071|e<<17}function Pv(n){return n|2}function Yl(n){return(n&131068)>>2}function $0(n,e){return n&-131069|e<<2}function X5(n){return(n&1)===1}function Nv(n){return n|1}function Z5(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=Va(s),l=Yl(s);n[r]=t;let c=!1,u;if(Array.isArray(t)){let d=t;u=d[1],(u===null||Zu(d,u)>0)&&(c=!0)}else u=t;if(i)if(l!==0){let f=Va(n[a+1]);n[r+1]=Lh(f,a),f!==0&&(n[f+1]=$0(n[f+1],r)),n[a+1]=W5(n[a+1],r)}else n[r+1]=Lh(a,0),a!==0&&(n[a+1]=$0(n[a+1],r)),a=r;else n[r+1]=Lh(l,0),a===0?a=r:n[l+1]=$0(n[l+1],r),l=r;c&&(n[r+1]=Pv(n[r+1])),QM(n,u,r,!0),QM(n,u,r,!1),Y5(e,u,n,r,o),s=Lh(a,l),o?e.classBindings=s:e.styleBindings=s}function Y5(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Zu(o,e)>=0&&(t[r+1]=Nv(t[r+1]))}function QM(n,e,t,r){let i=n[t+1],o=e===null,s=r?Va(i):Yl(i),a=!1;for(;s!==0&&(a===!1||o);){let l=n[s],c=n[s+1];K5(l,e)&&(a=!0,n[s+1]=r?Nv(c):Pv(c)),s=r?Va(c):Yl(c)}a&&(n[t+1]=r?Pv(i):Nv(i))}function K5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Zu(n,e)>=0:!1}function Et(n,e,t){let r=ct(),i=HT();if(Zl(r,i,e)){let o=Bn(),s=Qv();g_(o,s,r,n,e,r[an],t,!1)}return Et}function eT(n,e,t,r,i){v_(e,n,t,i?"class":"style",r)}function $a(n,e,t){return J5(n,e,t,!1),$a}function J5(n,e,t,r){let i=ct(),o=Bn(),s=qT(2);if(o.firstUpdatePass&&eV(o,n,s,r),e!==Yi&&Zl(i,s,e)){let a=o.data[Ql()];oV(o,a,i,i[an],n,i[s+1]=sV(e,t),r,s)}}function Q5(n,e){return e>=n.expandoStartIndex}function eV(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[Ql()],s=Q5(n,t);aV(o,r)&&e===null&&!s&&(e=!1),e=tV(i,o,e,r),Z5(i,o,e,t,s,r)}}function tV(n,e,t,r){let i=fk(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=H0(null,n,e,t,r),t=Xu(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=H0(i,n,e,t,r),o===null){let l=nV(n,e,r);l!==void 0&&Array.isArray(l)&&(l=H0(null,n,e,l[1],r),l=Xu(l,e.attrs,r),rV(n,e,r,l))}else o=iV(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function nV(n,e,t){let r=t?e.classBindings:e.styleBindings;if(Yl(r)!==0)return n[Va(r)]}function rV(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[Va(i)]=r}function iV(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=Xu(r,s,t)}return Xu(r,e.attrs,t)}function H0(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=Xu(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function Xu(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),SL(n,s,t?!0:e[++o]))}return n===void 0?null:n}function oV(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let l=n.data,c=l[a+1],u=X5(c)?tT(l,e,t,i,Yl(c),s):void 0;if(!fp(u)){fp(o)||q5(c)&&(o=tT(l,null,t,i,a,s));let d=LT(Ql(),t);y3(r,s,d,i,o)}}function tT(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let l=n[i],c=Array.isArray(l),u=c?l[1]:l,d=u===null,f=t[i+1];f===Yi&&(f=d?fi:void 0);let h=d?F0(f,r):u===r?f:void 0;if(c&&!fp(h)&&(h=F0(l,r)),fp(h)&&(a=h,s))return a;let p=n[i+1];i=s?Va(p):Yl(p)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=F0(l,r))}return a}function fp(n){return n!==void 0}function sV(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=ir(As(n)))),n}function aV(n,e){return(n.flags&(e?8:16))!==0}function Fe(n,e,t,r){let i=ct(),o=Bn(),s=Gr+n,a=i[an],l=o.firstCreatePass?hI(s,o,i,e,y_,Zv(),t,r):o.data[s],c=lV(o,i,l,a,e,n);i[s]=c;let u=Ep(l);return Ga(l,!0),$S(a,c,l),!ZS(l)&&Cp()&&Ap(o,i,c,l),(QL()===0||u)&&tc(c,i),ek(),u&&(Rp(o,i,l),l_(o,l,i)),r!==null&&m_(i,l),Fe}function Re(){let n=gi();Yv()?zT():(n=n.parent,Ga(n,!1));let e=n;rk(e)&&ik(),tk();let t=Bn();return t.firstCreatePass&&pI(t,e),e.classesWithoutHost!=null&&vk(e)&&eT(t,e,ct(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&_k(e)&&eT(t,e,ct(),e.stylesWithoutHost,!1),Re}function Gn(n,e,t,r){return Fe(n,e,t,r),Re(),Gn}var lV=(n,e,t,r,i,o)=>(bp(!0),US(r,i,mk()));function cV(n,e,t,r,i){let o=e.consts,s=ql(o,r),a=Op(e,n,8,"ng-container",s);s!==null&&Sv(a,s,!0);let l=ql(o,i);return Zv()&&b_(e,t,a,l,y_),a.mergedAttrs=Mp(a.mergedAttrs,a.attrs),e.queries!==null&&e.queries.elementStart(e,a),a}function Vp(n,e,t){let r=ct(),i=Bn(),o=n+Gr,s=i.firstCreatePass?cV(o,i,r,e,t):i.data[o];Ga(s,!0);let a=uV(i,r,s,n);return r[o]=a,Cp()&&Ap(i,r,a,s),tc(a,r),Ep(s)&&(Rp(i,r,s),l_(i,s,r)),t!=null&&m_(r,s),Vp}function Bp(){let n=gi(),e=Bn();return Yv()?zT():(n=n.parent,Ga(n,!1)),e.firstCreatePass&&(e_(e,n),qv(n)&&e.queries.elementEnd(n)),Bp}var uV=(n,e,t,r)=>(bp(!0),kj(e[an],""));function td(){return ct()}var Ra=void 0;function dV(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var fV=["en",[["a","p"],["AM","PM"],Ra],[["AM","PM"],Ra,Ra],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Ra,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Ra,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Ra,"{1} 'at' {0}",Ra],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",dV],q0={};function Ur(n){let e=hV(n),t=nT(e);if(t)return t;let r=e.split("-")[0];if(t=nT(r),t)return t;if(r==="en")return fV;throw new Q(701,!1)}function nT(n){return n in q0||(q0[n]=sn.ng&&sn.ng.common&&sn.ng.common.locales&&sn.ng.common.locales[n]),q0[n]}var Vt=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Vt||{});function hV(n){return n.toLowerCase().replace(/_/g,"-")}var hp="en-US";var pV=hp;function mV(n){typeof n=="string"&&(pV=n.toLowerCase().replace(/_/g,"-"))}function rT(n,e,t){return function r(i){if(i===Function)return t;let o=Jl(n)?No(n.index,e):e;C_(o,5);let s=e[or],a=iT(e,s,t,i),l=r.__ngNextListenerFn__;for(;l;)a=iT(e,s,l,i)&&a,l=l.__ngNextListenerFn__;return a}}function iT(n,e,t,r){let i=Ne(null);try{return gt(6,e,t),t(r)!==!1}catch(o){return gV(n,o),!1}finally{gt(7,e,t),Ne(i)}}function gV(n,e){let t=n[zl],r=t?t.get(br,null):null;r&&r.handleError(e)}function oT(n,e,t,r,i,o){let s=e[t],a=e[Oe],c=a.data[t].outputs[r],u=s[c],d=a.firstCreatePass?GT(a):null,f=BT(e),h=u.subscribe(o),p=f.length;f.push(o,h),d&&d.push(i,n.index,p,-(p+1))}var yV=(n,e,t)=>{};function zo(n,e,t,r){let i=ct(),o=Bn(),s=gi();return _V(o,i,i[an],s,n,e,r),zo}function vV(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[Wh],l=i[o+2];return a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function _V(n,e,t,r,i,o,s){let a=Ep(r),c=n.firstCreatePass?GT(n):null,u=BT(e),d=!0;if(r.type&3||s){let f=Vo(r,e),h=s?s(f):f,p=u.length,m=s?y=>s(Wi(y[r.index])):r.index,g=null;if(!s&&a&&(g=vV(n,e,i,r.index)),g!==null){let y=g.__ngLastListenerFn__||g;y.__ngNextListenerFn__=o,g.__ngLastListenerFn__=o,d=!1}else{o=rT(r,e,o),yV(h,i,o);let y=t.listen(h,i,o);u.push(o,y),c&&c.push(i,m,p,p+1)}}else o=rT(r,e,o);if(d){let f=r.outputs?.[i],h=r.hostDirectiveOutputs?.[i];if(h&&h.length)for(let p=0;p<h.length;p+=2){let m=h[p],g=h[p+1];oT(r,e,m,g,i,o)}if(f&&f.length)for(let p of f)oT(r,e,p,i,i,o)}}function Bt(n=1){return pk(n)}function nd(n,e,t,r,i){let o=ct(),s=EI(o,e,t,r);if(s!==Yi){let a=Bn(),l=Qv();g_(a,l,o,n,s,o[an],i,!1)}return nd}function D_(n,e,t,r,i,o,s){let a=ct(),l=H5(a,e,t,r,i,o);if(l!==Yi){let c=Bn(),u=Qv();g_(c,u,a,n,l,a[an],s,!1)}return D_}function xV(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function ln(n,e=""){let t=ct(),r=Bn(),i=n+Gr,o=r.firstCreatePass?Op(r,i,1,e,null):r.data[i],s=EV(r,t,o,e,n);t[i]=s,Cp()&&Ap(r,t,s,o),Ga(o,!1)}var EV=(n,e,t,r,i)=>(bp(!0),Fj(e[an],r));function vi(n){return rd("",n,""),vi}function rd(n,e,t){let r=ct(),i=EI(r,n,e,t);return i!==Yi&&wV(r,Ql(),i),rd}function wV(n,e,t){let r=LT(e,n);Lj(n[an],r,t)}function CV(n,e,t){let r=Bn();if(r.firstCreatePass){let i=Is(n);Ov(t,r.data,r.blueprint,i,!0),Ov(e,r.data,r.blueprint,i,!1)}}function Ov(n,e,t,r,i){if(n=rr(n),Array.isArray(n))for(let o=0;o<n.length;o++)Ov(n[o],e,t,r,i);else{let o=Bn(),s=ct(),a=gi(),l=Ul(n)?n:rr(n.provide),c=IT(n),u=a.providerIndexes&1048575,d=a.directiveStart,f=a.providerIndexes>>20;if(Ul(n)||!n.multi){let h=new ka(c,i,pe),p=X0(l,e,i?u:u+f,d);p===-1?(sv(tp(a,s),o,l),W0(o,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(h),s.push(h)):(t[p]=h,s[p]=h)}else{let h=X0(l,e,u+f,d),p=X0(l,e,u,u+f),m=h>=0&&t[h],g=p>=0&&t[p];if(i&&!g||!i&&!m){sv(tp(a,s),o,l);let y=TV(i?MV:bV,t.length,i,r,c);!i&&g&&(t[p].providerFactory=y),W0(o,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(y),s.push(y)}else{let y=wI(t[i?p:h],c,!i&&r);W0(o,n,h>-1?h:p,y)}!i&&r&&g&&t[p].componentProviders++}}}function W0(n,e,t,r){let i=Ul(e),o=LL(e);if(i||o){let l=(o?rr(e.useClass):e).prototype.ngOnDestroy;if(l){let c=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let u=c.indexOf(t);u===-1?c.push(t,[r,l]):c[u+1].push(r,l)}else c.push(t,l)}}}function wI(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function X0(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function bV(n,e,t,r){return Fv(this.multi,[])}function MV(n,e,t,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=np(t,t[Oe],this.providerFactory.index,r);o=a.slice(0,s),Fv(i,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],Fv(i,o);return o}function Fv(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function TV(n,e,t,r,i){let o=new ka(n,t,pe);return o.multi=[],o.index=e,o.componentProviders=0,wI(o,i,r&&!t),o}function CI(n,e=[]){return t=>{t.providersResolver=(r,i)=>CV(r,i?i(n):n,e)}}function SV(n,e){let t=n[e];return t===Yi?void 0:t}function IV(n,e,t,r,i,o){let s=e+t;return Zl(n,s,i)?A5(n,s+1,o?r.call(o,i):r(i)):SV(n,s+1)}function R_(n,e){let t=Bn(),r,i=n+Gr;t.firstCreatePass?(r=DV(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=Bl(r.type,!0)),s,a=nr(pe);try{let l=ep(!1),c=o();return ep(l),xV(t,ct(),i,c),c}finally{nr(a)}}function DV(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function A_(n,e,t){let r=n+Gr,i=ct(),o=ZL(i,r);return RV(i,r)?IV(i,sk(),e,o.transform,t,o):o.transform(t)}function RV(n,e){return n[Oe].data[e].pure}var kh=null;function AV(n){kh!==null&&(n.defaultEncapsulation!==kh.defaultEncapsulation||n.preserveWhitespaces!==kh.preserveWhitespaces)||(kh=n)}var PV=new oe("");function NV(n,e,t){let r=new Dv(t);return Promise.resolve(r)}function sT(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var OV=(()=>{class n{zone=Se(st);changeDetectionScheduler=Se(ja);applicationRef=Se(Lo);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function FV({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new st(jn(xt({},bI()),{scheduleInRootZone:t})),[{provide:st,useFactory:n},{provide:zu,multi:!0,useFactory:()=>{let r=Se(OV,{optional:!0});return()=>r.initialize()}},{provide:zu,multi:!0,useFactory:()=>{let r=Se(LV);return()=>{r.initialize()}}},e===!0?{provide:pS,useValue:!0}:[],{provide:mS,useValue:t??fS}]}function bI(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var LV=(()=>{class n{subscription=new pn;initialized=!1;zone=Se(st);pendingTasks=Se(ec);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{st.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{st.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var kV=(()=>{class n{appRef=Se(Lo);taskService=Se(ec);ngZone=Se(st);zonelessEnabled=Se(n_);tracing=Se(Sp,{optional:!0});disableScheduling=Se(pS,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new pn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(ip):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(Se(mS,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof op||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?NM:gS;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(ip+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,NM(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function jV(){return typeof $localize<"u"&&$localize.locale||hp}var Gp=new oe("",{providedIn:"root",factory:()=>Se(Gp,De.Optional|De.SkipSelf)||jV()});var pp=new oe(""),VV=new oe("");function ku(n){return!n.moduleRef}function BV(n){let e=ku(n)?n.r3Injector:n.moduleRef.injector,t=e.get(st);return t.run(()=>{ku(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(br,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),ku(n)){let o=()=>e.destroy(),s=n.platformInjector.get(pp);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(pp);s.add(o),n.moduleRef.onDestroy(()=>{Gh(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return UV(r,t,()=>{let o=e.get(_I);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(Gp,hp);if(mV(s||hp),!e.get(VV,!0))return ku(n)?e.get(Lo):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(ku(n)){let l=e.get(Lo);return n.rootComponent!==void 0&&l.bootstrap(n.rootComponent),l}else return GV(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function GV(n,e){let t=n.injector.get(Lo);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new Q(-403,!1);e.push(n)}function UV(n,e,t){try{let r=t();return jp(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var MI=(()=>{class n{_injector;_modules=[];_destroyListeners=[];_destroyed=!1;constructor(t){this._injector=t}bootstrapModuleFactory(t,r){let i=r?.scheduleInRootZone,o=()=>Bk(r?.ngZone,jn(xt({},bI({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing})),{scheduleInRootZone:i})),s=r?.ignoreChangesOutsideZone,a=[FV({ngZoneFactory:o,ignoreChangesOutsideZone:s}),{provide:ja,useExisting:kV}],l=E5(t.moduleType,this.injector,a);return BV({moduleRef:l,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(t,r=[]){let i=xI({},r);return NV(this.injector,i,t).then(o=>this.bootstrapModuleFactory(o,i))}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Q(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());let t=this._injector.get(pp,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static \u0275fac=function(r){return new(r||n)(U(Cr))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),Gu=null,TI=new oe("");function zV(n){if(Gu&&!Gu.get(TI,!1))throw new Q(400,!1);G5(),Gu=n;let e=n.get(MI);return qV(n),e}function P_(n,e,t=[]){let r=`Platform: ${e}`,i=new oe(r);return(o=[])=>{let s=SI();if(!s||s.injector.get(TI,!1)){let a=[...t,...o,{provide:i,useValue:!0}];n?n(a):zV($V(a,r))}return HV(i)}}function $V(n=[],e){return Cr.create({name:e,providers:[{provide:vp,useValue:"platform"},{provide:pp,useValue:new Set([()=>Gu=null])},...n]})}function HV(n){let e=SI();if(!e)throw new Q(401,!1);return e}function SI(){return Gu?.get(MI)??null}function qV(n){let e=n.get(s_,null);_p(n,()=>{e?.forEach(t=>t())})}var Up=(()=>{class n{static __NG_ELEMENT_ID__=WV}return n})();function WV(n){return XV(gi(),ct(),(n&16)===16)}function XV(n,e,t){if(Jl(n)&&!t){let r=No(n.index,e);return new Wu(r,r)}else if(n.type&175){let r=e[qi];return new Wu(r,e)}return null}var Lv=class{constructor(){}supports(e){return vI(e)}create(e){return new kv(e)}},ZV=(n,e)=>e,kv=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||ZV}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<aT(r,i,o)?t:r,a=aT(s,i,o),l=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let c=a-i,u=l-i;if(c!=u){for(let f=0;f<c;f++){let h=f<o.length?o[f]:o[f]=0,p=h+f;u<=p&&p<c&&(o[f]=h+1)}let d=s.previousIndex;o[d]=u-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!vI(e))throw new Q(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,D5(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new jv(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new mp),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new mp),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},jv=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},Vv=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},mp=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Vv,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function aT(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function lT(){return new N_([new Lv])}var N_=(()=>{class n{factories;static \u0275prov=Y({token:n,providedIn:"root",factory:lT});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||lT()),deps:[[n,new ML,new ET]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new Q(901,!1)}}return n})();var II=P_(null,"core",[]),DI=(()=>{class n{constructor(t){}static \u0275fac=function(r){return new(r||n)(U(Lo))};static \u0275mod=yi({type:n});static \u0275inj=pi({})}return n})();function O_(n){return _0(n)}var cT=class{[Ru];constructor(e){this[Ru]=e}destroy(){this[Ru].destroy()}};var sr=new oe("");var RI=null;function Ha(){return RI}function F_(n){RI??=n}var id=class{};var Tn=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(Tn||{}),Je=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(Je||{}),ar=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(ar||{}),Ho={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function OI(n){return Ur(n)[Vt.LocaleId]}function FI(n,e,t){let r=Ur(n),i=[r[Vt.DayPeriodsFormat],r[Vt.DayPeriodsStandalone]],o=zr(i,e);return zr(o,t)}function LI(n,e,t){let r=Ur(n),i=[r[Vt.DaysFormat],r[Vt.DaysStandalone]],o=zr(i,e);return zr(o,t)}function kI(n,e,t){let r=Ur(n),i=[r[Vt.MonthsFormat],r[Vt.MonthsStandalone]],o=zr(i,e);return zr(o,t)}function jI(n,e){let r=Ur(n)[Vt.Eras];return zr(r,e)}function od(n,e){let t=Ur(n);return zr(t[Vt.DateFormat],e)}function sd(n,e){let t=Ur(n);return zr(t[Vt.TimeFormat],e)}function ad(n,e){let r=Ur(n)[Vt.DateTimeFormat];return zr(r,e)}function ld(n,e){let t=Ur(n),r=t[Vt.NumberSymbols][e];if(typeof r>"u"){if(e===Ho.CurrencyDecimal)return t[Vt.NumberSymbols][Ho.Decimal];if(e===Ho.CurrencyGroup)return t[Vt.NumberSymbols][Ho.Group]}return r}function VI(n){if(!n[Vt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Vt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function BI(n){let e=Ur(n);return VI(e),(e[Vt.ExtraData][2]||[]).map(r=>typeof r=="string"?L_(r):[L_(r[0]),L_(r[1])])}function GI(n,e,t){let r=Ur(n);VI(r);let i=[r[Vt.ExtraData][0],r[Vt.ExtraData][1]],o=zr(i,e)||[];return zr(o,t)||[]}function zr(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function L_(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var YV=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,zp={},KV=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function UI(n,e,t,r){let i=sB(n);e=$o(t,e)||e;let s=[],a;for(;e;)if(a=KV.exec(e),a){s=s.concat(a.slice(1));let u=s.pop();if(!u)break;e=u}else{s.push(e);break}let l=i.getTimezoneOffset();r&&(l=$I(r,l),i=oB(i,r));let c="";return s.forEach(u=>{let d=rB(u);c+=d?d(i,t,l):u==="''"?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function Xp(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function $o(n,e){let t=OI(n);if(zp[t]??={},zp[t][e])return zp[t][e];let r="";switch(e){case"shortDate":r=od(n,ar.Short);break;case"mediumDate":r=od(n,ar.Medium);break;case"longDate":r=od(n,ar.Long);break;case"fullDate":r=od(n,ar.Full);break;case"shortTime":r=sd(n,ar.Short);break;case"mediumTime":r=sd(n,ar.Medium);break;case"longTime":r=sd(n,ar.Long);break;case"fullTime":r=sd(n,ar.Full);break;case"short":let i=$o(n,"shortTime"),o=$o(n,"shortDate");r=$p(ad(n,ar.Short),[i,o]);break;case"medium":let s=$o(n,"mediumTime"),a=$o(n,"mediumDate");r=$p(ad(n,ar.Medium),[s,a]);break;case"long":let l=$o(n,"longTime"),c=$o(n,"longDate");r=$p(ad(n,ar.Long),[l,c]);break;case"full":let u=$o(n,"fullTime"),d=$o(n,"fullDate");r=$p(ad(n,ar.Full),[u,d]);break}return r&&(zp[t][e]=r),r}function $p(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function _i(n,e,t="-",r,i){let o="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return r&&(s=s.slice(s.length-e)),o+s}function JV(n,e){return _i(n,3).substring(0,e)}function Gt(n,e,t=0,r=!1,i=!1){return function(o,s){let a=QV(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return JV(a,e);let l=ld(s,Ho.MinusSign);return _i(a,e,l,r,i)}}function QV(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function at(n,e,t=Tn.Format,r=!1){return function(i,o){return eB(i,o,n,e,t,r)}}function eB(n,e,t,r,i,o){switch(t){case 2:return kI(e,i,r)[n.getMonth()];case 1:return LI(e,i,r)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let c=BI(e),u=GI(e,i,r),d=c.findIndex(f=>{if(Array.isArray(f)){let[h,p]=f,m=s>=h.hours&&a>=h.minutes,g=s<p.hours||s===p.hours&&a<p.minutes;if(h.hours<p.hours){if(m&&g)return!0}else if(m||g)return!0}else if(f.hours===s&&f.minutes===a)return!0;return!1});if(d!==-1)return u[d]}return FI(e,i,r)[s<12?0:1];case 3:return jI(e,r)[n.getFullYear()<=0?0:1];default:let l=t;throw new Error(`unexpected translation type ${l}`)}}function Hp(n){return function(e,t,r){let i=-1*r,o=ld(t,Ho.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+_i(s,2,o)+_i(Math.abs(i%60),2,o);case 1:return"GMT"+(i>=0?"+":"")+_i(s,1,o);case 2:return"GMT"+(i>=0?"+":"")+_i(s,2,o)+":"+_i(Math.abs(i%60),2,o);case 3:return r===0?"Z":(i>=0?"+":"")+_i(s,2,o)+":"+_i(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${n}"`)}}}var tB=0,Wp=4;function nB(n){let e=Xp(n,tB,1).getDay();return Xp(n,0,1+(e<=Wp?Wp:Wp+7)-e)}function zI(n){let e=n.getDay(),t=e===0?-3:Wp-e;return Xp(n.getFullYear(),n.getMonth(),n.getDate()+t)}function k_(n,e=!1){return function(t,r){let i;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();i=1+Math.floor((s+o)/7)}else{let o=zI(t),s=nB(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return _i(i,n,ld(r,Ho.MinusSign))}}function qp(n,e=!1){return function(t,r){let o=zI(t).getFullYear();return _i(o,n,ld(r,Ho.MinusSign),e)}}var j_={};function rB(n){if(j_[n])return j_[n];let e;switch(n){case"G":case"GG":case"GGG":e=at(3,Je.Abbreviated);break;case"GGGG":e=at(3,Je.Wide);break;case"GGGGG":e=at(3,Je.Narrow);break;case"y":e=Gt(0,1,0,!1,!0);break;case"yy":e=Gt(0,2,0,!0,!0);break;case"yyy":e=Gt(0,3,0,!1,!0);break;case"yyyy":e=Gt(0,4,0,!1,!0);break;case"Y":e=qp(1);break;case"YY":e=qp(2,!0);break;case"YYY":e=qp(3);break;case"YYYY":e=qp(4);break;case"M":case"L":e=Gt(1,1,1);break;case"MM":case"LL":e=Gt(1,2,1);break;case"MMM":e=at(2,Je.Abbreviated);break;case"MMMM":e=at(2,Je.Wide);break;case"MMMMM":e=at(2,Je.Narrow);break;case"LLL":e=at(2,Je.Abbreviated,Tn.Standalone);break;case"LLLL":e=at(2,Je.Wide,Tn.Standalone);break;case"LLLLL":e=at(2,Je.Narrow,Tn.Standalone);break;case"w":e=k_(1);break;case"ww":e=k_(2);break;case"W":e=k_(1,!0);break;case"d":e=Gt(2,1);break;case"dd":e=Gt(2,2);break;case"c":case"cc":e=Gt(7,1);break;case"ccc":e=at(1,Je.Abbreviated,Tn.Standalone);break;case"cccc":e=at(1,Je.Wide,Tn.Standalone);break;case"ccccc":e=at(1,Je.Narrow,Tn.Standalone);break;case"cccccc":e=at(1,Je.Short,Tn.Standalone);break;case"E":case"EE":case"EEE":e=at(1,Je.Abbreviated);break;case"EEEE":e=at(1,Je.Wide);break;case"EEEEE":e=at(1,Je.Narrow);break;case"EEEEEE":e=at(1,Je.Short);break;case"a":case"aa":case"aaa":e=at(0,Je.Abbreviated);break;case"aaaa":e=at(0,Je.Wide);break;case"aaaaa":e=at(0,Je.Narrow);break;case"b":case"bb":case"bbb":e=at(0,Je.Abbreviated,Tn.Standalone,!0);break;case"bbbb":e=at(0,Je.Wide,Tn.Standalone,!0);break;case"bbbbb":e=at(0,Je.Narrow,Tn.Standalone,!0);break;case"B":case"BB":case"BBB":e=at(0,Je.Abbreviated,Tn.Format,!0);break;case"BBBB":e=at(0,Je.Wide,Tn.Format,!0);break;case"BBBBB":e=at(0,Je.Narrow,Tn.Format,!0);break;case"h":e=Gt(3,1,-12);break;case"hh":e=Gt(3,2,-12);break;case"H":e=Gt(3,1);break;case"HH":e=Gt(3,2);break;case"m":e=Gt(4,1);break;case"mm":e=Gt(4,2);break;case"s":e=Gt(5,1);break;case"ss":e=Gt(5,2);break;case"S":e=Gt(6,1);break;case"SS":e=Gt(6,2);break;case"SSS":e=Gt(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Hp(0);break;case"ZZZZZ":e=Hp(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Hp(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Hp(2);break;default:return null}return j_[n]=e,e}function $I(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function iB(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function oB(n,e,t){let i=n.getTimezoneOffset(),o=$I(e,i);return iB(n,-1*(o-i))}function sB(n){if(AI(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,o=1,s=1]=n.split("-").map(a=>+a);return Xp(i,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(YV))return aB(r)}let e=new Date(n);if(!AI(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function aB(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-r,l=Number(n[6]||0),c=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,l,c),e}function AI(n){return n instanceof Date&&!isNaN(n.valueOf())}var Zp=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Ki=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new Zp(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),PI(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);PI(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(pe(Fp),pe(Np),pe(N_))};static \u0275dir=M_({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function PI(n,e){n.context.$implicit=e.item}var xi=(()=>{class n{_viewContainer;_context=new Yp;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){NI(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){NI(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(pe(Fp),pe(Np))};static \u0275dir=M_({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Yp=class{$implicit=null;ngIf=null};function NI(n,e){if(n&&!n.createEmbeddedView)throw new Q(2020,!1)}function HI(n,e){return new Q(2100,!1)}var V_=class{createSubscription(e,t){return O_(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){O_(()=>e.unsubscribe())}},B_=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},lB=new B_,cB=new V_,G_=(()=>{class n{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(t){this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if(jp(t))return lB;if(I_(t))return cB;throw HI(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(r){return new(r||n)(pe(Up,16))};static \u0275pipe=Qu({name:"async",type:n,pure:!1})}return n})();var uB="mediumDate",qI=new oe(""),WI=new oe(""),U_=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,o){if(t==null||t===""||t!==t)return null;try{let s=r??this.defaultOptions?.dateFormat??uB,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return UI(t,s,o||this.locale,a)}catch(s){throw HI(n,s.message)}}static \u0275fac=function(r){return new(r||n)(pe(Gp,16),pe(qI,24),pe(WI,24))};static \u0275pipe=Qu({name:"date",type:n,pure:!0})}return n})();var Un=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=yi({type:n});static \u0275inj=pi({})}return n})();function cd(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var Kp="browser",XI="server";function z_(n){return n===Kp}function Jp(n){return n===XI}var qa=class{};var tm=new oe(""),W_=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new Q(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(U(tm),U(st))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),ud=class{_doc;constructor(e){this._doc=e}manager},Qp="ng-app-id";function ZI(n){for(let e of n)e.remove()}function YI(n,e){let t=e.createElement("style");return t.textContent=n,t}function dB(n,e,t,r){let i=n.head?.querySelectorAll(`style[${Qp}="${e}"],link[${Qp}="${e}"]`);if(i)for(let o of i)o.removeAttribute(Qp),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function H_(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var X_=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=Jp(o),dB(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,YI);r?.forEach(i=>this.addUsage(i,this.external,H_))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(ZI(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])ZI(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,YI(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,H_(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(Qp,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(U(sr),U(o_),U(a_,8),U(Bo))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),$_={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Z_=/%COMP%/g;var JI="%COMP%",fB=`_nghost-${JI}`,hB=`_ngcontent-${JI}`,pB=!0,mB=new oe("",{providedIn:"root",factory:()=>pB});function gB(n){return hB.replace(Z_,n)}function yB(n){return fB.replace(Z_,n)}function QI(n,e){return e.map(t=>t.replace(Z_,n))}var Y_=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,o,s,a,l,c=null,u=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=l,this.nonce=c,this.tracingService=u,this.platformIsServer=Jp(a),this.defaultRenderer=new dd(t,s,l,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Xi.ShadowDom&&(r=jn(xt({},r),{encapsulation:Xi.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof em?i.applyToHost(t):i instanceof fd&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer,f=this.tracingService;switch(r.encapsulation){case Xi.Emulated:o=new em(l,c,r,this.appId,u,s,a,d,f);break;case Xi.ShadowDom:return new q_(l,c,t,r,s,a,this.nonce,d,f);default:o=new fd(l,c,r,u,s,a,d,f);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(U(W_),U(X_),U(o_),U(mB),U(sr),U(Bo),U(st),U(a_),U(Sp,8))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),dd=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,o){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS($_[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(KI(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(KI(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Q(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=$_[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=$_[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Fo.DashCase|Fo.Important)?e.style.setProperty(t,r,i&Fo.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Fo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Ha().getGlobalEventTarget(this.doc,e),!e))throw new Q(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function KI(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var q_=class extends dd{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,o,s,a,l,c){super(e,o,s,l,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=i.styles;u=QI(i.id,u);for(let f of u){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=f,this.shadowRoot.appendChild(h)}let d=i.getExternalStyles?.();if(d)for(let f of d){let h=H_(f,o);a&&h.setAttribute("nonce",a),this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},fd=class extends dd{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,l,c){super(e,o,s,a,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let u=r.styles;this.styles=c?QI(c,u):u,this.styleUrls=r.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},em=class extends fd{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,l,c){let u=i+"-"+r.id;super(e,t,r,o,s,a,l,c,u),this.contentAttr=gB(u),this.hostAttr=yB(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var nm=class n extends id{supportsDOMEvents=!0;static makeCurrent(){F_(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=vB();return t==null?null:_B(t)}resetBaseElement(){hd=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return cd(document.cookie,e)}},hd=null;function vB(){return hd=hd||document.querySelector("base"),hd?hd.getAttribute("href"):null}function _B(n){return new URL(n,document.baseURI).pathname}var rm=class{addToWindow(e){sn.getAngularTestability=(r,i=!0)=>{let o=e.findTestabilityInTree(r,i);if(o==null)throw new Q(5103,!1);return o},sn.getAllAngularTestabilities=()=>e.getAllTestabilities(),sn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=sn.getAllAngularTestabilities(),o=i.length,s=function(){o--,o==0&&r()};i.forEach(a=>{a.whenStable(s)})};sn.frameworkStabilizers||(sn.frameworkStabilizers=[]),sn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?Ha().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},xB=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),tD=(()=>{class n extends ud{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(U(sr))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),eD=["alt","control","meta","shift"],EB={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},wB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},nD=(()=>{class n extends ud{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ha().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),eD.forEach(c=>{let u=r.indexOf(c);u>-1&&(r.splice(u,1),s+=c+".")}),s+=o,r.length!=0||o.length===0)return null;let l={};return l.domEventName=i,l.fullKey=s,l}static matchEventFullKeyCode(t,r){let i=EB[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),eD.forEach(s=>{if(s!==i){let a=wB[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(U(sr))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})();function CB(){nm.makeCurrent()}function bB(){return new br}function MB(){return bS(document),document}var TB=[{provide:Bo,useValue:Kp},{provide:s_,useValue:CB,multi:!0},{provide:sr,useFactory:MB}],K_=P_(II,"browser",TB);var SB=[{provide:ed,useClass:rm},{provide:T_,useClass:Lp,deps:[st,kp,ed]},{provide:Lp,useClass:Lp,deps:[st,kp,ed]}],IB=[{provide:vp,useValue:"root"},{provide:br,useFactory:bB},{provide:tm,useClass:tD,multi:!0,deps:[sr]},{provide:tm,useClass:nD,multi:!0,deps:[sr]},Y_,X_,W_,{provide:Wl,useExisting:Y_},{provide:qa,useClass:xB},[]],J_=(()=>{class n{constructor(){}static \u0275fac=function(r){return new(r||n)};static \u0275mod=yi({type:n});static \u0275inj=pi({providers:[...IB,...SB],imports:[Un,DI]})}return n})();var rc=class{},Ps=class{},Sn=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),o=t.slice(r+1).trim();this.addHeaderEntry(i,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(o=>o.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var om=class{encodeKey(e){return rD(e)}encodeValue(e){return rD(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function DB(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let o=i.indexOf("="),[s,a]=o==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],l=t.get(s)||[];l.push(a),t.set(s,l)}),t}var RB=/%(\d[a-f0-9])/gi,AB={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function rD(n){return encodeURIComponent(n).replace(RB,(e,t)=>AB[t]??e)}function im(n){return`${n}`}var Mr=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new om,e.fromString){if(e.fromObject)throw new Q(2805,!1);this.map=DB(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(im):[im(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(o=>{t.push({param:r,value:o,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(im(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(im(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var sm=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function PB(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function iD(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function oD(n){return typeof Blob<"u"&&n instanceof Blob}function sD(n){return typeof FormData<"u"&&n instanceof FormData}function NB(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var aD="Content-Type",lD="Accept",cD="X-Request-URL",uD="text/plain",dD="application/json",OB=`${dD}, ${uD}, */*`,Ei=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,t,r,i){this.url=t,this.method=e.toUpperCase();let o;if(PB(this.method)||i?(this.body=r!==void 0?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new Sn,this.context??=new sm,!this.params)this.params=new Mr,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),l=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+l+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||iD(this.body)||oD(this.body)||sD(this.body)||NB(this.body)?this.body:this.body instanceof Mr?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||sD(this.body)?null:oD(this.body)?this.body.type||null:iD(this.body)?null:typeof this.body=="string"?uD:this.body instanceof Mr?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?dD:null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,o=e.transferCache??this.transferCache,s=e.body!==void 0?e.body:this.body,a=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,c=e.headers||this.headers,u=e.params||this.params,d=e.context??this.context;return e.setHeaders!==void 0&&(c=Object.keys(e.setHeaders).reduce((f,h)=>f.set(h,e.setHeaders[h]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((f,h)=>f.set(h,e.setParams[h]),u)),new n(t,r,s,{params:u,headers:c,context:d,reportProgress:l,responseType:i,withCredentials:a,transferCache:o})}},Ji=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Ji||{}),ic=class{headers;status;statusText;url;ok;type;constructor(e,t=200,r="OK"){this.headers=e.headers||new Sn,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},am=class n extends ic{constructor(e={}){super(e)}type=Ji.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Qe=class n extends ic{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=Ji.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Wa=class extends ic{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},FB=200,LB=204;function Q_(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var lr=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,i={}){let o;if(t instanceof Ei)o=t;else{let l;i.headers instanceof Sn?l=i.headers:l=new Sn(i.headers);let c;i.params&&(i.params instanceof Mr?c=i.params:c=new Mr({fromObject:i.params})),o=new Ei(t,r,i.body!==void 0?i.body:null,{headers:l,context:i.context,params:c,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let s=tr(o).pipe(Fu(l=>this.handler.handle(l)));if(t instanceof Ei||i.observe==="events")return s;let a=s.pipe(tt(l=>l instanceof Qe));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(ue(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Q(2806,!1);return l.body}));case"blob":return a.pipe(ue(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Q(2807,!1);return l.body}));case"text":return a.pipe(ue(l=>{if(l.body!==null&&typeof l.body!="string")throw new Q(2808,!1);return l.body}));case"json":default:return a.pipe(ue(l=>l.body))}case"response":return a;default:throw new Q(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new Mr().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,Q_(i,r))}post(t,r,i={}){return this.request("POST",t,Q_(i,r))}put(t,r,i={}){return this.request("PUT",t,Q_(i,r))}static \u0275fac=function(r){return new(r||n)(U(rc))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})();var kB=new oe("");function jB(n,e){return e(n)}function VB(n,e,t){return(r,i)=>_p(t,()=>e(r,o=>n(o,i)))}var tx=new oe(""),fD=new oe(""),hD=new oe("",{providedIn:"root",factory:()=>!0});var lm=(()=>{class n extends rc{backend;injector;chain=null;pendingTasks=Se(ec);contributeToStability=Se(hD);constructor(t,r){super(),this.backend=t,this.injector=r}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(tx),...this.injector.get(fD,[])]));this.chain=r.reduceRight((i,o)=>VB(i,o,this.injector),jB)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(A0(()=>this.pendingTasks.remove(r)))}else return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||n)(U(Ps),U(Hi))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})();var BB=/^\)\]\}',?\n/,GB=RegExp(`^${cD}:`,"m");function UB(n){return"responseURL"in n&&n.responseURL?n.responseURL:GB.test(n.getAllResponseHeaders())?n.getResponseHeader(cD):null}var ex=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new Q(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?Da(r.\u0275loadImpl()):tr(null)).pipe(Lu(()=>new Xe(o=>{let s=r.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((m,g)=>s.setRequestHeader(m,g.join(","))),t.headers.has(lD)||s.setRequestHeader(lD,OB),!t.headers.has(aD)){let m=t.detectContentTypeHeader();m!==null&&s.setRequestHeader(aD,m)}if(t.responseType){let m=t.responseType.toLowerCase();s.responseType=m!=="json"?m:"text"}let a=t.serializeBody(),l=null,c=()=>{if(l!==null)return l;let m=s.statusText||"OK",g=new Sn(s.getAllResponseHeaders()),y=UB(s)||t.url;return l=new am({headers:g,status:s.status,statusText:m,url:y}),l},u=()=>{let{headers:m,status:g,statusText:y,url:v}=c(),x=null;g!==LB&&(x=typeof s.response>"u"?s.responseText:s.response),g===0&&(g=x?FB:0);let E=g>=200&&g<300;if(t.responseType==="json"&&typeof x=="string"){let _=x;x=x.replace(BB,"");try{x=x!==""?JSON.parse(x):null}catch(w){x=_,E&&(E=!1,x={error:w,text:x})}}E?(o.next(new Qe({body:x,headers:m,status:g,statusText:y,url:v||void 0})),o.complete()):o.error(new Wa({error:x,headers:m,status:g,statusText:y,url:v||void 0}))},d=m=>{let{url:g}=c(),y=new Wa({error:m,status:s.status||0,statusText:s.statusText||"Unknown Error",url:g||void 0});o.error(y)},f=!1,h=m=>{f||(o.next(c()),f=!0);let g={type:Ji.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(g.total=m.total),t.responseType==="text"&&s.responseText&&(g.partialText=s.responseText),o.next(g)},p=m=>{let g={type:Ji.UploadProgress,loaded:m.loaded};m.lengthComputable&&(g.total=m.total),o.next(g)};return s.addEventListener("load",u),s.addEventListener("error",d),s.addEventListener("timeout",d),s.addEventListener("abort",d),t.reportProgress&&(s.addEventListener("progress",h),a!==null&&s.upload&&s.upload.addEventListener("progress",p)),s.send(a),o.next({type:Ji.Sent}),()=>{s.removeEventListener("error",d),s.removeEventListener("abort",d),s.removeEventListener("load",u),s.removeEventListener("timeout",d),t.reportProgress&&(s.removeEventListener("progress",h),a!==null&&s.upload&&s.upload.removeEventListener("progress",p)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(r){return new(r||n)(U(qa))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})(),pD=new oe(""),zB="XSRF-TOKEN",$B=new oe("",{providedIn:"root",factory:()=>zB}),HB="X-XSRF-TOKEN",qB=new oe("",{providedIn:"root",factory:()=>HB}),pd=class{},WB=(()=>{class n{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=cd(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(r){return new(r||n)(U(sr),U(Bo),U($B))};static \u0275prov=Y({token:n,factory:n.\u0275fac})}return n})();function XB(n,e){let t=n.url.toLowerCase();if(!Se(pD)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=Se(pd).getToken(),i=Se(qB);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var nx=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(nx||{});function ZB(n,e){return{\u0275kind:n,\u0275providers:e}}function rx(...n){let e=[lr,ex,lm,{provide:rc,useExisting:lm},{provide:Ps,useFactory:()=>Se(kB,{optional:!0})??Se(ex)},{provide:tx,useValue:XB,multi:!0},{provide:pD,useValue:!0},{provide:pd,useClass:WB}];for(let t of n)e.push(...t.\u0275providers);return zv(e)}function ix(n){return ZB(nx.Interceptors,n.map(e=>({provide:tx,useValue:e,multi:!0})))}var ox=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Y({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=U(KB),i},providedIn:"root"})}return n})(),KB=(()=>{class n extends ox{_doc;constructor(t){super(),this._doc=t}sanitize(t,r){if(r==null)return null;switch(t){case Uo.NONE:return r;case Uo.HTML:return Ua(r,"HTML")?As(r):u_(this._doc,String(r)).toString();case Uo.STYLE:return Ua(r,"Style")?As(r):r;case Uo.SCRIPT:if(Ua(r,"Script"))return As(r);throw new Q(5200,!1);case Uo.URL:return Ua(r,"URL")?As(r):c_(String(r));case Uo.RESOURCE_URL:if(Ua(r,"ResourceURL"))return As(r);throw new Q(5201,!1);default:throw new Q(5202,!1)}}bypassSecurityTrustHtml(t){return RS(t)}bypassSecurityTrustStyle(t){return AS(t)}bypassSecurityTrustScript(t){return PS(t)}bypassSecurityTrustUrl(t){return NS(t)}bypassSecurityTrustResourceUrl(t){return OS(t)}static \u0275fac=function(r){return new(r||n)(U(sr))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var JB={schedule(n,e){let t=setTimeout(n,e);return()=>clearTimeout(t)}};function QB(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function eG(n){return!!n&&n.nodeType===Node.ELEMENT_NODE}var sx;function tG(n,e){if(!sx){let t=Element.prototype;sx=t.matches||t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}return n.nodeType===Node.ELEMENT_NODE?sx.call(n,e):!1}function nG(n){let e={};return n.forEach(({propName:t,templateName:r,transform:i})=>{e[QB(r)]=[t,i]}),e}function rG(n,e){return e.get(za).resolveComponentFactory(n).inputs}function iG(n,e){let t=n.childNodes,r=e.map(()=>[]),i=-1;e.some((o,s)=>o==="*"?(i=s,!0):!1);for(let o=0,s=t.length;o<s;++o){let a=t[o],l=oG(a,e,i);l!==-1&&r[l].push(a)}return r}function oG(n,e,t){let r=t;return eG(n)&&e.some((i,o)=>i!=="*"&&tG(n,i)?(r=o,!0):!1),r}var sG=10,ax=class{componentFactory;inputMap=new Map;constructor(e,t){this.componentFactory=t.get(za).resolveComponentFactory(e);for(let r of this.componentFactory.inputs)this.inputMap.set(r.propName,r.templateName)}create(e){return new lx(this.componentFactory,e,this.inputMap)}},lx=class{componentFactory;injector;inputMap;eventEmitters=new Sa(1);events=this.eventEmitters.pipe(Lu(e=>R0(...e)));componentRef=null;scheduledDestroyFn=null;initialInputValues=new Map;ngZone;elementZone;appRef;cdScheduler;constructor(e,t,r){this.componentFactory=e,this.injector=t,this.inputMap=r,this.ngZone=this.injector.get(st),this.appRef=this.injector.get(Lo),this.cdScheduler=t.get(ja),this.elementZone=typeof Zone>"u"?null:this.ngZone.run(()=>Zone.current)}connect(e){this.runInZone(()=>{if(this.scheduledDestroyFn!==null){this.scheduledDestroyFn(),this.scheduledDestroyFn=null;return}this.componentRef===null&&this.initializeComponent(e)})}disconnect(){this.runInZone(()=>{this.componentRef===null||this.scheduledDestroyFn!==null||(this.scheduledDestroyFn=JB.schedule(()=>{this.componentRef!==null&&(this.componentRef.destroy(),this.componentRef=null)},sG))})}getInputValue(e){return this.runInZone(()=>this.componentRef===null?this.initialInputValues.get(e):this.componentRef.instance[e])}setInputValue(e,t){if(this.componentRef===null){this.initialInputValues.set(e,t);return}this.runInZone(()=>{this.componentRef.setInput(this.inputMap.get(e)??e,t),cI(this.componentRef.hostView)&&(uI(this.componentRef.changeDetectorRef),this.cdScheduler.notify(6))})}initializeComponent(e){let t=Cr.create({providers:[],parent:this.injector}),r=iG(e,this.componentFactory.ngContentSelectors);this.componentRef=this.componentFactory.create(t,r,e),this.initializeInputs(),this.initializeOutputs(this.componentRef),this.appRef.attachView(this.componentRef.hostView),this.componentRef.hostView.detectChanges()}initializeInputs(){for(let[e,t]of this.initialInputValues)this.setInputValue(e,t);this.initialInputValues.clear()}initializeOutputs(e){let t=this.componentFactory.outputs.map(({propName:r,templateName:i})=>{let o=e.instance[r];return new Xe(s=>{let a=o.subscribe(l=>s.next({name:i,value:l}));return()=>a.unsubscribe()})});this.eventEmitters.next(t)}runInZone(e){return this.elementZone&&Zone.current!==this.elementZone?this.ngZone.run(e):e()}},cx=class extends HTMLElement{ngElementEventsSubscription=null};function Za(n,e){let t=rG(n,e.injector),r=e.strategyFactory||new ax(n,e.injector),i=nG(t);class o extends cx{injector;static observedAttributes=Object.keys(i);get ngElementStrategy(){if(!this._ngElementStrategy){let a=this._ngElementStrategy=r.create(this.injector||e.injector);t.forEach(({propName:l,transform:c})=>{if(!this.hasOwnProperty(l))return;let u=this[l];delete this[l],a.setInputValue(l,u,c)})}return this._ngElementStrategy}_ngElementStrategy;constructor(a){super(),this.injector=a}attributeChangedCallback(a,l,c,u){let[d,f]=i[a];this.ngElementStrategy.setInputValue(d,c,f)}connectedCallback(){let a=!1;this.ngElementStrategy.events&&(this.subscribeToEvents(),a=!0),this.ngElementStrategy.connect(this),a||this.subscribeToEvents()}disconnectedCallback(){this._ngElementStrategy&&this._ngElementStrategy.disconnect(),this.ngElementEventsSubscription&&(this.ngElementEventsSubscription.unsubscribe(),this.ngElementEventsSubscription=null)}subscribeToEvents(){this.ngElementEventsSubscription=this.ngElementStrategy.events.subscribe(a=>{let l=new CustomEvent(a.name,{detail:a.value});this.dispatchEvent(l)})}}return t.forEach(({propName:s,transform:a})=>{Object.defineProperty(o.prototype,s,{get(){return this.ngElementStrategy.getInputValue(s)},set(l){this.ngElementStrategy.setInputValue(s,l,a)},configurable:!0,enumerable:!0})}),o}var cn={ADD:"add",REMOVE:"remove"};var wi={PROPERTYCHANGE:"propertychange"};var H={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};var ux=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}},Ns=ux;function gD(n,e,t){let r,i;t=t||In;let o=0,s=n.length,a=!1;for(;o<s;)r=o+(s-o>>1),i=+t(n[r],e),i<0?o=r+1:(s=r,a=!i);return a?o:~o}function In(n,e){return n>e?1:n<e?-1:0}function yD(n,e){return n<e?1:n>e?-1:0}function oc(n,e,t){if(n[0]<=e)return 0;let r=n.length;if(e<=n[r-1])return r-1;if(typeof t=="function"){for(let i=1;i<r;++i){let o=n[i];if(o===e)return i;if(o<e)return t(e,n[i-1],o)>0?i-1:i}return r-1}if(t>0){for(let i=1;i<r;++i)if(n[i]<e)return i-1;return r-1}if(t<0){for(let i=1;i<r;++i)if(n[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(n[i]==e)return i;if(n[i]<e)return n[i-1]-e<e-n[i]?i-1:i}return r-1}function vD(n,e,t){for(;e<t;){let r=n[e];n[e]=n[t],n[t]=r,++e,--t}}function mn(n,e){let t=Array.isArray(e)?e:[e],r=t.length;for(let i=0;i<r;i++)n[n.length]=t[i]}function Dn(n,e){let t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function _D(n,e,t){let r=e||In;return n.every(function(i,o){if(o===0)return!0;let s=r(n[o-1],i);return!(s>0||t&&s===0)})}function Ci(){return!0}function $r(){return!1}function qo(){}function cm(n){let e,t,r;return function(){let i=Array.prototype.slice.call(arguments);return(!t||this!==r||!Dn(i,t))&&(r=this,t=i,e=n.apply(this,arguments)),e}}function Qi(n){function e(){let t;try{t=n()}catch(r){return Promise.reject(r)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function eo(n){for(let e in n)delete n[e]}function zn(n){let e;for(e in n)return!1;return!e}var dx=class{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}};var Ut=dx;var fx=class extends Ns{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;let r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(t)||i.push(t)}dispatchEvent(e){let t=typeof e=="string",r=t?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;let o=t?new Ut(e):e;o.target||(o.target=this.eventTarget_||this);let s=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});r in s||(s[r]=0,a[r]=0),++s[r];let l;for(let c=0,u=i.length;c<u;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(o):l=i[c].call(this,o),l===!1||o.propagationStopped){l=!1;break}if(--s[r]===0){let c=a[r];for(delete a[r];c--;)this.removeEventListener(r,qo);delete s[r]}return l}disposeInternal(){this.listeners_&&eo(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;let r=this.listeners_[e];if(!r)return;let i=r.indexOf(t);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=qo,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}},Os=fx;function te(n,e,t,r,i){if(i){let s=t;t=function(a){return n.removeEventListener(e,t),s.call(r??this,a)}}else r&&r!==n&&(t=t.bind(r));let o={target:n,type:e,listener:t};return n.addEventListener(e,t),o}function sc(n,e,t,r){return te(n,e,t,r,!0)}function ce(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),eo(n))}var ac=class extends Os{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(H.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){let r=e.length,i=new Array(r);for(let o=0;o<r;++o)i[o]=te(this,e[o],t);return i}return te(this,e,t)}onceInternal(e,t){let r;if(Array.isArray(e)){let i=e.length;r=new Array(i);for(let o=0;o<i;++o)r[o]=sc(this,e[o],t)}else r=sc(this,e,t);return t.ol_key=r,r}unInternal(e,t){let r=t.ol_key;if(r)aG(r);else if(Array.isArray(e))for(let i=0,o=e.length;i<o;++i)this.removeEventListener(e[i],t);else this.removeEventListener(e,t)}};ac.prototype.on;ac.prototype.once;ac.prototype.un;function aG(n){if(Array.isArray(n))for(let e=0,t=n.length;e<t;++e)ce(n[e]);else ce(n)}var um=ac;function W(){throw new Error("Unimplemented abstract method.")}var lG=0;function X(n){return n.ol_uid||(n.ol_uid=String(++lG))}var dm=class extends Ut{constructor(e,t,r){super(e),this.key=t,this.oldValue=r}},hx=class extends um{constructor(e){super(),this.on,this.once,this.un,X(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new dm(r,e,t)),r=wi.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new dm(r,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,r){let i=this.values_||(this.values_={});if(r)i[e]=t;else{let o=i[e];i[e]=t,o!==t&&this.notify(e,o)}}setProperties(e,t){for(let r in e)this.set(r,e[r],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){let r=this.values_[e];delete this.values_[e],zn(this.values_)&&(this.values_=null),t||this.notify(e,r)}}},At=hx;var xD={LENGTH:"length"},lc=class extends Ut{constructor(e,t,r){super(e),this.element=t,this.index=r}},px=class extends At{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let r=0,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,r=e.length;t<r;++t)this.push(e[t]);return this}forEach(e){let t=this.array_;for(let r=0,i=t.length;r<i;++r)e(t[r],r,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(xD.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new lc(cn.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);let t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){let t=this.array_;for(let r=0,i=t.length;r<i;++r)if(t[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;let t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new lc(cn.REMOVE,t,e)),t}setAt(e,t){let r=this.getLength();if(e>=r){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);let i=this.array_[e];this.array_[e]=t,this.dispatchEvent(new lc(cn.REMOVE,i,e)),this.dispatchEvent(new lc(cn.ADD,t,e))}updateLength_(){this.set(xD.LENGTH,this.array_.length)}assertUnique_(e,t){for(let r=0,i=this.array_.length;r<i;++r)if(this.array_[r]===e&&r!==t)throw new Error("Duplicate item added to a unique collection")}},$n=px;function se(n,e){if(!n)throw new Error(e)}var mx=class n extends At{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){let t=e;this.setGeometry(t)}else{let t=e;this.setProperties(t)}}clone(){let e=new n(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());let t=this.getGeometry();t&&e.setGeometry(t.clone());let r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(ce(this.geometryChangeKey_),this.geometryChangeKey_=null);let e=this.getGeometry();e&&(this.geometryChangeKey_=te(e,H.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?cG(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}};function cG(n){if(typeof n=="function")return n;let e;return Array.isArray(n)?e=n:(se(typeof n.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[n]),function(){return e}}var zt=mx;var $t={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Fs(n){let e=wt();for(let t=0,r=n.length;t<r;++t)Ya(e,n[t]);return e}function uG(n,e,t){let r=Math.min.apply(null,n),i=Math.min.apply(null,e),o=Math.max.apply(null,n),s=Math.max.apply(null,e);return Hn(r,i,o,s,t)}function Tr(n,e,t){return t?(t[0]=n[0]-e,t[1]=n[1]-e,t[2]=n[2]+e,t[3]=n[3]+e,t):[n[0]-e,n[1]-e,n[2]+e,n[3]+e]}function hm(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n.slice()}function cr(n,e,t){let r,i;return e<n[0]?r=n[0]-e:n[2]<e?r=e-n[2]:r=0,t<n[1]?i=n[1]-t:n[3]<t?i=t-n[3]:i=0,r*r+i*i}function bi(n,e){return md(n,e[0],e[1])}function Mi(n,e){return n[0]<=e[0]&&e[2]<=n[2]&&n[1]<=e[1]&&e[3]<=n[3]}function md(n,e,t){return n[0]<=e&&e<=n[2]&&n[1]<=t&&t<=n[3]}function fm(n,e){let t=n[0],r=n[1],i=n[2],o=n[3],s=e[0],a=e[1],l=$t.UNKNOWN;return s<t?l=l|$t.LEFT:s>i&&(l=l|$t.RIGHT),a<r?l=l|$t.BELOW:a>o&&(l=l|$t.ABOVE),l===$t.UNKNOWN&&(l=$t.INTERSECTING),l}function wt(){return[1/0,1/0,-1/0,-1/0]}function Hn(n,e,t,r,i){return i?(i[0]=n,i[1]=e,i[2]=t,i[3]=r,i):[n,e,t,r]}function Wo(n){return Hn(1/0,1/0,-1/0,-1/0,n)}function pm(n,e){let t=n[0],r=n[1];return Hn(t,r,t,r,e)}function cc(n,e,t,r,i){let o=Wo(i);return gx(o,n,e,t,r)}function Ti(n,e){return n[0]==e[0]&&n[2]==e[2]&&n[1]==e[1]&&n[3]==e[3]}function Ls(n,e){return e[0]<n[0]&&(n[0]=e[0]),e[2]>n[2]&&(n[2]=e[2]),e[1]<n[1]&&(n[1]=e[1]),e[3]>n[3]&&(n[3]=e[3]),n}function Ya(n,e){e[0]<n[0]&&(n[0]=e[0]),e[0]>n[2]&&(n[2]=e[0]),e[1]<n[1]&&(n[1]=e[1]),e[1]>n[3]&&(n[3]=e[1])}function gx(n,e,t,r,i){for(;t<r;t+=i)dG(n,e[t],e[t+1]);return n}function dG(n,e,t){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}function uc(n,e){let t;return t=e(Xo(n)),t||(t=e(js(n)),t)||(t=e(Vs(n)),t)||(t=e(ut(n)),t)?t:!1}function ks(n){let e=0;return Bs(n)||(e=ee(n)*et(n)),e}function Xo(n){return[n[0],n[1]]}function js(n){return[n[2],n[1]]}function Ht(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function ED(n,e){let t;if(e==="bottom-left")t=Xo(n);else if(e==="bottom-right")t=js(n);else if(e==="top-left")t=ut(n);else if(e==="top-right")t=Vs(n);else throw new Error("Invalid corner");return t}function gd(n,e,t,r,i){let[o,s,a,l,c,u,d,f]=yx(n,e,t,r);return Hn(Math.min(o,a,c,d),Math.min(s,l,u,f),Math.max(o,a,c,d),Math.max(s,l,u,f),i)}function yx(n,e,t,r){let i=e*r[0]/2,o=e*r[1]/2,s=Math.cos(t),a=Math.sin(t),l=i*s,c=i*a,u=o*s,d=o*a,f=n[0],h=n[1];return[f-l+d,h-c-u,f-l-d,h-c+u,f+l-d,h+c+u,f+l+d,h+c-u,f-l+d,h-c-u]}function et(n){return n[3]-n[1]}function Qt(n,e,t){let r=t||wt();return Le(n,e)?(n[0]>e[0]?r[0]=n[0]:r[0]=e[0],n[1]>e[1]?r[1]=n[1]:r[1]=e[1],n[2]<e[2]?r[2]=n[2]:r[2]=e[2],n[3]<e[3]?r[3]=n[3]:r[3]=e[3]):Wo(r),r}function ut(n){return[n[0],n[3]]}function Vs(n){return[n[2],n[3]]}function ee(n){return n[2]-n[0]}function Le(n,e){return n[0]<=e[2]&&n[2]>=e[0]&&n[1]<=e[3]&&n[3]>=e[1]}function Bs(n){return n[2]<n[0]||n[3]<n[1]}function wD(n,e){return e?(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e):n}function CD(n,e,t){let r=!1,i=fm(n,e),o=fm(n,t);if(i===$t.INTERSECTING||o===$t.INTERSECTING)r=!0;else{let s=n[0],a=n[1],l=n[2],c=n[3],u=e[0],d=e[1],f=t[0],h=t[1],p=(h-d)/(f-u),m,g;o&$t.ABOVE&&!(i&$t.ABOVE)&&(m=f-(h-c)/p,r=m>=s&&m<=l),!r&&o&$t.RIGHT&&!(i&$t.RIGHT)&&(g=h-(f-l)*p,r=g>=a&&g<=c),!r&&o&$t.BELOW&&!(i&$t.BELOW)&&(m=f-(h-a)/p,r=m>=s&&m<=l),!r&&o&$t.LEFT&&!(i&$t.LEFT)&&(g=h-(f-s)*p,r=g>=a&&g<=c)}return r}function mm(n,e,t,r){if(Bs(n))return Wo(t);let i=[];if(r>1){let a=n[2]-n[0],l=n[3]-n[1];for(let c=0;c<r;++c)i.push(n[0]+a*c/r,n[1],n[2],n[1]+l*c/r,n[2]-a*c/r,n[3],n[0],n[3]-l*c/r)}else i=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]];e(i,i,2);let o=[],s=[];for(let a=0,l=i.length;a<l;a+=2)o.push(i[a]),s.push(i[a+1]);return uG(o,s,t)}function vx(n,e){let t=e.getExtent(),r=Ht(n);if(e.canWrapX()&&(r[0]<t[0]||r[0]>=t[2])){let i=ee(t),s=Math.floor((r[0]-t[0])/i)*i;n[0]-=s,n[2]-=s}return n}function dc(n,e,t){if(e.canWrapX()){let r=e.getExtent();if(!isFinite(n[0])||!isFinite(n[2]))return[[r[0],n[1],r[2],n[3]]];vx(n,e);let i=ee(r);if(ee(n)>i&&!t)return[[r[0],n[1],r[2],n[3]]];if(n[0]<r[0])return[[n[0]+i,n[1],r[2],n[3]],[r[0],n[1],n[2],n[3]]];if(n[2]>r[2])return[[n[0],n[1],r[2],n[3]],[r[0],n[1],n[2]-i,n[3]]]}return[n]}function xe(n,e,t){return Math.min(Math.max(n,e),t)}function bD(n,e,t,r,i,o){let s=i-t,a=o-r;if(s!==0||a!==0){let l=((n-t)*s+(e-r)*a)/(s*s+a*a);l>1?(t=i,r=o):l>0&&(t+=s*l,r+=a*l)}return ur(n,e,t,r)}function ur(n,e,t,r){let i=t-n,o=r-e;return i*i+o*o}function MD(n){let e=n.length;for(let r=0;r<e;r++){let i=r,o=Math.abs(n[r][r]);for(let a=r+1;a<e;a++){let l=Math.abs(n[a][r]);l>o&&(o=l,i=a)}if(o===0)return null;let s=n[i];n[i]=n[r],n[r]=s;for(let a=r+1;a<e;a++){let l=-n[a][r]/n[r][r];for(let c=r;c<e+1;c++)r==c?n[a][c]=0:n[a][c]+=l*n[r][c]}}let t=new Array(e);for(let r=e-1;r>=0;r--){t[r]=n[r][e]/n[r][r];for(let i=r-1;i>=0;i--)n[i][e]-=n[i][r]*t[r]}return t}function gm(n){return n*180/Math.PI}function Si(n){return n*Math.PI/180}function Hr(n,e){let t=n%e;return t*e<0?t+e:t}function gn(n,e,t){return n+t*(e-n)}function Gs(n,e){let t=Math.pow(10,e);return Math.round(n*t)/t}function yd(n,e){return Math.floor(Gs(n,e))}function vd(n,e){return Math.ceil(Gs(n,e))}function ym(n,e,t){if(n>=e&&n<t)return n;let r=t-e;return((n-e)%r+r)%r+e}var fG=63710088e-1;function _x(n,e,t){t=t||fG;let r=Si(n[1]),i=Si(e[1]),o=(i-r)/2,s=Si(e[0]-n[0])/2,a=Math.sin(o)*Math.sin(o)+Math.sin(s)*Math.sin(s)*Math.cos(r)*Math.cos(i);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}var TD={info:1,warn:2,error:3,none:4},hG=TD.info;function vm(...n){hG>TD.warn||console.warn(...n)}function SD(n,e){return n[0]+=+e[0],n[1]+=+e[1],n}function Ka(n,e){let t=!0;for(let r=n.length-1;r>=0;--r)if(n[r]!=e[r]){t=!1;break}return t}function fc(n,e){let t=Math.cos(e),r=Math.sin(e),i=n[0]*t-n[1]*r,o=n[1]*t+n[0]*r;return n[0]=i,n[1]=o,n}function ID(n,e){return n[0]*=e,n[1]*=e,n}function xx(n,e){let t=n[0]-e[0],r=n[1]-e[1];return t*t+r*r}function Ex(n,e){return Math.sqrt(xx(n,e))}function hc(n,e){if(e.canWrapX()){let t=ee(e.getExtent()),r=wx(n,e,t);r&&(n[0]-=r*t)}return n}function wx(n,e,t){let r=e.getExtent(),i=0;return e.canWrapX()&&(n[0]<r[0]||n[0]>r[2])&&(t=t||ee(r),i=Math.floor((n[0]-r[0])/t)),i}var Ii={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};var Cx=class{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ii[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}},un=Cx;var _d=6378137,pc=Math.PI*_d,pG=[-pc,-pc,pc,pc],mG=[-180,-85,180,85],_m=_d*Math.log(Math.tan(Math.PI/2)),Us=class extends un{constructor(e){super({code:e,units:"m",extent:pG,global:!0,worldExtent:mG,getPointResolution:function(t,r){return t/Math.cosh(r[1]/_d)}})}},bx=[new Us("EPSG:3857"),new Us("EPSG:102100"),new Us("EPSG:102113"),new Us("EPSG:900913"),new Us("http://www.opengis.net/def/crs/EPSG/0/3857"),new Us("http://www.opengis.net/gml/srs/epsg.xml#3857")];function DD(n,e,t,r){let i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let o=0;o<i;o+=r){e[o]=pc*n[o]/180;let s=_d*Math.log(Math.tan(Math.PI*(+n[o+1]+90)/360));s>_m?s=_m:s<-_m&&(s=-_m),e[o+1]=s}return e}function RD(n,e,t,r){let i=n.length;t=t>1?t:2,r=r??t,e===void 0&&(t>2?e=n.slice():e=new Array(i));for(let o=0;o<i;o+=r)e[o]=180*n[o]/pc,e[o+1]=360*Math.atan(Math.exp(n[o+1]/_d))/Math.PI-90;return e}var gG=6378137,AD=[-180,-90,180,90],yG=Math.PI*gG/180,Zo=class extends un{constructor(e,t){super({code:e,units:"degrees",extent:AD,axisOrientation:t,global:!0,metersPerUnit:yG,worldExtent:AD})}},Mx=[new Zo("CRS:84"),new Zo("EPSG:4326","neu"),new Zo("urn:ogc:def:crs:OGC:1.3:CRS84"),new Zo("urn:ogc:def:crs:OGC:2:84"),new Zo("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Zo("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Zo("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];var Tx={};function mc(n){return Tx[n]||Tx[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function PD(n,e){Tx[n]=e}var gc={};function zs(n,e,t){let r=n.getCode(),i=e.getCode();r in gc||(gc[r]={}),gc[r][i]=t}function yc(n,e){return n in gc&&e in gc[n]?gc[n][e]:null}var xm=.9996,qr=.00669438,wm=qr*qr,Cm=wm*qr,Ja=qr/(1-qr),ND=Math.sqrt(1-qr),vc=(1-ND)/(1+ND),kD=vc*vc,Sx=kD*vc,Ix=Sx*vc,jD=Ix*vc,VD=1-qr/4-3*wm/64-5*Cm/256,vG=3*qr/8+3*wm/32+45*Cm/1024,_G=15*wm/256+45*Cm/1024,xG=35*Cm/3072,EG=3/2*vc-27/32*Sx+269/512*jD,wG=21/16*kD-55/32*Ix,CG=151/96*Sx-417/128*jD,bG=1097/512*Ix,Em=6378137;function MG(n,e,t){let r=n-5e5,s=(t.north?e:e-1e7)/xm/(Em*VD),a=s+EG*Math.sin(2*s)+wG*Math.sin(4*s)+CG*Math.sin(6*s)+bG*Math.sin(8*s),l=Math.sin(a),c=l*l,u=Math.cos(a),d=l/u,f=d*d,h=f*f,p=1-qr*c,m=Math.sqrt(1-qr*c),g=Em/m,y=(1-qr)/p,v=Ja*u**2,x=v*v,E=r/(g*xm),_=E*E,w=_*E,b=w*E,M=b*E,S=M*E,C=a-d/y*(_/2-b/24*(5+3*f+10*v-4*x-9*Ja))+S/720*(61+90*f+298*v+45*h-252*Ja-3*x),R=(E-w/6*(1+2*f+v)+M/120*(5-2*v+28*f-3*x+8*Ja+24*h))/u;return R=ym(R+Si(BD(t.number)),-Math.PI,Math.PI),[gm(R),gm(C)]}var OD=-80,FD=84,TG=-180,SG=180;function IG(n,e,t){n=ym(n,TG,SG),e<OD?e=OD:e>FD&&(e=FD);let r=Si(e),i=Math.sin(r),o=Math.cos(r),s=i/o,a=s*s,l=a*a,c=Si(n),u=BD(t.number),d=Si(u),f=Em/Math.sqrt(1-qr*i**2),h=Ja*o**2,p=o*ym(c-d,-Math.PI,Math.PI),m=p*p,g=m*p,y=g*p,v=y*p,x=v*p,E=Em*(VD*r-vG*Math.sin(2*r)+_G*Math.sin(4*r)-xG*Math.sin(6*r)),_=xm*f*(p+g/6*(1-a+h)+v/120*(5-18*a+l+72*h-58*Ja))+5e5,w=xm*(E+f*s*(m/2+y/24*(5-a+9*h+4*h**2)+x/720*(61-58*a+l+600*h-330*Ja)));return t.north||(w+=1e7),[_,w]}function BD(n){return(n-1)*6-180+3}var DG=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function GD(n){let e=0;for(let i of DG){let o=n.match(i);if(o){e=parseInt(o[1]);break}}if(!e)return null;let t=0,r=!1;return e>32700&&e<32761?t=e-32700:e>32600&&e<32661&&(r=!0,t=e-32600),t?{number:t,north:r}:null}function LD(n,e){return function(t,r,i,o){let s=t.length;i=i>1?i:2,o=o??i,r||(i>2?r=t.slice():r=new Array(s));for(let a=0;a<s;a+=o){let l=t[a],c=t[a+1],u=n(l,c,e);r[a]=u[0],r[a+1]=u[1]}return r}}function UD(n){return GD(n)?new un({code:n,units:"m"}):null}function zD(n){let e=GD(n.getCode());return e?{forward:LD(IG,e),inverse:LD(MG,e)}:null}var RG=[zD],AG=[UD];var Rx=!0;function Ax(n){Rx=!(n===void 0?!0:n)}function Px(n,e){if(e!==void 0){for(let t=0,r=n.length;t<r;++t)e[t]=n[t];e=e}else e=n.slice();return e}function xd(n){PD(n.getCode(),n),zs(n,n,Px)}function PG(n){n.forEach(xd)}function ne(n){if(typeof n!="string")return n;let e=mc(n);if(e)return e;for(let t of AG){let r=t(n);if(r)return r}return null}function $s(n,e,t,r){n=ne(n);let i,o=n.getPointResolutionFunc();if(o){if(i=o(e,t),r&&r!==n.getUnits()){let s=n.getMetersPerUnit();s&&(i=i*s/Ii[r])}}else{let s=n.getUnits();if(s=="degrees"&&!r||r=="degrees")i=e;else{let a=Yo(n,ne("EPSG:4326"));if(!a&&s!=="degrees")i=e*n.getMetersPerUnit();else{let c=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];c=a(c,c,2);let u=_x(c.slice(0,2),c.slice(2,4)),d=_x(c.slice(4,6),c.slice(6,8));i=(u+d)/2}let l=r?Ii[r]:n.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function bm(n){PG(n),n.forEach(function(e){n.forEach(function(t){e!==t&&zs(e,t,Px)})})}function NG(n,e,t,r){n.forEach(function(i){e.forEach(function(o){zs(i,o,t),zs(o,i,r)})})}function Tm(n,e){return n?typeof n=="string"?ne(n):n:ne(e)}function Mm(n){return function(e,t,r,i){let o=e.length;r=r!==void 0?r:2,i=i??r,t=t!==void 0?t:new Array(o);for(let s=0;s<o;s+=i){let a=n(e.slice(s,s+r)),l=a.length;for(let c=0,u=i;c<u;++c)t[s+c]=c>=l?e[s+c]:a[c]}return t}}function $D(n,e,t,r){let i=ne(n),o=ne(e);zs(i,o,Mm(t)),zs(o,i,Mm(r))}function Nx(n,e){return Ax(),Jo(n,"EPSG:4326",e!==void 0?e:"EPSG:3857")}function qn(n,e){if(n===e)return!0;let t=n.getUnits()===e.getUnits();return(n.getCode()===e.getCode()||Yo(n,e)===Px)&&t}function Yo(n,e){let t=n.getCode(),r=e.getCode(),i=yc(t,r);if(i)return i;let o=null,s=null;for(let l of RG)o||(o=l(n)),s||(s=l(e));if(!o&&!s)return null;let a="EPSG:4326";if(s)if(o)i=Dx(o.inverse,s.forward);else{let l=yc(t,a);l&&(i=Dx(l,s.forward))}else{let l=yc(a,r);l&&(i=Dx(o.inverse,l))}return i&&(xd(n),xd(e),zs(n,e,i)),i}function Dx(n,e){return function(t,r,i,o){return r=n(t,r,i,o),e(r,r,i,o)}}function Ko(n,e){let t=ne(n),r=ne(e);return Yo(t,r)}function Jo(n,e,t){let r=Ko(e,t);if(!r){let i=ne(e).getCode(),o=ne(t).getCode();throw new Error(`No transform available between ${i} and ${o}`)}return r(n,void 0,n.length)}function Sm(n,e,t,r){let i=Ko(e,t);return mm(n,i,void 0,r)}var Wr=null;function OG(n){Wr=ne(n)}function Xr(){return Wr}function HD(){OG("EPSG:4326")}function Ed(n,e){return Wr?Jo(n,e,Wr):n}function Wn(n,e){return Wr?Jo(n,Wr,e):(Rx&&!Ka(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Rx=!1,vm("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n)}function Hs(n,e){return Wr?Sm(n,e,Wr):n}function Zr(n,e){return Wr?Sm(n,Wr,e):n}function qD(n,e){if(!Wr)return n;let t=ne(e).getMetersPerUnit(),r=Wr.getMetersPerUnit();return t&&r?n*t/r:n}function Ox(n,e,t){return function(r){let i,o;if(n.canWrapX()){let s=n.getExtent(),a=ee(s);r=r.slice(0),o=wx(r,n,a),o&&(r[0]=r[0]-o*a),r[0]=xe(r[0],s[0],s[2]),r[1]=xe(r[1],s[1],s[3]),i=t(r)}else i=t(r);return o&&e.canWrapX()&&(i[0]+=o*ee(e.getExtent())),i}}function FG(){bm(bx),bm(Mx),NG(Mx,bx,DD,RD)}FG();var XD=new Array(6);function qt(){return[1,0,0,1,0,0]}function Fx(n){return Lx(n,1,0,0,1,0,0)}function Im(n,e){let t=n[0],r=n[1],i=n[2],o=n[3],s=n[4],a=n[5],l=e[0],c=e[1],u=e[2],d=e[3],f=e[4],h=e[5];return n[0]=t*l+i*c,n[1]=r*l+o*c,n[2]=t*u+i*d,n[3]=r*u+o*d,n[4]=t*f+i*h+s,n[5]=r*f+o*h+a,n}function Lx(n,e,t,r,i,o,s){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=o,n[5]=s,n}function ZD(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function dt(n,e){let t=e[0],r=e[1];return e[0]=n[0]*t+n[2]*r+n[4],e[1]=n[1]*t+n[3]*r+n[5],e}function wd(n,e,t){return Im(n,Lx(XD,e,0,0,t,0,0))}function YD(n,e,t){return Im(n,Lx(XD,1,0,0,1,e,t))}function yn(n,e,t,r,i,o,s,a){let l=Math.sin(o),c=Math.cos(o);return n[0]=r*c,n[1]=i*l,n[2]=-r*l,n[3]=i*c,n[4]=s*r*c-a*r*l+e,n[5]=s*i*l+a*i*c+t,n}function Dm(n,e){let t=LG(e);se(t!==0,"Transformation matrix cannot be inverted");let r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],l=e[5];return n[0]=s/t,n[1]=-i/t,n[2]=-o/t,n[3]=r/t,n[4]=(o*l-s*a)/t,n[5]=-(r*l-i*a)/t,n}function LG(n){return n[0]*n[3]-n[1]*n[2]}var kG=[1e5,1e5,1e5,1e5,2,2];function KD(n){return"matrix("+n.join(", ")+")"}function WD(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function JD(n,e){let t=WD(n),r=WD(e);for(let i=0;i<6;++i)if(Math.round((t[i]-r[i])*kG[i])!==0)return!1;return!0}function dr(n,e,t,r,i,o,s){o=o||[],s=s||2;let a=0;for(let l=e;l<t;l+=r){let c=n[l],u=n[l+1];o[a++]=i[0]*c+i[2]*u+i[4],o[a++]=i[1]*c+i[3]*u+i[5];for(let d=2;d<s;d++)o[a++]=n[l+d]}return o&&o.length!=a&&(o.length=a),o}function _c(n,e,t,r,i,o,s){s=s||[];let a=Math.cos(i),l=Math.sin(i),c=o[0],u=o[1],d=0;for(let f=e;f<t;f+=r){let h=n[f]-c,p=n[f+1]-u;s[d++]=c+h*a-p*l,s[d++]=u+h*l+p*a;for(let m=f+2;m<f+r;++m)s[d++]=n[m]}return s&&s.length!=d&&(s.length=d),s}function QD(n,e,t,r,i,o,s,a){a=a||[];let l=s[0],c=s[1],u=0;for(let d=e;d<t;d+=r){let f=n[d]-l,h=n[d+1]-c;a[u++]=l+i*f,a[u++]=c+o*h;for(let p=d+2;p<d+r;++p)a[u++]=n[p]}return a&&a.length!=u&&(a.length=u),a}function eR(n,e,t,r,i,o,s){s=s||[];let a=0;for(let l=e;l<t;l+=r){s[a++]=n[l]+i,s[a++]=n[l+1]+o;for(let c=l+2;c<l+r;++c)s[a++]=n[c]}return s&&s.length!=a&&(s.length=a),s}var tR=qt(),jG=[NaN,NaN],kx=class extends At{constructor(){super(),this.extent_=wt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=cm((e,t,r)=>{if(!r)return this.getSimplifiedGeometry(t);let i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return W()}closestPointXY(e,t,r,i){return W()}containsXY(e,t){return this.closestPointXY(e,t,jG,Number.MIN_VALUE)===0}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return W()}getExtent(e){if(this.extentRevision_!=this.getRevision()){let t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Wo(t),this.extentRevision_=this.getRevision()}return wD(this.extent_,e)}rotate(e,t){W()}scale(e,t,r){W()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return W()}getType(){return W()}applyTransform(e){W()}intersectsExtent(e){return W()}translate(e,t){W()}transform(e,t){let r=ne(e),i=r.getUnits()=="tile-pixels"?function(o,s,a){let l=r.getExtent(),c=r.getWorldExtent(),u=et(c)/et(l);yn(tR,c[0],c[3],u,-u,0,0,0);let d=dr(o,0,o.length,a,tR,s),f=Ko(r,t);return f?f(d,d,a):d}:Ko(r,t);return this.applyTransform(i),this}},Rm=kx;var jx=class extends Rm{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return cc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return W()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;let t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=Cd(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){W()}setLayout(e,t,r){let i;if(e)i=Cd(e);else{for(let o=0;o<r;++o){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}i=t.length,e=qs(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,t){let r=this.getFlatCoordinates();if(r){let i=this.getStride();_c(r,0,r.length,i,e,t,r),this.changed()}}scale(e,t,r){t===void 0&&(t=e),r||(r=Ht(this.getExtent()));let i=this.getFlatCoordinates();if(i){let o=this.getStride();QD(i,0,i.length,o,e,t,r,i),this.changed()}}translate(e,t){let r=this.getFlatCoordinates();if(r){let i=this.getStride();eR(r,0,r.length,i,e,t,r),this.changed()}}};function qs(n){let e;return n==2?e="XY":n==3?e="XYZ":n==4&&(e="XYZM"),e}function Cd(n){let e;return n=="XY"?e=2:n=="XYZ"||n=="XYM"?e=3:n=="XYZM"&&(e=4),e}function nR(n,e,t){let r=n.getFlatCoordinates();if(!r)return null;let i=n.getStride();return dr(r,0,r.length,i,e,t)}var Rn=jx;function Vx(n,e,t,r){let i=0,o=n[t-r],s=n[t-r+1],a=0,l=0;for(;e<t;e+=r){let c=n[e]-o,u=n[e+1]-s;i+=l*c-a*u,a=c,l=u}return i/2}function Bx(n,e,t,r){let i=0;for(let o=0,s=t.length;o<s;++o){let a=t[o];i+=Vx(n,e,a,r),e=a}return i}function rR(n,e,t,r){let i=0;for(let o=0,s=t.length;o<s;++o){let a=t[o];i+=Bx(n,e,a,r),e=a[a.length-1]}return i}function iR(n,e,t,r,i,o,s){let a=n[e],l=n[e+1],c=n[t]-a,u=n[t+1]-l,d;if(c===0&&u===0)d=e;else{let f=((i-a)*c+(o-l)*u)/(c*c+u*u);if(f>1)d=t;else if(f>0){for(let h=0;h<r;++h)s[h]=gn(n[e+h],n[t+h],f);s.length=r;return}else d=e}for(let f=0;f<r;++f)s[f]=n[d+f];s.length=r}function bd(n,e,t,r,i){let o=n[e],s=n[e+1];for(e+=r;e<t;e+=r){let a=n[e],l=n[e+1],c=ur(o,s,a,l);c>i&&(i=c),o=a,s=l}return i}function Md(n,e,t,r,i){for(let o=0,s=t.length;o<s;++o){let a=t[o];i=bd(n,e,a,r,i),e=a}return i}function oR(n,e,t,r,i){for(let o=0,s=t.length;o<s;++o){let a=t[o];i=Md(n,e,a,r,i),e=a[a.length-1]}return i}function Td(n,e,t,r,i,o,s,a,l,c,u){if(e==t)return c;let d,f;if(i===0){if(f=ur(s,a,n[e],n[e+1]),f<c){for(d=0;d<r;++d)l[d]=n[e+d];return l.length=r,f}return c}u=u||[NaN,NaN];let h=e+r;for(;h<t;)if(iR(n,h-r,h,r,s,a,u),f=ur(s,a,u[0],u[1]),f<c){for(c=f,d=0;d<r;++d)l[d]=u[d];l.length=r,h+=r}else h+=r*Math.max((Math.sqrt(f)-Math.sqrt(c))/i|0,1);if(o&&(iR(n,t-r,e,r,s,a,u),f=ur(s,a,u[0],u[1]),f<c)){for(c=f,d=0;d<r;++d)l[d]=u[d];l.length=r}return c}function Sd(n,e,t,r,i,o,s,a,l,c,u){u=u||[NaN,NaN];for(let d=0,f=t.length;d<f;++d){let h=t[d];c=Td(n,e,h,r,i,o,s,a,l,c,u),e=h}return c}function sR(n,e,t,r,i,o,s,a,l,c,u){u=u||[NaN,NaN];for(let d=0,f=t.length;d<f;++d){let h=t[d];c=Sd(n,e,h,r,i,o,s,a,l,c,u),e=h[h.length-1]}return c}function Am(n,e,t,r){for(let i=0,o=t.length;i<o;++i)n[e++]=t[i];return e}function Qa(n,e,t,r){for(let i=0,o=t.length;i<o;++i){let s=t[i];for(let a=0;a<r;++a)n[e++]=s[a]}return e}function Ws(n,e,t,r,i){i=i||[];let o=0;for(let s=0,a=t.length;s<a;++s){let l=Qa(n,e,t[s],r);i[o++]=l,e=l}return i.length=o,i}function Pm(n,e,t,r,i){i=i||[];let o=0;for(let s=0,a=t.length;s<a;++s){let l=Ws(n,e,t[s],r,i[o]);l.length===0&&(l[0]=e),i[o++]=l,e=l[l.length-1]}return i.length=o,i}function Yr(n,e,t,r,i){i=i!==void 0?i:[];let o=0;for(let s=e;s<t;s+=r)i[o++]=n.slice(s,s+r);return i.length=o,i}function Xs(n,e,t,r,i){i=i!==void 0?i:[];let o=0;for(let s=0,a=t.length;s<a;++s){let l=t[s];i[o++]=Yr(n,e,l,r,i[o]),e=l}return i.length=o,i}function Id(n,e,t,r,i){i=i!==void 0?i:[];let o=0;for(let s=0,a=t.length;s<a;++s){let l=t[s];i[o++]=l.length===1&&l[0]===e?[]:Xs(n,e,l,r,i[o]),e=l[l.length-1]}return i.length=o,i}function el(n,e,t,r,i,o,s){let a=(t-e)/r;if(a<3){for(;e<t;e+=r)o[s++]=n[e],o[s++]=n[e+1];return s}let l=new Array(a);l[0]=1,l[a-1]=1;let c=[e,t-r],u=0;for(;c.length>0;){let d=c.pop(),f=c.pop(),h=0,p=n[f],m=n[f+1],g=n[d],y=n[d+1];for(let v=f+r;v<d;v+=r){let x=n[v],E=n[v+1],_=bD(x,E,p,m,g,y);_>h&&(u=v,h=_)}h>i&&(l[(u-e)/r]=1,f+r<u&&c.push(f,u),u+r<d&&c.push(u,d))}for(let d=0;d<a;++d)l[d]&&(o[s++]=n[e+d*r],o[s++]=n[e+d*r+1]);return s}function Nm(n,e,t,r,i,o,s,a){for(let l=0,c=t.length;l<c;++l){let u=t[l];s=el(n,e,u,r,i,o,s),a.push(s),e=u}return s}function Zs(n,e){return e*Math.round(n/e)}function VG(n,e,t,r,i,o,s){if(e==t)return s;let a=Zs(n[e],i),l=Zs(n[e+1],i);e+=r,o[s++]=a,o[s++]=l;let c,u;do if(c=Zs(n[e],i),u=Zs(n[e+1],i),e+=r,e==t)return o[s++]=c,o[s++]=u,s;while(c==a&&u==l);for(;e<t;){let d=Zs(n[e],i),f=Zs(n[e+1],i);if(e+=r,d==c&&f==u)continue;let h=c-a,p=u-l,m=d-a,g=f-l;if(h*g==p*m&&(h<0&&m<h||h==m||h>0&&m>h)&&(p<0&&g<p||p==g||p>0&&g>p)){c=d,u=f;continue}o[s++]=c,o[s++]=u,a=c,l=u,c=d,u=f}return o[s++]=c,o[s++]=u,s}function Dd(n,e,t,r,i,o,s,a){for(let l=0,c=t.length;l<c;++l){let u=t[l];s=VG(n,e,u,r,i,o,s),a.push(s),e=u}return s}function aR(n,e,t,r,i,o,s,a){for(let l=0,c=t.length;l<c;++l){let u=t[l],d=[];s=Dd(n,e,u,r,i,o,s,d),a.push(d),e=u[u.length-1]}return s}var Gx=class n extends Rn{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new n(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,r,i){return i<cr(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(bd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Td(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,r,i))}getArea(){return Vx(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Yr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){let t=[];return t.length=el(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new n(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Qa(this.flatCoordinates,0,e,this.stride),this.changed()}},Ux=Gx;var zx=class n extends Rn{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){let e=new n(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){let o=this.flatCoordinates,s=ur(e,t,o[0],o[1]);if(s<i){let a=this.stride;for(let l=0;l<a;++l)r[l]=o[l];return r.length=a,s}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return pm(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return md(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Am(this.flatCoordinates,0,e,this.stride),this.changed()}},dn=zx;function lR(n,e,t,r,i){return!uc(i,function(s){return!Ys(n,e,t,r,s[0],s[1])})}function Ys(n,e,t,r,i,o){let s=0,a=n[t-r],l=n[t-r+1];for(;e<t;e+=r){let c=n[e],u=n[e+1];l<=o?u>o&&(c-a)*(o-l)-(i-a)*(u-l)>0&&s++:u<=o&&(c-a)*(o-l)-(i-a)*(u-l)<0&&s--,a=c,l=u}return s!==0}function Rd(n,e,t,r,i,o){if(t.length===0||!Ys(n,e,t[0],r,i,o))return!1;for(let s=1,a=t.length;s<a;++s)if(Ys(n,t[s-1],t[s],r,i,o))return!1;return!0}function cR(n,e,t,r,i,o){if(t.length===0)return!1;for(let s=0,a=t.length;s<a;++s){let l=t[s];if(Rd(n,e,l,r,i,o))return!0;e=l[l.length-1]}return!1}function Ad(n,e,t,r,i,o,s){let a,l,c,u,d,f,h,p=i[o+1],m=[];for(let v=0,x=t.length;v<x;++v){let E=t[v];for(u=n[E-r],f=n[E-r+1],a=e;a<E;a+=r)d=n[a],h=n[a+1],(p<=f&&h<=p||f<=p&&p<=h)&&(c=(p-f)/(h-f)*(d-u)+u,m.push(c)),u=d,f=h}let g=NaN,y=-1/0;for(m.sort(In),u=m[0],a=1,l=m.length;a<l;++a){d=m[a];let v=Math.abs(d-u);v>y&&(c=(u+d)/2,Rd(n,e,t,r,c,p)&&(g=c,y=v)),u=d}return isNaN(g)&&(g=i[o]),s?(s.push(g,p,y),s):[g,p,y]}function Om(n,e,t,r,i){let o=[];for(let s=0,a=t.length;s<a;++s){let l=t[s];o=Ad(n,e,l,r,i,2*s,o),e=l[l.length-1]}return o}function Fm(n,e,t,r,i){let o;for(e+=r;e<t;e+=r)if(o=i(n.slice(e-r,e),n.slice(e,e+r)),o)return o;return!1}function Pd(n,e,t,r,i,o){return o=o??gx(wt(),n,e,t,r),Le(i,o)?o[0]>=i[0]&&o[2]<=i[2]||o[1]>=i[1]&&o[3]<=i[3]?!0:Fm(n,e,t,r,function(s,a){return CD(i,s,a)}):!1}function uR(n,e,t,r,i){for(let o=0,s=t.length;o<s;++o){if(Pd(n,e,t[o],r,i))return!0;e=t[o]}return!1}function $x(n,e,t,r,i){return!!(Pd(n,e,t,r,i)||Ys(n,e,t,r,i[0],i[1])||Ys(n,e,t,r,i[0],i[3])||Ys(n,e,t,r,i[2],i[1])||Ys(n,e,t,r,i[2],i[3]))}function Hx(n,e,t,r,i){if(!$x(n,e,t[0],r,i))return!1;if(t.length===1)return!0;for(let o=1,s=t.length;o<s;++o)if(lR(n,t[o-1],t[o],r,i)&&!Pd(n,t[o-1],t[o],r,i))return!1;return!0}function dR(n,e,t,r,i){for(let o=0,s=t.length;o<s;++o){let a=t[o];if(Hx(n,e,a,r,i))return!0;e=a[a.length-1]}return!1}function fR(n,e,t,r){for(;e<t-r;){for(let i=0;i<r;++i){let o=n[e+i];n[e+i]=n[t-r+i],n[t-r+i]=o}e+=r,t-=r}}function qx(n,e,t,r){let i=0,o=n[t-r],s=n[t-r+1];for(;e<t;e+=r){let a=n[e],l=n[e+1];i+=(a-o)*(l+s),o=a,s=l}return i===0?void 0:i>0}function Nd(n,e,t,r,i){i=i!==void 0?i:!1;for(let o=0,s=t.length;o<s;++o){let a=t[o],l=qx(n,e,a,r);if(o===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=a}return!0}function Lm(n,e,t,r,i){for(let o=0,s=t.length;o<s;++o){let a=t[o];if(!Nd(n,e,a,r,i))return!1;a.length&&(e=a[a.length-1])}return!0}function xc(n,e,t,r,i){i=i!==void 0?i:!1;for(let o=0,s=t.length;o<s;++o){let a=t[o],l=qx(n,e,a,r);(o===0?i&&l||!i&&!l:i&&!l||!i&&l)&&fR(n,e,a,r),e=a}return e}function Od(n,e,t,r,i){for(let o=0,s=t.length;o<s;++o)e=xc(n,e,t[o],r,i);return e}function km(n,e){let t=[],r=0,i=0,o;for(let s=0,a=e.length;s<a;++s){let l=e[s],c=qx(n,r,l,2);if(o===void 0&&(o=c),c===o)t.push(e.slice(i,s+1));else{if(t.length===0)continue;t[t.length-1].push(e[i])}i=s+1,r=l}return t}var jm=class n extends Rn{constructor(e,t,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&r?(this.setFlatCoordinates(t,e),this.ends_=r):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?mn(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){let e=new n(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<cr(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Md(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Sd(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return Rd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return Bx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),xc(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,Xs(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){let e=Ht(this.getExtent());this.flatInteriorPoint_=Ad(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new dn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new Ux(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){let e=this.layout,t=this.flatCoordinates,r=this.ends_,i=[],o=0;for(let s=0,a=r.length;s<a;++s){let l=r[s],c=new Ux(t.slice(o,l),e);i.push(c),o=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){let e=this.flatCoordinates;Nd(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=xc(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){let t=[],r=[];return t.length=Dd(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,r),new n(t,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return Hx(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);let r=Ws(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}},An=jm;function to(n){if(Bs(n))throw new Error("Cannot create polygon from empty extent");let e=n[0],t=n[1],r=n[2],i=n[3],o=[e,t,e,i,r,i,r,t,e,t];return new jm(o,"XY",[o.length])}function tl(n,e,t,r,i,o,s){let a,l,c=(t-e)/r;if(c===1)a=e;else if(c===2)a=e,l=i;else if(c!==0){let u=n[e],d=n[e+1],f=0,h=[0];for(let g=e+r;g<t;g+=r){let y=n[g],v=n[g+1];f+=Math.sqrt((y-u)*(y-u)+(v-d)*(v-d)),h.push(f),u=y,d=v}let p=i*f,m=gD(h,p);m<0?(l=(p-h[-m-2])/(h[-m-1]-h[-m-2]),a=e+(-m-2)*r):a=e+m*r}s=s>1?s:2,o=o||new Array(s);for(let u=0;u<s;++u)o[u]=a===void 0?NaN:l===void 0?n[a+u]:gn(n[a+u],n[a+r+u],l);return o}function Vm(n,e,t,r,i,o){if(t==e)return null;let s;if(i<n[e+r-1])return o?(s=n.slice(e,e+r),s[r-1]=i,s):null;if(n[t-1]<i)return o?(s=n.slice(t-r,t),s[r-1]=i,s):null;if(i==n[e+r-1])return n.slice(e,e+r);let a=e/r,l=t/r;for(;a<l;){let f=a+l>>1;i<n[(f+1)*r-1]?l=f:a=f+1}let c=n[a*r-1];if(i==c)return n.slice((a-1)*r,(a-1)*r+r);let u=n[(a+1)*r-1],d=(i-c)/(u-c);s=[];for(let f=0;f<r-1;++f)s.push(gn(n[(a-1)*r+f],n[a*r+f],d));return s.push(i),s}function hR(n,e,t,r,i,o,s){if(s)return Vm(n,e,t[t.length-1],r,i,o);let a;if(i<n[r-1])return o?(a=n.slice(0,r),a[r-1]=i,a):null;if(n[n.length-1]<i)return o?(a=n.slice(n.length-r),a[r-1]=i,a):null;for(let l=0,c=t.length;l<c;++l){let u=t[l];if(e!=u){if(i<n[e+r-1])return null;if(i<=n[u-1])return Vm(n,e,u,r,i,!1);e=u}}return null}function Ec(n,e,t,r){let i=n[e],o=n[e+1],s=0;for(let a=e+r;a<t;a+=r){let l=n[a],c=n[a+1];s+=Math.sqrt((l-i)*(l-i)+(c-o)*(c-o)),i=l,o=c}return s}var Wx=class n extends Rn{constructor(e,t){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendCoordinate(e){mn(this.flatCoordinates,e),this.changed()}clone(){let e=new n(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<cr(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(bd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Td(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,t,r,i))}forEachSegment(e){return Fm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,t){return this.layout!="XYM"&&this.layout!="XYZM"?null:(t=t!==void 0?t:!1,Vm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t))}getCoordinates(){return Yr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,t){return tl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,this.stride)}getLength(){return Ec(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){let t=[];return t.length=el(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new n(t,"XY")}getType(){return"LineString"}intersectsExtent(e){return Pd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Qa(this.flatCoordinates,0,e,this.stride),this.changed()}},vn=Wx;var _n={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};var nl=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",BG=nl.includes("safari")&&!nl.includes("chrom"),Ore=BG&&(nl.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(nl)),pR=nl.includes("webkit")&&!nl.includes("edge"),Xx=nl.includes("macintosh"),mR=typeof devicePixelRatio<"u"?devicePixelRatio:1,wc=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Zx=typeof Image<"u"&&Image.prototype.decode;var Bm=function(){let n=!1;try{let e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return n}();var re={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function be(n,e,t,r){let i;return t&&t.length?i=t.shift():wc?i=new OffscreenCanvas(n||300,e||300):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("2d",r)}var Yx;function Cc(){return Yx||(Yx=be(1,1)),Yx}function Qo(n){let e=n.canvas;e.width=1,e.height=1,n.clearRect(0,0,1,1)}function gR(n){let e=n.offsetWidth,t=getComputedStyle(n);return e+=parseInt(t.marginLeft,10)+parseInt(t.marginRight,10),e}function yR(n){let e=n.offsetHeight,t=getComputedStyle(n);return e+=parseInt(t.marginTop,10)+parseInt(t.marginBottom,10),e}function bc(n,e){let t=e.parentNode;t&&t.replaceChild(n,e)}function Gm(n){for(;n.lastChild;)n.lastChild.remove()}function vR(n,e){let t=n.childNodes;for(let r=0;;++r){let i=t[r],o=e[r];if(!i&&!o)break;if(i!==o){if(!i){n.appendChild(o);continue}if(!o){n.removeChild(i),--r;continue}n.insertBefore(o,i)}}}var zm=[NaN,NaN,NaN,0],Kx;function GG(){return Kx||(Kx=be(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Kx}var UG=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,zG=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,$G=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,HG=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Um(n,e){return n.endsWith("%")?Number(n.substring(0,n.length-1))/e:Number(n)}function Ld(n){throw new Error('failed to parse "'+n+'" as color')}function _R(n){if(n.toLowerCase().startsWith("rgb")){let o=n.match(zG)||n.match(UG)||n.match($G);if(o){let s=o[4],a=100/255;return[xe(Um(o[1],a)+.5|0,0,255),xe(Um(o[2],a)+.5|0,0,255),xe(Um(o[3],a)+.5|0,0,255),s!==void 0?xe(Um(s,100),0,1):1]}Ld(n)}if(n.startsWith("#")){if(HG.test(n)){let o=n.substring(1),s=o.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=o.length;l<c;l+=s){let u=parseInt(o.substring(l,l+s),16);s===1&&(u+=u<<4),a[l/s]=u}return a[3]=a[3]/255,a}Ld(n)}let e=GG();e.fillStyle="#abcdef";let t=e.fillStyle;e.fillStyle=n,e.fillStyle===t&&(e.fillStyle="#fedcba",t=e.fillStyle,e.fillStyle=n,e.fillStyle===t&&Ld(n));let r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return _R(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);let i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=Gs(i[3]/255,3),i}function xR(n){return typeof n=="string"?n:jd(n)}var qG=1024,Fd={},Jx=0;function ER(n){if(n.length===4)return n;let e=n.slice();return e[3]=1,e}function Qx(n){return n>.0031308?Math.pow(n,1/2.4)*269.025-14.025:n*3294.6}function eE(n){return n>.2068965?Math.pow(n,3):(n-4/29)*(108/841)}function tE(n){return n>10.314724?Math.pow((n+14.025)/269.025,2.4):n/3294.6}function nE(n){return n>.0088564?Math.pow(n,1/3):n/(108/841)+4/29}function rE(n){let e=tE(n[0]),t=tE(n[1]),r=tE(n[2]),i=nE(e*.222488403+t*.716873169+r*.06060791),o=500*(nE(e*.452247074+t*.399439023+r*.148375274)-i),s=200*(i-nE(e*.016863605+t*.117638439+r*.865350722)),a=Math.atan2(s,o)*(180/Math.PI);return[116*i-16,Math.sqrt(o*o+s*s),a<0?a+360:a,n[3]]}function wR(n){let e=(n[0]+16)/116,t=n[1],r=n[2]*Math.PI/180,i=eE(e),o=eE(e+t/500*Math.cos(r)),s=eE(e-t/200*Math.sin(r)),a=Qx(o*3.021973625-i*1.617392459-s*.404875592),l=Qx(o*-.943766287+i*1.916279586+s*.027607165),c=Qx(o*.069407491-i*.22898585+s*1.159737864);return[xe(a+.5|0,0,255),xe(l+.5|0,0,255),xe(c+.5|0,0,255),n[3]]}function kd(n){if(n==="none")return zm;if(Fd.hasOwnProperty(n))return Fd[n];if(Jx>=qG){let t=0;for(let r in Fd)(t++&3)===0&&(delete Fd[r],--Jx)}let e=_R(n);e.length!==4&&Ld(n);for(let t of e)isNaN(t)&&Ld(n);return Fd[n]=e,++Jx,e}function Di(n){return Array.isArray(n)?n:kd(n)}function jd(n){let e=n[0];e!=(e|0)&&(e=e+.5|0);let t=n[1];t!=(t|0)&&(t=t+.5|0);let r=n[2];r!=(r|0)&&(r=r+.5|0);let i=n[3]===void 0?1:Math.round(n[3]*1e3)/1e3;return"rgba("+e+","+t+","+r+","+i+")"}function CR(n,e,t){let r=n,i=!0,o=!1,s=!1,a=[sc(r,H.LOAD,function(){s=!0,o||e()})];return r.src&&Zx?(o=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(s?e():t())})):a.push(sc(r,H.ERROR,t)),function(){i=!1,a.forEach(ce)}}function WG(n,e){return new Promise((t,r)=>{function i(){s(),t(n)}function o(){s(),r(new Error("Image load error"))}function s(){n.removeEventListener("load",i),n.removeEventListener("error",o)}n.addEventListener("load",i),n.addEventListener("error",o),e&&(n.src=e)})}function bR(n,e){return e&&(n.src=e),n.src&&Zx?new Promise((t,r)=>n.decode().then(()=>t(n)).catch(i=>n.complete&&n.width?t(n):r(i))):WG(n)}var oE=class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(let t in this.cache_){let r=this.cache_[t];(e++&3)===0&&!r.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,r){let i=iE(e,t,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,t,r){let i=iE(e,t,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,t,r,i,o){let s=iE(e,t,r),a=s in this.cache_;this.cache_[s]=i,o&&(i.getImageState()===re.IDLE&&i.load(),i.getImageState()===re.LOADING?i.ready().then(()=>{this.patternCache_[s]=Cc().createPattern(i.getImage(1),"repeat")}):this.patternCache_[s]=Cc().createPattern(i.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}};function iE(n,e,t){let r=t?Di(t):"null";return e+":"+n+":"+r}var Pn=new oE;var Vd=null,$m=class extends Os{constructor(e,t,r,i,o){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=o,this.imageState_=i===void 0?re.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===re.LOADED){Vd||(Vd=be(1,1,void 0,{willReadFrequently:!0})),Vd.drawImage(this.image_,0,0);try{Vd.getImageData(0,0,1,1),this.tainted_=!1}catch{Vd=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(H.CHANGE)}handleImageError_(){this.imageState_=re.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=re.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){let e=this.size_[0],t=this.size_[1],r=be(e,t);r.fillRect(0,0,e,t),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===re.IDLE){this.image_||this.initializeImage_(),this.imageState_=re.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&bR(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==re.LOADED)return;let t=this.image_,r=be(Math.ceil(t.width*e),Math.ceil(t.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(t,0,0),r.globalCompositeOperation="multiply",r.fillStyle=xR(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===re.LOADED||this.imageState_===re.ERROR)e();else{let t=()=>{(this.imageState_===re.LOADED||this.imageState_===re.ERROR)&&(this.removeEventListener(H.CHANGE,t),e())};this.addEventListener(H.CHANGE,t)}})),this.ready_}};function Mc(n,e,t,r,i,o){let s=e===void 0?void 0:Pn.get(e,t,i);return s||(s=new $m(n,n&&"src"in n?n.src||void 0:e,t,r,i),Pn.set(e,t,i,s,o)),o&&s&&!Pn.getPattern(e,t,i)&&Pn.set(e,t,i,s,o),s}var MR=$m;function fr(n){return n?Array.isArray(n)?jd(n):typeof n=="object"&&"src"in n?XG(n):n:null}function XG(n){if(!n.offset||!n.size)return Pn.getPattern(n.src,"anonymous",n.color);let e=n.src+":"+n.offset,t=Pn.getPattern(e,void 0,n.color);if(t)return t;let r=Pn.get(n.src,"anonymous",null);if(r.getImageState()!==re.LOADED)return null;let i=be(n.size[0],n.size[1]);return i.drawImage(r.getImage(1),n.offset[0],n.offset[1],n.size[0],n.size[1],0,0,n.size[0],n.size[1]),Mc(i.canvas,e,void 0,re.LOADED,n.color,!0),Pn.getPattern(e,void 0,n.color)}var sE=class{drawCustom(e,t,r,i,o){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,r){}drawFeature(e,t,r){}drawGeometryCollection(e,t,r){}drawLineString(e,t,r){}drawMultiLineString(e,t,r){}drawMultiPoint(e,t,r){}drawMultiPolygon(e,t,r){}drawPoint(e,t,r){}drawPolygon(e,t,r){}drawText(e,t,r){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}},Hm=sE;var Bd="ol-hidden",SR="ol-selectable",no="ol-unselectable",aE="ol-unsupported",Ks="ol-control",lE="ol-collapsed",ZG=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),TR=["style","variant","weight","size","lineHeight","family"],cE=function(n){let e=n.match(ZG);if(!e)return null;let t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let r=0,i=TR.length;r<i;++r){let o=e[r+1];o!==void 0&&(t[TR[r]]=o)}return t.families=t.family.split(/,\s?/),t};var Wm="10px sans-serif",en="#000",ro="round",hr=[],pr=0,io="round",es=10,ts="#000",Js="center",rl="middle",ns=[0,0,0,0],rs=1,Kr=new At,Tc=null,uE,dE={},Xm=function(){let e="32px ",t=["monospace","serif"],r=t.length,i="wmytzilWMYTZIL@#/&?$%10\uF013",o,s;function a(c,u,d){let f=!0;for(let h=0;h<r;++h){let p=t[h];if(s=qm(c+" "+u+" "+e+p,i),d!=p){let m=qm(c+" "+u+" "+e+d+","+p,i);f=f&&m!=s}}return!!f}function l(){let c=!0,u=Kr.getKeys();for(let d=0,f=u.length;d<f;++d){let h=u[d];if(Kr.get(h)<100){let[p,m,g]=h.split(`
`);a(p,m,g)?(eo(dE),Tc=null,uE=void 0,Kr.set(h,100)):(Kr.set(h,Kr.get(h)+1,!0),c=!1)}}c&&(clearInterval(o),o=void 0)}return function(c){let u=cE(c);if(!u)return;let d=u.families;for(let f=0,h=d.length;f<h;++f){let p=d[f],m=u.style+`
`+u.weight+`
`+p;Kr.get(m)===void 0&&(Kr.set(m,100,!0),a(u.style,u.weight,p)||(Kr.set(m,0,!0),o===void 0&&(o=setInterval(l,32))))}}}(),YG=function(){let n;return function(e){let t=dE[e];if(t==null){if(wc){let r=cE(e),i=IR(e,"\u017Dg");t=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else n||(n=document.createElement("div"),n.innerHTML="M",n.style.minHeight="0",n.style.maxHeight="none",n.style.height="auto",n.style.padding="0",n.style.border="none",n.style.position="absolute",n.style.display="block",n.style.left="-99999px"),n.style.font=e,document.body.appendChild(n),t=n.offsetHeight,document.body.removeChild(n);dE[e]=t}return t}}();function IR(n,e){return Tc||(Tc=be(1,1)),n!=uE&&(Tc.font=n,uE=Tc.font),Tc.measureText(e)}function qm(n,e){return IR(n,e).width}function fE(n,e,t){if(e in t)return t[e];let r=e.split(`
`).reduce((i,o)=>Math.max(i,qm(n,o)),0);return t[e]=r,r}function DR(n,e){let t=[],r=[],i=[],o=0,s=0,a=0,l=0;for(let c=0,u=e.length;c<=u;c+=2){let d=e[c];if(d===`
`||c===u){o=Math.max(o,s),i.push(s),s=0,a+=l,l=0;continue}let f=e[c+1]||n.font,h=qm(f,d);t.push(h),s+=h;let p=YG(f);r.push(p),l=Math.max(l,p)}return{width:o,height:a,widths:t,heights:r,lineWidths:i}}function RR(n,e,t,r,i,o,s,a,l,c,u){n.save(),t!==1&&(n.globalAlpha===void 0?n.globalAlpha=d=>d.globalAlpha*=t:n.globalAlpha*=t),e&&n.transform.apply(n,e),r.contextInstructions?(n.translate(l,c),n.scale(u[0],u[1]),KG(r,n)):u[0]<0||u[1]<0?(n.translate(l,c),n.scale(u[0],u[1]),n.drawImage(r,i,o,s,a,0,0,s,a)):n.drawImage(r,i,o,s,a,l,c,s*u[0],a*u[1]),n.restore()}function KG(n,e){let t=n.contextInstructions;for(let r=0,i=t.length;r<i;r+=2)Array.isArray(t[r+1])?e[t[r]].apply(e,t[r+1]):e[t[r]]=t[r+1]}var hE=class extends Hm{constructor(e,t,r,i,o,s,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=r,this.transform_=i,this.transformRotation_=i?Gs(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=o,this.squaredTolerance_=s,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=qt()}drawImages_(e,t,r,i){if(!this.image_)return;let o=dr(e,t,r,i,this.transform_,this.pixelCoordinates_),s=this.context_,a=this.tmpLocalTransform_,l=s.globalAlpha;this.imageOpacity_!=1&&(s.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let u=0,d=o.length;u<d;u+=2){let f=o[u]-this.imageAnchorX_,h=o[u+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){let p=f+this.imageAnchorX_,m=h+this.imageAnchorY_;yn(a,p,m,1,1,c,-p,-m),s.save(),s.transform.apply(s,a),s.translate(p,m),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,h,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(s.globalAlpha=l)}drawText_(e,t,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);let o=dr(e,t,r,i,this.transform_,this.pixelCoordinates_),s=this.context_,a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<r;t+=i){let l=o[t]+this.textOffsetX_,c=o[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(s.save(),s.translate(l-this.textOffsetX_,c-this.textOffsetY_),s.rotate(a),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,l,c),this.textFillState_&&s.fillText(this.text_,l,c))}}moveToLineTo_(e,t,r,i,o){let s=this.context_,a=dr(e,t,r,i,this.transform_,this.pixelCoordinates_);s.moveTo(a[0],a[1]);let l=a.length;o&&(l-=2);for(let c=2;c<l;c+=2)s.lineTo(a[c],a[c+1]);return o&&s.closePath(),r}drawRings_(e,t,r,i){for(let o=0,s=r.length;o<s;++o)t=this.moveToLineTo_(e,t,r[o],i,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Le(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let t=nR(e,this.transform_,this.pixelCoordinates_),r=t[2]-t[0],i=t[3]-t[1],o=Math.sqrt(r*r+i*i),s=this.context_;s.beginPath(),s.arc(t[0],t[1],o,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break;default:}}drawFeature(e,t){let r=t.getGeometryFunction()(e);r&&(this.setStyle(t),this.drawGeometry(r))}drawGeometryCollection(e){let t=e.getGeometriesArray();for(let r=0,i=t.length;r<i;++r)this.drawGeometry(t[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let t=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(t,0,t.length,r),this.text_!==""&&this.drawText_(t,0,t.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Le(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);let t=this.context_,r=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){let t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));let t=e.getExtent();if(Le(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);let r=this.context_,i=e.getFlatCoordinates(),o=0,s=e.getEnds(),a=e.getStride();r.beginPath();for(let l=0,c=s.length;l<c;++l)o=this.moveToLineTo_(i,o,s[l],a,!1);r.stroke()}if(this.text_!==""){let r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Le(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){let t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Le(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);let t=this.context_,r=e.getOrientedFlatCoordinates(),i=0,o=e.getEndss(),s=e.getStride();t.beginPath();for(let a=0,l=o.length;a<l;++a){let c=o[a];i=this.drawRings_(r,i,c,s)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){let t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){let t=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){let t=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,t.lineCap=e.lineCap),Dn(r.lineDash,e.lineDash)||t.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){let t=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:Js;r?(r.font!=e.font&&(r.font=e.font,t.font=e.font),r.textAlign!=i&&(r.textAlign=i,t.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=i,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{let r=e.getColor();this.fillState_={fillStyle:fr(r||en)}}if(!t)this.strokeState_=null;else{let r=t.getColor(),i=t.getLineCap(),o=t.getLineDash(),s=t.getLineDashOffset(),a=t.getLineJoin(),l=t.getWidth(),c=t.getMiterLimit(),u=o||hr;this.strokeState_={lineCap:i!==void 0?i:ro,lineDash:this.pixelRatio_===1?u:u.map(d=>d*this.pixelRatio_),lineDashOffset:(s||pr)*this.pixelRatio_,lineJoin:a!==void 0?a:io,lineWidth:(l!==void 0?l:rs)*this.pixelRatio_,miterLimit:c!==void 0?c:es,strokeStyle:fr(r||ts)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}let r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),o=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=t[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=o[0],this.imageOriginY_=o[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();let s=e.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/r,s[1]*this.pixelRatio_/r],this.imageWidth_=t[0]*r}setTextStyle(e){if(!e)this.text_="";else{let t=e.getFill();if(!t)this.textFillState_=null;else{let h=t.getColor();this.textFillState_={fillStyle:fr(h||en)}}let r=e.getStroke();if(!r)this.textStrokeState_=null;else{let h=r.getColor(),p=r.getLineCap(),m=r.getLineDash(),g=r.getLineDashOffset(),y=r.getLineJoin(),v=r.getWidth(),x=r.getMiterLimit();this.textStrokeState_={lineCap:p!==void 0?p:ro,lineDash:m||hr,lineDashOffset:g||pr,lineJoin:y!==void 0?y:io,lineWidth:v!==void 0?v:rs,miterLimit:x!==void 0?x:es,strokeStyle:fr(h||ts)}}let i=e.getFont(),o=e.getOffsetX(),s=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),u=e.getText(),d=e.getTextAlign(),f=e.getTextBaseline();this.textState_={font:i!==void 0?i:Wm,textAlign:d!==void 0?d:Js,textBaseline:f!==void 0?f:rl},this.text_=u!==void 0?Array.isArray(u)?u.reduce((h,p,m)=>h+=m%2?" ":p,""):u:"",this.textOffsetX_=o!==void 0?this.pixelRatio_*o:0,this.textOffsetY_=s!==void 0?this.pixelRatio_*s:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}},AR=hE;var JG=.5,PR={Point:oU,LineString:nU,Polygon:aU,MultiPoint:sU,MultiLineString:rU,MultiPolygon:iU,GeometryCollection:tU,Circle:QG};function NR(n,e){return parseInt(X(n),10)-parseInt(X(e),10)}function Gd(n,e){let t=pE(n,e);return t*t}function pE(n,e){return JG*n/e}function QG(n,e,t,r,i){let o=t.getFill(),s=t.getStroke();if(o||s){let l=n.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(o,s),l.drawCircle(e,r,i)}let a=t.getText();if(a&&a.getText()){let l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r)}}function Sc(n,e,t,r,i,o,s,a){let l=[],c=t.getImage();if(c){let f=!0,h=c.getImageState();h==re.LOADED||h==re.ERROR?f=!1:h==re.IDLE&&c.load(),f&&l.push(c.ready())}let u=t.getFill();u&&u.loading()&&l.push(u.ready());let d=l.length>0;return d&&Promise.all(l).then(()=>i(null)),eU(n,e,t,r,o,s,a),d}function eU(n,e,t,r,i,o,s){let a=t.getGeometryFunction()(e);if(!a)return;let l=a.simplifyTransformed(r,i);if(t.getRenderer())OR(n,l,t,e,s);else{let u=PR[l.getType()];u(n,l,t,e,s,o)}}function OR(n,e,t,r,i){if(e.getType()=="GeometryCollection"){let s=e.getGeometries();for(let a=0,l=s.length;a<l;++a)OR(n,s[a],t,r,i);return}n.getBuilder(t.getZIndex(),"Default").drawCustom(e,r,t.getRenderer(),t.getHitDetectionRenderer(),i)}function tU(n,e,t,r,i,o){let s=e.getGeometriesArray(),a,l;for(a=0,l=s.length;a<l;++a){let c=PR[s[a].getType()];c(n,s[a],t,r,i,o)}}function nU(n,e,t,r,i){let o=t.getStroke();if(o){let a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawLineString(e,r,i)}let s=t.getText();if(s&&s.getText()){let a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(s),a.drawText(e,r,i)}}function rU(n,e,t,r,i){let o=t.getStroke();if(o){let a=n.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawMultiLineString(e,r,i)}let s=t.getText();if(s&&s.getText()){let a=n.getBuilder(t.getZIndex(),"Text");a.setTextStyle(s),a.drawText(e,r,i)}}function iU(n,e,t,r,i){let o=t.getFill(),s=t.getStroke();if(s||o){let l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(o,s),l.drawMultiPolygon(e,r,i)}let a=t.getText();if(a&&a.getText()){let l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}function oU(n,e,t,r,i,o){let s=t.getImage(),a=t.getText(),l=a&&a.getText(),c=o&&s&&l?{}:void 0;if(s){if(s.getImageState()!=re.LOADED)return;let u=n.getBuilder(t.getZIndex(),"Image");u.setImageStyle(s,c),u.drawPoint(e,r,i)}if(l){let u=n.getBuilder(t.getZIndex(),"Text");u.setTextStyle(a,c),u.drawText(e,r,i)}}function sU(n,e,t,r,i,o){let s=t.getImage(),a=s&&s.getOpacity()!==0,l=t.getText(),c=l&&l.getText(),u=o&&a&&c?{}:void 0;if(a){if(s.getImageState()!=re.LOADED)return;let d=n.getBuilder(t.getZIndex(),"Image");d.setImageStyle(s,u),d.drawMultiPoint(e,r,i)}if(c){let d=n.getBuilder(t.getZIndex(),"Text");d.setTextStyle(l,u),d.drawText(e,r,i)}}function aU(n,e,t,r,i){let o=t.getFill(),s=t.getStroke();if(o||s){let l=n.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(o,s),l.drawPolygon(e,r,i)}let a=t.getText();if(a&&a.getText()){let l=n.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}var lU=!1;function mE(n,e,t,r,i,o,s){let a=new XMLHttpRequest;a.open("GET",typeof n=="function"?n(t,r,i):n,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=lU,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){let c=e.getType();try{let u;c=="text"||c=="json"?u=a.responseText:c=="xml"?u=a.responseXML||a.responseText:c=="arraybuffer"&&(u=a.response),u?o(e.readFeatures(u,{extent:t,featureProjection:i}),e.readProjection(u)):s()}catch{s()}}else s()},a.onerror=s,a.send()}function gE(n,e){return function(t,r,i,o,s){mE(n,e,t,r,i,(a,l)=>{this.addFeatures(a),o!==void 0&&o(a)},()=>{this.changed(),s!==void 0&&s()})}}function FR(n,e){return[[-1/0,-1/0,1/0,1/0]]}function LR(n,e){return[n]}function Zm(n,e,t,r){let i=[],o=wt();for(let s=0,a=t.length;s<a;++s){let l=t[s];o=cc(n,e,l[0],r),i.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=l[l.length-1]}return i}var Ym=class n extends Rn{constructor(e,t,r){super(),r!==void 0&&t===void 0?this.setFlatCoordinates(r,e):(t=t||0,this.setCenterAndRadius(e,t,r))}clone(){let e=new n(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){let o=this.flatCoordinates,s=e-o[0],a=t-o[1],l=s*s+a*a;if(l<i){if(l===0)for(let c=0;c<this.stride;++c)r[c]=o[c];else{let c=this.getRadius()/Math.sqrt(l);r[0]=o[0]+c*s,r[1]=o[1]+c*a;for(let u=2;u<this.stride;++u)r[u]=o[u]}return r.length=this.stride,l}return i}containsXY(e,t){let r=this.flatCoordinates,i=e-r[0],o=t-r[1];return i*i+o*o<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){let t=this.flatCoordinates,r=t[this.stride]-t[0];return Hn(t[0]-r,t[1]-r,t[0]+r,t[1]+r,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){let e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){let t=this.getExtent();if(Le(e,t)){let r=this.getCenter();return e[0]<=r[0]&&e[2]>=r[0]||e[1]<=r[1]&&e[3]>=r[1]?!0:uc(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){let t=this.stride,r=this.flatCoordinates[t]-this.flatCoordinates[0],i=e.slice();i[t]=i[0]+r;for(let o=1;o<t;++o)i[t+o]=e[o];this.setFlatCoordinates(this.layout,i),this.changed()}setCenterAndRadius(e,t,r){this.setLayout(r,e,0),this.flatCoordinates||(this.flatCoordinates=[]);let i=this.flatCoordinates,o=Am(i,0,e,this.stride);i[o++]=i[0]+t;for(let s=1,a=this.stride;s<a;++s)i[o++]=i[s];i.length=o,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){let r=this.getCenter(),i=this.getStride();this.setCenter(_c(r,0,r.length,i,e,t,r)),this.changed()}};Ym.prototype.transform;var kR=Ym;var vE=class n extends Rm{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(ce),this.changeEventsKeys_.length=0}listenGeometriesChange_(){let e=this.geometries_;for(let t=0,r=e.length;t<r;++t)this.changeEventsKeys_.push(te(e[t],H.CHANGE,this.changed,this))}clone(){let e=new n(yE(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<cr(this.getExtent(),e,t))return i;let o=this.geometries_;for(let s=0,a=o.length;s<a;++s)i=o[s].closestPointXY(e,t,r,i);return i}containsXY(e,t){let r=this.geometries_;for(let i=0,o=r.length;i<o;++i)if(r[i].containsXY(e,t))return!0;return!1}computeExtent(e){Wo(e);let t=this.geometries_;for(let r=0,i=t.length;r<i;++r)Ls(e,t[r].getExtent());return e}getGeometries(){return yE(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[],t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;let t=[],r=this.geometries_,i=!1;for(let o=0,s=r.length;o<s;++o){let a=r[o],l=a.getSimplifiedGeometry(e);t.push(l),l!==a&&(i=!0)}return i?new n(t):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){let t=this.geometries_;for(let r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,t){let r=this.geometries_;for(let i=0,o=r.length;i<o;++i)r[i].rotate(e,t);this.changed()}scale(e,t,r){r||(r=Ht(this.getExtent()));let i=this.geometries_;for(let o=0,s=i.length;o<s;++o)i[o].scale(e,t,r);this.changed()}setGeometries(e){this.setGeometriesArray(yE(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){let t=this.geometries_;for(let r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()}translate(e,t){let r=this.geometries_;for(let i=0,o=r.length;i<o;++i)r[i].translate(e,t);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}};function yE(n){return n.map(e=>e.clone())}var is=vE;var _E=class n extends Rn{constructor(e,t,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,t);else if(t!==void 0&&r)this.setFlatCoordinates(t,e),this.ends_=r;else{let i=e,o=[],s=[];for(let l=0,c=i.length;l<c;++l){let u=i[l];mn(o,u.getFlatCoordinates()),s.push(o.length)}let a=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(a,o),this.ends_=s}}appendLineString(e){mn(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){let e=new n(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,r,i){return i<cr(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Md(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Sd(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,t,r,i))}getCoordinateAtM(e,t,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(t=t!==void 0?t:!1,r=r!==void 0?r:!1,hR(this.flatCoordinates,0,this.ends_,this.stride,e,t,r))}getCoordinates(){return Xs(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new vn(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){let e=this.flatCoordinates,t=this.ends_,r=this.layout,i=[],o=0;for(let s=0,a=t.length;s<a;++s){let l=t[s],c=new vn(e.slice(o,l),r);i.push(c),o=l}return i}getLength(){let e=this.ends_,t=0,r=0;for(let i=0,o=e.length;i<o;++i)r+=Ec(this.flatCoordinates,t,e[i],this.stride),t=e[i];return r}getFlatMidpoints(){let e=[],t=this.flatCoordinates,r=0,i=this.ends_,o=this.stride;for(let s=0,a=i.length;s<a;++s){let l=i[s],c=tl(t,r,l,o,.5);mn(e,c),r=l}return e}getSimplifiedGeometryInternal(e){let t=[],r=[];return t.length=Nm(this.flatCoordinates,0,this.ends_,this.stride,e,t,0,r),new n(t,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return uR(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);let r=Ws(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}},oo=_E;var xE=class n extends Rn{constructor(e,t){super(),t&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}appendPoint(e){mn(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){let e=new n(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,r,i){if(i<cr(this.getExtent(),e,t))return i;let o=this.flatCoordinates,s=this.stride;for(let a=0,l=o.length;a<l;a+=s){let c=ur(e,t,o[a],o[a+1]);if(c<i){i=c;for(let u=0;u<s;++u)r[u]=o[a+u];r.length=s}}return i}getCoordinates(){return Yr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){let t=this.flatCoordinates.length/this.stride;return e<0||t<=e?null:new dn(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){let e=this.flatCoordinates,t=this.layout,r=this.stride,i=[];for(let o=0,s=e.length;o<s;o+=r){let a=new dn(e.slice(o,o+r),t);i.push(a)}return i}getType(){return"MultiPoint"}intersectsExtent(e){let t=this.flatCoordinates,r=this.stride;for(let i=0,o=t.length;i<o;i+=r){let s=t[i],a=t[i+1];if(md(e,s,a))return!0}return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Qa(this.flatCoordinates,0,e,this.stride),this.changed()}},Ri=xE;var EE=class n extends Rn{constructor(e,t,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){let i=e,o=[],s=[];for(let a=0,l=i.length;a<l;++a){let c=i[a],u=o.length,d=c.getEnds();for(let f=0,h=d.length;f<h;++f)d[f]+=u;mn(o,c.getFlatCoordinates()),s.push(d)}t=i.length===0?this.getLayout():i[0].getLayout(),e=o,r=s}t!==void 0&&r?(this.setFlatCoordinates(t,e),this.endss_=r):this.setCoordinates(e,t)}appendPolygon(e){let t;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),t=e.getEnds().slice(),this.endss_.push();else{let r=this.flatCoordinates.length;mn(this.flatCoordinates,e.getFlatCoordinates()),t=e.getEnds().slice();for(let i=0,o=t.length;i<o;++i)t[i]+=r}this.endss_.push(t),this.changed()}clone(){let e=this.endss_.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=this.endss_[i].slice();let r=new n(this.flatCoordinates.slice(),this.layout,t);return r.applyProperties(this),r}closestPointXY(e,t,r,i){return i<cr(this.getExtent(),e,t)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(oR(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),sR(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,t,r,i))}containsXY(e,t){return cR(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,t)}getArea(){return rR(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),Od(t,0,this.endss_,this.stride,e)):t=this.flatCoordinates,Id(t,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){let e=Zm(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Om(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Ri(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){let e=this.flatCoordinates;Lm(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Od(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){let t=[],r=[];return t.length=aR(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),t,0,r),new n(t,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let t;if(e===0)t=0;else{let o=this.endss_[e-1];t=o[o.length-1]}let r=this.endss_[e].slice(),i=r[r.length-1];if(t!==0)for(let o=0,s=r.length;o<s;++o)r[o]-=t;return new An(this.flatCoordinates.slice(t,i),this.layout,r)}getPolygons(){let e=this.layout,t=this.flatCoordinates,r=this.endss_,i=[],o=0;for(let s=0,a=r.length;s<a;++s){let l=r[s].slice(),c=l[l.length-1];if(o!==0)for(let d=0,f=l.length;d<f;++d)l[d]-=o;let u=new An(t.slice(o,c),e,l);i.push(u),o=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return dR(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,3),this.flatCoordinates||(this.flatCoordinates=[]);let r=Pm(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{let i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}},so=EE;var jR=qt(),Ud=class n{constructor(e,t,r,i,o,s){this.styleFunction,this.extent_,this.id_=s,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=o,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?pm(this.flatCoordinates_):cc(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){let e=Ht(this.getExtent());this.flatInteriorPoints_=Ad(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){let e=km(this.flatCoordinates_,this.ends_),t=Zm(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=Om(this.flatCoordinates_,0,e,2,t)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=tl(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];let e=this.flatCoordinates_,t=0,r=this.ends_;for(let i=0,o=r.length;i<o;++i){let s=r[i],a=tl(e,t,s,2,.5);mn(this.flatMidpoints_,a),t=s}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ne(e);let t=e.getExtent(),r=e.getWorldExtent();if(t&&r){let i=et(r)/et(t);yn(jR,r[0],r[3],i,-i,0,0,0),dr(this.flatCoordinates_,0,this.flatCoordinates_.length,2,jR,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new n(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=cm((e,t)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),t&&this.simplifiedGeometry_.applyTransform(t);let r=this.simplifiedGeometry_.getFlatCoordinates(),i;switch(this.type_){case"LineString":r.length=el(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=Nm(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=Dd(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break;default:}return i&&(this.simplifiedGeometry_=new n(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}};Ud.prototype.getFlatCoordinates=Ud.prototype.getOrientedFlatCoordinates;var fn=Ud;function Km(n,e,t=0,r=n.length-1,i=cU){for(;r>t;){if(r-t>600){let l=r-t+1,c=e-t+1,u=Math.log(l),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(l-d)/l)*(c-l/2<0?-1:1),h=Math.max(t,Math.floor(e-c*d/l+f)),p=Math.min(r,Math.floor(e+(l-c)*d/l+f));Km(n,e,h,p,i)}let o=n[e],s=t,a=r;for(zd(n,t,e),i(n[r],o)>0&&zd(n,t,r);s<a;){for(zd(n,s,a),s++,a--;i(n[s],o)<0;)s++;for(;i(n[a],o)>0;)a--}i(n[t],o)===0?zd(n,t,a):(a++,zd(n,a,r)),a<=e&&(t=a+1),e<=a&&(r=a-1)}}function zd(n,e,t){let r=n[e];n[e]=n[t],n[t]=r}function cU(n,e){return n<e?-1:n>e?1:0}var Rc=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data,r=[];if(!Qm(e,t))return r;let i=this.toBBox,o=[];for(;t;){for(let s=0;s<t.children.length;s++){let a=t.children[s],l=t.leaf?i(a):a;Qm(e,l)&&(t.leaf?r.push(a):CE(e,l)?this._all(a,r):o.push(a))}t=o.pop()}return r}collides(e){let t=this.data;if(!Qm(e,t))return!1;let r=[];for(;t;){for(let i=0;i<t.children.length;i++){let o=t.children[i],s=t.leaf?this.toBBox(o):o;if(Qm(e,s)){if(t.leaf||CE(e,s))return!0;r.push(o)}}t=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){let r=this.data;this.data=t,t=r}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Dc([]),this}remove(e,t){if(!e)return this;let r=this.data,i=this.toBBox(e),o=[],s=[],a,l,c;for(;r||o.length;){if(r||(r=o.pop(),l=o[o.length-1],a=s.pop(),c=!0),r.leaf){let u=uU(e,r.children,t);if(u!==-1)return r.children.splice(u,1),o.push(r),this._condense(o),this}!c&&!r.leaf&&CE(r,i)?(o.push(r),s.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){let r=[];for(;e;)e.leaf?t.push(...e.children):r.push(...e.children),e=r.pop();return t}_build(e,t,r,i){let o=r-t+1,s=this._maxEntries,a;if(o<=s)return a=Dc(e.slice(t,r+1)),Ic(a,this.toBBox),a;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),a=Dc([]),a.leaf=!1,a.height=i;let l=Math.ceil(o/s),c=l*Math.ceil(Math.sqrt(s));VR(e,t,r,c,this.compareMinX);for(let u=t;u<=r;u+=c){let d=Math.min(u+c-1,r);VR(e,u,d,l,this.compareMinY);for(let f=u;f<=d;f+=l){let h=Math.min(f+l-1,d);a.children.push(this._build(e,f,h,i-1))}}return Ic(a,this.toBBox),a}_chooseSubtree(e,t,r,i){for(;i.push(t),!(t.leaf||i.length-1===r);){let o=1/0,s=1/0,a;for(let l=0;l<t.children.length;l++){let c=t.children[l],u=wE(c),d=hU(e,c)-u;d<s?(s=d,o=u<o?u:o,a=c):d===s&&u<o&&(o=u,a=c)}t=a||t.children[0]}return t}_insert(e,t,r){let i=r?e:this.toBBox(e),o=[],s=this._chooseSubtree(i,this.data,t,o);for(s.children.push(e),Hd(s,i);t>=0&&o[t].children.length>this._maxEntries;)this._split(o,t),t--;this._adjustParentBBoxes(i,o,t)}_split(e,t){let r=e[t],i=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,i);let s=this._chooseSplitIndex(r,o,i),a=Dc(r.children.splice(s,r.children.length-s));a.height=r.height,a.leaf=r.leaf,Ic(r,this.toBBox),Ic(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,t){this.data=Dc([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Ic(this.data,this.toBBox)}_chooseSplitIndex(e,t,r){let i,o=1/0,s=1/0;for(let a=t;a<=r-t;a++){let l=$d(e,0,a,this.toBBox),c=$d(e,a,r,this.toBBox),u=pU(l,c),d=wE(l)+wE(c);u<o?(o=u,i=a,s=d<s?d:s):u===o&&d<s&&(s=d,i=a)}return i||r-t}_chooseSplitAxis(e,t,r){let i=e.leaf?this.compareMinX:dU,o=e.leaf?this.compareMinY:fU,s=this._allDistMargin(e,t,r,i),a=this._allDistMargin(e,t,r,o);s<a&&e.children.sort(i)}_allDistMargin(e,t,r,i){e.children.sort(i);let o=this.toBBox,s=$d(e,0,t,o),a=$d(e,r-t,r,o),l=Jm(s)+Jm(a);for(let c=t;c<r-t;c++){let u=e.children[c];Hd(s,e.leaf?o(u):u),l+=Jm(s)}for(let c=r-t-1;c>=t;c--){let u=e.children[c];Hd(a,e.leaf?o(u):u),l+=Jm(a)}return l}_adjustParentBBoxes(e,t,r){for(let i=r;i>=0;i--)Hd(t[i],e)}_condense(e){for(let t=e.length-1,r;t>=0;t--)e[t].children.length===0?t>0?(r=e[t-1].children,r.splice(r.indexOf(e[t]),1)):this.clear():Ic(e[t],this.toBBox)}};function uU(n,e,t){if(!t)return e.indexOf(n);for(let r=0;r<e.length;r++)if(t(n,e[r]))return r;return-1}function Ic(n,e){$d(n,0,n.children.length,e,n)}function $d(n,e,t,r,i){i||(i=Dc(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o=e;o<t;o++){let s=n.children[o];Hd(i,n.leaf?r(s):s)}return i}function Hd(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function dU(n,e){return n.minX-e.minX}function fU(n,e){return n.minY-e.minY}function wE(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function Jm(n){return n.maxX-n.minX+(n.maxY-n.minY)}function hU(n,e){return(Math.max(e.maxX,n.maxX)-Math.min(e.minX,n.minX))*(Math.max(e.maxY,n.maxY)-Math.min(e.minY,n.minY))}function pU(n,e){let t=Math.max(n.minX,e.minX),r=Math.max(n.minY,e.minY),i=Math.min(n.maxX,e.maxX),o=Math.min(n.maxY,e.maxY);return Math.max(0,i-t)*Math.max(0,o-r)}function CE(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function Qm(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Dc(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function VR(n,e,t,r,i){let o=[e,t];for(;o.length;){if(t=o.pop(),e=o.pop(),t-e<=r)continue;let s=e+Math.ceil((t-e)/r/2)*r;Km(n,s,e,t,i),o.push(e,s,s,t)}}var bE=class{constructor(e){this.rbush_=new Rc(e),this.items_={}}insert(e,t){let r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:t};this.rbush_.insert(r),this.items_[X(t)]=r}load(e,t){let r=new Array(t.length);for(let i=0,o=t.length;i<o;i++){let s=e[i],a=t[i],l={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:a};r[i]=l,this.items_[X(a)]=l}this.rbush_.load(r)}remove(e){let t=X(e),r=this.items_[t];return delete this.items_[t],this.rbush_.remove(r)!==null}update(e,t){let r=this.items_[X(t)],i=[r.minX,r.minY,r.maxX,r.maxY];Ti(i,e)||(this.remove(t),this.insert(e,t))}getAll(){return this.rbush_.all().map(function(t){return t.value})}getInExtent(e){let t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(t).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,t){return this.forEach_(this.getInExtent(e),t)}forEach_(e,t){let r;for(let i=0,o=e.length;i<o;i++)if(r=t(e[i]),r)return r;return r}isEmpty(){return zn(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){let t=this.rbush_.toJSON();return Hn(t.minX,t.minY,t.maxX,t.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(let t in e.items_)this.items_[t]=e.items_[t]}},ME=bE;var TE=class extends At{constructor(e){super(),this.projection=ne(e.projection),this.attributions_=BR(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;let t=this;this.viewPromise_=new Promise(function(r,i){t.viewResolver=r,t.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=BR(e),this.changed()}setState(e){this.state_=e,this.changed()}};function BR(n){return n?typeof n=="function"?n:(Array.isArray(n)||(n=[n]),e=>n):null}var eg=TE;var Sr={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};var ao=class extends Ut{constructor(e,t,r){super(e),this.feature=t,this.features=r}},SE=class extends eg{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=qo,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(se(this.format_,"`format` must be set when `url` is set"),this.loader_=gE(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:FR;let t=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=t?new ME:null,this.loadedExtentsRtree_=new ME,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!t&&r===void 0&&(r=new $n(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){let t=X(e);if(!this.addToIndex_(t,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(t,e);let r=e.getGeometry();if(r){let i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new ao(Sr.ADDFEATURE,e))}setupChangeEvents_(e,t){t instanceof fn||(this.featureChangeKeys_[e]=[te(t,H.CHANGE,this.handleFeatureChange_,this),te(t,wi.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,t){let r=!0;if(t.getId()!==void 0){let i=String(t.getId());if(!(i in this.idIndex_))this.idIndex_[i]=t;else if(t instanceof fn){let o=this.idIndex_[i];o instanceof fn?Array.isArray(o)?o.push(t):this.idIndex_[i]=[o,t]:r=!1}else r=!1}return r&&(se(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=t),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){let t=[],r=[],i=[];for(let o=0,s=e.length;o<s;o++){let a=e[o],l=X(a);this.addToIndex_(l,a)&&r.push(a)}for(let o=0,s=r.length;o<s;o++){let a=r[o],l=X(a);this.setupChangeEvents_(l,a);let c=a.getGeometry();if(c){let u=c.getExtent();t.push(u),i.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(t,i),this.hasListener(Sr.ADDFEATURE))for(let o=0,s=r.length;o<s;o++)this.dispatchEvent(new ao(Sr.ADDFEATURE,r[o]))}bindFeaturesCollection_(e){let t=!1;this.addEventListener(Sr.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(Sr.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(cn.ADD,r=>{t||(t=!0,this.addFeature(r.element),t=!1)}),e.addEventListener(cn.REMOVE,r=>{t||(t=!0,this.removeFeature(r.element),t=!1)}),this.featuresCollection_=e}clear(e){if(e){for(let r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(ce);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(let r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};let t=new ao(Sr.CLEAR);this.dispatchEvent(t),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,t){let r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){let o=i.getGeometry();if(o instanceof fn||o.intersectsCoordinate(e))return t(i)})}forEachFeatureInExtent(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureIntersectingExtent(e,t){return this.forEachFeatureInExtent(e,function(r){let i=r.getGeometry();if(i instanceof fn||i.intersectsExtent(e)){let o=t(r);if(o)return o}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),zn(this.nullGeometryFeatures_)||mn(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){let t=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){t.push(r)}),t}getFeaturesInExtent(e,t){if(this.featuresRtree_){if(!(t&&t.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);let i=dc(e,t);return[].concat(...i.map(o=>this.featuresRtree_.getInExtent(o)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,t){let r=e[0],i=e[1],o=null,s=[NaN,NaN],a=1/0,l=[-1/0,-1/0,1/0,1/0];return t=t||Ci,this.featuresRtree_.forEachInExtent(l,function(c){if(t(c)){let u=c.getGeometry(),d=a;if(a=u instanceof fn?0:u.closestPointXY(r,i,s,a),a<d){o=c;let f=Math.sqrt(a);l[0]=r-f,l[1]=i-f,l[2]=r+f,l[3]=i+f}}}),o}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){let t=this.idIndex_[e.toString()];return t!==void 0?t:null}getFeatureByUid(e){let t=this.uidIndex_[e];return t!==void 0?t:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){let t=e.target,r=X(t),i=t.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);else{let s=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(s,t)):this.featuresRtree_&&this.featuresRtree_.update(s,t)}let o=t.getId();if(o!==void 0){let s=o.toString();this.idIndex_[s]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[s]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new ao(Sr.CHANGEFEATURE,t))}hasFeature(e){let t=e.getId();return t!==void 0?t in this.idIndex_:X(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&zn(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,t,r){let i=this.loadedExtentsRtree_,o=this.strategy_(e,t,r);for(let s=0,a=o.length;s<a;++s){let l=o[s];i.forEachInExtent(l,function(u){return Mi(u.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new ao(Sr.FEATURESLOADSTART)),this.loader_.call(this,l,t,r,u=>{--this.loadingExtentsCount_,this.dispatchEvent(new ao(Sr.FEATURESLOADEND,void 0,u))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new ao(Sr.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){let t=this.loadedExtentsRtree_,r=t.forEachInExtent(e,function(i){if(Ti(i.extent,e))return i});r&&t.remove(r)}removeFeatures(e){let t=!1;for(let r=0,i=e.length;r<i;++r)t=this.removeFeatureInternal(e[r])||t;t&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){let t=X(e);if(!(t in this.uidIndex_))return!1;t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[t]?.forEach(ce),delete this.featureChangeKeys_[t];let i=e.getId();if(i!==void 0){let o=i.toString(),s=this.idIndex_[o];s===e?delete this.idIndex_[o]:Array.isArray(s)&&(s.splice(s.indexOf(e),1),s.length===1&&(this.idIndex_[o]=s[0]))}return delete this.uidIndex_[t],this.hasListener(Sr.REMOVEFEATURE)&&this.dispatchEvent(new ao(Sr.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(let t in this.idIndex_)if(this.idIndex_[t]===e){delete this.idIndex_[t];break}}setLoader(e){this.loader_=e}setUrl(e){se(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(gE(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}},Ir=SE;var IE=class n{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){let e=this.getColor();return new n({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){let t=Mc(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===re.IDLE&&t.load(),t.getImageState()===re.LOADING&&(this.patternImage_=t)}this.color_=e}getKey(){let e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?X(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Di(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}},Wt=IE;var DE=class n{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){let e=this.getColor();return new n({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}},tn=DE;function RE(n){return n[0]>0&&n[1]>0}function GR(n,e,t){return t===void 0&&(t=[0,0]),t[0]=n[0]*e+.5|0,t[1]=n[1]*e+.5|0,t}function Ge(n,e){return Array.isArray(n)?n:(e===void 0?e=[n,n]:(e[0]=n,e[1]=n),e)}var AE=class n{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ge(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){let e=this.getScale();return new n({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return W()}getImage(e){return W()}getHitDetectionImage(){return W()}getPixelRatio(e){return 1}getImageState(){return W()}getImageSize(){return W()}getOrigin(){return W()}getSize(){return W()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ge(e)}listenImageChange(e){W()}load(){W()}unlistenImageChange(e){W()}ready(){return Promise.resolve()}},tg=AE;var PE=class n extends tg{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?re.LOADING:re.LOADED,this.imageState_===re.LOADING&&this.ready().then(()=>this.imageState_=re.LOADED),this.render()}clone(){let e=this.getScale(),t=new n({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){let e=this.size_,t=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-t[0]/r[0],e[1]/2+t[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){let t=this.fill_?.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${t}`+Object.values(this.renderOptions_).join(","),i=Pn.get(r,null,null)?.getImage(1);if(!i){let o=this.renderOptions_,s=Math.ceil(o.size*e),a=be(s,s);this.draw_(o,a,e),i=a.canvas,Pn.set(r,null,null,new MR(i,void 0,null,re.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,r){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let i=this.radius,o=this.radius2_===void 0?i:this.radius2_;if(i<o){let w=i;i=o,o=w}let s=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/s,l=o*Math.sin(a),c=Math.sqrt(o*o-l*l),u=i-c,d=Math.sqrt(l*l+u*u),f=d/l;if(e==="miter"&&f<=r)return f*t;let h=t/2/f,p=t/2*(u/d),g=Math.sqrt((i+h)*(i+h)+p*p)-i;if(this.radius2_===void 0||e==="bevel")return g*2;let y=i*Math.sin(a),v=Math.sqrt(i*i-y*y),x=o-v,_=Math.sqrt(y*y+x*x)/y;if(_<=r){let w=_*t/2-o-i;return 2*Math.max(g,w)}return g*2}createRenderOptions(){let e=ro,t=io,r=0,i=null,o=0,s,a=0;this.stroke_&&(s=fr(this.stroke_.getColor()??ts),a=this.stroke_.getWidth()??rs,i=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??io,e=this.stroke_.getLineCap()??ro,r=this.stroke_.getMiterLimit()??es);let l=this.calculateLineJoinSize_(t,a,r),c=Math.max(this.radius,this.radius2_||0),u=Math.ceil(2*c+l);return{strokeStyle:s,strokeWidth:a,size:u,lineCap:e,lineDash:i,lineDashOffset:o,lineJoin:t,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();let e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,r){if(t.scale(r,r),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let i=this.fill_.getColor();i===null&&(i=en),t.fillStyle=fr(i),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Di(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(t=be(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_,r=this.radius;if(t===1/0)e.arc(0,0,r,0,2*Math.PI);else{let i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(t*=2);let o=this.angle_-Math.PI/2,s=2*Math.PI/t;for(let a=0;a<t;a++){let l=o+a*s,c=a%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=en,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}},ng=PE;var NE=class n extends ng{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){let e=this.getScale(),t=new n({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius=e,this.render()}},lo=NE;var Qs=class n{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=UR,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new n({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=UR,this.geometry_=e}setZIndex(e){this.zIndex_=e}};function zR(n){let e;if(typeof n=="function")e=n;else{let t;Array.isArray(n)?t=n:(se(typeof n.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[n]),e=function(){return t}}return e}var OE=null;function FE(n,e){if(!OE){let t=new Wt({color:"rgba(255,255,255,0.4)"}),r=new tn({color:"#3399CC",width:1.25});OE=[new Qs({image:new lo({fill:t,stroke:r,radius:5}),fill:t,stroke:r})]}return OE}function $R(){let n={},e=[255,255,255,1],t=[0,153,255,1],r=3;return n.Polygon=[new Qs({fill:new Wt({color:[255,255,255,.5]})})],n.MultiPolygon=n.Polygon,n.LineString=[new Qs({stroke:new tn({color:e,width:r+2})}),new Qs({stroke:new tn({color:t,width:r})})],n.MultiLineString=n.LineString,n.Circle=n.Polygon.concat(n.LineString),n.Point=[new Qs({image:new lo({radius:r*2,fill:new Wt({color:t}),stroke:new tn({color:e,width:r/2})}),zIndex:1/0})],n.MultiPoint=n.Point,n.GeometryCollection=n.Polygon.concat(n.LineString,n.Point),n}function UR(n){return n.getGeometry()}var Xt=Qs;var mU="#333",LE=class n{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Ge(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Wt({color:mU}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){let e=this.getScale();return new n({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ge(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}},ea=LE;var lt={ANIMATING:0,INTERACTING:1};var qd={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Wd=[qd.FILL],co=[qd.STROKE],os=[qd.BEGIN_PATH],kE=[qd.CLOSE_PATH],K=qd;var jE=class extends Hm{constructor(e,t,r,i){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){let t=this.pixelRatio;return t==1?e:e.map(function(r){return r*t})}appendFlatPointCoordinates(e,t){let r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,o=this.coordinates,s=o.length;for(let a=0,l=e.length;a<l;a+=t)i[0]=e[a],i[1]=e[a+1],bi(r,i)&&(o[s++]=i[0],o[s++]=i[1]);return s}appendFlatLineCoordinates(e,t,r,i,o,s){let a=this.coordinates,l=a.length,c=this.getBufferedMaxExtent();s&&(t+=i);let u=e[t],d=e[t+1],f=this.tmpCoordinate_,h=!0,p,m,g;for(p=t+i;p<r;p+=i)f[0]=e[p],f[1]=e[p+1],g=fm(c,f),g!==m?(h&&(a[l++]=u,a[l++]=d,h=!1),a[l++]=f[0],a[l++]=f[1]):g===$t.INTERSECTING?(a[l++]=f[0],a[l++]=f[1],h=!1):h=!0,u=f[0],d=f[1],m=g;return(o&&h||p===t+i)&&(a[l++]=u,a[l++]=d),l}drawCustomCoordinates_(e,t,r,i,o){for(let s=0,a=r.length;s<a;++s){let l=r[s],c=this.appendFlatLineCoordinates(e,t,l,i,!1,!1);o.push(c),t=l}return t}drawCustom(e,t,r,i,o){this.beginGeometry(e,t,o);let s=e.getType(),a=e.getStride(),l=this.coordinates.length,c,u,d,f,h;switch(s){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),f=[];let p=e.getEndss();h=0;for(let m=0,g=p.length;m<g;++m){let y=[];h=this.drawCustomCoordinates_(c,h,p[m],a,y),f.push(y)}this.instructions.push([K.CUSTOM,l,f,e,r,Id,o]),this.hitDetectionInstructions.push([K.CUSTOM,l,f,e,i||r,Id,o]);break;case"Polygon":case"MultiLineString":d=[],c=s=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),h=this.drawCustomCoordinates_(c,0,e.getEnds(),a,d),this.instructions.push([K.CUSTOM,l,d,e,r,Xs,o]),this.hitDetectionInstructions.push([K.CUSTOM,l,d,e,i||r,Xs,o]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),u=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([K.CUSTOM,l,u,e,r,Yr,o]),this.hitDetectionInstructions.push([K.CUSTOM,l,u,e,i||r,Yr,o]);break;case"MultiPoint":c=e.getFlatCoordinates(),u=this.appendFlatPointCoordinates(c,a),u>l&&(this.instructions.push([K.CUSTOM,l,u,e,r,Yr,o]),this.hitDetectionInstructions.push([K.CUSTOM,l,u,e,i||r,Yr,o]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),u=this.coordinates.length,this.instructions.push([K.CUSTOM,l,u,e,r,void 0,o]),this.hitDetectionInstructions.push([K.CUSTOM,l,u,e,i||r,void 0,o]);break;default:}this.endGeometry(t)}beginGeometry(e,t,r){this.beginGeometryInstruction1_=[K.BEGIN_GEOMETRY,t,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[K.BEGIN_GEOMETRY,t,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){let e=this.hitDetectionInstructions;e.reverse();let t,r=e.length,i,o,s=-1;for(t=0;t<r;++t)i=e[t],o=i[0],o==K.END_GEOMETRY?s=t:o==K.BEGIN_GEOMETRY&&(i[2]=t,vD(this.hitDetectionInstructions,s,t),s=-1)}fillStyleToState(e,t={}){if(e){let r=e.getColor();t.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,t.fillStyle=fr(r||en)}else t.fillStyle=void 0;return t}strokeStyleToState(e,t={}){if(e){let r=e.getColor();t.strokeStyle=fr(r||ts);let i=e.getLineCap();t.lineCap=i!==void 0?i:ro;let o=e.getLineDash();t.lineDash=o?o.slice():hr;let s=e.getLineDashOffset();t.lineDashOffset=s||pr;let a=e.getLineJoin();t.lineJoin=a!==void 0?a:io;let l=e.getWidth();t.lineWidth=l!==void 0?l:rs;let c=e.getMiterLimit();t.miterLimit=c!==void 0?c:es,t.lineWidth>this.maxLineWidth&&(this.maxLineWidth=t.lineWidth,this.bufferedMaxExtent_=null)}else t.strokeStyle=void 0,t.lineCap=void 0,t.lineDash=null,t.lineDashOffset=void 0,t.lineJoin=void 0,t.lineWidth=void 0,t.miterLimit=void 0;return t}setFillStrokeStyle(e,t){let r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(t,r)}createFill(e){let t=e.fillStyle,r=[K.SET_FILL_STYLE,t];return typeof t!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[K.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){let r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(r!==void 0&&this.instructions.push(t.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,t){let r=e.strokeStyle,i=e.lineCap,o=e.lineDash,s=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||o!=e.currentLineDash&&!Dn(e.currentLineDash,o)||e.currentLineDashOffset!=s||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(r!==void 0&&t.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=o,e.currentLineDashOffset=s,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;let t=[K.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=hm(this.maxExtent),this.maxLineWidth>0)){let e=this.resolution*(this.maxLineWidth+1)/2;Tr(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},uo=jE;var VE=class extends uo{constructor(e,t,r,i){super(e,t,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,r){if(!this.image_||this.maxExtent&&!bi(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,r);let i=e.getFlatCoordinates(),o=e.getStride(),s=this.coordinates.length,a=this.appendFlatPointCoordinates(i,o);this.instructions.push([K.DRAW_IMAGE,s,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([K.DRAW_IMAGE,s,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,r){if(!this.image_)return;this.beginGeometry(e,t,r);let i=e.getFlatCoordinates(),o=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||bi(this.maxExtent,i.slice(l,l+2)))&&o.push(i[l],i[l+1]);let s=this.coordinates.length,a=this.appendFlatPointCoordinates(o,2);this.instructions.push([K.DRAW_IMAGE,s,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([K.DRAW_IMAGE,s,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){let r=e.getAnchor(),i=e.getSize(),o=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=o[0],this.originY_=o[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}},HR=VE;var BE=class extends uo{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinates_(e,t,r,i){let o=this.coordinates.length,s=this.appendFlatLineCoordinates(e,t,r,i,!1,!1),a=[K.MOVE_TO_LINE_TO,o,s];return this.instructions.push(a),this.hitDetectionInstructions.push(a),r}drawLineString(e,t,r){let i=this.state,o=i.strokeStyle,s=i.lineWidth;if(o===void 0||s===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([K.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,hr,pr],os);let a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(co),this.endGeometry(t)}drawMultiLineString(e,t,r){let i=this.state,o=i.strokeStyle,s=i.lineWidth;if(o===void 0||s===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,t,r),this.hitDetectionInstructions.push([K.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,hr,pr],os);let a=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride(),u=0;for(let d=0,f=a.length;d<f;++d)u=this.drawFlatCoordinates_(l,u,a[d],c);this.hitDetectionInstructions.push(co),this.endGeometry(t)}finish(){let e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(co),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(co),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(os)}},qR=BE;var GE=class extends uo{constructor(e,t,r,i){super(e,t,r,i)}drawFlatCoordinatess_(e,t,r,i){let o=this.state,s=o.fillStyle!==void 0,a=o.strokeStyle!==void 0,l=r.length;this.instructions.push(os),this.hitDetectionInstructions.push(os);for(let c=0;c<l;++c){let u=r[c],d=this.coordinates.length,f=this.appendFlatLineCoordinates(e,t,u,i,!0,!a),h=[K.MOVE_TO_LINE_TO,d,f];this.instructions.push(h),this.hitDetectionInstructions.push(h),a&&(this.instructions.push(kE),this.hitDetectionInstructions.push(kE)),t=u}return s&&(this.instructions.push(Wd),this.hitDetectionInstructions.push(Wd)),a&&(this.instructions.push(co),this.hitDetectionInstructions.push(co)),t}drawCircle(e,t,r){let i=this.state,o=i.fillStyle,s=i.strokeStyle;if(o===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([K.SET_FILL_STYLE,en]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([K.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,hr,pr]);let a=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);let u=[K.CIRCLE,c];this.instructions.push(os,u),this.hitDetectionInstructions.push(os,u),i.fillStyle!==void 0&&(this.instructions.push(Wd),this.hitDetectionInstructions.push(Wd)),i.strokeStyle!==void 0&&(this.instructions.push(co),this.hitDetectionInstructions.push(co)),this.endGeometry(t)}drawPolygon(e,t,r){let i=this.state,o=i.fillStyle,s=i.strokeStyle;if(o===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([K.SET_FILL_STYLE,en]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([K.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,hr,pr]);let a=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(t)}drawMultiPolygon(e,t,r){let i=this.state,o=i.fillStyle,s=i.strokeStyle;if(o===void 0&&s===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([K.SET_FILL_STYLE,en]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([K.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,hr,pr]);let a=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride(),u=0;for(let d=0,f=a.length;d<f;++d)u=this.drawFlatCoordinatess_(l,u,a[d],c);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;let e=this.tolerance;if(e!==0){let t=this.coordinates;for(let r=0,i=t.length;r<i;++r)t[r]=Zs(t[r],e)}return super.finish()}setFillStrokeStyles_(){let e=this.state;e.fillStyle!==void 0&&this.updateFillStyle(e,this.createFill),e.strokeStyle!==void 0&&this.updateStrokeStyle(e,this.applyStroke)}},UE=GE;function WR(n,e,t,r,i){let o=[],s=t,a=0,l=e.slice(t,2);for(;a<n&&s+i<r;){let[c,u]=l.slice(-2),d=e[s+i],f=e[s+i+1],h=Math.sqrt((d-c)*(d-c)+(f-u)*(f-u));if(a+=h,a>=n){let p=(n-a+h)/h,m=gn(c,d,p),g=gn(u,f,p);l.push(m,g),o.push(l),l=[m,g],a==n&&(s+=i),a=0}else if(a<n)l.push(e[s+i],e[s+i+1]),s+=i;else{let p=h-a,m=gn(c,d,p/h),g=gn(u,f,p/h);l.push(m,g),o.push(l),l=[m,g],a=0,s+=i}}return a>0&&o.push(l),o}function XR(n,e,t,r,i){let o=t,s=t,a=0,l=0,c=t,u,d,f,h,p,m,g,y,v,x;for(d=t;d<r;d+=i){let E=e[d],_=e[d+1];p!==void 0&&(v=E-p,x=_-m,h=Math.sqrt(v*v+x*x),g!==void 0&&(l+=f,u=Math.acos((g*v+y*x)/(f*h)),u>n&&(l>a&&(a=l,o=c,s=d),l=0,c=d-i)),f=h,g=v,y=x),p=E,m=_}return l+=h,l>a?[c,d]:[o,s]}var Xd={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},zE=class extends uo{constructor(e,t,r,i){super(e,t,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[en]={fillStyle:en},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){let e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,r){let i=this.textFillState_,o=this.textStrokeState_,s=this.textState_;if(this.text_===""||!s||!i&&!o)return;let a=this.coordinates,l=a.length,c=e.getType(),u=null,d=e.getStride();if(s.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!Le(this.maxExtent,e.getExtent()))return;let f;if(u=e.getFlatCoordinates(),c=="LineString")f=[u.length];else if(c=="MultiLineString")f=e.getEnds();else if(c=="Polygon")f=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){let g=e.getEndss();f=[];for(let y=0,v=g.length;y<v;++y)f.push(g[y][0])}this.beginGeometry(e,t,r);let h=s.repeat,p=h?void 0:s.textAlign,m=0;for(let g=0,y=f.length;g<y;++g){let v;h?v=WR(h*this.resolution,u,m,f[g],d):v=[u.slice(m,f[g])];for(let x=0,E=v.length;x<E;++x){let _=v[x],w=0,b=_.length;if(p==null){let S=XR(s.maxAngle,_,0,_.length,2);w=S[0],b=S[1]}for(let S=w;S<b;S+=d)a.push(_[S],_[S+1]);let M=a.length;m=f[g],this.drawChars_(l,M),l=M}}this.endGeometry(t)}else{let f=s.overflow?null:[];switch(c){case"Point":case"MultiPoint":u=e.getFlatCoordinates();break;case"LineString":u=e.getFlatMidpoint();break;case"Circle":u=e.getCenter();break;case"MultiLineString":u=e.getFlatMidpoints(),d=2;break;case"Polygon":u=e.getFlatInteriorPoint(),s.overflow||f.push(u[2]/this.resolution),d=3;break;case"MultiPolygon":let E=e.getFlatInteriorPoints();u=[];for(let _=0,w=E.length;_<w;_+=3)s.overflow||f.push(E[_+2]/this.resolution),u.push(E[_],E[_+1]);if(u.length===0)return;d=2;break;default:}let h=this.appendFlatPointCoordinates(u,d);if(h===l)return;if(f&&(h-l)/2!==u.length/d){let E=l/2;f=f.filter((_,w)=>{let b=a[(E+w)*2]===u[w*d]&&a[(E+w)*2+1]===u[w*d+1];return b||--E,b})}this.saveTextStates_();let p=s.backgroundFill?this.createFill(this.fillStyleToState(s.backgroundFill)):null,m=s.backgroundStroke?this.createStroke(this.strokeStyleToState(s.backgroundStroke)):null;this.beginGeometry(e,t,r);let g=s.padding;if(g!=ns&&(s.scale[0]<0||s.scale[1]<0)){let E=s.padding[0],_=s.padding[1],w=s.padding[2],b=s.padding[3];s.scale[0]<0&&(_=-_,b=-b),s.scale[1]<0&&(E=-E,w=-w),g=[E,_,w,b]}let y=this.pixelRatio;this.instructions.push([K.DRAW_IMAGE,l,h,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,g==ns?ns:g.map(function(E){return E*y}),p,m,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);let v=1/y,x=p?p.slice(0):null;x&&(x[1]=en),this.hitDetectionInstructions.push([K.DRAW_IMAGE,l,h,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[v,v],NaN,this.declutterMode_,this.declutterImageWithText_,g,x,m,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?en:this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),this.endGeometry(t)}}saveTextStates_(){let e=this.textStrokeState_,t=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));let o=this.textKey_;o in this.textStates||(this.textStates[o]={font:t.font,textAlign:t.textAlign||Js,justify:t.justify,textBaseline:t.textBaseline||rl,scale:t.scale});let s=this.fillKey_;r&&(s in this.fillStates||(this.fillStates[s]={fillStyle:r.fillStyle}))}drawChars_(e,t){let r=this.textStrokeState_,i=this.textState_,o=this.strokeKey_,s=this.textKey_,a=this.fillKey_;this.saveTextStates_();let l=this.pixelRatio,c=Xd[i.textBaseline],u=this.textOffsetY_*l,d=this.text_,f=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([K.DRAW_CHARS,e,t,c,i.overflow,a,i.maxAngle,l,u,o,f*l,d,s,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([K.DRAW_CHARS,e,t,c,i.overflow,a&&en,i.maxAngle,l,u,o,f*l,d,s,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,t){let r,i,o;if(!e)this.text_="";else{let s=e.getFill();s?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=fr(s.getColor()||en)):(i=null,this.textFillState_=i);let a=e.getStroke();if(!a)o=null,this.textStrokeState_=o;else{o=this.textStrokeState_,o||(o={},this.textStrokeState_=o);let m=a.getLineDash(),g=a.getLineDashOffset(),y=a.getWidth(),v=a.getMiterLimit();o.lineCap=a.getLineCap()||ro,o.lineDash=m?m.slice():hr,o.lineDashOffset=g===void 0?pr:g,o.lineJoin=a.getLineJoin()||io,o.lineWidth=y===void 0?rs:y,o.miterLimit=v===void 0?es:v,o.strokeStyle=fr(a.getColor()||ts)}r=this.textState_;let l=e.getFont()||Wm;Xm(l);let c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||rl,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||ns,r.scale=c===void 0?[1,1]:c;let u=e.getOffsetX(),d=e.getOffsetY(),f=e.getRotateWithView(),h=e.getKeepUpright(),p=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=u===void 0?0:u,this.textOffsetY_=d===void 0?0:d,this.textRotateWithView_=f===void 0?!1:f,this.textKeepUpright_=h===void 0?!0:h,this.textRotation_=p===void 0?0:p,this.strokeKey_=o?(typeof o.strokeStyle=="string"?o.strokeStyle:X(o.strokeStyle))+o.lineCap+o.lineDashOffset+"|"+o.lineWidth+o.lineJoin+o.miterLimit+"["+o.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+X(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}},ZR=zE;var gU={Circle:UE,Default:uo,Image:HR,LineString:qR,Polygon:UE,Text:ZR},$E=class{constructor(e,t,r,i){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){let e={};for(let t in this.buildersByZIndex_){e[t]=e[t]||{};let r=this.buildersByZIndex_[t];for(let i in r){let o=r[i].finish();e[t][i]=o}}return e}getBuilder(e,t){let r=e!==void 0?e.toString():"0",i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let o=i[t];if(o===void 0){let s=gU[t];o=new s(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[t]=o}return o}},rg=$E;function YR(n,e,t,r,i,o,s,a,l,c,u,d,f=!0){let h=n[e],p=n[e+1],m=0,g=0,y=0,v=0;function x(){m=h,g=p,e+=r,h=n[e],p=n[e+1],v+=y,y=Math.sqrt((h-m)*(h-m)+(p-g)*(p-g))}do x();while(e<t-r&&v+y<o);let E=y===0?0:(o-v)/y,_=gn(m,h,E),w=gn(g,p,E),b=e-r,M=v,S=o+a*l(c,i,u);for(;e<t-r&&v+y<S;)x();E=y===0?0:(S-v)/y;let C=gn(m,h,E),R=gn(g,p,E),T=!1;if(f)if(d){let V=[_,w,C,R];_c(V,0,4,2,d,V,V),T=V[0]>V[2]}else T=_>C;let I=Math.PI,B=[],j=b+r===e;e=b,y=0,v=M,h=n[e],p=n[e+1];let $;if(j){x(),$=Math.atan2(p-g,h-m),T&&($+=$>0?-I:I);let V=(C+_)/2,q=(R+w)/2;return B[0]=[V,q,(S-o)/2,$,i],B}i=i.replace(/\n/g," ");for(let V=0,q=i.length;V<q;){x();let D=Math.atan2(p-g,h-m);if(T&&(D+=D>0?-I:I),$!==void 0){let ge=D-$;if(ge+=ge>I?-2*I:ge<-I?2*I:0,Math.abs(ge)>s)return null}$=D;let Z=V,ie=0;for(;V<q;++V){let ge=T?q-V-1:V,rt=a*l(c,i[ge],u);if(e+r<t&&v+y<o+ie+rt/2)break;ie+=rt}if(V===Z)continue;let O=T?i.substring(q-Z,q-V):i.substring(Z,V);E=y===0?0:(o+ie/2-v)/y;let we=gn(m,h,E),_e=gn(g,p,E);B.push([we,_e,ie/2,D,O]),o+=ie}return B}var HE=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Cc(),{get:(e,t)=>{if(typeof Cc()[t]=="function")return this.push_(t),this.pushMethodArgs_},set:(e,t,r)=>(this.push_(t,r),!0)})}push_(...e){let t=this.instructions_,r=this.zIndex+this.offset_;t[r]||(t[r]=[]),t[r].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let r=0,i=t.length;r<i;++r){let o=t[r];if(typeof o=="function"){o(e);continue}let s=t[++r];if(typeof e[o]=="function")e[o](...s);else{if(typeof s=="function"){e[o]=s(e);continue}e[o]=s}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},Ac=HE;var Pc=wt(),ta=[],ss=[],as=[],na=[];function KR(n){return n[3].declutterBox}var JR=new RegExp("[\u0591-\u08FF\uFB1D-\uFDFF\uFE70-\uFEFC\u0800-\u0FFF\uE800-\uEFFF]");function qE(n,e){return e==="start"?e=JR.test(n)?"right":"left":e==="end"&&(e=JR.test(n)?"left":"right"),Xd[e]}function yU(n,e,t){return t>0&&n.push(`
`,""),n.push(e,""),n}function vU(n,e,t){return t%2===0&&(n+=e),n}var WE=class{constructor(e,t,r,i,o){this.overlaps=r,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=qt(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=o?new Ac:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,r,i){let o=e+t+r+i;if(this.labels_[o])return this.labels_[o];let s=i?this.strokeStates[i]:null,a=r?this.fillStates[r]:null,l=this.textStates[t],c=this.pixelRatio,u=[l.scale[0]*c,l.scale[1]*c],d=l.justify?Xd[l.justify]:qE(Array.isArray(e)?e[0]:e,l.textAlign||Js),f=i&&s.lineWidth?s.lineWidth:0,h=Array.isArray(e)?e:String(e).split(`
`).reduce(yU,[]),{width:p,height:m,widths:g,heights:y,lineWidths:v}=DR(l,h),x=p+f,E=[],_=(x+2)*u[0],w=(m+f)*u[1],b={width:_<0?Math.floor(_):Math.ceil(_),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:E};(u[0]!=1||u[1]!=1)&&E.push("scale",u),i&&(E.push("strokeStyle",s.strokeStyle),E.push("lineWidth",f),E.push("lineCap",s.lineCap),E.push("lineJoin",s.lineJoin),E.push("miterLimit",s.miterLimit),E.push("setLineDash",[s.lineDash]),E.push("lineDashOffset",s.lineDashOffset)),r&&E.push("fillStyle",a.fillStyle),E.push("textBaseline","middle"),E.push("textAlign","center");let M=.5-d,S=d*x+M*f,C=[],R=[],T=0,I=0,B=0,j=0,$;for(let V=0,q=h.length;V<q;V+=2){let D=h[V];if(D===`
`){I+=T,T=0,S=d*x+M*f,++j;continue}let Z=h[V+1]||l.font;Z!==$&&(i&&C.push("font",Z),r&&R.push("font",Z),$=Z),T=Math.max(T,y[B]);let ie=[D,S+M*g[B]+d*(g[B]-v[j]),.5*(f+T)+I];S+=g[B],i&&C.push("strokeText",ie),r&&R.push("fillText",ie),++B}return Array.prototype.push.apply(E,C),Array.prototype.push.apply(E,R),this.labels_[o]=b,b}replayTextBackground_(e,t,r,i,o,s,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,o),e.lineTo.apply(e,t),s&&(this.alignAndScaleFill_=s[2],e.fillStyle=s[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,r,i,o,s,a,l,c,u,d,f,h,p,m,g){a*=f[0],l*=f[1];let y=r-a,v=i-l,x=o+c>e?e-c:o,E=s+u>t?t-u:s,_=p[3]+x*f[0]+p[1],w=p[0]+E*f[1]+p[2],b=y-p[3],M=v-p[0];(m||d!==0)&&(ta[0]=b,na[0]=b,ta[1]=M,ss[1]=M,ss[0]=b+_,as[0]=ss[0],as[1]=M+w,na[1]=as[1]);let S;return d!==0?(S=yn(qt(),r,i,1,1,d,-r,-i),dt(S,ta),dt(S,ss),dt(S,as),dt(S,na),Hn(Math.min(ta[0],ss[0],as[0],na[0]),Math.min(ta[1],ss[1],as[1],na[1]),Math.max(ta[0],ss[0],as[0],na[0]),Math.max(ta[1],ss[1],as[1],na[1]),Pc)):Hn(Math.min(b,b+_),Math.min(M,M+w),Math.max(b,b+_),Math.max(M,M+w),Pc),h&&(y=Math.round(y),v=Math.round(v)),{drawImageX:y,drawImageY:v,drawImageW:x,drawImageH:E,originX:c,originY:u,declutterBox:{minX:Pc[0],minY:Pc[1],maxX:Pc[2],maxY:Pc[3],value:g},canvasTransform:S,scale:f}}replayImageOrLabel_(e,t,r,i,o,s,a){let l=!!(s||a),c=i.declutterBox,u=a?a[2]*i.scale[0]/2:0;return c.minX-u<=t[0]&&c.maxX+u>=0&&c.minY-u<=t[1]&&c.maxY+u>=0&&(l&&this.replayTextBackground_(e,ta,ss,as,na,s,a),RR(e,i.canvasTransform,o,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){let t=this.alignAndScaleFill_;if(t){let r=dt(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6])}drawLabelWithPointPlacement_(e,t,r,i){let o=this.textStates[t],s=this.createLabel(e,t,i,r),a=this.strokeStates[r],l=this.pixelRatio,c=qE(Array.isArray(e)?e[0]:e,o.textAlign||Js),u=Xd[o.textBaseline||rl],d=a&&a.lineWidth?a.lineWidth:0,f=s.width/l-2*o.scale[0],h=c*f+2*(.5-c)*d,p=u*s.height/l+2*(.5-u)*d;return{label:s,anchorX:h,anchorY:p}}execute_(e,t,r,i,o,s,a,l){let c=this.zIndexContext_,u;this.pixelCoordinates_&&Dn(r,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=dr(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),ZD(this.renderedTransform_,r));let d=0,f=i.length,h=0,p,m,g,y,v,x,E,_,w,b,M,S,C,R=0,T=0,I=this.coordinateCache_,B=this.viewRotation_,j=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,$={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:B},V=this.instructions!=i||this.overlaps?0:200,q,D,Z,ie;for(;d<f;){let O=i[d];switch(O[0]){case K.BEGIN_GEOMETRY:q=O[1],ie=O[3],q.getGeometry()?a!==void 0&&!Le(a,ie.getExtent())?d=O[2]+1:++d:d=O[2],c&&(c.zIndex=O[4]);break;case K.BEGIN_PATH:R>V&&(this.fill_(e),R=0),T>V&&(e.stroke(),T=0),!R&&!T&&(e.beginPath(),v=NaN,x=NaN),++d;break;case K.CIRCLE:h=O[1];let _e=u[h],ge=u[h+1],rt=u[h+2],Pe=u[h+3],St=rt-_e,z=Pe-ge,It=Math.sqrt(St*St+z*z);e.moveTo(_e+It,ge),e.arc(_e,ge,It,0,2*Math.PI,!0),++d;break;case K.CLOSE_PATH:e.closePath(),++d;break;case K.CUSTOM:h=O[1],p=O[2];let li=O[3],Me=O[4],Gi=O[5];$.geometry=li,$.feature=q,d in I||(I[d]=[]);let xn=I[d];Gi?Gi(u,h,p,2,xn):(xn[0]=u[h],xn[1]=u[h+1],xn.length=2),c&&(c.zIndex=O[6]),Me(xn,$),++d;break;case K.DRAW_IMAGE:h=O[1],p=O[2],w=O[3],m=O[4],g=O[5];let He=O[6],En=O[7],ht=O[8],Nr=O[9],ci=O[10],wn=O[11],Or=O[12],Ui=O[13];y=O[14]||"declutter";let he=O[15];if(!w&&O.length>=20){b=O[19],M=O[20],S=O[21],C=O[22];let er=this.drawLabelWithPointPlacement_(b,M,S,C);w=er.label,O[3]=w;let wa=O[23];m=(er.anchorX-wa)*this.pixelRatio,O[4]=m;let Lr=O[24];g=(er.anchorY-Lr)*this.pixelRatio,O[5]=g,He=w.height,O[6]=He,Ui=w.width,O[13]=Ui}let Ke;O.length>25&&(Ke=O[25]);let qe,Be,pt;O.length>17?(qe=O[16],Be=O[17],pt=O[18]):(qe=ns,Be=null,pt=null),ci&&j?wn+=B:!ci&&!j&&(wn-=B);let Te=0;for(;h<p;h+=2){if(Ke&&Ke[Te++]<Ui/this.pixelRatio)continue;let er=this.calculateImageOrLabelDimensions_(w.width,w.height,u[h],u[h+1],Ui,He,m,g,ht,Nr,wn,Or,o,qe,!!Be||!!pt,q),wa=[e,t,w,er,En,Be,pt];if(l){let Lr,zi,kr;if(he){let Dt=p-h;if(!he[Dt]){he[Dt]={args:wa,declutterMode:y};continue}let kn=he[Dt];Lr=kn.args,zi=kn.declutterMode,delete he[Dt],kr=KR(Lr)}let So,Io;if(Lr&&(zi!=="declutter"||!l.collides(kr))&&(So=!0),(y!=="declutter"||!l.collides(er.declutterBox))&&(Io=!0),zi==="declutter"&&y==="declutter"){let Dt=So&&Io;So=Dt,Io=Dt}So&&(zi!=="none"&&l.insert(kr),this.replayImageOrLabel_.apply(this,Lr)),Io&&(y!=="none"&&l.insert(er.declutterBox),this.replayImageOrLabel_.apply(this,wa))}else this.replayImageOrLabel_.apply(this,wa)}++d;break;case K.DRAW_CHARS:let Ve=O[1],Ft=O[2],Lt=O[3],Fr=O[4];C=O[5];let Er=O[6],on=O[7],Cn=O[8];S=O[9];let it=O[10];b=O[11],Array.isArray(b)&&(b=b.reduce(vU,"")),M=O[12];let Jt=[O[13],O[13]];y=O[14]||"declutter";let Jn=O[15],ot=this.textStates[M],Qn=ot.font,xa=[ot.scale[0]*on,ot.scale[1]*on],Ea;Qn in this.widths_?Ea=this.widths_[Qn]:(Ea={},this.widths_[Qn]=Ea);let Dl=Ec(u,Ve,Ft,2),oh=Math.abs(xa[0])*fE(Qn,b,Ea);if(Fr||oh<=Dl){let er=this.textStates[M].textAlign,wa=(Dl-oh)*qE(b,er),Lr=YR(u,Ve,Ft,2,b,wa,Er,Math.abs(xa[0]),fE,Qn,Ea,j?0:this.viewRotation_,Jn);e:if(Lr){let zi=[],kr,So,Io,Dt,kn;if(S)for(kr=0,So=Lr.length;kr<So;++kr){kn=Lr[kr],Io=kn[4],Dt=this.createLabel(Io,M,"",S),m=kn[2]+(xa[0]<0?-it:it),g=Lt*Dt.height+(.5-Lt)*2*it*xa[1]/xa[0]-Cn;let Do=this.calculateImageOrLabelDimensions_(Dt.width,Dt.height,kn[0],kn[1],Dt.width,Dt.height,m,g,0,0,kn[3],Jt,!1,ns,!1,q);if(l&&y==="declutter"&&l.collides(Do.declutterBox))break e;zi.push([e,t,Dt,Do,1,null,null])}if(C)for(kr=0,So=Lr.length;kr<So;++kr){kn=Lr[kr],Io=kn[4],Dt=this.createLabel(Io,M,C,""),m=kn[2],g=Lt*Dt.height-Cn;let Do=this.calculateImageOrLabelDimensions_(Dt.width,Dt.height,kn[0],kn[1],Dt.width,Dt.height,m,g,0,0,kn[3],Jt,!1,ns,!1,q);if(l&&y==="declutter"&&l.collides(Do.declutterBox))break e;zi.push([e,t,Dt,Do,1,null,null])}l&&y!=="none"&&l.load(zi.map(KR));for(let Do=0,PF=zi.length;Do<PF;++Do)this.replayImageOrLabel_.apply(this,zi[Do])}}++d;break;case K.END_GEOMETRY:if(s!==void 0){q=O[1];let er=s(q,ie,y);if(er)return er}++d;break;case K.FILL:V?R++:this.fill_(e),++d;break;case K.MOVE_TO_LINE_TO:for(h=O[1],p=O[2],D=u[h],Z=u[h+1],e.moveTo(D,Z),v=D+.5|0,x=Z+.5|0,h+=2;h<p;h+=2)D=u[h],Z=u[h+1],E=D+.5|0,_=Z+.5|0,(h==p-2||E!==v||_!==x)&&(e.lineTo(D,Z),v=E,x=_);++d;break;case K.SET_FILL_STYLE:this.alignAndScaleFill_=O[2],R&&(this.fill_(e),R=0,T&&(e.stroke(),T=0)),e.fillStyle=O[1],++d;break;case K.SET_STROKE_STYLE:T&&(e.stroke(),T=0),this.setStrokeStyle_(e,O),++d;break;case K.STROKE:V?T++:e.stroke(),++d;break;default:++d;break}}R&&this.fill_(e),T&&e.stroke()}execute(e,t,r,i,o,s){this.viewRotation_=i,this.execute_(e,t,r,this.instructions,o,void 0,void 0,s)}executeHitDetection(e,t,r,i,o){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,i,o)}},QR=WE;var il=["Polygon","Circle","LineString","Image","Text","Default"],Nc=["Image","Text"],eA=il.filter(n=>!Nc.includes(n)),ZE=class{constructor(e,t,r,i,o,s,a){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=t,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=qt(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(o,a)}clip(e,t){let r=this.getClipCoords(t);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,t){for(let r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);let o=e[r];for(let s in o){let a=o[s];i[s]=new QR(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(let t in this.executorsByZIndex_){let r=this.executorsByZIndex_[t];for(let i=0,o=e.length;i<o;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,t,r,i,o,s){i=Math.round(i);let a=i*2+1,l=yn(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=be(a,a));let u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):c||u.clearRect(0,0,a,a);let d;this.renderBuffer_!==void 0&&(d=wt(),Ya(d,e),Tr(d,t*(this.renderBuffer_+i),d));let f=_U(i),h;function p(_,w,b){let M=u.getImageData(0,0,a,a).data;for(let S=0,C=f.length;S<C;S++)if(M[f[S]]>0){if(!s||b==="none"||h!=="Image"&&h!=="Text"||s.includes(_)){let R=(f[S]-3)/4,T=i-R%a,I=i-(R/a|0),B=o(_,w,T*T+I*I);if(B)return B}u.clearRect(0,0,a,a);break}}let m=Object.keys(this.executorsByZIndex_).map(Number);m.sort(In);let g,y,v,x,E;for(g=m.length-1;g>=0;--g){let _=m[g].toString();for(v=this.executorsByZIndex_[_],y=il.length-1;y>=0;--y)if(h=il[y],x=v[h],x!==void 0&&(E=x.executeHitDetection(u,l,r,p,d),E))return E}}getClipCoords(e){let t=this.maxExtent_;if(!t)return null;let r=t[0],i=t[1],o=t[2],s=t[3],a=[r,i,r,s,o,s,o,i];return dr(a,0,8,2,e,a),a}isEmpty(){return zn(this.executorsByZIndex_)}execute(e,t,r,i,o,s,a){let l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?yD:In),s=s||il;let c=il.length;for(let u=0,d=l.length;u<d;++u){let f=l[u].toString(),h=this.executorsByZIndex_[f];for(let p=0,m=s.length;p<m;++p){let g=s[p],y=h[g];if(y!==void 0){let v=a===null?void 0:y.getZIndexContext(),x=v?v.getContext():e,E=this.maxExtent_&&g!=="Image"&&g!=="Text";if(E&&(x.save(),this.clip(x,r)),!v||g==="Text"||g==="Image"?y.execute(x,t,r,i,o,a):v.pushFunction(_=>y.execute(_,t,r,i,o,a)),E&&x.restore(),v){v.offset();let _=l[u]*c+p;this.deferredZIndexContexts_[_]||(this.deferredZIndexContexts_[_]=[]),this.deferredZIndexContexts_[_].push(v)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){let e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(In);for(let r=0,i=t.length;r<i;++r)e[t[r]].forEach(o=>{o.draw(this.renderedContext_),o.clear()}),e[t[r]].length=0}},XE={};function _U(n){if(XE[n]!==void 0)return XE[n];let e=n*2+1,t=n*n,r=new Array(t+1);for(let o=0;o<=n;++o)for(let s=0;s<=n;++s){let a=o*o+s*s;if(a>t)break;let l=r[a];l||(l=[],r[a]=l),l.push(((n+o)*e+(n+s))*4+3),o>0&&l.push(((n-o)*e+(n+s))*4+3),s>0&&(l.push(((n+o)*e+(n-s))*4+3),o>0&&l.push(((n-o)*e+(n-s))*4+3))}let i=[];for(let o=0,s=r.length;o<s;++o)r[o]&&i.push(...r[o]);return XE[n]=i,i}var ig=ZE;function tA(n,e,t,r){return t!==void 0&&r!==void 0?[t/n,r/e]:t!==void 0?t/n:r!==void 0?r/e:1}var YE=class n extends tg{constructor(e){e=e||{};let t=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,o=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:o,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;let s=e.img!==void 0?e.img:null,a=e.src;se(!(a!==void 0&&s),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&s&&(a=s.src||X(s)),se(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),se(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=re.IDLE:s!==void 0&&("complete"in s?s.complete?l=s.src?re.LOADED:re.IDLE:l=re.LOADING:l=re.LOADED),this.color_=e.color!==void 0?Di(e.color):null,this.iconImage_=Mc(s,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,u;if(e.size)[c,u]=e.size;else{let d=this.getImage(1);if(d.width&&d.height)c=d.width,u=d.height;else if(d instanceof HTMLImageElement){this.initialOptions_=e;let f=()=>{if(this.unlistenImageChange(f),!this.initialOptions_)return;let h=this.iconImage_.getSize();this.setScale(tA(h[0],h[1],e.width,e.height))};this.listenImageChange(f);return}}c!==void 0&&this.setScale(tA(c,u,e.width,e.height))}}clone(){let e,t,r;return this.initialOptions_?(t=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new n({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;let i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}let t=this.getDisplacement(),r=this.getScaleArray();return[e[0]-t[0]/r[0],e[1]+t[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){let t=this.getSize(),r=this.iconImage_.getSize();if(!t||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){let e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==re.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){let e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==re.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(H.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(H.CHANGE,e)}ready(){return this.iconImage_.ready()}},ra=YE;var Xn=.5;function og(n,e,t,r,i,o,s,a,l){let c=l?Hs(i,l):i,u=n[0]*Xn,d=n[1]*Xn,f=be(u,d);f.imageSmoothingEnabled=!1;let h=f.canvas,p=new AR(f,Xn,i,null,s,a,l?Yo(Xr(),l):null),m=t.length,g=Math.floor((256*256*256-1)/m),y={};for(let x=1;x<=m;++x){let E=t[x-1],_=E.getStyleFunction()||r;if(!_)continue;let w=_(E,o);if(!w)continue;Array.isArray(w)||(w=[w]);let M=(x*g).toString(16).padStart(7,"#00000");for(let S=0,C=w.length;S<C;++S){let R=w[S],T=R.getGeometryFunction()(E);if(!T||!Le(c,T.getExtent()))continue;let I=R.clone(),B=I.getFill();B&&B.setColor(M);let j=I.getStroke();j&&(j.setColor(M),j.setLineDash(null)),I.setText(void 0);let $=R.getImage();if($){let Z=$.getImageSize();if(!Z)continue;let ie=be(Z[0],Z[1],void 0,{alpha:!1}),O=ie.canvas;ie.fillStyle=M,ie.fillRect(0,0,O.width,O.height),I.setImage(new ra({img:O,anchor:$.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:$.getOrigin(),opacity:1,size:$.getSize(),scale:$.getScale(),rotation:$.getRotation(),rotateWithView:$.getRotateWithView()}))}let V=I.getZIndex()||0,q=y[V];q||(q={},y[V]=q,q.Polygon=[],q.Circle=[],q.LineString=[],q.Point=[]);let D=T.getType();if(D==="GeometryCollection"){let Z=T.getGeometriesArrayRecursive();for(let ie=0,O=Z.length;ie<O;++ie){let we=Z[ie];q[we.getType().replace("Multi","")].push(we,I)}}else q[D.replace("Multi","")].push(T,I)}}let v=Object.keys(y).map(Number).sort(In);for(let x=0,E=v.length;x<E;++x){let _=y[v[x]];for(let w in _){let b=_[w];for(let M=0,S=b.length;M<S;M+=2){p.setStyle(b[M+1]);for(let C=0,R=e.length;C<R;++C)p.setTransform(e[C]),p.drawGeometry(b[M])}}}return f.getImageData(0,0,h.width,h.height)}function sg(n,e,t){let r=[];if(t){let i=Math.floor(Math.round(n[0])*Xn),o=Math.floor(Math.round(n[1])*Xn),s=(xe(i,0,t.width-1)+xe(o,0,t.height-1)*t.width)*4,a=t.data[s],l=t.data[s+1],u=t.data[s+2]+256*(l+256*a),d=Math.floor((256*256*256-1)/e.length);u&&u%d===0&&r.push(e[u/d-1])}return r}var KE=class extends Ut{constructor(e,t,r,i){super(e),this.inversePixelTransform=t,this.frameState=r,this.context=i}},ag=KE;var xU=5,JE=class extends um{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=xU}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return W()}getData(e){return null}prepareFrame(e){return W()}renderFrame(e,t){return W()}forEachFeatureAtCoordinate(e,t,r,i,o){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){let t=e.target;(t.getState()===re.LOADED||t.getState()===re.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=re.LOADED&&t!=re.ERROR&&e.addEventListener(H.CHANGE,this.boundHandleImageChange_),t==re.IDLE&&(e.load(),t=e.getState()),t==re.LOADED}renderIfReadyAndVisible(){let e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}},nA=JE;var ew=[],Oc=null;function EU(){Oc=be(1,1,void 0,{willReadFrequently:!0})}var QE=class extends nA{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=qt(),this.pixelTransform=qt(),this.inversePixelTransform=qt(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,t,r){Oc||EU(),Oc.clearRect(0,0,1,1);let i;try{Oc.drawImage(e,t,r,1,1,0,0,1,1),i=Oc.getImageData(0,0,1,1).data}catch{return Oc=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,t,r){let i=this.getLayer().getClassName(),o,s;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&Dn(Di(e.style.backgroundColor),Di(r)))){let a=e.firstElementChild;a instanceof HTMLCanvasElement&&(s=a.getContext("2d"))}if(s&&JD(s.canvas.style.transform,t)?(this.container=e,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){o=document.createElement("div"),o.className=i;let a=o.style;a.position="absolute",a.width="100%",a.height="100%",s=be();let l=s.canvas;o.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=o,this.context=s}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,t,r){let i=ut(r),o=Vs(r),s=js(r),a=Xo(r);dt(t.coordinateToPixelTransform,i),dt(t.coordinateToPixelTransform,o),dt(t.coordinateToPixelTransform,s),dt(t.coordinateToPixelTransform,a);let l=this.inversePixelTransform;dt(l,i),dt(l,o),dt(l,s),dt(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,t){let r=e.extent,i=e.viewState.resolution,o=e.viewState.rotation,s=e.pixelRatio,a=Math.round(ee(r)/i*s),l=Math.round(et(r)/i*s);yn(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/s,1/s,o,-a/2,-l/2),Dm(this.inversePixelTransform,this.pixelTransform);let c=KD(this.pixelTransform);if(this.useContainer(t,c,this.getBackground(e)),!this.containerReused){let u=this.context.canvas;u.width!=a||u.height!=l?(u.width=a,u.height=l):this.context.clearRect(0,0,a,l),c!==u.style.transform&&(u.style.transform=c)}}dispatchRenderEvent_(e,t,r){let i=this.getLayer();if(i.hasListener(e)){let o=new ag(e,this.inversePixelTransform,r,t);i.dispatchEvent(o)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(_n.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(_n.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Ac),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(_n.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(_n.POSTRENDER,this.context,e))}getRenderTransform(e,t,r,i,o,s,a){let l=o/2,c=s/2,u=i/t,d=-u,f=-e[0]+a,h=-e[1];return yn(this.tempTransform,l,c,u,d,-r,f,h)}disposeInternal(){delete this.frameState,super.disposeInternal()}},lg=QE;var tw=class extends lg{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=wt(),this.wrappedRenderedExtent_=wt(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,r){let i=t.extent,o=t.viewState,s=o.center,a=o.resolution,l=o.projection,c=o.rotation,u=l.getExtent(),d=this.getLayer().getSource(),f=this.getLayer().getDeclutter(),h=t.pixelRatio,p=t.viewHints,m=!(p[lt.ANIMATING]||p[lt.INTERACTING]),g=this.context,y=Math.round(ee(i)/a*h),v=Math.round(et(i)/a*h),x=d.getWrapX()&&l.canWrapX(),E=x?ee(u):null,_=x?Math.ceil((i[2]-u[2])/E)+1:1,w=x?Math.floor((i[0]-u[0])/E):0;do{let b=this.getRenderTransform(s,a,0,h,y,v,w*E);t.declutter&&(b=b.slice(0)),e.execute(g,[g.canvas.width,g.canvas.height],b,c,m,r===void 0?il:r?Nc:eA,r?f&&t.declutter[f]:void 0)}while(++w<_)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=be(this.context.canvas.width,this.context.canvas.height,ew))}resetDrawContext_(){if(this.opacity_!==1){let e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Qo(this.context),ew.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,t){let r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;let i=e.viewState;this.prepareContainer(e,t);let o=this.context,s=this.replayGroup_,a=s&&!s.isEmpty();if(!a&&!(this.getLayer().hasListener(_n.PRERENDER)||this.getLayer().hasListener(_n.POSTRENDER)))return this.container;this.setDrawContext_(),this.preRender(o,e);let l=i.projection;if(this.clipped_=!1,a&&r.extent&&this.clipping){let c=Zr(r.extent,l);a=Le(c,e.extent),this.clipped_=a&&!Mi(c,e.extent),this.clipped_&&this.clipUnrotated(o,e,c)}return a&&this.renderWorlds(s,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&o.restore(),this.postRender(o,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){let r=this.frameState.size.slice(),i=this.renderedCenter_,o=this.renderedResolution_,s=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),u=[],d=r[0]*Xn,f=r[1]*Xn;u.push(this.getRenderTransform(i,o,s,Xn,d,f,0).slice());let h=c.getSource(),p=a.getExtent();if(h.getWrapX()&&a.canWrapX()&&!Mi(p,l)){let g=l[0],y=ee(p),v=0,x;for(;g<p[0];)--v,x=y*v,u.push(this.getRenderTransform(i,o,s,Xn,d,f,x).slice()),g+=y;for(v=0,g=l[2];g>p[2];)++v,x=y*v,u.push(this.getRenderTransform(i,o,s,Xn,d,f,x).slice()),g-=y}let m=Xr();this.hitDetectionImageData_=og(r,u,this.renderedFeatures_,c.getStyleFunction(),l,o,s,Gd(o,this.renderedPixelRatio_),m?a:null)}t(sg(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,r,i,o){if(!this.replayGroup_)return;let s=t.viewState.resolution,a=t.viewState.rotation,l=this.getLayer(),c={},u=function(f,h,p){let m=X(f),g=c[m];if(g){if(g!==!0&&p<g.distanceSq){if(p===0)return c[m]=!0,o.splice(o.lastIndexOf(g),1),i(f,l,h);g.geometry=h,g.distanceSq=p}}else{if(p===0)return c[m]=!0,i(f,l,h);o.push(c[m]={feature:f,layer:l,geometry:h,distanceSq:p,callback:i})}},d=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,s,a,r,u,d?t.declutter?.[d]?.all().map(f=>f.value):null)}handleFontsChanged(){let e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){let t=this.getLayer(),r=t.getSource();if(!r)return!1;let i=e.viewHints[lt.ANIMATING],o=e.viewHints[lt.INTERACTING],s=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!s&&i||!a&&o)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;let l=e.extent,c=e.viewState,u=c.projection,d=c.resolution,f=e.pixelRatio,h=t.getRevision(),p=t.getRenderBuffer(),m=t.getRenderOrder();m===void 0&&(m=NR);let g=c.center.slice(),y=Tr(l,p*d),v=y.slice(),x=[y.slice()],E=u.getExtent();if(r.getWrapX()&&u.canWrapX()&&!Mi(E,e.extent)){let j=ee(E),$=Math.max(ee(y)/2,j);y[0]=E[0]-$,y[2]=E[2]+$,hc(g,u);let V=vx(x[0],u);V[0]<E[0]&&V[2]<E[2]?x.push([V[0]+j,V[1],V[2]+j,V[3]]):V[0]>E[0]&&V[2]>E[2]&&x.push([V[0]-j,V[1],V[2]-j,V[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==h&&this.renderedRenderOrder_==m&&this.renderedFrameDeclutter_===!!e.declutter&&Mi(this.wrappedRenderedExtent_,y))return Dn(this.renderedExtent_,v)||(this.hitDetectionImageData_=null,this.renderedExtent_=v),this.renderedCenter_=g,this.replayGroupChanged=!1,!0;this.replayGroup_=null;let _=new rg(pE(d,f),y,d,f),w=Xr(),b;if(w){for(let j=0,$=x.length;j<$;++j){let V=x[j],q=Hs(V,u);r.loadFeatures(q,qD(d,u),w)}b=Yo(w,u)}else for(let j=0,$=x.length;j<$;++j)r.loadFeatures(x[j],d,u);let M=Gd(d,f),S=!0,C=(j,$)=>{let V,q=j.getStyleFunction()||t.getStyleFunction();if(q&&(V=q(j,d)),V){let D=this.renderFeature(j,M,V,_,b,this.getLayer().getDeclutter(),$);S=S&&!D}},R=Hs(y,u),T=r.getFeaturesInExtent(R);m&&T.sort(m);for(let j=0,$=T.length;j<$;++j)C(T[j],j);this.renderedFeatures_=T,this.ready=S;let I=_.finish(),B=new ig(y,d,f,r.getOverlaps(),I,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=d,this.renderedRevision_=h,this.renderedRenderOrder_=m,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=v,this.wrappedRenderedExtent_=y,this.renderedCenter_=g,this.renderedProjection_=u,this.renderedPixelRatio_=f,this.replayGroup_=B,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,r,i,o,s,a){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,u=r.length;c<u;++c)l=Sc(i,e,r[c],t,this.boundHandleStyleImageChange_,o,s,a)||l;else l=Sc(i,e,r,t,this.boundHandleStyleImageChange_,o,s,a);return l}},rA=tw;var ol=0;var Nn=1<<ol++,Ae=1<<ol++,Zn=1<<ol++,Dr=1<<ol++,oa=1<<ol++,Zd=1<<ol++,cg=Math.pow(2,ol)-1,iw={[Nn]:"boolean",[Ae]:"number",[Zn]:"string",[Dr]:"color",[oa]:"number[]",[Zd]:"size"},wU=Object.keys(iw).map(Number).sort(In);function CU(n){return n in iw}function Yd(n){let e=[];for(let t of wU)Kd(n,t)&&e.push(iw[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Kd(n,e){return(n&e)===e}function ia(n,e){return n===e}var Pt=class{constructor(e,t){if(!CU(e))throw new Error(`literal expressions must have a specific type, got ${Yd(e)}`);this.type=e,this.value=t}},rw=class{constructor(e,t,...r){this.type=e,this.operator=t,this.args=r}};function ow(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function hn(n,e,t){switch(typeof n){case"boolean":{if(ia(e,Zn))return new Pt(Zn,n?"true":"false");if(!Kd(e,Nn))throw new Error(`got a boolean, but expected ${Yd(e)}`);return new Pt(Nn,n)}case"number":{if(ia(e,Zd))return new Pt(Zd,Ge(n));if(ia(e,Nn))return new Pt(Nn,!!n);if(ia(e,Zn))return new Pt(Zn,n.toString());if(!Kd(e,Ae))throw new Error(`got a number, but expected ${Yd(e)}`);return new Pt(Ae,n)}case"string":{if(ia(e,Dr))return new Pt(Dr,kd(n));if(ia(e,Nn))return new Pt(Nn,!!n);if(!Kd(e,Zn))throw new Error(`got a string, but expected ${Yd(e)}`);return new Pt(Zn,n)}default:}if(!Array.isArray(n))throw new Error("expression must be an array or a primitive value");if(n.length===0)throw new Error("empty expression");if(typeof n[0]=="string")return OU(n,e,t);for(let r of n)if(typeof r!="number")throw new Error("expected an array of numbers");if(ia(e,Zd)){if(n.length!==2)throw new Error(`expected an array of two values for a size, got ${n.length}`);return new Pt(Zd,n)}if(ia(e,Dr)){if(n.length===3)return new Pt(Dr,[...n,1]);if(n.length===4)return new Pt(Dr,n);throw new Error(`expected an array of 3 or 4 values for a color, got ${n.length}`)}if(!Kd(e,oa))throw new Error(`got an array of numbers, but expected ${Yd(e)}`);return new Pt(oa,n)}var A={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},bU={[A.Get]:ae(ve(1,1/0),iA),[A.Var]:ae(ve(1,1),MU),[A.Has]:ae(ve(1,1/0),iA),[A.Id]:ae(TU,Fc),[A.Concat]:ae(ve(2,1/0),Ue(Zn)),[A.GeometryType]:ae(SU,Fc),[A.LineMetric]:ae(Fc),[A.Resolution]:ae(nw,Fc),[A.Zoom]:ae(nw,Fc),[A.Time]:ae(nw,Fc),[A.Any]:ae(ve(2,1/0),Ue(Nn)),[A.All]:ae(ve(2,1/0),Ue(Nn)),[A.Not]:ae(ve(1,1),Ue(Nn)),[A.Equal]:ae(ve(2,2),Ue(cg)),[A.NotEqual]:ae(ve(2,2),Ue(cg)),[A.GreaterThan]:ae(ve(2,2),Ue(Ae)),[A.GreaterThanOrEqualTo]:ae(ve(2,2),Ue(Ae)),[A.LessThan]:ae(ve(2,2),Ue(Ae)),[A.LessThanOrEqualTo]:ae(ve(2,2),Ue(Ae)),[A.Multiply]:ae(ve(2,1/0),oA),[A.Coalesce]:ae(ve(2,1/0),oA),[A.Divide]:ae(ve(2,2),Ue(Ae)),[A.Add]:ae(ve(2,1/0),Ue(Ae)),[A.Subtract]:ae(ve(2,2),Ue(Ae)),[A.Clamp]:ae(ve(3,3),Ue(Ae)),[A.Mod]:ae(ve(2,2),Ue(Ae)),[A.Pow]:ae(ve(2,2),Ue(Ae)),[A.Abs]:ae(ve(1,1),Ue(Ae)),[A.Floor]:ae(ve(1,1),Ue(Ae)),[A.Ceil]:ae(ve(1,1),Ue(Ae)),[A.Round]:ae(ve(1,1),Ue(Ae)),[A.Sin]:ae(ve(1,1),Ue(Ae)),[A.Cos]:ae(ve(1,1),Ue(Ae)),[A.Atan]:ae(ve(1,2),Ue(Ae)),[A.Sqrt]:ae(ve(1,1),Ue(Ae)),[A.Match]:ae(ve(4,1/0),sA,DU),[A.Between]:ae(ve(3,3),Ue(Ae)),[A.Interpolate]:ae(ve(6,1/0),sA,RU),[A.Case]:ae(ve(3,1/0),IU,AU),[A.In]:ae(ve(2,2),PU),[A.Number]:ae(ve(1,1/0),Ue(cg)),[A.String]:ae(ve(1,1/0),Ue(cg)),[A.Array]:ae(ve(1,1/0),Ue(Ae)),[A.Color]:ae(ve(1,4),Ue(Ae)),[A.Band]:ae(ve(1,3),Ue(Ae)),[A.Palette]:ae(ve(2,2),NU),[A.ToString]:ae(ve(1,1),Ue(Nn|Ae|Zn|Dr))};function iA(n,e,t){let r=n.length-1,i=new Array(r);for(let o=0;o<r;++o){let s=n[o+1];switch(typeof s){case"number":{i[o]=new Pt(Ae,s);break}case"string":{i[o]=new Pt(Zn,s);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${s}`)}o===0&&t.properties.add(String(s))}return i}function MU(n,e,t){let r=n[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return t.variables.add(r),[new Pt(Zn,r)]}function TU(n,e,t){t.featureId=!0}function SU(n,e,t){t.geometryType=!0}function nw(n,e,t){t.mapState=!0}function Fc(n,e,t){let r=n[0];if(n.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function ve(n,e){return function(t,r,i){let o=t[0],s=t.length-1;if(n===e){if(s!==n){let a=n===1?"":"s";throw new Error(`expected ${n} argument${a} for ${o}, got ${s}`)}}else if(s<n||s>e){let a=e===1/0?`${n} or more`:`${n} to ${e}`;throw new Error(`expected ${a} arguments for ${o}, got ${s}`)}}}function oA(n,e,t){let r=n.length-1,i=new Array(r);for(let o=0;o<r;++o){let s=hn(n[o+1],e,t);i[o]=s}return i}function Ue(n){return function(e,t,r){let i=e.length-1,o=new Array(i);for(let s=0;s<i;++s){let a=hn(e[s+1],n,r);o[s]=a}return o}}function IU(n,e,t){let r=n[0],i=n.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function sA(n,e,t){let r=n[0],i=n.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function DU(n,e,t){let r=n.length-1,i=Zn|Ae|Nn,o=hn(n[1],i,t),s=hn(n[n.length-1],e,t),a=new Array(r-2);for(let l=0;l<r-2;l+=2){try{let c=hn(n[l+2],o.type,t);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{let c=hn(n[l+3],s.type,t);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[o,...a,s]}function RU(n,e,t){let r=n[1],i;switch(r[0]){case"linear":i=1;break;case"exponential":let l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}let o=new Pt(Ae,i),s;try{s=hn(n[2],Ae,t)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}let a=new Array(n.length-3);for(let l=0;l<a.length;l+=2){try{let c=hn(n[l+3],Ae,t);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{let c=hn(n[l+4],e,t);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[o,s,...a]}function AU(n,e,t){let r=hn(n[n.length-1],e,t),i=new Array(n.length-1);for(let o=0;o<i.length-1;o+=2){try{let s=hn(n[o+1],Nn,t);i[o]=s}catch(s){throw new Error(`failed to parse argument ${o} of case expression: ${s.message}`)}try{let s=hn(n[o+2],r.type,t);i[o+1]=s}catch(s){throw new Error(`failed to parse argument ${o+1} of case expression: ${s.message}`)}}return i[i.length-1]=r,i}function PU(n,e,t){let r=n[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=Zn}else i=Ae;let o=new Array(r.length);for(let a=0;a<o.length;a++)try{let l=hn(r[a],i,t);o[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[hn(n[1],i,t),...o]}function NU(n,e,t){let r;try{r=hn(n[1],Ae,t)}catch(s){throw new Error(`failed to parse first argument in palette expression: ${s.message}`)}let i=n[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");let o=new Array(i.length);for(let s=0;s<o.length;s++){let a;try{a=hn(i[s],Dr,t)}catch(l){throw new Error(`failed to parse color at index ${s} in palette expression: ${l.message}`)}if(!(a instanceof Pt))throw new Error(`the palette color at index ${s} must be a literal value`);o[s]=a}return[r,...o]}function ae(...n){return function(e,t,r){let i=e[0],o;for(let s=0;s<n.length;s++){let a=n[s](e,t,r);if(s==n.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");o=a}}return new rw(t,i,...o)}}function OU(n,e,t){let r=n[0],i=bU[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(n,e,t)}function sw(n){if(!n)return"";let e=n.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return sw(n.getGeometries()[0]);default:return""}}function aw(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function fo(n,e,t){let r=hn(n,e,t);return Ai(r,t)}function Ai(n,e){if(n instanceof Pt){if(n.type===Dr&&typeof n.value=="string"){let r=kd(n.value);return function(){return r}}return function(){return n.value}}let t=n.operator;switch(t){case A.Number:case A.String:case A.Coalesce:return FU(n,e);case A.Get:case A.Var:case A.Has:return LU(n,e);case A.Id:return r=>r.featureId;case A.GeometryType:return r=>r.geometryType;case A.Concat:{let r=n.args.map(i=>Ai(i,e));return i=>"".concat(...r.map(o=>o(i).toString()))}case A.Resolution:return r=>r.resolution;case A.Any:case A.All:case A.Between:case A.In:case A.Not:return jU(n,e);case A.Equal:case A.NotEqual:case A.LessThan:case A.LessThanOrEqualTo:case A.GreaterThan:case A.GreaterThanOrEqualTo:return kU(n,e);case A.Multiply:case A.Divide:case A.Add:case A.Subtract:case A.Clamp:case A.Mod:case A.Pow:case A.Abs:case A.Floor:case A.Ceil:case A.Round:case A.Sin:case A.Cos:case A.Atan:case A.Sqrt:return VU(n,e);case A.Case:return BU(n,e);case A.Match:return GU(n,e);case A.Interpolate:return UU(n,e);case A.ToString:return zU(n,e);default:throw new Error(`Unsupported operator ${t}`)}}function FU(n,e){let t=n.operator,r=n.args.length,i=new Array(r);for(let o=0;o<r;++o)i[o]=Ai(n.args[o],e);switch(t){case A.Coalesce:return o=>{for(let s=0;s<r;++s){let a=i[s](o);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case A.Number:case A.String:return o=>{for(let s=0;s<r;++s){let a=i[s](o);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function LU(n,e){let r=n.args[0].value;switch(n.operator){case A.Get:return i=>{let o=n.args,s=i.properties[r];for(let a=1,l=o.length;a<l;++a){let u=o[a].value;s=s[u]}return s};case A.Var:return i=>i.variables[r];case A.Has:return i=>{let o=n.args;if(!(r in i.properties))return!1;let s=i.properties[r];for(let a=1,l=o.length;a<l;++a){let u=o[a].value;if(!s||!Object.hasOwn(s,u))return!1;s=s[u]}return!0};default:throw new Error(`Unsupported accessor operator ${n.operator}`)}}function kU(n,e){let t=n.operator,r=Ai(n.args[0],e),i=Ai(n.args[1],e);switch(t){case A.Equal:return o=>r(o)===i(o);case A.NotEqual:return o=>r(o)!==i(o);case A.LessThan:return o=>r(o)<i(o);case A.LessThanOrEqualTo:return o=>r(o)<=i(o);case A.GreaterThan:return o=>r(o)>i(o);case A.GreaterThanOrEqualTo:return o=>r(o)>=i(o);default:throw new Error(`Unsupported comparison operator ${t}`)}}function jU(n,e){let t=n.operator,r=n.args.length,i=new Array(r);for(let o=0;o<r;++o)i[o]=Ai(n.args[o],e);switch(t){case A.Any:return o=>{for(let s=0;s<r;++s)if(i[s](o))return!0;return!1};case A.All:return o=>{for(let s=0;s<r;++s)if(!i[s](o))return!1;return!0};case A.Between:return o=>{let s=i[0](o),a=i[1](o),l=i[2](o);return s>=a&&s<=l};case A.In:return o=>{let s=i[0](o);for(let a=1;a<r;++a)if(s===i[a](o))return!0;return!1};case A.Not:return o=>!i[0](o);default:throw new Error(`Unsupported logical operator ${t}`)}}function VU(n,e){let t=n.operator,r=n.args.length,i=new Array(r);for(let o=0;o<r;++o)i[o]=Ai(n.args[o],e);switch(t){case A.Multiply:return o=>{let s=1;for(let a=0;a<r;++a)s*=i[a](o);return s};case A.Divide:return o=>i[0](o)/i[1](o);case A.Add:return o=>{let s=0;for(let a=0;a<r;++a)s+=i[a](o);return s};case A.Subtract:return o=>i[0](o)-i[1](o);case A.Clamp:return o=>{let s=i[0](o),a=i[1](o);if(s<a)return a;let l=i[2](o);return s>l?l:s};case A.Mod:return o=>i[0](o)%i[1](o);case A.Pow:return o=>Math.pow(i[0](o),i[1](o));case A.Abs:return o=>Math.abs(i[0](o));case A.Floor:return o=>Math.floor(i[0](o));case A.Ceil:return o=>Math.ceil(i[0](o));case A.Round:return o=>Math.round(i[0](o));case A.Sin:return o=>Math.sin(i[0](o));case A.Cos:return o=>Math.cos(i[0](o));case A.Atan:return r===2?o=>Math.atan2(i[0](o),i[1](o)):o=>Math.atan(i[0](o));case A.Sqrt:return o=>Math.sqrt(i[0](o));default:throw new Error(`Unsupported numeric operator ${t}`)}}function BU(n,e){let t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=Ai(n.args[i],e);return i=>{for(let o=0;o<t-1;o+=2)if(r[o](i))return r[o+1](i);return r[t-1](i)}}function GU(n,e){let t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=Ai(n.args[i],e);return i=>{let o=r[0](i);for(let s=1;s<t-1;s+=2)if(o===r[s](i))return r[s+1](i);return r[t-1](i)}}function UU(n,e){let t=n.args.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=Ai(n.args[i],e);return i=>{let o=r[0](i),s=r[1](i),a,l;for(let c=2;c<t;c+=2){let u=r[c](i),d=r[c+1](i),f=Array.isArray(d);if(f&&(d=ER(d)),u>=s)return c===2?d:f?$U(o,s,a,l,u,d):Jd(o,s,a,l,u,d);a=u,l=d}return l}}function zU(n,e){let t=n.operator,r=n.args.length,i=new Array(r);for(let o=0;o<r;++o)i[o]=Ai(n.args[o],e);switch(t){case A.ToString:return o=>{let s=i[0](o);return n.args[0].type===Dr?jd(s):s.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function Jd(n,e,t,r,i,o){let s=i-t;if(s===0)return r;let a=e-t,l=n===1?a/s:(Math.pow(n,a)-1)/(Math.pow(n,s)-1);return r+l*(o-r)}function $U(n,e,t,r,i,o){if(i-t===0)return r;let a=rE(r),l=rE(o),c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);let u=[Jd(n,e,t,a[0],i,l[0]),Jd(n,e,t,a[1],i,l[1]),a[2]+Jd(n,e,t,0,i,c),Jd(n,e,t,r[3],i,o[3])];return wR(u)}function HU(n){return!0}function uA(n){let e=ow(),t=qU(n,e),r=aw();return function(i,o){if(r.properties=i.getPropertiesInternal(),r.resolution=o,e.featureId){let s=i.getId();s!==void 0?r.featureId=s:r.featureId=null}return e.geometryType&&(r.geometryType=sw(i.getGeometry())),t(r)}}function uw(n){let e=ow(),t=n.length,r=new Array(t);for(let s=0;s<t;++s)r[s]=lw(n[s],e);let i=aw(),o=new Array(t);return function(s,a){if(i.properties=s.getPropertiesInternal(),i.resolution=a,e.featureId){let c=s.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<t;++c){let u=r[c](i);u&&(o[l]=u,l+=1)}return o.length=l,o}}function qU(n,e){let t=n.length,r=new Array(t);for(let i=0;i<t;++i){let o=n[i],s="filter"in o?fo(o.filter,Nn,e):HU,a;if(Array.isArray(o.style)){let l=o.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=lw(o.style[c],e)}else a=[lw(o.style,e)];r[i]={filter:s,styles:a}}return function(i){let o=[],s=!1;for(let a=0;a<t;++a){let l=r[a].filter;if(l(i)&&!(n[a].else&&s)){s=!0;for(let c of r[a].styles){let u=c(i);u&&o.push(u)}}}return o}}function lw(n,e){let t=Qd(n,"",e),r=ef(n,"",e),i=WU(n,e),o=XU(n,e),s=mr(n,"z-index",e);if(!t&&!r&&!i&&!o&&!zn(n))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(n));let a=new Xt;return function(l){let c=!0;if(t){let u=t(l);u&&(c=!1),a.setFill(u)}if(r){let u=r(l);u&&(c=!1),a.setStroke(u)}if(i){let u=i(l);u&&(c=!1),a.setText(u)}if(o){let u=o(l);u&&(c=!1),a.setImage(u)}return s&&a.setZIndex(s(l)),c?null:a}}function Qd(n,e,t){let r;if(e+"fill-pattern-src"in n)r=JU(n,e+"fill-",t);else{if(n[e+"fill-color"]==="none")return o=>null;r=dw(n,e+"fill-color",t)}if(!r)return null;let i=new Wt;return function(o){let s=r(o);return s===zm?null:(i.setColor(s),i)}}function ef(n,e,t){let r=mr(n,e+"stroke-width",t),i=dw(n,e+"stroke-color",t);if(!r&&!i)return null;let o=ls(n,e+"stroke-line-cap",t),s=ls(n,e+"stroke-line-join",t),a=dA(n,e+"stroke-line-dash",t),l=mr(n,e+"stroke-line-dash-offset",t),c=mr(n,e+"stroke-miter-limit",t),u=new tn;return function(d){if(i){let f=i(d);if(f===zm)return null;u.setColor(f)}if(r&&u.setWidth(r(d)),o){let f=o(d);if(f!=="butt"&&f!=="round"&&f!=="square")throw new Error("Expected butt, round, or square line cap");u.setLineCap(f)}if(s){let f=s(d);if(f!=="bevel"&&f!=="round"&&f!=="miter")throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(f)}return a&&u.setLineDash(a(d)),l&&u.setLineDashOffset(l(d)),c&&u.setMiterLimit(c(d)),u}}function WU(n,e){let t="text-",r=ls(n,t+"value",e);if(!r)return null;let i=Qd(n,t,e),o=Qd(n,t+"background-",e),s=ef(n,t,e),a=ef(n,t+"background-",e),l=ls(n,t+"font",e),c=mr(n,t+"max-angle",e),u=mr(n,t+"offset-x",e),d=mr(n,t+"offset-y",e),f=Lc(n,t+"overflow",e),h=ls(n,t+"placement",e),p=mr(n,t+"repeat",e),m=fg(n,t+"scale",e),g=Lc(n,t+"rotate-with-view",e),y=mr(n,t+"rotation",e),v=ls(n,t+"align",e),x=ls(n,t+"justify",e),E=ls(n,t+"baseline",e),_=Lc(n,t+"keep-upright",e),w=dA(n,t+"padding",e),b=hg(n,t+"declutter-mode"),M=new ea({declutterMode:b});return function(S){if(M.setText(r(S)),i&&M.setFill(i(S)),o&&M.setBackgroundFill(o(S)),s&&M.setStroke(s(S)),a&&M.setBackgroundStroke(a(S)),l&&M.setFont(l(S)),c&&M.setMaxAngle(c(S)),u&&M.setOffsetX(u(S)),d&&M.setOffsetY(d(S)),f&&M.setOverflow(f(S)),h){let C=h(S);if(C!=="point"&&C!=="line")throw new Error("Expected point or line for text-placement");M.setPlacement(C)}if(p&&M.setRepeat(p(S)),m&&M.setScale(m(S)),g&&M.setRotateWithView(g(S)),y&&M.setRotation(y(S)),v){let C=v(S);if(C!=="left"&&C!=="center"&&C!=="right"&&C!=="end"&&C!=="start")throw new Error("Expected left, right, center, start, or end for text-align");M.setTextAlign(C)}if(x){let C=x(S);if(C!=="left"&&C!=="right"&&C!=="center")throw new Error("Expected left, right, or center for text-justify");M.setJustify(C)}if(E){let C=E(S);if(C!=="bottom"&&C!=="top"&&C!=="middle"&&C!=="alphabetic"&&C!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");M.setTextBaseline(C)}return w&&M.setPadding(w(S)),_&&M.setKeepUpright(_(S)),M}}function XU(n,e){return"icon-src"in n?ZU(n,e):"shape-points"in n?YU(n,e):"circle-radius"in n?KU(n,e):null}function ZU(n,e){let t="icon-",r=t+"src",i=fA(n[r],r),o=ug(n,t+"anchor",e),s=fg(n,t+"scale",e),a=mr(n,t+"opacity",e),l=ug(n,t+"displacement",e),c=mr(n,t+"rotation",e),u=Lc(n,t+"rotate-with-view",e),d=lA(n,t+"anchor-origin"),f=cA(n,t+"anchor-x-units"),h=cA(n,t+"anchor-y-units"),p=n4(n,t+"color"),m=e4(n,t+"cross-origin"),g=t4(n,t+"offset"),y=lA(n,t+"offset-origin"),v=dg(n,t+"width"),x=dg(n,t+"height"),E=QU(n,t+"size"),_=hg(n,t+"declutter-mode"),w=new ra({src:i,anchorOrigin:d,anchorXUnits:f,anchorYUnits:h,color:p,crossOrigin:m,offset:g,offsetOrigin:y,height:x,width:v,size:E,declutterMode:_});return function(b){return a&&w.setOpacity(a(b)),l&&w.setDisplacement(l(b)),c&&w.setRotation(c(b)),u&&w.setRotateWithView(u(b)),s&&w.setScale(s(b)),o&&w.setAnchor(o(b)),w}}function YU(n,e){let t="shape-",r=t+"points",i=t+"radius",o=cw(n[r],r),s=cw(n[i],i),a=Qd(n,t,e),l=ef(n,t,e),c=fg(n,t+"scale",e),u=ug(n,t+"displacement",e),d=mr(n,t+"rotation",e),f=Lc(n,t+"rotate-with-view",e),h=dg(n,t+"radius2"),p=dg(n,t+"angle"),m=hg(n,t+"declutter-mode"),g=new ng({points:o,radius:s,radius2:h,angle:p,declutterMode:m});return function(y){return a&&g.setFill(a(y)),l&&g.setStroke(l(y)),u&&g.setDisplacement(u(y)),d&&g.setRotation(d(y)),f&&g.setRotateWithView(f(y)),c&&g.setScale(c(y)),g}}function KU(n,e){let t="circle-",r=Qd(n,t,e),i=ef(n,t,e),o=mr(n,t+"radius",e),s=fg(n,t+"scale",e),a=ug(n,t+"displacement",e),l=mr(n,t+"rotation",e),c=Lc(n,t+"rotate-with-view",e),u=hg(n,t+"declutter-mode"),d=new lo({radius:5,declutterMode:u});return function(f){return o&&d.setRadius(o(f)),r&&d.setFill(r(f)),i&&d.setStroke(i(f)),a&&d.setDisplacement(a(f)),l&&d.setRotation(l(f)),c&&d.setRotateWithView(c(f)),s&&d.setScale(s(f)),d}}function mr(n,e,t){if(!(e in n))return;let r=fo(n[e],Ae,t);return function(i){return cw(r(i),e)}}function ls(n,e,t){if(!(e in n))return null;let r=fo(n[e],Zn,t);return function(i){return fA(r(i),e)}}function JU(n,e,t){let r=ls(n,e+"pattern-src",t),i=aA(n,e+"pattern-offset",t),o=aA(n,e+"pattern-size",t),s=dw(n,e+"color",t);return function(a){return{src:r(a),offset:i&&i(a),size:o&&o(a),color:s&&s(a)}}}function Lc(n,e,t){if(!(e in n))return null;let r=fo(n[e],Nn,t);return function(i){let o=r(i);if(typeof o!="boolean")throw new Error(`Expected a boolean for ${e}`);return o}}function dw(n,e,t){if(!(e in n))return null;let r=fo(n[e],Dr,t);return function(i){return hA(r(i),e)}}function dA(n,e,t){if(!(e in n))return null;let r=fo(n[e],oa,t);return function(i){return tf(r(i),e)}}function ug(n,e,t){if(!(e in n))return null;let r=fo(n[e],oa,t);return function(i){let o=tf(r(i),e);if(o.length!==2)throw new Error(`Expected two numbers for ${e}`);return o}}function aA(n,e,t){if(!(e in n))return null;let r=fo(n[e],oa,t);return function(i){return pA(r(i),e)}}function fg(n,e,t){if(!(e in n))return null;let r=fo(n[e],oa|Ae,t);return function(i){return r4(r(i),e)}}function dg(n,e){let t=n[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function QU(n,e){let t=n[e];if(t!==void 0){if(typeof t=="number")return Ge(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function e4(n,e){let t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function lA(n,e){let t=n[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function cA(n,e){let t=n[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function t4(n,e){let t=n[e];if(t!==void 0)return tf(t,e)}function hg(n,e){let t=n[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function n4(n,e){let t=n[e];if(t!==void 0)return hA(t,e)}function tf(n,e){if(!Array.isArray(n))throw new Error(`Expected an array for ${e}`);let t=n.length;for(let r=0;r<t;++r)if(typeof n[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return n}function fA(n,e){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}function cw(n,e){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}function hA(n,e){if(typeof n=="string")return n;let t=tf(n,e),r=t.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function pA(n,e){let t=tf(n,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function r4(n,e){return typeof n=="number"?n:pA(n,e)}var Jr={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function fw(n,e,t){return function(r,i,o,s,a){if(!r)return;if(!i&&!e)return r;let l=e?0:o[0]*i,c=e?0:o[1]*i,u=a?a[0]:0,d=a?a[1]:0,f=n[0]+l/2+u,h=n[2]-l/2+u,p=n[1]+c/2+d,m=n[3]-c/2+d;f>h&&(f=(h+f)/2,h=f),p>m&&(p=(m+p)/2,m=p);let g=xe(r[0],f,h),y=xe(r[1],p,m);if(s&&t&&i){let v=30*i;g+=-v*Math.log(1+Math.max(0,f-r[0])/v)+v*Math.log(1+Math.max(0,r[0]-h)/v),y+=-v*Math.log(1+Math.max(0,p-r[1])/v)+v*Math.log(1+Math.max(0,r[1]-m)/v)}return[g,y]}}function mA(n){return n}function hw(n){return Math.pow(n,3)}function Qr(n){return 1-hw(1-n)}function gA(n){return 3*n*n-2*n*n*n}function yA(n){return n}function pw(n,e,t,r){let i=ee(e)/t[0],o=et(e)/t[1];return r?Math.min(n,Math.max(i,o)):Math.min(n,Math.min(i,o))}function mw(n,e,t){let r=Math.min(n,e),i=50;return r*=Math.log(1+i*Math.max(0,n/e-1))/i+1,t&&(r=Math.max(r,t),r/=Math.log(1+i*Math.max(0,t/n-1))/i+1),xe(r,t/2,e*2)}function vA(n,e,t,r){return e=e!==void 0?e:!0,function(i,o,s,a){if(i!==void 0){let l=n[0],c=n[n.length-1],u=t?pw(l,t,s,r):l;if(a)return e?mw(i,u,c):xe(i,c,u);let d=Math.min(u,i),f=Math.floor(oc(n,d,o));return n[f]>u&&f<n.length-1?n[f+1]:n[f]}}}function _A(n,e,t,r,i,o){return r=r!==void 0?r:!0,t=t!==void 0?t:0,function(s,a,l,c){if(s!==void 0){let u=i?pw(e,i,l,o):e;if(c)return r?mw(s,u,t):xe(s,t,u);let d=1e-9,f=Math.ceil(Math.log(e/u)/Math.log(n)-d),h=-a*(.5-d)+.5,p=Math.min(u,s),m=Math.floor(Math.log(e/p)/Math.log(n)+h),g=Math.max(f,m),y=e/Math.pow(n,g);return xe(y,t,u)}}}function gw(n,e,t,r,i){return t=t!==void 0?t:!0,function(o,s,a,l){if(o!==void 0){let c=r?pw(n,r,a,i):n;return!t||!l?xe(o,e,c):mw(o,c,e)}}}function kc(n){if(n!==void 0)return 0}function yw(n){if(n!==void 0)return n}function xA(n){let e=2*Math.PI/n;return function(t,r){if(r)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function EA(n){let e=n===void 0?Si(5):n;return function(t,r){return r||t===void 0?t:Math.abs(t)<=e?0:t}}var vw=0,xw=class extends At{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Tm(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Ax(),e.center&&(e.center=Wn(e.center,this.projection_)),e.extent&&(e.extent=Zr(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){let t=Object.assign({},e);for(let a in Jr)delete t[a];this.setProperties(t,!0);let r=o4(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;let i=i4(e),o=r.constraint,s=s4(e);this.constraints_={center:i,resolution:o,rotation:s},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;let r=this.getCenterInternal();if(r){let i=e||[0,0,0,0];t=t||[0,0,0,0];let o=this.getResolution(),s=o/2*(i[3]-t[3]+t[1]-i[1]),a=o/2*(i[0]-t[0]+t[2]-i[2]);this.setCenterInternal([r[0]+s,r[1]-a])}}getUpdatedOptions_(e){let t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);let t=new Array(arguments.length);for(let r=0;r<t.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Wn(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Wn(i.anchor,this.getProjection())),t[r]=i}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,r;t>1&&typeof arguments[t-1]=="function"&&(r=arguments[t-1],--t);let i=0;for(;i<t&&!this.isDef();++i){let u=arguments[i];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(i===t){r&&pg(r,!0);return}let o=Date.now(),s=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_,c=[];for(;i<t;++i){let u=arguments[i],d={start:o,complete:!1,anchor:u.anchor,duration:u.duration!==void 0?u.duration:1e3,easing:u.easing||gA,callback:r};if(u.center&&(d.sourceCenter=s,d.targetCenter=u.center.slice(),s=d.targetCenter),u.zoom!==void 0?(d.sourceResolution=a,d.targetResolution=this.getResolutionForZoom(u.zoom),a=d.targetResolution):u.resolution&&(d.sourceResolution=a,d.targetResolution=u.resolution,a=d.targetResolution),u.rotation!==void 0){d.sourceRotation=l;let f=Hr(u.rotation-l+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=l+f,l=d.targetRotation}a4(d)?d.complete=!0:o+=d.duration,c.push(d)}this.animations_.push(c),this.setHint(lt.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[lt.ANIMATING]>0}getInteracting(){return this.hints_[lt.INTERACTING]>0}cancelAnimations(){this.setHint(lt.ANIMATING,-this.hints_[lt.ANIMATING]);let e;for(let t=0,r=this.animations_.length;t<r;++t){let i=this.animations_[t];if(i[0].callback&&pg(i[0].callback,!1),!e)for(let o=0,s=i.length;o<s;++o){let a=i[o];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;let e=Date.now(),t=!1;for(let r=this.animations_.length-1;r>=0;--r){let i=this.animations_[r],o=!0;for(let s=0,a=i.length;s<a;++s){let l=i[s];if(l.complete)continue;let c=e-l.start,u=l.duration>0?c/l.duration:1;u>=1?(l.complete=!0,u=1):o=!1;let d=l.easing(u);if(l.sourceCenter){let f=l.sourceCenter[0],h=l.sourceCenter[1],p=l.targetCenter[0],m=l.targetCenter[1];this.nextCenter_=l.targetCenter;let g=f+d*(p-f),y=h+d*(m-h);this.targetCenter_=[g,y]}if(l.sourceResolution&&l.targetResolution){let f=d===1?l.targetResolution:l.sourceResolution+d*(l.targetResolution-l.sourceResolution);if(l.anchor){let h=this.getViewportSize_(this.getRotation()),p=this.constraints_.resolution(f,0,h,!0);this.targetCenter_=this.calculateCenterZoom(p,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=f,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){let f=d===1?Hr(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+d*(l.targetRotation-l.sourceRotation);if(l.anchor){let h=this.constraints_.rotation(f,!0);this.targetCenter_=this.calculateCenterRotate(h,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=f}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(o){this.animations_[r]=null,this.setHint(lt.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;let s=i[0].callback;s&&pg(s,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let r,i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-t[0],i[1]-t[1]],fc(r,e-this.getRotation()),SD(r,t)),r}calculateCenterZoom(e,t){let r,i=this.getCenterInternal(),o=this.getResolution();if(i!==void 0&&o!==void 0){let s=t[0]-e*(t[0]-i[0])/o,a=t[1]-e*(t[1]-i[1])/o;r=[s,a]}return r}getViewportSize_(e){let t=this.viewportSize_;if(e){let r=t[0],i=t[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){let e=this.getCenterInternal();return e&&Ed(e,this.getProjection())}getCenterInternal(){return this.get(Jr.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){let t=this.calculateExtentInternal(e);return Hs(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();let t=this.getCenterInternal();se(t,"The view center is not defined");let r=this.getResolution();se(r!==void 0,"The view resolution is not defined");let i=this.getRotation();return se(i!==void 0,"The view rotation is not defined"),gd(t,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Jr.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(Zr(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();let r=ee(e)/t[0],i=et(e)/t[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;let t=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(t/r)/Math.log(e);return function(o){return t/Math.pow(e,o*i)}}getRotation(){return this.get(Jr.ROTATION)}getValueForResolutionFunction(e){let t=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,o=Math.log(r/i)/t;return function(s){return Math.log(r/s)/t/o}}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e),r=this.padding_;return r&&(t=[t[0]-r[1]-r[3],t[1]-r[0]-r[2]]),t}getState(){let e=this.getProjection(),t=this.getResolution(),r=this.getRotation(),i=this.getCenterInternal(),o=this.padding_;if(o){let s=this.getViewportSizeMinusPadding_();i=_w(i,this.getViewportSize_(),[s[0]/2+o[3],s[1]/2+o[0]],t,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e,t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,r,i;if(this.resolutions_){let o=oc(this.resolutions_,e,1);t=o,r=this.resolutions_[o],o==this.resolutions_.length-1?i=2:i=r/this.resolutions_[o+1]}else r=this.maxResolution_,i=this.zoomFactor_;return t+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];let t=xe(Math.floor(e),0,this.resolutions_.length-2),r=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(r,xe(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let r;if(se(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){se(!Bs(e),"Cannot fit empty extent provided as `geometry`");let i=Zr(e,this.getProjection());r=to(i)}else if(e.getType()==="Circle"){let i=Zr(e.getExtent(),this.getProjection());r=to(i),r.rotate(this.getRotation(),Ht(i))}else{let i=Xr();i?r=e.clone().transform(i,this.getProjection()):r=e}this.fitInternal(r,t)}rotatedExtentForGeometry(e){let t=this.getRotation(),r=Math.cos(t),i=Math.sin(-t),o=e.getFlatCoordinates(),s=e.getStride(),a=1/0,l=1/0,c=-1/0,u=-1/0;for(let d=0,f=o.length;d<f;d+=s){let h=o[d]*r-o[d+1]*i,p=o[d]*i+o[d+1]*r;a=Math.min(a,h),l=Math.min(l,p),c=Math.max(c,h),u=Math.max(u,p)}return[a,l,c,u]}fitInternal(e,t){t=t||{};let r=t.size;r||(r=this.getViewportSizeMinusPadding_());let i=t.padding!==void 0?t.padding:[0,0,0,0],o=t.nearest!==void 0?t.nearest:!1,s;t.minResolution!==void 0?s=t.minResolution:t.maxZoom!==void 0?s=this.getResolutionForZoom(t.maxZoom):s=0;let a=this.rotatedExtentForGeometry(e),l=this.getResolutionForExtentInternal(a,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?s:Math.max(l,s),l=this.getConstrainedResolution(l,o?0:1);let c=this.getRotation(),u=Math.sin(c),d=Math.cos(c),f=Ht(a);f[0]+=(i[1]-i[3])/2*l,f[1]+=(i[0]-i[2])/2*l;let h=f[0]*d-f[1]*u,p=f[1]*d+f[0]*u,m=this.getConstrainedCenter([h,p],l),g=t.callback?t.callback:qo;t.duration!==void 0?this.animateInternal({resolution:l,center:m,duration:t.duration,easing:t.easing},g):(this.targetResolution_=l,this.targetCenter_=m,this.applyTargetState_(!1,!0),pg(g,!0))}centerOn(e,t,r){this.centerOnInternal(Wn(e,this.getProjection()),t,r)}centerOnInternal(e,t,r){this.setCenterInternal(_w(e,t,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,r,i){let o,s=this.padding_;if(s&&e){let a=this.getViewportSizeMinusPadding_(-r),l=_w(e,i,[a[0]/2+s[3],a[1]/2+s[0]],t,r);o=[e[0]-l[0],e[1]-l[1]]}return o}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){let t=Ed(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){let t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&Wn(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){let r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*e,0,i,r);t&&(this.targetCenter_=this.calculateCenterZoom(o,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=Wn(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){let r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);t&&(this.targetCenter_=this.calculateCenterRotate(i,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Wn(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){let r=this.getAnimating()||this.getInteracting()||t,i=this.constraints_.rotation(this.targetRotation_,r),o=this.getViewportSize_(i),s=this.constraints_.resolution(this.targetResolution_,0,o,r),a=this.constraints_.center(this.targetCenter_,s,o,r,this.calculateCenterShift(this.targetCenter_,s,i,o));this.get(Jr.ROTATION)!==i&&this.set(Jr.ROTATION,i),this.get(Jr.RESOLUTION)!==s&&(this.set(Jr.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Jr.CENTER)||!Ka(this.get(Jr.CENTER),a))&&this.set(Jr.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,r){e=e!==void 0?e:200;let i=t||0,o=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(o),a=this.constraints_.resolution(this.targetResolution_,i,s),l=this.constraints_.center(this.targetCenter_,a,s,!1,this.calculateCenterShift(this.targetCenter_,a,o,s));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=o,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==o||!this.getCenterInternal()||!Ka(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:l,resolution:a,duration:e,easing:Qr,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(lt.INTERACTING,1)}endInteraction(e,t,r){r=r&&Wn(r,this.getProjection()),this.endInteractionInternal(e,t,r)}endInteractionInternal(e,t,r){this.getInteracting()&&(this.setHint(lt.INTERACTING,-1),this.resolveConstraints(e,t,r))}getConstrainedCenter(e,t){let r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),r)}getConstrainedZoom(e,t){let r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,t))}getConstrainedResolution(e,t){t=t||0;let r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,r)}};function pg(n,e){setTimeout(function(){n(e)},0)}function i4(n){if(n.extent!==void 0){let t=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return fw(n.extent,n.constrainOnlyCenter,t)}let e=Tm(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&e.isGlobal()){let t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,fw(t,!1,!1)}return mA}function o4(n){let e,t,r,s=n.minZoom!==void 0?n.minZoom:vw,a=n.maxZoom!==void 0?n.maxZoom:28,l=n.zoomFactor!==void 0?n.zoomFactor:2,c=n.multiWorld!==void 0?n.multiWorld:!1,u=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,d=n.showFullExtent!==void 0?n.showFullExtent:!1,f=Tm(n.projection,"EPSG:3857"),h=f.getExtent(),p=n.constrainOnlyCenter,m=n.extent;if(!c&&!m&&f.isGlobal()&&(p=!1,m=h),n.resolutions!==void 0){let g=n.resolutions;t=g[s],r=g[a]!==void 0?g[a]:g[g.length-1],n.constrainResolution?e=vA(g,u,!p&&m,d):e=gw(t,r,u,!p&&m,d)}else{let y=(h?Math.max(ee(h),et(h)):360*Ii.degrees/f.getMetersPerUnit())/256/Math.pow(2,vw),v=y/Math.pow(2,28-vw);t=n.maxResolution,t!==void 0?s=0:t=y/Math.pow(l,s),r=n.minResolution,r===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?r=t/Math.pow(l,a):r=y/Math.pow(l,a):r=v),a=s+Math.floor(Math.log(t/r)/Math.log(l)),r=t/Math.pow(l,a-s),n.constrainResolution?e=_A(l,t,r,u,!p&&m,d):e=gw(t,r,u,!p&&m,d)}return{constraint:e,maxResolution:t,minResolution:r,minZoom:s,zoomFactor:l}}function s4(n){if(n.enableRotation!==void 0?n.enableRotation:!0){let t=n.constrainRotation;return t===void 0||t===!0?EA():t===!1?yw:typeof t=="number"?xA(t):yw}return kc}function a4(n){return!(n.sourceCenter&&n.targetCenter&&!Ka(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function _w(n,e,t,r,i){let o=Math.cos(-i),s=Math.sin(-i),a=n[0]*o-n[1]*s,l=n[1]*o+n[0]*s;a+=(e[0]/2-t[0])*r,l+=(t[1]-e[1]/2)*r,s=-s;let c=a*o-l*s,u=l*o+a*s;return[c,u]}var nn=xw;var ze={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};var Ew=class extends At{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;let t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[ze.OPACITY]=e.opacity!==void 0?e.opacity:1,se(typeof t[ze.OPACITY]=="number","Layer opacity must be a number"),t[ze.VISIBLE]=e.visible!==void 0?e.visible:!0,t[ze.Z_INDEX]=e.zIndex,t[ze.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[ze.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[ze.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[ze.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){let t=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return t.opacity=xe(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=r===void 0&&!t.managed?1/0:r,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return W()}getLayerStatesArray(e){return W()}getExtent(){return this.get(ze.EXTENT)}getMaxResolution(){return this.get(ze.MAX_RESOLUTION)}getMinResolution(){return this.get(ze.MIN_RESOLUTION)}getMinZoom(){return this.get(ze.MIN_ZOOM)}getMaxZoom(){return this.get(ze.MAX_ZOOM)}getOpacity(){return this.get(ze.OPACITY)}getSourceState(){return W()}getVisible(){return this.get(ze.VISIBLE)}getZIndex(){return this.get(ze.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(ze.EXTENT,e)}setMaxResolution(e){this.set(ze.MAX_RESOLUTION,e)}setMinResolution(e){this.set(ze.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(ze.MAX_ZOOM,e)}setMinZoom(e){this.set(ze.MIN_ZOOM,e)}setOpacity(e){se(typeof e=="number","Layer opacity must be a number"),this.set(ze.OPACITY,e)}setVisible(e){this.set(ze.VISIBLE,e)}setZIndex(e){this.set(ze.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},mg=Ew;var ww=class extends mg{constructor(e){let t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(ze.SOURCE,this.handleSourcePropertyChange_);let r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(ze.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){let e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(ce(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;let e=this.getSource();e&&(this.sourceChangeKey_=te(e,H.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0)),this.clearRenderer()),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t,r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof nn?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&r&&(t.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(t.layerStatesArray){if(i=t.layerStatesArray.find(s=>s.layer===this),!i)return!1}else i=this.getLayerState();let o=this.getExtent();return nf(i,t.viewState)&&(!o||Le(o,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];let t=this.getSource()?.getAttributions();if(!t)return[];let r=e instanceof nn?e.getViewStateAndExtent():e,i=t(r);return Array.isArray(i)||(i=[i]),i}render(e,t){let r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){let t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(ze.MAP,e)}getMapInternal(){return this.get(ze.MAP)}setMap(e){this.mapPrecomposeKey_&&(ce(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(ce(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=te(e,_n.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=te(this,H.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){let t=e.frameState.layerStatesArray,r=this.getLayerState(!1);se(!t.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),t.push(r)}setSource(e){this.set(ze.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}};function nf(n,e){if(!n.visible)return!1;let t=e.resolution;if(t<n.minResolution||t>=n.maxResolution)return!1;let r=e.zoom;return r>n.minZoom&&r<=n.maxZoom}var sl=ww;var CA={RENDER_ORDER:"renderOrder"},Cw=class extends sl{constructor(e){e=e||{};let t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(CA.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){let r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new Rc(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(CA.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?FE:e;let t=l4(e);this.styleFunction_=e===null?void 0:zR(t),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}};function l4(n){if(n===void 0)return FE;if(!n)return null;if(typeof n=="function"||n instanceof Xt)return n;if(!Array.isArray(n))return uw([n]);if(n.length===0)return[];let e=n.length,t=n[0];if(t instanceof Xt){let i=new Array(e);for(let o=0;o<e;++o){let s=n[o];if(!(s instanceof Xt))throw new Error("Expected a list of style instances");i[o]=s}return i}if("style"in t){let i=new Array(e);for(let o=0;o<e;++o){let s=n[o];if(!("style"in s))throw new Error("Expected a list of rules with a style property");i[o]=s}return uA(i)}return uw(n)}var jc=Cw;var bw=class extends jc{constructor(e){super(e)}createRenderer(){return new rA(this)}},ho=bw;var N={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var Mw=class extends Os{constructor(e,t,r){super(),r=r||{},this.tileCoord=e,this.state=t,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(H.CHANGE)}release(){this.setState(N.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==N.EMPTY){if(this.state!==N.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){W()}getAlpha(e,t){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=t,this.transitionStarts_[e]=r;else if(r===-1)return 1;let i=t-r+1e3/60;return i>=this.transition_?1:hw(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}},po=Mw;var Tw=class extends po{constructor(e,t,r,i,o,s){super(e,t,s),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_=new Image,i!==null&&(this.image_.crossOrigin=i),this.unlisten_=null,this.tileLoadFunction_=o}getImage(){return this.image_}setImage(e){this.image_=e,this.state=N.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=N.ERROR,this.unlistenImage_(),this.image_=c4(),this.changed()}handleImageLoad_(){let e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=N.LOADED:this.state=N.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==N.ERROR&&(this.state=N.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==N.IDLE&&(this.state=N.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=CR(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}};function c4(){let n=be(1,1);return n.fillStyle="rgba(0,0,0,0)",n.fillRect(0,0,1,1),n.canvas}var gg=Tw;var Sw=class{constructor(e,t,r){this.decay_=e,this.minVelocity_=t,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;let e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let r=t-3;for(;r>0&&this.points_[r+2]>e;)r-=3;let i=this.points_[t+2]-this.points_[r+2];if(i<1e3/60)return!1;let o=this.points_[t]-this.points_[r],s=this.points_[t+1]-this.points_[r+1];return this.angle_=Math.atan2(s,o),this.initialVelocity_=Math.sqrt(o*o+s*s)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},bA=Sw;var Iw=class extends Ut{constructor(e,t,r){super(e),this.map=t,this.frameState=r!==void 0?r:null}},sa=Iw;var Dw=class extends sa{constructor(e,t,r,i,o,s){super(e,t,o),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},ei=Dw;var ke={SINGLECLICK:"singleclick",CLICK:H.CLICK,DBLCLICK:H.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var rf={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var Rw=class extends Os{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;let r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=te(r,rf.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=te(r,rf.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(H.TOUCHMOVE,this.boundHandleTouchMove_,Bm?{passive:!1}:!1)}emulateClick_(e){let t=new ei(ke.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new ei(ke.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;let r=new ei(ke.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){let t=e,r=t.pointerId;if(t.type==ke.POINTERUP||t.type==ke.POINTERCANCEL){delete this.trackedTouches_[r];for(let i in this.trackedTouches_)if(this.trackedTouches_[i].target!==t.target){delete this.trackedTouches_[i];break}}else(t.type==ke.POINTERDOWN||t.type==ke.POINTERMOVE)&&(this.trackedTouches_[r]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);let t=new ei(ke.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(ce),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);let t=new ei(ke.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){let r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(te(r,ke.POINTERMOVE,this.handlePointerMove_,this),te(r,ke.POINTERUP,this.handlePointerUp_,this),te(this.element_,ke.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(te(this.element_.getRootNode(),ke.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;let t=new ei(ke.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;let t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new ei(ke.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){let t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(ce(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(H.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(ce(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(ce),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},MA=Rw;var ti={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"};var Zt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var of=1/0,Aw=class{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,eo(this.queuedElements_)}dequeue(){let e=this.elements_,t=this.priorities_,r=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));let i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){se(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");let t=this.priorityFunction_(e);return t!=of?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){let t=this.elements_,r=this.priorities_,i=t.length,o=t[e],s=r[e],a=e;for(;e<i>>1;){let l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),u=c<i&&r[c]<r[l]?c:l;t[e]=t[u],r[e]=r[u],e=u}t[e]=o,r[e]=s,this.siftDown_(a,e)}siftDown_(e,t){let r=this.elements_,i=this.priorities_,o=r[t],s=i[t];for(;t>e;){let a=this.getParentIndex_(t);if(i[a]>s)r[t]=r[a],i[t]=i[a],t=a;else break}r[t]=o,i[t]=s}reprioritize(){let e=this.priorityFunction_,t=this.elements_,r=this.priorities_,i=0,o=t.length,s,a,l;for(a=0;a<o;++a)s=t[a],l=e(s),l==of?delete this.queuedElements_[this.keyFunction_(s)]:(r[i]=l,t[i++]=s);t.length=i,r.length=i,this.heapify_()}},TA=Aw;var Pw=class extends TA{constructor(e,t){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){let t=super.enqueue(e);return t&&e[0].addEventListener(H.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){let t=e.target,r=t.getState();if(r===N.LOADED||r===N.ERROR||r===N.EMPTY){r!==N.ERROR&&t.removeEventListener(H.CHANGE,this.boundHandleTileChange_);let i=t.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let r=0;for(;this.tilesLoading_<e&&r<t&&this.getCount()>0;){let i=this.dequeue()[0],o=i.getKey();i.getState()===N.IDLE&&!(o in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++r,i.load())}}},SA=Pw;function IA(n,e,t,r,i){if(!n||!(t in n.wantedTiles))return of;if(!n.wantedTiles[t][e.getKey()])return of;let o=n.viewState.center,s=r[0]-o[0],a=r[1]-o[1];return 65536*Math.log(i)+Math.sqrt(s*s+a*a)/i}var Nw=class extends At{constructor(e){super();let t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let t=0,r=this.listenerKeys.length;t<r;++t)ce(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=e,e){let t=this.target_??e.getOverlayContainerStopEvent();this.element&&t.appendChild(this.element),this.render!==qo&&this.listenerKeys.push(te(e,ti.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}},Rr=Nw;var Ow=class extends Rr{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;let t=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:t+"-expand",o=e.collapseLabel!==void 0?e.collapseLabel:"\u203A",s=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof o=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o,this.collapseLabel_.className=s):this.collapseLabel_=o;let a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=i):this.label_=a;let l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(H.CLICK,this.handleClick_.bind(this),!1);let c=t+" "+no+" "+Ks+(this.collapsed_&&this.collapsible_?" "+lE:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=c,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){let t=this.getMap().getAllLayers(),r=new Set(t.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){let i=!t.some(o=>o.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(i)}return Array.from(r)}updateElement_(e){return bs(this,null,function*(){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}let t=yield Promise.all(this.collectSourceAttributions_(e).map(i=>Qi(()=>i))),r=t.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!Dn(t,this.renderedAttributions_)){Gm(this.ulElement_);for(let i=0,o=t.length;i<o;++i){let s=document.createElement("li");s.innerHTML=t[i],this.ulElement_.appendChild(s)}this.renderedAttributions_=t}})}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(lE),this.collapsed_?bc(this.collapseLabel_,this.label_):bc(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}},DA=Ow;var Fw=class extends Rr{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});let t=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"\u21E7",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));let o=e.tipLabel?e.tipLabel:"Reset rotation",s=document.createElement("button");s.className=t+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),s.addEventListener(H.CLICK,this.handleClick_.bind(this),!1);let a=t+" "+no+" "+Ks,l=this.element;l.className=a,l.appendChild(s),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Bd)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){let t=this.getMap().getView();if(!t)return;let r=t.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Qr}):t.setRotation(0))}render(e){let t=e.frameState;if(!t)return;let r=t.viewState.rotation;if(r!=this.rotation_){let i="rotate("+r+"rad)";if(this.autoHide_){let o=this.element.classList.contains(Bd);!o&&r===0?this.element.classList.add(Bd):o&&r!==0&&this.element.classList.remove(Bd)}this.label_.style.transform=i}this.rotation_=r}},RA=Fw;var Lw=class extends Rr{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});let t=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",o=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",s=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"\u2013",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=i,u.setAttribute("type","button"),u.title=l,u.appendChild(typeof s=="string"?document.createTextNode(s):s),u.addEventListener(H.CLICK,this.handleClick_.bind(this,r),!1);let d=document.createElement("button");d.className=o,d.setAttribute("type","button"),d.title=c,d.appendChild(typeof a=="string"?document.createTextNode(a):a),d.addEventListener(H.CLICK,this.handleClick_.bind(this,-r),!1);let f=t+" "+no+" "+Ks,h=this.element;h.className=f,h.appendChild(u),h.appendChild(d),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){let r=this.getMap().getView();if(!r)return;let i=r.getZoom();if(i!==void 0){let o=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:o,duration:this.duration_,easing:Qr})):r.setZoom(o)}}},AA=Lw;function al(n){n=n||{};let e=new $n;return(n.zoom!==void 0?n.zoom:!0)&&e.push(new AA(n.zoomOptions)),(n.rotate!==void 0?n.rotate:!0)&&e.push(new RA(n.rotateOptions)),(n.attribution!==void 0?n.attribution:!0)&&e.push(new DA(n.attributionOptions)),e}var sf={ACTIVE:"active"};var kw=class extends At{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(sf.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(sf.ACTIVE,e)}setMap(e){this.map_=e}};function PA(n,e,t){let r=n.getCenterInternal();if(r){let i=[r[0]+e[0],r[1]+e[1]];n.animateInternal({duration:t!==void 0?t:250,easing:yA,center:n.getConstrainedCenter(i)})}}function Vc(n,e,t,r){let i=n.getZoom();if(i===void 0)return;let o=n.getConstrainedZoom(i+e),s=n.getResolutionForZoom(o);n.getAnimating()&&n.cancelAnimations(),n.animate({resolution:s,anchor:t,duration:r!==void 0?r:250,easing:Qr})}var mo=kw;var jw=class extends mo{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==ke.DBLCLICK){let r=e.originalEvent,i=e.map,o=e.coordinate,s=r.shiftKey?-this.delta_:this.delta_,a=i.getView();Vc(a,s,o,this.duration_),r.preventDefault(),t=!0}return!t}},NA=jw;function af(n){let e=arguments;return function(t){let r=!0;for(let i=0,o=e.length;i<o&&(r=r&&e[i](t),!!r);++i);return r}}var OA=function(n){let e=n.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},u4=function(n){let e=n.map.getTargetElement(),t=e.getRootNode(),r=n.map.getOwnerDocument().activeElement;return t instanceof ShadowRoot?t.host.contains(r):e.contains(r)},yg=function(n){let e=n.map.getTargetElement(),t=e.getRootNode();return(t instanceof ShadowRoot?t.host:e).hasAttribute("tabindex")?u4(n):!0},lf=Ci;var vg=function(n){let e=n.originalEvent;return e instanceof PointerEvent&&e.button==0&&!(pR&&Xx&&e.ctrlKey)},FA=$r;var Bc=function(n){let e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey};var LA=function(n){let e=n.originalEvent;return Xx?e.metaKey:e.ctrlKey},_g=function(n){let e=n.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},xg=function(n){let e=n.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},Eg=function(n){let e=n.originalEvent;return e instanceof PointerEvent&&e.pointerType=="mouse"};var kA=function(n){let e=n.originalEvent;return e instanceof PointerEvent&&e.isPrimary&&e.button===0};var Vw=class extends mo{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==ke.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==ke.POINTERUP){let r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==ke.POINTERDOWN){let r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==ke.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}};function Gc(n){let e=n.length,t=0,r=0;for(let i=0;i<e;i++)t+=n[i].clientX,r+=n[i].clientY;return{clientX:t/e,clientY:r/e}}var ni=Vw;var Bw=class extends ni{constructor(e){super({stopDown:$r}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;let t=e.condition?e.condition:af(Bc,kA);this.condition_=e.onFocusOnly?af(yg,t):t,this.noKinetic_=!1}handleDragEvent(e){let t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());let r=this.targetPointers,i=t.getEventPixel(Gc(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){let o=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],a=e.map.getView();ID(o,a.getResolution()),fc(o,a.getRotation()),a.adjustCenterInternal(o)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){let t=e.map,r=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){let i=this.kinetic_.getDistance(),o=this.kinetic_.getAngle(),s=r.getCenterInternal(),a=t.getPixelFromCoordinateInternal(s),l=t.getCoordinateFromPixelInternal([a[0]-i*Math.cos(o),a[1]-i*Math.sin(o)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:Qr})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){let r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},jA=Bw;var Gw=class extends ni{constructor(e){e=e||{},super({stopDown:$r}),this.condition_=e.condition?e.condition:OA,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!Eg(e))return;let t=e.map,r=t.getView();if(r.getConstraints().rotation===kc)return;let i=t.getSize(),o=e.pixel,s=Math.atan2(i[1]/2-o[1],o[0]-i[0]/2);if(this.lastAngle_!==void 0){let a=s-this.lastAngle_;r.adjustRotationInternal(-a)}this.lastAngle_=s}handleUpEvent(e){return Eg(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return Eg(e)&&vg(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}},VA=Gw;var Uw=class extends Ns{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){let e=this.startPixel_,t=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],t[0])+r,i.top=Math.min(e[1],t[1])+r,i.width=Math.abs(t[0]-e[0])+r,i.height=Math.abs(t[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);let t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;let e=this.startPixel_,t=this.endPixel_,i=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new An([i])}getGeometry(){return this.geometry_}},BA=Uw;var Uc={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},ll=class extends Ut{constructor(e,t,r){super(e),this.coordinate=t,this.mapBrowserEvent=r}},zw=class extends ni{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new BA(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??vg,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,r){let i=r[0]-t[0],o=r[1]-t[1];return i*i+o*o>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new ll(Uc.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;let t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new ll(t?Uc.BOXEND:Uc.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ll(Uc.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new ll(Uc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new ll(Uc.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}},GA=zw;var $w=class extends GA{constructor(e){e=e||{};let t=e.condition?e.condition:_g;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){let r=this.getMap().getView(),i=this.getGeometry();if(this.out_){let o=r.rotatedExtentForGeometry(i),s=r.getResolutionForExtentInternal(o),a=r.getResolution()/s;i=i.clone(),i.scale(a*a)}r.fitInternal(i,{duration:this.duration_,easing:Qr})}},UA=$w;var aa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};var Hw=class extends mo{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return Bc(t)&&xg(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==H.KEYDOWN){let r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==aa.DOWN||i==aa.LEFT||i==aa.RIGHT||i==aa.UP)){let s=e.map.getView(),a=s.getResolution()*this.pixelDelta_,l=0,c=0;i==aa.DOWN?c=-a:i==aa.LEFT?l=-a:i==aa.RIGHT?l=a:c=a;let u=[l,c];fc(u,s.getRotation()),PA(s,u,this.duration_),r.preventDefault(),t=!0}}return!t}},zA=Hw;var qw=class extends mo{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!LA(t)&&xg(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==H.KEYDOWN||e.type==H.KEYPRESS){let r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){let o=e.map,s=i==="+"?this.delta_:-this.delta_,a=o.getView();Vc(a,s,void 0,this.duration_),r.preventDefault(),t=!0}}return!t}},$A=qw;var Ww=class extends mo{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;let t=e.condition?e.condition:lf;this.condition_=e.onFocusOnly?af(yg,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;let e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==H.WHEEL)return!0;let r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let o;if(e.type==H.WHEEL&&(o=i.deltaY,i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(o*=40)),o===0)return!1;this.lastDelta_=o;let s=Date.now();this.startTime_===void 0&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(o)<4?"trackpad":"wheel");let a=r.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-o/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=s,!1;this.totalDelta_+=o;let l=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){let t=e.getView();t.getAnimating()&&t.cancelAnimations();let r=-xe(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),Vc(t,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}},HA=Ww;var Xw=class extends ni{constructor(e){e=e||{};let t=e;t.stopDown||(t.stopDown=$r),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0,r=this.targetPointers[0],i=this.targetPointers[1],o=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){let l=o-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=o;let s=e.map,a=s.getView();a.getConstraints().rotation!==kc&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Gc(this.targetPointers))),this.rotating_&&(s.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){let t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}},qA=Xw;var Zw=class extends ni{constructor(e){e=e||{};let t=e;t.stopDown||(t.stopDown=$r),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1,r=this.targetPointers[0],i=this.targetPointers[1],o=r.clientX-i.clientX,s=r.clientY-i.clientY,a=Math.sqrt(o*o+s*s);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;let l=e.map,c=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Gc(this.targetPointers))),l.render(),c.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){let r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){let t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}},WA=Zw;function XA(n){n=n||{};let e=new $n,t=new bA(-.005,.05,100);return(n.altShiftDragRotate!==void 0?n.altShiftDragRotate:!0)&&e.push(new VA),(n.doubleClickZoom!==void 0?n.doubleClickZoom:!0)&&e.push(new NA({delta:n.zoomDelta,duration:n.zoomDuration})),(n.dragPan!==void 0?n.dragPan:!0)&&e.push(new jA({onFocusOnly:n.onFocusOnly,kinetic:t})),(n.pinchRotate!==void 0?n.pinchRotate:!0)&&e.push(new qA),(n.pinchZoom!==void 0?n.pinchZoom:!0)&&e.push(new WA({duration:n.zoomDuration})),(n.keyboard!==void 0?n.keyboard:!0)&&(e.push(new zA),e.push(new $A({delta:n.zoomDelta,duration:n.zoomDuration}))),(n.mouseWheelZoom!==void 0?n.mouseWheelZoom:!0)&&e.push(new HA({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(n.shiftDragZoom!==void 0?n.shiftDragZoom:!0)&&e.push(new UA({duration:n.zoomDuration})),e}var Pi=class extends Ut{constructor(e,t){super(e),this.layer=t}},Yw={LAYERS:"layers"},Kw=class n extends mg{constructor(e){e=e||{};let t=Object.assign({},e);delete t.layers;let r=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Yw.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new $n(r.slice(),{unique:!0}):se(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new $n(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(ce),this.layersListenerKeys_.length=0;let e=this.getLayers();this.layersListenerKeys_.push(te(e,cn.ADD,this.handleLayersAdd_,this),te(e,cn.REMOVE,this.handleLayersRemove_,this));for(let r in this.listenerKeys_)this.listenerKeys_[r].forEach(ce);eo(this.listenerKeys_);let t=e.getArray();for(let r=0,i=t.length;r<i;r++){let o=t[r];this.registerLayerListeners_(o),this.dispatchEvent(new Pi("addlayer",o))}this.changed()}registerLayerListeners_(e){let t=[te(e,wi.PROPERTYCHANGE,this.handleLayerChange_,this),te(e,H.CHANGE,this.handleLayerChange_,this)];e instanceof n&&t.push(te(e,"addlayer",this.handleLayerGroupAdd_,this),te(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[X(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Pi("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Pi("removelayer",e.layer))}handleLayersAdd_(e){let t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Pi("addlayer",t)),this.changed()}handleLayersRemove_(e){let t=e.element,r=X(t);this.listenerKeys_[r].forEach(ce),delete this.listenerKeys_[r],this.dispatchEvent(new Pi("removelayer",t)),this.changed()}getLayers(){return this.get(Yw.LAYERS)}setLayers(e){let t=this.getLayers();if(t){let r=t.getArray();for(let i=0,o=r.length;i<o;++i)this.dispatchEvent(new Pi("removelayer",r[i]))}this.set(Yw.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){let t=e!==void 0?e:[],r=t.length;this.getLayers().forEach(function(s){s.getLayerStatesArray(t)});let i=this.getLayerState(),o=i.zIndex;!e&&i.zIndex===void 0&&(o=0);for(let s=r,a=t.length;s<a;s++){let l=t[s];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=Qt(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=o)}return t}getSourceState(){return"ready"}},cf=Kw;var Jw=class extends Ns{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){W()}calculateMatrices2D(e){let t=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;yn(r,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),Dm(i,r)}forEachFeatureAtCoordinate(e,t,r,i,o,s,a,l){let c,u=t.viewState;function d(E,_,w,b){return o.call(s,_,E?w:null,b)}let f=u.projection,h=hc(e.slice(),f),p=[[0,0]];if(f.canWrapX()&&i){let E=f.getExtent(),_=ee(E);p.push([-_,0],[_,0])}let m=t.layerStatesArray,g=m.length,y=[],v=[];for(let E=0;E<p.length;E++)for(let _=g-1;_>=0;--_){let w=m[_],b=w.layer;if(b.hasRenderer()&&nf(w,u)&&a.call(l,b)){let M=b.getRenderer(),S=b.getSource();if(M&&S){let C=S.getWrapX()?h:e,R=d.bind(null,w.managed);v[0]=C[0]+p[E][0],v[1]=C[1]+p[E][1],c=M.forEachFeatureAtCoordinate(v,t,r,R,y)}if(c)return c}}if(y.length===0)return;let x=1/y.length;return y.forEach((E,_)=>E.distanceSq+=_*x),y.sort((E,_)=>E.distanceSq-_.distanceSq),y.some(E=>c=E.callback(E.feature,E.layer,E.geometry)),c}hasFeatureAtCoordinate(e,t,r,i,o,s){return this.forEachFeatureAtCoordinate(e,t,r,i,Ci,this,o,s)!==void 0}getMap(){return this.map_}renderFrame(e){W()}scheduleExpireIconCache(e){Pn.canExpireCache()&&e.postRenderFunctions.push(d4)}};function d4(n,e){Pn.expire()}var ZA=Jw;var Qw=class extends ZA{constructor(e){super(e),this.fontChangeListenerKey_=te(Kr,wi.PROPERTYCHANGE,e.redrawText,e),this.element_=document.createElement("div");let t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=no+" ol-layers";let r=e.getViewport();r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){let r=this.getMap();if(r.hasListener(e)){let i=new ag(e,void 0,t);r.dispatchEvent(i)}}disposeInternal(){ce(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(_n.PRECOMPOSE,e);let t=e.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);t.some(a=>a.layer instanceof jc&&a.layer.getDeclutter())&&(e.declutter={});let i=e.viewState;this.children_.length=0;let o=[],s=null;for(let a=0,l=t.length;a<l;++a){let c=t[a];e.layerIndex=a;let u=c.layer,d=u.getSourceState();if(!nf(c,i)||d!="ready"&&d!="undefined"){u.unrender();continue}let f=u.render(e,s);f&&(f!==s&&(this.children_.push(f),s=f),o.push(c))}this.declutter(e,o),vR(this.element_,this.children_),this.dispatchRenderEvent(_n.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){if(e.declutter){for(let r=t.length-1;r>=0;--r){let i=t[r],o=i.layer;o.getDeclutter()&&o.renderDeclutter(e,i)}t.forEach(r=>r.layer.renderDeferred(e))}}},YA=Qw;function KA(n){if(n instanceof sl){n.setMapInternal(null);return}n instanceof cf&&n.getLayers().forEach(KA)}function JA(n,e){if(n instanceof sl){n.setMapInternal(e);return}if(n instanceof cf){let t=n.getLayers().getArray();for(let r=0,i=t.length;r<i;++r)JA(t[r],e)}}var e1=class extends At{constructor(e){super(),e=e||{},this.on,this.once,this.un;let t=f4(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:mR,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=qt(),this.pixelToCoordinateTransform_=qt(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||al(),this.interactions=t.interactions||XA({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new SA(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Zt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Zt.VIEW,this.handleViewChanged_),this.addChangeListener(Zt.SIZE,this.handleSizeChanged_),this.addChangeListener(Zt.TARGET,this.handleTargetChanged_),this.setProperties(t.values);let r=this;e.view&&!(e.view instanceof nn)&&e.view.then(function(i){r.setView(new nn(i))}),this.controls.addEventListener(cn.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(cn.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(cn.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(cn.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(cn.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(cn.REMOVE,i=>{let o=i.element.getId();o!==void 0&&delete this.overlayIdIndex_[o.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){JA(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){let t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,r){if(!this.frameState_||!this.renderer_)return;let i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};let o=r.hitTolerance!==void 0?r.hitTolerance:0,s=r.layerFilter!==void 0?r.layerFilter:Ci,a=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,o,a,t,null,s,null)}getFeaturesAtPixel(e,t){let r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},t),r}getAllLayers(){let e=[];function t(r){r.forEach(function(i){i instanceof cf?t(i.getLayers()):e.push(i)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;let r=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};let i=t.layerFilter!==void 0?t.layerFilter:Ci,o=t.hitTolerance!==void 0?t.hitTolerance:0,s=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,o,s,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){let r=this.viewport_.getBoundingClientRect(),i=this.getSize(),o=r.width/i[0],s=r.height/i[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-r.left)/o,(a.clientY-r.top)/s]}getTarget(){return this.get(Zt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Ed(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){let t=this.frameState_;return t?dt(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){let t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Zt.LAYERGROUP)}setLayers(e){let t=this.getLayerGroup();if(e instanceof $n){t.setLayers(e);return}let r=t.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){let e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){let i=e[t];if(!i.visible)continue;let o=i.layer.getRenderer();if(o&&!o.ready)return!0;let s=i.layer.getSource();if(s&&s.loading)return!0}return!1}getPixelFromCoordinate(e){let t=Wn(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){let t=this.frameState_;return t?dt(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Zt.SIZE)}getView(){return this.get(Zt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){let e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,r,i){return IA(this.frameState_,e,t,r,i)}handleBrowserEvent(e,t){t=t||e.type;let r=new ei(t,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;let t=e.originalEvent,r=t.type;if(r===rf.POINTERDOWN||r===H.WHEEL||r===H.KEYDOWN){let i=this.getOwnerDocument(),o=this.viewport_.getRootNode?this.viewport_.getRootNode():i,s=t.target,a=o instanceof ShadowRoot?o.host===s?o.host.ownerDocument:o:o===i?i.documentElement:o;if(this.overlayContainerStopEvent_.contains(s)||!a.contains(s))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){let i=this.getInteractions().getArray().slice();for(let o=i.length-1;o>=0;o--){let s=i[o];if(s.getMap()!==this||!s.getActive()||!this.getTargetElement())continue;if(!s.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){let e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let i=this.maxTilesLoading_,o=i;if(e){let s=e.viewHints;if(s[lt.ANIMATING]||s[lt.INTERACTING]){let a=Date.now()-e.time>8;i=a?0:8,o=a?0:2}}t.getTilesLoading()<i&&(t.reprioritize(),t.loadMoreTiles(i,o))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(_n.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(_n.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new sa(ti.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new sa(ti.LOADSTART,this,e))));let r=this.postRenderFunctions_;if(e)for(let i=0,o=r.length;i<o;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,i=this.targetChangeHandlerKeys_.length;r<i;++r)ce(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(H.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(H.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);let r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}let e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new YA(this)),this.mapBrowserEventHandler_=new MA(this,this.moveTolerance_);for(let o in ke)this.mapBrowserEventHandler_.addEventListener(ke[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(H.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(H.WHEEL,this.boundHandleBrowserEvent_,Bm?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{let o=t.getRootNode();r=o instanceof ShadowRoot?o.host:t}this.targetChangeHandlerKeys_=[te(r,H.KEYDOWN,this.handleBrowserEvent,this),te(r,H.KEYPRESS,this.handleBrowserEvent,this)];let i=t.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(t)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(ce(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ce(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);let e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=te(e,wi.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=te(e,H.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ce),this.layerGroupPropertyListenerKeys_=null);let e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Pi("addlayer",e)),this.layerGroupPropertyListenerKeys_=[te(e,wi.PROPERTYCHANGE,this.render,this),te(e,H.CHANGE,this.render,this),te(e,"addlayer",this.handleLayerAdd_,this),te(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){let e=this.getLayerGroup().getLayerStatesArray();for(let t=0,r=e.length;t<r;++t){let i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){KA(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){let t=this.getSize(),r=this.getView(),i=this.frameState_,o=null;if(t!==void 0&&RE(t)&&r&&r.isDef()){let s=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=r.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:gd(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:s,wantedTiles:{},mapId:X(this),renderTargets:{}},a.nextCenter&&a.nextResolution){let l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;o.nextExtent=gd(a.nextCenter,a.nextResolution,l,t)}}this.frameState_=o,this.renderer_.renderFrame(o),o&&(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),i&&(!this.previousExtent_||!Bs(this.previousExtent_)&&!Ti(o.extent,this.previousExtent_))&&(this.dispatchEvent(new sa(ti.MOVESTART,this,i)),this.previousExtent_=Wo(this.previousExtent_)),this.previousExtent_&&!o.viewHints[lt.ANIMATING]&&!o.viewHints[lt.INTERACTING]&&!Ti(o.extent,this.previousExtent_)&&(this.dispatchEvent(new sa(ti.MOVEEND,this,o)),hm(o.extent,this.previousExtent_))),this.dispatchEvent(new sa(ti.POSTRENDER,this,o)),this.renderComplete_=(this.hasListener(ti.LOADSTART)||this.hasListener(ti.LOADEND)||this.hasListener(_n.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){let t=this.getLayerGroup();t&&this.handleLayerRemove_(new Pi("removelayer",t)),this.set(Zt.LAYERGROUP,e)}setSize(e){this.set(Zt.SIZE,e)}setTarget(e){this.set(Zt.TARGET,e)}setView(e){if(!e||e instanceof nn){this.set(Zt.VIEW,e);return}this.set(Zt.VIEW,new nn);let t=this;e.then(function(r){t.setView(new nn(r))})}updateSize(){let e=this.getTargetElement(),t;if(e){let i=getComputedStyle(e),o=e.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),s=e.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);!isNaN(o)&&!isNaN(s)&&(t=[Math.max(0,o),Math.max(0,s)],!RE(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&vm("No map visible because the map container's width or height are 0."))}let r=this.getSize();t&&(!r||!Dn(t,r))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){let t=this.getView();t&&t.setViewportSize(e)}};function f4(n){let e=null;n.keyboardEventTarget!==void 0&&(e=typeof n.keyboardEventTarget=="string"?document.getElementById(n.keyboardEventTarget):n.keyboardEventTarget);let t={},r=n.layers&&typeof n.layers.getLayers=="function"?n.layers:new cf({layers:n.layers});t[Zt.LAYERGROUP]=r,t[Zt.TARGET]=n.target,t[Zt.VIEW]=n.view instanceof nn?n.view:new nn;let i;n.controls!==void 0&&(Array.isArray(n.controls)?i=new $n(n.controls.slice()):(se(typeof n.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=n.controls));let o;n.interactions!==void 0&&(Array.isArray(n.interactions)?o=new $n(n.interactions.slice()):(se(typeof n.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),o=n.interactions));let s;return n.overlays!==void 0?Array.isArray(n.overlays)?s=new $n(n.overlays.slice()):(se(typeof n.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),s=n.overlays):s=new $n,{controls:i,interactions:o,keyboardEventTarget:e,overlays:s,values:t}}var go=e1;var On={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},t1=class extends At{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+SR,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(On.ELEMENT,this.handleElementChanged),this.addChangeListener(On.MAP,this.handleMapChanged),this.addChangeListener(On.OFFSET,this.handleOffsetChanged),this.addChangeListener(On.POSITION,this.handlePositionChanged),this.addChangeListener(On.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(On.ELEMENT)}getId(){return this.id}getMap(){return this.get(On.MAP)||null}getOffset(){return this.get(On.OFFSET)}getPosition(){return this.get(On.POSITION)}getPositioning(){return this.get(On.POSITIONING)}handleElementChanged(){Gm(this.element);let e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(this.element?.remove(),ce(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);let e=this.getMap();if(e){this.mapPostrenderListenerKey=te(e,ti.POSTRENDER,this.render,this),this.updatePixelPosition();let t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(On.ELEMENT,e)}setMap(e){this.set(On.MAP,e)}setOffset(e){this.set(On.OFFSET,e)}setPosition(e){this.set(On.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){let t=this.getMap();if(!t||!t.getTargetElement()||!this.get(On.POSITION))return;let r=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),o=this.getRect(i,[gR(i),yR(i)]);e=e||{};let s=e.margin===void 0?20:e.margin;if(!Mi(r,o)){let a=o[0]-r[0],l=r[2]-o[2],c=o[1]-r[1],u=r[3]-o[3],d=[0,0];if(a<0?d[0]=a-s:l<0&&(d[0]=Math.abs(l)+s),c<0?d[1]=c-s:u<0&&(d[1]=Math.abs(u)+s),d[0]!==0||d[1]!==0){let f=t.getView().getCenterInternal(),h=t.getPixelFromCoordinateInternal(f);if(!h)return;let p=[h[0]+d[0],h[1]+d[1]],m=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(p),duration:m.duration,easing:m.easing})}}}getRect(e,t){let r=e.getBoundingClientRect(),i=r.left+window.pageXOffset,o=r.top+window.pageYOffset;return[i,o,i+t[0],o+t[1]]}setPositioning(e){this.set(On.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){let e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}let r=e.getPixelFromCoordinate(t),i=e.getSize();this.updateRenderedPosition(r,i)}updateRenderedPosition(e,t){let r=this.element.style,i=this.getOffset(),o=this.getPositioning();this.setVisible(!0);let s=Math.round(e[0]+i[0])+"px",a=Math.round(e[1]+i[1])+"px",l="0%",c="0%";o=="bottom-right"||o=="center-right"||o=="top-right"?l="-100%":(o=="bottom-center"||o=="center-center"||o=="top-center")&&(l="-50%"),o=="bottom-left"||o=="bottom-center"||o=="bottom-right"?c="-100%":(o=="center-left"||o=="center-center"||o=="center-right")&&(c="-50%");let u=`translate(${l}, ${c}) translate(${s}, ${a})`;this.rendered.transform_!=u&&(this.rendered.transform_=u,r.transform=u)}getOptions(){return this.options}},n1=t1;var wg=class{constructor(e,t,r,i){this.minX=e,this.maxX=t,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}};function cl(n,e,t,r,i){return i!==void 0?(i.minX=n,i.maxX=e,i.minY=t,i.maxY=r,i):new wg(n,e,t,r)}var Cg=wg;var QA=[],r1=class extends po{constructor(e,t,r,i,o){super(e,t,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=i.bind(void 0,this),this.removeSourceTiles_=o,this.wrappedTileCoord=r}getContext(){return this.context_||(this.context_=be(1,1,QA)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(e){let t=X(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){this.context_&&(Qo(this.context_),QA.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}},eP=r1;var i1=class extends po{constructor(e,t,r,i,o,s){super(e,t,s),this.extent=null,this.format_=i,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=o,this.url_=r,this.key=r}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==N.IDLE&&(this.setState(N.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,t){this.setFeatures(e)}onError(){this.setState(N.ERROR)}setFeatures(e){this.features_=e,this.setState(N.LOADED)}setLoader(e){this.loader_=e}},uf=i1;var tP=["fullscreenchange","webkitfullscreenchange"],nP={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"},o1=class extends Rr{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target}),this.on,this.once,this.un,this.keys_=e.keys!==void 0?e.keys:!1,this.source_=e.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=e.className!==void 0?e.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=e.activeClassName!==void 0?e.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=e.inactiveClassName!==void 0?e.inactiveClassName.split(" "):[this.cssClassName_+"-false"];let t=e.label!==void 0?e.label:"\u2922";this.labelNode_=typeof t=="string"?document.createTextNode(t):t;let r=e.labelActive!==void 0?e.labelActive:"\xD7";this.labelActiveNode_=typeof r=="string"?document.createTextNode(r):r;let i=e.tipLabel?e.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=i,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener(H.CLICK,this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${no} ${Ks}`,this.element.appendChild(this.button_)}handleClick_(e){e.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){let e=this.getMap();if(!e)return;let t=e.getOwnerDocument();if(rP(t))if(iP(t))p4(t);else{let r;this.source_?r=typeof this.source_=="string"?t.getElementById(this.source_):this.source_:r=e.getTargetElement(),this.keys_?h4(r):oP(r)}}handleFullScreenChange_(){let e=this.getMap();if(!e)return;let t=this.isInFullscreen_;this.isInFullscreen_=iP(e.getOwnerDocument()),t!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(bc(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(nP.ENTERFULLSCREEN)):(bc(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(nP.LEAVEFULLSCREEN)),e.updateSize())}setClassName_(e,t){t?(e.classList.remove(...this.inactiveClassName_),e.classList.add(...this.activeClassName_)):(e.classList.remove(...this.activeClassName_),e.classList.add(...this.inactiveClassName_))}setMap(e){let t=this.getMap();t&&t.removeChangeListener(Zt.TARGET,this.boundHandleMapTargetChange_),super.setMap(e),this.handleMapTargetChange_(),e&&e.addChangeListener(Zt.TARGET,this.boundHandleMapTargetChange_)}handleMapTargetChange_(){let e=this.documentListeners_;for(let r=0,i=e.length;r<i;++r)ce(e[r]);e.length=0;let t=this.getMap();if(t){let r=t.getOwnerDocument();rP(r)?this.element.classList.remove(aE):this.element.classList.add(aE);for(let i=0,o=tP.length;i<o;++i)e.push(te(r,tP[i],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}};function rP(n){let e=n.body;return!!(e.webkitRequestFullscreen||e.requestFullscreen&&n.fullscreenEnabled)}function iP(n){return!!(n.webkitIsFullScreen||n.fullscreenElement)}function oP(n){n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()}function h4(n){n.webkitRequestFullscreen?n.webkitRequestFullscreen():oP(n)}function p4(n){n.exitFullscreen?n.exitFullscreen():n.webkitExitFullscreen&&n.webkitExitFullscreen()}var s1=o1;function bg(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function df(n,e,t,r,i,o,s){s=s??bg();let a=1/(n-e),l=1/(t-r),c=1/(i-o);return s[0]=-2*a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*l,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*c,s[11]=0,s[12]=(n+e)*a,s[13]=(r+t)*l,s[14]=(o+i)*c,s[15]=1,s}function a1(n,e,t,r,i){return i=i??bg(),i[0]=n[0]*e,i[1]=n[1]*e,i[2]=n[2]*e,i[3]=n[3]*e,i[4]=n[4]*t,i[5]=n[5]*t,i[6]=n[6]*t,i[7]=n[7]*t,i[8]=n[8]*r,i[9]=n[9]*r,i[10]=n[10]*r,i[11]=n[11]*r,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i}function sP(n,e,t,r,i){i=i??bg();let o,s,a,l,c,u,d,f,h,p,m,g;return n===i?(i[12]=n[0]*e+n[4]*t+n[8]*r+n[12],i[13]=n[1]*e+n[5]*t+n[9]*r+n[13],i[14]=n[2]*e+n[6]*t+n[10]*r+n[14],i[15]=n[3]*e+n[7]*t+n[11]*r+n[15]):(o=n[0],s=n[1],a=n[2],l=n[3],c=n[4],u=n[5],d=n[6],f=n[7],h=n[8],p=n[9],m=n[10],g=n[11],i[0]=o,i[1]=s,i[2]=a,i[3]=l,i[4]=c,i[5]=u,i[6]=d,i[7]=f,i[8]=h,i[9]=p,i[10]=m,i[11]=g,i[12]=o*e+c*t+h*r+n[12],i[13]=s*e+u*t+p*r+n[13],i[14]=a*e+d*t+m*r+n[14],i[15]=l*e+f*t+g*r+n[15]),i}function aP(n,e,t,r){return r=r??bg(),r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=n,r[13]=e,r[14]=t,r[15]=1,r}function $c(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageBitmap?n:null}function cP(n){return n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Float32Array||n instanceof DataView?n:null}var m4=new Error("disposed"),zc=null;function uP(n){zc||(zc=be(n.width,n.height,void 0,{willReadFrequently:!0}));let e=zc.canvas,t=n.width;e.width!==t&&(e.width=t);let r=n.height;return e.height!==r&&(e.height=r),zc.clearRect(0,0,t,r),zc.drawImage(n,0,0),zc.getImageData(0,0,t,r).data}var g4=[256,256],l1=class extends po{constructor(e){let t=N.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;let e=$c(this.data_);return e?[e.width,e.height]:g4}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==N.IDLE&&this.state!==N.ERROR)return;this.state=N.LOADING,this.changed();let e=this;this.loader_().then(function(t){e.data_=t,e.state=N.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=N.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(m4),this.controller_=null),super.disposeInternal()}},ul=l1;var c1,dl=[];function dP(n,e,t,r,i){n.beginPath(),n.moveTo(0,0),n.lineTo(e,t),n.lineTo(r,i),n.closePath(),n.save(),n.clip(),n.fillRect(0,0,Math.max(e,r)+1,Math.max(t,i)),n.restore()}function u1(n,e){return Math.abs(n[e*4]-210)>2||Math.abs(n[e*4+3]-.75*255)>2}function y4(){if(c1===void 0){let n=be(6,6,dl);n.globalCompositeOperation="lighter",n.fillStyle="rgba(210, 0, 0, 0.75)",dP(n,4,5,4,0),dP(n,4,5,0,5);let e=n.getImageData(0,0,3,3).data;c1=u1(e,0)||u1(e,4)||u1(e,8),Qo(n),dl.push(n.canvas)}return c1}function fP(n,e,t,r){let i=Jo(t,e,n),o=$s(e,r,t),s=e.getMetersPerUnit();s!==void 0&&(o*=s);let a=n.getMetersPerUnit();a!==void 0&&(o/=a);let l=n.getExtent();if(!l||bi(l,i)){let c=$s(n,o,i)/o;isFinite(c)&&c>0&&(o/=c)}return o}function Mg(n,e,t,r){let i=Ht(t),o=fP(n,e,i,r);return(!isFinite(o)||o<=0)&&uc(t,function(s){return o=fP(n,e,s,r),isFinite(o)&&o>0}),o}function hP(n,e,t,r,i,o,s,a,l,c,u,d,f,h){let p=be(Math.round(t*n),Math.round(t*e),dl);if(d||(p.imageSmoothingEnabled=!1),l.length===0)return p.canvas;p.scale(t,t);function m(_){return Math.round(_*t)/t}p.globalCompositeOperation="lighter";let g=wt();l.forEach(function(_,w,b){Ls(g,_.extent)});let y,v=t/r,x=(d?1:1+Math.pow(2,-24))/v;if(!f||l.length!==1||c!==0){if(y=be(Math.round(ee(g)*v),Math.round(et(g)*v),dl),d||(y.imageSmoothingEnabled=!1),i&&h){let _=(i[0]-g[0])*v,w=-(i[3]-g[3])*v,b=ee(i)*v,M=et(i)*v;y.rect(_,w,b,M),y.clip()}l.forEach(function(_,w,b){if(_.image.width>0&&_.image.height>0){if(_.clipExtent){y.save();let T=(_.clipExtent[0]-g[0])*v,I=-(_.clipExtent[3]-g[3])*v,B=ee(_.clipExtent)*v,j=et(_.clipExtent)*v;y.rect(d?T:Math.round(T),d?I:Math.round(I),d?B:Math.round(T+B)-Math.round(T),d?j:Math.round(I+j)-Math.round(I)),y.clip()}let M=(_.extent[0]-g[0])*v,S=-(_.extent[3]-g[3])*v,C=ee(_.extent)*v,R=et(_.extent)*v;y.drawImage(_.image,c,c,_.image.width-2*c,_.image.height-2*c,d?M:Math.round(M),d?S:Math.round(S),d?C:Math.round(M+C)-Math.round(M),d?R:Math.round(S+R)-Math.round(S)),_.clipExtent&&y.restore()}})}let E=ut(s);return a.getTriangles().forEach(function(_,w,b){let M=_.source,S=_.target,C=M[0][0],R=M[0][1],T=M[1][0],I=M[1][1],B=M[2][0],j=M[2][1],$=m((S[0][0]-E[0])/o),V=m(-(S[0][1]-E[1])/o),q=m((S[1][0]-E[0])/o),D=m(-(S[1][1]-E[1])/o),Z=m((S[2][0]-E[0])/o),ie=m(-(S[2][1]-E[1])/o),O=C,we=R;C=0,R=0,T-=O,I-=we,B-=O,j-=we;let _e=[[T,I,0,0,q-$],[B,j,0,0,Z-$],[0,0,T,I,D-V],[0,0,B,j,ie-V]],ge=MD(_e);if(!ge)return;if(p.save(),p.beginPath(),y4()||!d){p.moveTo(q,D);let Pe=4,St=$-q,z=V-D;for(let It=0;It<Pe;It++)p.lineTo(q+m((It+1)*St/Pe),D+m(It*z/(Pe-1))),It!=Pe-1&&p.lineTo(q+m((It+1)*St/Pe),D+m((It+1)*z/(Pe-1)));p.lineTo(Z,ie)}else p.moveTo(q,D),p.lineTo($,V),p.lineTo(Z,ie);p.clip(),p.transform(ge[0],ge[2],ge[1],ge[3],$,V),p.translate(g[0]-O,g[3]-we);let rt;if(y)rt=y.canvas,p.scale(x,-x);else{let Pe=l[0],St=Pe.extent;rt=Pe.image,p.scale(ee(St)/rt.width,-et(St)/rt.height)}p.drawImage(rt,0,0),p.restore()}),y&&(Qo(y),dl.push(y.canvas)),u&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,a.getTriangles().forEach(function(_,w,b){let M=_.target,S=(M[0][0]-E[0])/o,C=-(M[0][1]-E[1])/o,R=(M[1][0]-E[0])/o,T=-(M[1][1]-E[1])/o,I=(M[2][0]-E[0])/o,B=-(M[2][1]-E[1])/o;p.beginPath(),p.moveTo(R,T),p.lineTo(S,C),p.lineTo(I,B),p.closePath(),p.stroke()}),p.restore()),p.canvas}var v4=10,pP=.25,d1=class{constructor(e,t,r,i,o,s,a){this.sourceProj_=e,this.targetProj_=t;let l={},c=a?Mm(x=>dt(a,Jo(x,this.targetProj_,this.sourceProj_))):Ko(this.targetProj_,this.sourceProj_);this.transformInv_=function(x){let E=x[0]+"/"+x[1];return l[E]||(l[E]=c(x)),l[E]},this.maxSourceExtent_=i,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&ee(i)>=ee(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ee(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ee(this.targetProj_.getExtent()):null;let u=ut(r),d=Vs(r),f=js(r),h=Xo(r),p=this.transformInv_(u),m=this.transformInv_(d),g=this.transformInv_(f),y=this.transformInv_(h),v=v4+(s?Math.max(0,Math.ceil(Math.log2(ks(r)/(s*s*256*256)))):0);if(this.addQuad_(u,d,f,h,p,m,g,y,v),this.wrapsXInSource_){let x=1/0;this.triangles_.forEach(function(E,_,w){x=Math.min(x,E.source[0][0],E.source[1][0],E.source[2][0])}),this.triangles_.forEach(E=>{if(Math.max(E.source[0][0],E.source[1][0],E.source[2][0])-x>this.sourceWorldWidth_/2){let _=[[E.source[0][0],E.source[0][1]],[E.source[1][0],E.source[1][1]],[E.source[2][0],E.source[2][1]]];_[0][0]-x>this.sourceWorldWidth_/2&&(_[0][0]-=this.sourceWorldWidth_),_[1][0]-x>this.sourceWorldWidth_/2&&(_[1][0]-=this.sourceWorldWidth_),_[2][0]-x>this.sourceWorldWidth_/2&&(_[2][0]-=this.sourceWorldWidth_);let w=Math.min(_[0][0],_[1][0],_[2][0]);Math.max(_[0][0],_[1][0],_[2][0])-w<this.sourceWorldWidth_/2&&(E.source=_)}})}l={}}addTriangle_(e,t,r,i,o,s){this.triangles_.push({source:[i,o,s],target:[e,t,r]})}addQuad_(e,t,r,i,o,s,a,l,c){let u=Fs([o,s,a,l]),d=this.sourceWorldWidth_?ee(u)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,h=this.sourceProj_.canWrapX()&&d>.5&&d<1,p=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){let g=Fs([e,t,r,i]);p=ee(g)/this.targetWorldWidth_>pP||p}!h&&this.sourceProj_.isGlobal()&&d&&(p=d>pP||p)}if(!p&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!Le(u,this.maxSourceExtent_))return;let m=0;if(!p&&(!isFinite(o[0])||!isFinite(o[1])||!isFinite(s[0])||!isFinite(s[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)p=!0;else if(m=(!isFinite(o[0])||!isFinite(o[1])?8:0)+(!isFinite(s[0])||!isFinite(s[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),m!=1&&m!=2&&m!=4&&m!=8)return}if(c>0){if(!p){let g=[(e[0]+r[0])/2,(e[1]+r[1])/2],y=this.transformInv_(g),v;h?v=(Hr(o[0],f)+Hr(a[0],f))/2-Hr(y[0],f):v=(o[0]+a[0])/2-y[0];let x=(o[1]+a[1])/2-y[1];p=v*v+x*x>this.errorThresholdSquared_}if(p){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){let g=[(t[0]+r[0])/2,(t[1]+r[1])/2],y=this.transformInv_(g),v=[(i[0]+e[0])/2,(i[1]+e[1])/2],x=this.transformInv_(v);this.addQuad_(e,t,g,v,o,s,y,x,c-1),this.addQuad_(v,g,r,i,x,y,a,l,c-1)}else{let g=[(e[0]+t[0])/2,(e[1]+t[1])/2],y=this.transformInv_(g),v=[(r[0]+i[0])/2,(r[1]+i[1])/2],x=this.transformInv_(v);this.addQuad_(e,g,v,i,o,y,x,l,c-1),this.addQuad_(g,t,r,v,y,s,a,x,c-1)}return}}if(h){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(m&11)==0&&this.addTriangle_(e,r,i,o,a,l),(m&14)==0&&this.addTriangle_(e,r,t,o,a,s),m&&((m&13)==0&&this.addTriangle_(t,i,e,s,l,o),(m&7)==0&&this.addTriangle_(t,i,r,s,l,a))}calculateSourceExtent(){let e=wt();return this.triangles_.forEach(function(t,r,i){let o=t.source;Ya(e,o[0]),Ya(e,o[1]),Ya(e,o[2])}),e}getTriangles(){return this.triangles_}},Tg=d1;var f1=class extends po{constructor(e,t,r,i,o,s,a,l,c,u,d,f){super(o,N.IDLE,f),this.renderEdges_=d!==void 0?d:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=i,this.wrappedTileCoord_=s||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;let h=i.getTileCoordExtent(this.wrappedTileCoord_),p=this.targetTileGrid_.getExtent(),m=this.sourceTileGrid_.getExtent(),g=p?Qt(h,p):h;if(ks(g)===0){this.state=N.EMPTY;return}let y=e.getExtent();y&&(m?m=Qt(m,y):m=y);let v=i.getResolution(this.wrappedTileCoord_[0]),x=Mg(e,r,g,v);if(!isFinite(x)||x<=0){this.state=N.EMPTY;return}let E=u!==void 0?u:.5;if(this.triangulation_=new Tg(e,r,g,m,x*E,v),this.triangulation_.getTriangles().length===0){this.state=N.EMPTY;return}this.sourceZ_=t.getZForResolution(x);let _=this.triangulation_.calculateSourceExtent();if(m&&(e.canWrapX()?(_[1]=xe(_[1],m[1],m[3]),_[3]=xe(_[3],m[1],m[3])):_=Qt(_,m)),!ks(_))this.state=N.EMPTY;else{let w=0,b=0;e.canWrapX()&&(w=ee(y),b=Math.floor((_[0]-y[0])/w)),dc(_.slice(),e,!0).forEach(S=>{let C=t.getTileRangeForExtentAndZ(S,this.sourceZ_);for(let R=C.minX;R<=C.maxX;R++)for(let T=C.minY;T<=C.maxY;T++){let I=c(this.sourceZ_,R,T,a);if(I){let B=b*w;this.sourceTiles_.push({tile:I,offset:B})}}++b}),this.sourceTiles_.length===0&&(this.state=N.EMPTY)}}getImage(){return this.canvas_}reproject_(){let e=[];if(this.sourceTiles_.forEach(t=>{let r=t.tile;if(r&&r.getState()==N.LOADED){let i=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);i[0]+=t.offset,i[2]+=t.offset;let o=this.clipExtent_?.slice();o&&(o[0]+=t.offset,o[2]+=t.offset),e.push({extent:i,clipExtent:o,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=N.ERROR;else{let t=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(t),i=typeof r=="number"?r:r[0],o=typeof r=="number"?r:r[1],s=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=hP(i,o,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),s,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=N.LOADED}this.changed()}load(){if(this.state==N.IDLE){this.state=N.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{let r=t.getState();if(r==N.IDLE||r==N.LOADING){e++;let i=te(t,H.CHANGE,o=>{let s=t.getState();(s==N.LOADED||s==N.ERROR||s==N.EMPTY)&&(ce(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t},r,i){t.getState()==N.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ce),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Qo(this.canvas_.getContext("2d")),dl.push(this.canvas_),this.canvas_=null),super.release()}},Sg=f1;var h1=class{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){let e=this.pop();e instanceof Ns&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){let r=this.entries_[e];return se(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){let t=this.entries_[e];return se(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){let e=new Array(this.count_),t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.key_;return e}getValues(){let e=new Array(this.count_),t=0,r;for(r=this.newest_;r;r=r.older)e[t++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){let e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){se(!(e in this.entries_),"Tried to set a value for a key that is used already");let r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}},mP=h1;function Hc(n,e,t,r){return r!==void 0?(r[0]=n,r[1]=e,r[2]=t,r):[n,e,t]}function gP(n,e,t){return n+"/"+e+"/"+t}function yP(n){return p1(n[0],n[1],n[2])}function p1(n,e,t){return(e<<n)+t}function vP(n,e){let t=n[0],r=n[1],i=n[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;let o=e.getFullTileRange(t);return o?o.containsXY(r,i):!0}function m1(n,e,t,r){return`${n},${gP(e,t,r)}`}function g1(n,e,t){if(!(t in n))return n[t]=new Set([e]),!0;let r=n[t],i=r.has(e);return i||r.add(e),!i}function x4(n,e,t){let r=n[t];return r?r.delete(e):!1}function _P(n,e){let t=n.layerStatesArray[n.layerIndex];t.extent&&(e=Qt(e,Zr(t.extent,n.viewState.projection)));let r=t.layer.getRenderSource();if(!r.getWrapX()){let i=r.getTileGridForProjection(n.viewState.projection).getExtent();i&&(e=Qt(e,i))}return e}var y1=class extends lg{constructor(e,t){super(e),t=t||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision_,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=wt(),this.tempTileRange_=new Cg(0,0,0,0),this.tempTileCoord_=Hc(0,0,0);let r=t.cacheSize!==void 0?t.cacheSize:512;this.tileCache_=new mP(r),this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getOrCreateTile(e,t,r,i){let o=this.tileCache_,a=this.getLayer().getSource(),l=m1(a.getKey(),e,t,r),c;if(o.containsKey(l))c=o.get(l);else{if(c=a.getTile(e,t,r,i.pixelRatio,i.viewState.projection),!c)return null;o.set(l,c)}return c}getTile(e,t,r,i){let o=this.getOrCreateTile(e,t,r,i);return o||null}getData(e){let t=this.frameState;if(!t)return null;let r=this.getLayer(),i=dt(t.pixelToCoordinateTransform,e.slice()),o=r.getExtent();if(o&&!bi(o,i))return null;let s=t.viewState,a=r.getRenderSource(),l=a.getTileGridForProjection(s.projection),c=a.getTilePixelRatio(t.pixelRatio);for(let u=l.getZForResolution(s.resolution);u>=l.getMinZoom();--u){let d=l.getTileCoordForCoordAndZ(i,u),f=this.getTile(u,d[1],d[2],t);if(!f||f.getState()!==N.LOADED)continue;let h=l.getOrigin(u),p=Ge(l.getTileSize(u)),m=l.getResolution(u),g;if(f instanceof gg||f instanceof Sg)g=f.getImage();else if(f instanceof ul){if(g=$c(f.getData()),!g)continue}else continue;let y=Math.floor(c*((i[0]-h[0])/m-d[1]*p[0])),v=Math.floor(c*((h[1]-i[1])/m-d[2]*p[1])),x=Math.round(c*a.getGutterForProjection(s.projection));return this.getImageData(g,y+x,v+x)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;let t=this.getLayer().getSource();if(!t)return!1;let r=t.getRevision();return this.renderedRevision_?this.renderedRevision_!==r&&(this.renderedRevision_=r,this.renderedSourceKey_===t.getKey()&&this.tileCache_.clear()):this.renderedRevision_=r,!0}enqueueTiles(e,t,r,i,o){let s=e.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(s.projection),u=X(l);u in e.wantedTiles||(e.wantedTiles[u]={});let d=e.wantedTiles[u],f=a.getMapInternal(),h=Math.max(r-o,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),f?f.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),p=s.rotation,m=p?yx(s.center,s.resolution,p,e.size):void 0;for(let g=r;g>=h;--g){let y=c.getTileRangeForExtentAndZ(t,g,this.tempTileRange_),v=c.getResolution(g);for(let x=y.minX;x<=y.maxX;++x)for(let E=y.minY;E<=y.maxY;++E){if(p&&!c.tileCoordIntersectsViewport([g,x,E],m))continue;let _=this.getTile(g,x,E,e);if(!_||!g1(i,_,g))continue;let b=_.getKey();if(d[b]=!0,_.getState()===N.IDLE&&!e.tileQueue.isKeyQueued(b)){let M=Hc(g,x,E,this.tempTileCoord_);e.tileQueue.enqueue([_,u,c.getTileCoordCenter(M),v])}}}}findStaleTile_(e,t){let r=this.tileCache_,i=e[0],o=e[1],s=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){let c=m1(a[l],i,o,s);if(r.containsKey(c)){let u=r.peek(c);if(u.getState()===N.LOADED)return u.endTransition(X(this)),g1(t,u,i),!0}}return!1}findAltTiles_(e,t,r,i){let o=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!o)return!1;let s=!0,a=this.tileCache_,c=this.getLayer().getRenderSource().getKey();for(let u=o.minX;u<=o.maxX;++u)for(let d=o.minY;d<=o.maxY;++d){let f=m1(c,r,u,d),h=!1;if(a.containsKey(f)){let p=a.peek(f);p.getState()===N.LOADED&&(g1(i,p,r),h=!0)}h||(s=!1)}return s}renderFrame(e,t){this.renderComplete=!0;let r=e.layerStatesArray[e.layerIndex],i=e.viewState,o=i.projection,s=i.resolution,a=i.center,l=e.pixelRatio,c=this.getLayer(),u=c.getSource(),d=u.getTileGridForProjection(o),f=d.getZForResolution(s,u.zDirection),h=d.getResolution(f),p=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==p&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=p):this.renderedSourceKey_=p;let m=e.extent,g=u.getTilePixelRatio(l);this.prepareContainer(e,t);let y=this.context.canvas.width,v=this.context.canvas.height,x=r.extent&&Zr(r.extent,o);x&&(m=Qt(m,Zr(r.extent,o)));let E=h*y/2/g,_=h*v/2/g,w=[a[0]-E,a[1]-_,a[0]+E,a[1]+_],b={};this.renderedTiles.length=0;let M=c.getPreload();if(e.nextExtent){let q=d.getZForResolution(i.nextResolution,u.zDirection),D=_P(e,e.nextExtent);this.enqueueTiles(e,D,q,b,M)}let S=_P(e,m);if(this.enqueueTiles(e,S,f,b,0),M>0&&setTimeout(()=>{this.enqueueTiles(e,S,f-1,b,M-1)},0),!(f in b))return this.container;let C=X(this),R=e.time;for(let q of b[f]){let D=q.getState();if(D===N.EMPTY)continue;let Z=q.tileCoord;if(D===N.LOADED&&q.getAlpha(C,R)===1){q.endTransition(C);continue}if(D!==N.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Z,b)){x4(b,q,f),e.animate=!0;continue}if(this.findAltTiles_(d,Z,f+1,b))continue;let we=d.getMinZoom();for(let _e=f-1;_e>=we&&!this.findAltTiles_(d,Z,_e,b);--_e);}let T=h/s*l/g,I=this.getRenderContext(e);yn(this.tempTransform,y/2,v/2,T,T,0,-y/2,-v/2),r.extent&&this.clipUnrotated(I,e,x),u.getInterpolate()||(I.imageSmoothingEnabled=!1),this.preRender(I,e);let B=Object.keys(b).map(Number);B.sort(In);let j,$=[],V=[];for(let q=B.length-1;q>=0;--q){let D=B[q],Z=u.getTilePixelSize(D,l,o),O=d.getResolution(D)/h,we=Z[0]*O*T,_e=Z[1]*O*T,ge=d.getTileCoordForCoordAndZ(ut(w),D),rt=d.getTileCoordExtent(ge),Pe=dt(this.tempTransform,[g*(rt[0]-w[0])/h,g*(w[3]-rt[3])/h]),St=g*u.getGutterForProjection(o);for(let z of b[D]){if(z.getState()!==N.LOADED)continue;let It=z.tileCoord,li=ge[1]-It[1],Me=Math.round(Pe[0]-(li-1)*we),Gi=ge[2]-It[2],xn=Math.round(Pe[1]-(Gi-1)*_e),He=Math.round(Pe[0]-li*we),En=Math.round(Pe[1]-Gi*_e),ht=Me-He,Nr=xn-En,ci=B.length===1,wn=!1;j=[He,En,He+ht,En,He+ht,En+Nr,He,En+Nr];for(let Or=0,Ui=$.length;Or<Ui;++Or)if(!ci&&D<V[Or]){let he=$[Or];Le([He,En,He+ht,En+Nr],[he[0],he[3],he[4],he[7]])&&(wn||(I.save(),wn=!0),I.beginPath(),I.moveTo(j[0],j[1]),I.lineTo(j[2],j[3]),I.lineTo(j[4],j[5]),I.lineTo(j[6],j[7]),I.moveTo(he[6],he[7]),I.lineTo(he[4],he[5]),I.lineTo(he[2],he[3]),I.lineTo(he[0],he[1]),I.clip())}$.push(j),V.push(D),this.drawTile(z,e,He,En,ht,Nr,St,ci),wn&&I.restore(),this.renderedTiles.unshift(z),this.updateUsedTiles(e.usedTiles,u,z)}}if(this.renderedResolution=h,this.extentChanged=!this.renderedExtent_||!Ti(this.renderedExtent_,w),this.renderedExtent_=w,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&I.restore(),I.imageSmoothingEnabled=!0,this.renderComplete){let q=(D,Z)=>{let ie=X(u),O=Z.wantedTiles[ie],we=O?Object.keys(O).length:0;this.updateCacheSize(we),this.tileCache_.expireCache()};e.postRenderFunctions.push(q)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,t,r,i,o,s,a,l){let c;if(e instanceof ul){if(c=$c(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;let u=this.getRenderContext(t),d=X(this),f=t.layerStatesArray[t.layerIndex],h=f.opacity*(l?e.getAlpha(d,t.time):1),p=h!==u.globalAlpha;p&&(u.save(),u.globalAlpha=h),u.drawImage(c,a,a,c.width-2*a,c.height-2*a,r,i,o,s),p&&u.restore(),h!==f.opacity?t.animate=!0:l&&e.endTransition(d)}getImage(){let e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,t,r){let i=X(t);i in e||(e[i]={}),e[i][r.getKey()]=!0}},Ig=y1;var yo={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var v1=class extends sl{constructor(e){e=e||{};let t=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(yo.PRELOAD)}setPreload(e){this.set(yo.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(yo.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(yo.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}},xP=v1;var _1=class extends xP{constructor(e){super(e)}createRenderer(){return new Ig(this,{cacheSize:this.getCacheSize()})}},fl=_1;var E4={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},EP={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]},x1=class extends Ig{constructor(e,t){super(e,t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=qt(),this.tileClipContexts_=null}drawTile(e,t,r,i,o,s,a,l){this.updateExecutorGroup_(e,t.pixelRatio,t.viewState.projection),this.tileImageNeedsRender_(e)&&this.renderTileImage_(e,t),super.drawTile(e,t,r,i,o,s,a,l)}getTile(e,t,r,i){let o=this.getOrCreateTile(e,t,r,i);if(!o)return null;let a=i.viewState.resolution,l=i.viewHints;return(!(l[lt.ANIMATING]||l[lt.INTERACTING])||!o.wantedResolution)&&(o.wantedResolution=a),o}prepareFrame(e){let t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,r){let i=this.getLayer(),o=i.getRevision(),s=i.getRenderOrder()||null,a=e.wantedResolution,l=e.getReplayState(i);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==o&&l.renderedRenderOrder==s)return;let c=i.getSource(),u=!!i.getDeclutter(),d=c.getTileGrid(),h=c.getTileGridForProjection(r).getTileCoordExtent(e.wrappedTileCoord),p=c.getSourceTiles(t,r,e),m=X(i);delete e.hitDetectionImageData[m],e.executorGroups[m]=[],l.dirty=!1;for(let g=0,y=p.length;g<y;++g){let v=p[g];if(v.getState()!=N.LOADED)continue;let x=v.tileCoord,E=d.getTileCoordExtent(x),_=Qt(h,E),w=Tr(_,i.getRenderBuffer()*a,this.tempExtent),b=Ti(E,_)?null:w,M=new rg(0,_,a,t),S=Gd(a,t),C=function(j,$){let V,q=j.getStyleFunction()||i.getStyleFunction();if(q&&(V=q(j,a)),V){let D=this.renderFeature(j,S,V,M,u,$);l.dirty=l.dirty||D}},R=v.getFeatures();s&&s!==l.renderedRenderOrder&&R.sort(s);for(let j=0,$=R.length;j<$;++j){let V=R[j];(!b||Le(b,V.getGeometry().getExtent()))&&C.call(this,V,j)}let T=M.finish(),I=i.getRenderMode()!=="vector"&&u&&p.length===1?null:_,B=new ig(I,a,t,c.getOverlaps(),T,i.getRenderBuffer(),!0);e.executorGroups[m].push(B)}l.renderedRevision=o,l.renderedRenderOrder=s,l.renderedResolution=a}forEachFeatureAtCoordinate(e,t,r,i,o){let s=t.viewState.resolution,a=t.viewState.rotation;r=r??0;let l=this.getLayer(),u=l.getSource().getTileGridForProjection(t.viewState.projection),d=Fs([e]);Tr(d,s*r,d);let f={},h=function(x,E,_){let w=x.getId();w===void 0&&(w=X(x));let b=f[w];if(b){if(b!==!0&&_<b.distanceSq){if(_===0)return f[w]=!0,o.splice(o.lastIndexOf(b),1),i(x,l,E);b.geometry=E,b.distanceSq=_}}else{if(_===0)return f[w]=!0,i(x,l,E);o.push(f[w]={feature:x,layer:l,geometry:E,distanceSq:_,callback:i})}},p=this.renderedTiles,m=X(l),g=l.getDeclutter(),y=g?t.declutter?.[g]?.all().map(x=>x.value):null,v;e:for(let x=0,E=p.length;x<E;++x){let _=p[x],w=u.getTileCoordExtent(_.wrappedTileCoord);if(!Le(w,d))continue;let b=_.executorGroups[m];for(let M=0,S=b.length;M<S;++M)if(v=b[M].forEachFeatureAtCoordinate(e,s,a,r,h,y),v)break e}return v}getFeatures(e){return this.renderedTiles.length===0?Promise.resolve([]):new Promise((t,r)=>{let i=this.getLayer(),o=i.getSource(),s=this.renderedProjection,a=s.getExtent(),l=this.renderedResolution,c=o.getTileGridForProjection(s),u=dt(this.renderedPixelToCoordinateTransform_,e.slice()),d=c.getTileCoordForCoordAndResolution(u,l).toString(),f=this.renderedTiles.find(x=>x.tileCoord.toString()===d&&x.getState()===N.LOADED);if(!f||f.loadingSourceTiles>0){t([]);return}o.getWrapX()&&s.canWrapX()&&!Mi(a,c.getTileCoordExtent(f.tileCoord))&&hc(u,s);let h=X(i),p=c.getTileCoordExtent(f.wrappedTileCoord),m=ut(p),g=[(u[0]-m[0])/l,(m[1]-u[1])/l],y=f.getSourceTiles().reduce((x,E)=>x.concat(E.getFeatures()),[]),v=f.hitDetectionImageData[h];if(!v){let x=Ge(c.getTileSize(c.getZForResolution(l,o.zDirection))),E=this.renderedRotation_,_=[this.getRenderTransform(c.getTileCoordCenter(f.wrappedTileCoord),l,0,Xn,x[0]*Xn,x[1]*Xn,0)];v=og(x,_,y,i.getStyleFunction(),c.getTileCoordExtent(f.wrappedTileCoord),f.getReplayState(i).renderedResolution,E),f.hitDetectionImageData[h]=v}t(sg(g,y,v))})}getFeaturesInExtent(e){let t=[],r=this.getTileCache();if(r.getCount()===0)return t;let o=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),s=o.getZForResolution(this.renderedResolution),a={};return r.forEach(l=>{if(l.tileCoord[0]!==s||l.getState()!==N.LOADED)return;let c=l.getSourceTiles();for(let u=0,d=c.length;u<d;++u){let f=c[u],h=f.getKey();if(h in a)continue;a[h]=!0;let p=f.tileCoord;if(Le(e,o.getTileCoordExtent(p))){let m=f.getFeatures();if(m)for(let g=0,y=m.length;g<y;++g){let v=m[g],x=v.getGeometry();Le(e,x.getExtent())&&t.push(v)}}}}),t}handleFontsChanged(){let e=this.getLayer();e.getVisible()&&this.renderedLayerRevision_!==void 0&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e,t){let r=this.context,i=r.globalAlpha;r.globalAlpha=t.opacity;let o=e.viewHints,s=!(o[lt.ANIMATING]||o[lt.INTERACTING]),a=[this.context.canvas.width,this.context.canvas.height],l=this.getLayer().getDeclutter(),c=l?e.declutter?.[l]:void 0,u=X(this.getLayer()),d=this.renderedTiles;for(let f=0,h=d.length;f<h;++f){let p=d[f],m=p.executorGroups[u];if(m)for(let g=m.length-1;g>=0;--g)m[g].execute(this.context,a,this.getTileRenderTransform(p,e),e.viewState.rotation,s,Nc,c)}r.globalAlpha=i}renderDeferredInternal(e){let t=this.renderedTiles,r=X(this.getLayer()),i=t.reduce((l,c,u)=>(c.executorGroups[r].forEach(d=>l.push({executorGroup:d,index:u})),l),[]),o=i.map(({executorGroup:l})=>l.getDeferredZIndexContexts()),s={};for(let l=0,c=i.length;l<c;++l){let u=i[l].executorGroup.getDeferredZIndexContexts();for(let d in u)s[d]=!0}Object.keys(s).map(Number).sort(In).forEach(l=>{o.forEach((c,u)=>{c[l]&&(c[l].forEach(d=>{let{executorGroup:f,index:h}=i[u],p=f.getRenderedContext(),m=p.globalAlpha;p.globalAlpha=this.renderedOpacity_;let g=this.tileClipContexts_[h];g&&g.draw(p),d.draw(p),g&&p.restore(),p.globalAlpha=m,d.clear()}),c[l].length=0)})})}getTileRenderTransform(e,t){let r=t.pixelRatio,i=t.viewState,o=i.center,s=i.resolution,a=i.rotation,l=t.size,c=Math.round(l[0]*r),u=Math.round(l[1]*r),f=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),h=e.tileCoord,p=f.getTileCoordExtent(e.wrappedTileCoord),m=f.getTileCoordExtent(h,this.tempExtent)[0]-p[0];return Im(wd(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(o,s,a,r,c,u,m))}postRender(e,t){let r=t.viewHints,i=!(r[lt.ANIMATING]||r[lt.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation,this.renderedOpacity_=t.layerStatesArray[t.layerIndex].opacity;let o=this.getLayer(),s=o.getRenderMode(),a=e.globalAlpha;e.globalAlpha=this.renderedOpacity_;let l=o.getDeclutter(),c=l?EP[s].filter(_=>!Nc.includes(_)):EP[s],u=t.viewState,d=u.rotation,f=o.getSource(),p=f.getTileGridForProjection(u.projection).getZForResolution(u.resolution,f.zDirection),m=this.renderedTiles,g=[],y=[],v=[],x=X(o),E=!0;for(let _=m.length-1;_>=0;--_){let w=m[_];E=E&&!w.getReplayState(o).dirty;let b=w.executorGroups[x].filter(B=>B.hasExecutors(c));if(b.length===0)continue;let M=this.getTileRenderTransform(w,t),S=w.tileCoord[0],C=!1,R=b[0].getClipCoords(M),T=e,I;if(R){I=new Ac,T=I.getContext();for(let B=0,j=g.length;B<j;++B)if(p!==S&&S<y[B]){let $=g[B];Le([R[0],R[3],R[4],R[7]],[$[0],$[3],$[4],$[7]])&&(C||(T.save(),C=!0),T.beginPath(),T.moveTo(R[0],R[1]),T.lineTo(R[2],R[3]),T.lineTo(R[4],R[5]),T.lineTo(R[6],R[7]),T.moveTo($[6],$[7]),T.lineTo($[4],$[5]),T.lineTo($[2],$[3]),T.lineTo($[0],$[1]),T.clip())}g.push(R),y.push(S)}for(let B=0,j=b.length;B<j;++B)b[B].execute(e,[e.canvas.width,e.canvas.height],M,d,i,c,t.declutter?.[l]);C&&(T===e?T.restore():v[_]=I)}e.globalAlpha=a,this.ready=E,this.tileClipContexts_=v,t.declutter||this.renderDeferredInternal(t),super.postRender(e,t)}renderFeature(e,t,r,i,o,s){if(!r)return!1;let a=!1;if(Array.isArray(r))for(let l=0,c=r.length;l<c;++l)a=Sc(i,e,r[l],t,this.boundHandleStyleImageChange_,void 0,o,s)||a;else a=Sc(i,e,r,t,this.boundHandleStyleImageChange_,void 0,o,s);return a}tileImageNeedsRender_(e){let t=this.getLayer();if(t.getRenderMode()==="vector")return!1;let r=e.getReplayState(t),i=t.getRevision(),o=e.wantedResolution;return r.renderedTileResolution!==o||r.renderedTileRevision!==i}renderTileImage_(e,t){let r=this.getLayer(),i=e.getReplayState(r),o=r.getRevision(),s=e.executorGroups[X(r)];i.renderedTileRevision=o;let a=e.wrappedTileCoord,l=a[0],c=r.getSource(),u=t.pixelRatio,f=t.viewState.projection,h=c.getTileGridForProjection(f),p=h.getResolution(e.tileCoord[0]),m=t.pixelRatio/e.wantedResolution*p,g=h.getResolution(l),y=e.getContext();u=Math.round(Math.max(u,m/u));let v=c.getTilePixelSize(l,u,f);y.canvas.width=v[0],y.canvas.height=v[1];let x=u/m;if(x!==1){let b=Fx(this.tmpTransform_);wd(b,x,x),y.setTransform.apply(y,b)}let E=h.getTileCoordExtent(a,this.tempExtent),_=m/g,w=Fx(this.tmpTransform_);wd(w,_,-_),YD(w,-E[0],-E[3]);for(let b=0,M=s.length;b<M;++b)s[b].execute(y,[y.canvas.width*x,y.canvas.height*x],w,0,!0,E4[r.getRenderMode()],null);i.renderedTileResolution=e.wantedResolution}},wP=x1;var E1=class extends jc{constructor(e){e=e||{};let t=Object.assign({},e);delete t.preload;let r=e.cacheSize===void 0?0:e.cacheSize;delete e.cacheSize,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=r;let i=e.renderMode||"hybrid";se(i=="hybrid"||i=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=i,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new wP(this,{cacheSize:this.cacheSize_})}getFeatures(e){return super.getFeatures(e)}getFeaturesInExtent(e){return this.getRenderer().getFeaturesInExtent(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(yo.PRELOAD)}getUseInterimTilesOnError(){return this.get(yo.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set(yo.PRELOAD,e)}setUseInterimTilesOnError(e){this.set(yo.USE_INTERIM_TILES_ON_ERROR,e)}},la=E1;var qc=[0,0,0],ca=5,w1=class{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,se(_D(this.resolutions_,(i,o)=>o-i,!0),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let i=0,o=this.resolutions_.length-1;i<o;++i)if(!t)t=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,se(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));let r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=ut(r)),se(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,se(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:256,se(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,o)=>{let s=new Cg(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){let a=this.getTileRangeForExtentAndZ(r,o);s.minX=Math.max(a.minX,s.minX),s.maxX=Math.min(a.maxX,s.maxX),s.minY=Math.max(a.minY,s.minY),s.maxY=Math.min(a.maxY,s.maxY)}return s}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,t,r){let i=this.getTileRangeForExtentAndZ(e,t);for(let o=i.minX,s=i.maxX;o<=s;++o)for(let a=i.minY,l=i.maxY;a<=l;++a)r([t,o,a])}forEachTileCoordParentTileRange(e,t,r,i){let o,s,a,l=null,c=e[0]-1;for(this.zoomFactor_===2?(s=e[1],a=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(s!==void 0&&a!==void 0?(s=Math.floor(s/2),a=Math.floor(a/2),o=cl(s,s,a,a,r)):o=this.getTileRangeForExtentAndZ(l,c,r),t(c,o))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){let o=e[1]*2,s=e[2]*2;return cl(o,o+1,s,s+1,t)}let i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,r){if(t>this.maxZoom||t<this.minZoom)return null;let i=e[0],o=e[1],s=e[2];if(t===i)return cl(o,s,o,s,r);if(this.zoomFactor_){let l=Math.pow(this.zoomFactor_,t-i),c=Math.floor(o*l),u=Math.floor(s*l);if(t<i)return cl(c,c,u,u,r);let d=Math.floor(l*(o+1))-1,f=Math.floor(l*(s+1))-1;return cl(c,d,u,f,r)}let a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,r)}getTileRangeForExtentAndZ(e,t,r){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,qc);let i=qc[1],o=qc[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,qc);let s=qc[1],a=qc[2];return cl(i,s,o,a,r)}getTileCoordCenter(e){let t=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=Ge(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*i[0]*r,t[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,t){let r=this.getOrigin(e[0]),i=this.getResolution(e[0]),o=Ge(this.getTileSize(e[0]),this.tmpSize_),s=r[0]+e[1]*o[0]*i,a=r[1]-(e[2]+1)*o[1]*i,l=s+o[0]*i,c=a+o[1]*i;return Hn(s,a,l,c,t)}getTileCoordForCoordAndResolution(e,t,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,r)}getTileCoordForXYAndResolution_(e,t,r,i,o){let s=this.getZForResolution(r),a=r/this.getResolution(s),l=this.getOrigin(s),c=Ge(this.getTileSize(s),this.tmpSize_),u=a*(e-l[0])/r/c[0],d=a*(l[1]-t)/r/c[1];return i?(u=vd(u,ca)-1,d=vd(d,ca)-1):(u=yd(u,ca),d=yd(d,ca)),Hc(s,u,d,o)}getTileCoordForXYAndZ_(e,t,r,i,o){let s=this.getOrigin(r),a=this.getResolution(r),l=Ge(this.getTileSize(r),this.tmpSize_),c=(e-s[0])/a/l[0],u=(s[1]-t)/a/l[1];return i?(c=vd(c,ca)-1,u=vd(u,ca)-1):(c=yd(c,ca),u=yd(u,ca)),Hc(r,c,u,o)}getTileCoordForCoordAndZ(e,t,r){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){let r=oc(this.resolutions_,e,t||0);return xe(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return $x(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){let t=this.resolutions_.length,r=new Array(t);for(let i=this.minZoom;i<t;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}},ri=w1;var C1=class extends ri{constructor(e){super({extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}),this.matrixIds_=e.matrixIds}getMatrixId(e){return this.matrixIds_[e]}getMatrixIds(){return this.matrixIds_}},CP=C1;function Wc(n){let e=n.getDefaultTileGrid();return e||(e=b4(n),n.setDefaultTileGrid(e)),e}function bP(n,e,t){let r=e[0],i=n.getTileCoordCenter(e),o=_o(t);if(!bi(o,i)){let s=ee(o),a=Math.ceil((o[0]-i[0])/s);return i[0]+=s*a,n.getTileCoordForCoordAndZ(i,r)}return e}function C4(n,e,t,r){r=r!==void 0?r:"top-left";let i=MP(n,e,t);return new ri({extent:n,origin:ED(n,r),resolutions:i,tileSize:t})}function vo(n){let e=n||{},t=e.extent||ne("EPSG:3857").getExtent(),r={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:MP(t,e.maxZoom,e.tileSize,e.maxResolution)};return new ri(r)}function MP(n,e,t,r){e=e!==void 0?e:42,t=Ge(t!==void 0?t:256);let i=et(n),o=ee(n);r=r>0?r:Math.max(o/t[0],i/t[1]);let s=e+1,a=new Array(s);for(let l=0;l<s;++l)a[l]=r/Math.pow(2,l);return a}function b4(n,e,t,r){let i=_o(n);return C4(i,e,t,r)}function _o(n){n=ne(n);let e=n.getExtent();if(!e){let t=180*Ii.degrees/n.getMetersPerUnit();e=Hn(-t,-t,t,t)}return e}function b1(n,e){let t=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&t.push(i+"="+encodeURIComponent(e[i]))});let r=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+r}var M4=/\{z\}/g,T4=/\{x\}/g,S4=/\{y\}/g,I4=/\{-y\}/g;function Xc(n,e,t,r,i){return n.replace(M4,e.toString()).replace(T4,t.toString()).replace(S4,r.toString()).replace(I4,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function TP(n,e,t,r){let i=p1(e,t,r),o=Hr(i,n.length);return n[o]}function Zc(n){let e=[],t=/\{([a-z])-([a-z])\}/.exec(n);if(t){let r=t[1].charCodeAt(0),i=t[2].charCodeAt(0),o;for(o=r;o<=i;++o)e.push(n.replace(t[0],String.fromCharCode(o)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(n),t){let r=parseInt(t[2],10);for(let i=parseInt(t[1],10);i<=r;i++)e.push(n.replace(t[0],i.toString()));return e}return e.push(n),e}function D4(n,e){return function(t,r,i){if(!t)return;let o,s=t[0];if(e){let a=e.getFullTileRange(s);a&&(o=a.getHeight()-1)}return Xc(n,s,t[1],t[2],o)}}function Dg(n,e){let t=n.length,r=new Array(t);for(let i=0;i<t;++i)r[i]=D4(n[i],e);return Rg(r)}function Rg(n){return n.length===1?n[0]:function(e,t,r){if(!e)return;let i=yP(e),o=Hr(i,n.length);return n[o](e,t,r)}}var M1=class extends eg{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;let t=[256,256];this.tileGrid&&Ge(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tmpSize=[0,0],this.key_=e.key||X(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){let t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,r,i,o){return W()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:Wc(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,r){let i=this.getTileGridForProjection(r),o=this.getTilePixelRatio(t),s=Ge(i.getTileSize(e),this.tmpSize);return o==1?s:GR(s,o,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){let r=t!==void 0?t:this.getProjection(),i=t!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=bP(i,e,r)),vP(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}},Yc=class extends Ut{constructor(e,t){super(e),this.tile=t}},Ag=M1;var ua={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var T1=class n extends Ag{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===n.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){let t=e.target,r=X(t),i=t.getState(),o;i==N.LOADING?(this.tileLoadingKeys_[r]=!0,o=ua.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],o=i==N.ERROR?ua.TILELOADERROR:i==N.LOADED?ua.TILELOADEND:void 0),o!=null&&this.dispatchEvent(new Yc(o,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){let t=Zc(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;let t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Dg(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,r){}},Pg=T1;var S1=class extends Pg{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:R4,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:gg,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!qn(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){let t=this.getProjection();if(this.tileGrid&&(!t||qn(t,e)))return this.tileGrid;let r=X(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=Wc(e)),this.tileGridForProjection[r]}createTile_(e,t,r,i,o,s){let a=[e,t,r],l=this.getTileCoordForTileUrlFunction(a,o),c=l?this.tileUrlFunction(l,i,o):void 0,u=new this.tileClass(a,c!==void 0?N.IDLE:N.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=s,u.addEventListener(H.CHANGE,this.handleTileChange.bind(this)),u}getTile(e,t,r,i,o){let s=this.getProjection();if(!s||!o||qn(s,o))return this.getTileInternal(e,t,r,i,s||o);let a=[e,t,r],l=this.getKey(),c=this.getTileGridForProjection(s),u=this.getTileGridForProjection(o),d=this.getTileCoordForTileUrlFunction(a,o),f=new Sg(s,c,o,u,a,d,this.getTilePixelRatio(i),this.getGutter(),(h,p,m,g)=>this.getTileInternal(h,p,m,g,s),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=l,f}getTileInternal(e,t,r,i,o){let s=this.getKey();return this.createTile_(e,t,r,i,o,s)}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){let r=ne(e);if(r){let i=X(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=t)}}};function R4(n,e){n.getImage().src=e}var Kc=S1;var I1=class extends Kc{constructor(e){e=e||{};let t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:vo({extent:_o(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}},SP=I1;var A4=`
  attribute vec4 a_position;
  attribute vec4 a_texcoord;

  uniform mat4 u_matrix;
  uniform mat4 u_textureMatrix;

  varying vec2 v_texcoord;

  void main() {
    gl_Position = u_matrix * a_position;
    vec2 texcoord = (u_textureMatrix * a_texcoord).xy;
    v_texcoord = texcoord;
  }
`,P4=`
  precision mediump float;

  varying vec2 v_texcoord;

  uniform sampler2D u_texture;

  void main() {
    if (
      v_texcoord.x < 0.0 ||
      v_texcoord.y < 0.0 ||
      v_texcoord.x > 1.0 ||
      v_texcoord.y > 1.0
    ) {
      discard;
    }
    gl_FragColor = texture2D(u_texture, v_texcoord);
  }
`,Ng=class{constructor(e){this.gl_=e,this.program_=Og(e,P4,A4),this.positionLocation=e.getAttribLocation(this.program_,"a_position"),this.texcoordLocation=e.getAttribLocation(this.program_,"a_texcoord"),this.matrixLocation=e.getUniformLocation(this.program_,"u_matrix"),this.textureMatrixLocation=e.getUniformLocation(this.program_,"u_textureMatrix"),this.textureLocation=e.getUniformLocation(this.program_,"u_texture"),this.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),this.positions=[0,0,0,1,1,0,1,0,0,1,1,1],e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.positions),e.STATIC_DRAW),this.texcoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.texcoordBuffer),this.texcoords=[0,0,0,1,1,0,1,0,0,1,1,1],e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.texcoords),e.STATIC_DRAW)}drawImage(e,t,r,i,o,s,a,l,c,u,d,f,h){let p=this.gl_;l===void 0&&(l=i),c===void 0&&(c=o),s===void 0&&(s=t),a===void 0&&(a=r),u===void 0&&(u=s),d===void 0&&(d=a),f===void 0&&(f=p.canvas.width),h===void 0&&(h=p.canvas.height),p.bindTexture(p.TEXTURE_2D,e),p.useProgram(this.program_),p.bindBuffer(p.ARRAY_BUFFER,this.positionBuffer),p.enableVertexAttribArray(this.positionLocation),p.vertexAttribPointer(this.positionLocation,2,p.FLOAT,!1,0,0),p.bindBuffer(p.ARRAY_BUFFER,this.texcoordBuffer),p.enableVertexAttribArray(this.texcoordLocation),p.vertexAttribPointer(this.texcoordLocation,2,p.FLOAT,!1,0,0);let m=df(0,f,0,h,-1,1);m=sP(m,l,c,0),m=a1(m,u,d,1),p.uniformMatrix4fv(this.matrixLocation,!1,m);let g=aP(i/t,o/r,0);g=a1(g,s/t,a/r,1),p.uniformMatrix4fv(this.textureMatrixLocation,!1,g),p.uniform1i(this.textureLocation,0),p.drawArrays(p.TRIANGLES,0,this.positions.length/2)}};function IP(n,e,t){let r=n.createShader(e);if(r===null)throw new Error("Shader compilation failed");if(n.shaderSource(r,t),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){let i=n.getShaderInfoLog(r);throw i===null?new Error("Shader info log creation failed"):new Error(i)}return r}function Og(n,e,t){let r=n.createProgram(),i=IP(n,n.VERTEX_SHADER,t),o=IP(n,n.FRAGMENT_SHADER,e);if(r===null)throw new Error("Program creation failed");if(n.attachShader(r,i),n.attachShader(r,o),n.linkProgram(r),!n.getProgramParameter(r,n.LINK_STATUS))throw n.getProgramInfoLog(r)===null?new Error("Program info log creation failed"):new Error;return r}var N4=`
  attribute vec4 a_position;

  uniform mat4 u_matrix;

  void main() {
     gl_Position = u_matrix * a_position;
  }
`,O4=`
  precision mediump float;

  uniform vec4 u_val;
  void main() {
     gl_FragColor = u_val;
  }
`,F4=`
  attribute vec4 a_position;
  attribute vec2 a_texcoord;

  varying vec2 v_texcoord;

  uniform mat4 u_matrix;

  void main() {
     gl_Position = u_matrix * a_position;
     v_texcoord = a_texcoord;
  }
`,L4=`
  precision mediump float;

  varying vec2 v_texcoord;

  uniform sampler2D u_texture;

  void main() {
    if (v_texcoord.x < 0.0 || v_texcoord.x > 1.0 || v_texcoord.y < 0.0 || v_texcoord.y > 1.0) {
      discard;
    }
    gl_FragColor = texture2D(u_texture, v_texcoord);
  }
`;function DP(n,e,t,r){let i;return t&&t.length?i=t.shift():wc?i=new OffscreenCanvas(n||300,e||300):i=document.createElement("canvas"),n&&(i.width=n),e&&(i.height=e),i.getContext("webgl",r)}function RP(n){let e=n.canvas;e.width=1,e.height=1,n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT|n.STENCIL_BUFFER_BIT)}var D1=[];function AP(n,e,t,r,i,o,s,a,l,c,u,d,f,h){let p=Math.round(r*e),m=Math.round(r*t);n.canvas.width=p,n.canvas.height=m;let g,y;if(y=n.createTexture(),n.bindTexture(n.TEXTURE_2D,y),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),f?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST)),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,p,m,0,n.RGBA,u,null),g=n.createFramebuffer(),n.bindFramebuffer(n.FRAMEBUFFER,g),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,y,0),g===null)throw new Error("Could not create framebuffer");if(y===null)throw new Error("Could not create texture");if(l.length===0)return{width:p,height:m,framebuffer:g,texture:y};let v=wt();l.forEach(function(C,R,T){Ls(v,C.extent)});let x,E,_,w=1/i;if(!h||l.length!==1||c!==0){if(x=n.createTexture(),y===null)throw new Error("Could not create texture");E=Math.round(ee(v)*w),_=Math.round(et(v)*w);let C=n.getParameter(n.MAX_TEXTURE_SIZE),R=Math.max(E,_),T=R>C?C/R:1,I=Math.round(E*T),B=Math.round(_*T);n.bindTexture(n.TEXTURE_2D,x),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),f?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST)),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,I,B,0,n.RGBA,u,null);let j=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,j),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,x,0);let $=new Ng(n);l.forEach(function(V,q,D){let Z=(V.extent[0]-v[0])*w*T,ie=-(V.extent[3]-v[3])*w*T,O=ee(V.extent)*w*T,we=et(V.extent)*w*T;if(n.bindFramebuffer(n.FRAMEBUFFER,j),n.viewport(0,0,I,B),V.clipExtent){let _e=(V.clipExtent[0]-v[0])*w*T,ge=-(V.clipExtent[3]-v[3])*w*T,rt=ee(V.clipExtent)*w*T,Pe=et(V.clipExtent)*w*T;n.enable(n.SCISSOR_TEST),n.scissor(f?_e:Math.round(_e),f?ge:Math.round(ge),f?rt:Math.round(_e+rt)-Math.round(_e),f?Pe:Math.round(ge+Pe)-Math.round(ge))}$.drawImage(V.texture,V.width,V.height,c,c,V.width-2*c,V.height-2*c,f?Z:Math.round(Z),f?ie:Math.round(ie),f?O:Math.round(Z+O)-Math.round(Z),f?we:Math.round(ie+we)-Math.round(ie),I,B),n.disable(n.SCISSOR_TEST)}),n.deleteFramebuffer(j)}else x=l[0].texture,E=l[0].width,_=l[0].width;let b=ut(s),M=ut(v),S=C=>{let R=(C[0][0]-b[0])/o*r,T=-(C[0][1]-b[1])/o*r,I=(C[1][0]-b[0])/o*r,B=-(C[1][1]-b[1])/o*r,j=(C[2][0]-b[0])/o*r,$=-(C[2][1]-b[1])/o*r;return{u1:I,v1:B,u0:R,v0:T,u2:j,v2:$}};n.bindFramebuffer(n.FRAMEBUFFER,g),n.viewport(0,0,p,m);{let C=[],R=[],T=Og(n,L4,F4);n.useProgram(T);let I=n.getUniformLocation(T,"u_texture");n.bindTexture(n.TEXTURE_2D,x),n.uniform1i(I,0),a.getTriangles().forEach(function(Z,ie,O){let we=Z.source,_e=Z.target,{u1:ge,v1:rt,u0:Pe,v0:St,u2:z,v2:It}=S(_e),li=(we[0][0]-M[0])/i/E,Me=-(we[0][1]-M[1])/i/_,Gi=(we[1][0]-M[0])/i/E,xn=-(we[1][1]-M[1])/i/_,He=(we[2][0]-M[0])/i/E,En=-(we[2][1]-M[1])/i/_;C.push(ge,rt,Pe,St,z,It),R.push(Gi,xn,li,Me,He,En)});let B=df(0,p,m,0,-1,1),j=n.getUniformLocation(T,"u_matrix");n.uniformMatrix4fv(j,!1,B);let $=n.getAttribLocation(T,"a_position"),V=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,V),n.bufferData(n.ARRAY_BUFFER,new Float32Array(C),n.STATIC_DRAW),n.vertexAttribPointer($,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray($);let q=n.getAttribLocation(T,"a_texcoord"),D=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,D),n.bufferData(n.ARRAY_BUFFER,new Float32Array(R),n.STATIC_DRAW),n.vertexAttribPointer(q,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(q),n.drawArrays(n.TRIANGLES,0,C.length/2)}if(d){let C=Og(n,O4,N4);n.useProgram(C);let R=df(0,p,m,0,-1,1),T=n.getUniformLocation(C,"u_matrix");n.uniformMatrix4fv(T,!1,R);let I=Array.isArray(d)?d:[0,0,0,255],B=n.getUniformLocation(C,"u_val");!0?n.uniform4fv(B,I):n.uniform4iv(B,I);let $=n.getAttribLocation(C,"a_position"),V=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,V),n.vertexAttribPointer($,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray($);let q=a.getTriangles().reduce(function(D,Z){let ie=Z.target,{u1:O,v1:we,u0:_e,v0:ge,u2:rt,v2:Pe}=S(ie);return D.concat([O,we,_e,ge,_e,ge,rt,Pe,rt,Pe,O,we])},[]);n.bufferData(n.ARRAY_BUFFER,new Float32Array(q),n.STATIC_DRAW),n.drawArrays(n.LINES,0,q.length/2)}return{width:p,height:m,framebuffer:g,texture:y}}var R1=class extends ul{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:e.interpolate,transition:e.transition}),this.renderEdges_=e.renderEdges!==void 0?e.renderEdges:!1,this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;let t=e.sourceProj,r=t.getExtent(),i=e.sourceTileGrid.getExtent();this.clipExtent_=t.canWrapX()?i?Qt(r,i):r:i;let o=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),s=this.targetTileGrid_.getExtent(),a=this.sourceTileGrid_.getExtent(),l=s?Qt(o,s):o;if(ks(l)===0){this.state=N.EMPTY;return}r&&(a?a=Qt(a,r):a=r);let c=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),u=e.targetProj,d=Mg(t,u,l,c);if(!isFinite(d)||d<=0){this.state=N.EMPTY;return}let f=e.errorThreshold!==void 0?e.errorThreshold:.5;if(this.triangulation_=new Tg(t,u,l,a,d*f,c,e.transformMatrix),this.triangulation_.getTriangles().length===0){this.state=N.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(d);let h=this.triangulation_.calculateSourceExtent();if(a&&(t.canWrapX()?(h[1]=xe(h[1],a[1],a[3]),h[3]=xe(h[3],a[1],a[3])):h=Qt(h,a)),!ks(h))this.state=N.EMPTY;else{let p=0,m=0;t.canWrapX()&&(p=ee(r),m=Math.floor((h[0]-r[0])/p)),dc(h.slice(),t,!0).forEach(y=>{let v=this.sourceTileGrid_.getTileRangeForExtentAndZ(y,this.sourceZ_),x=e.getTileFunction;for(let E=v.minX;E<=v.maxX;E++)for(let _=v.minY;_<=v.maxY;_++){let w=x(this.sourceZ_,E,_,this.pixelRatio_);if(w){let b=m*p;this.sourceTiles_.push({tile:w,offset:b})}}++m}),this.sourceTiles_.length===0&&(this.state=N.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){let e=[],t=!1;if(this.sourceTiles_.forEach(E=>{let _=E.tile;if(!_||_.getState()!==N.LOADED)return;let w=_.getSize(),b=this.gutter_,M,S=cP(_.getData());S?M=S:(t=!0,M=uP($c(_.getData())));let C=[w[0]+2*b,w[1]+2*b],R=M instanceof Float32Array,T=C[0]*C[1],I=R?Float32Array:Uint8ClampedArray,B=new I(M.buffer),j=I.BYTES_PER_ELEMENT,$=j*B.length/T,V=B.byteLength/C[1],q=Math.floor(V/j/C[0]),D=this.sourceTileGrid_.getTileCoordExtent(_.tileCoord);D[0]+=E.offset,D[2]+=E.offset;let Z=this.clipExtent_?.slice();Z&&(Z[0]+=E.offset,Z[2]+=E.offset),e.push({extent:D,clipExtent:Z,data:B,dataType:I,bytesPerPixel:$,pixelSize:C,bandCount:q})}),this.sourceTiles_.length=0,e.length===0){this.state=N.ERROR,this.changed();return}let r=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(r),o=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],a=o*this.pixelRatio_,l=s*this.pixelRatio_,c=this.targetTileGrid_.getResolution(r),u=this.sourceTileGrid_.getResolution(this.sourceZ_),d=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),f=e[0].bandCount,h=new e[0].dataType(f*a*l),p=DP(a,l,D1,{premultipliedAlpha:!1,antialias:!1}),m,g=p.RGBA,y;e[0].dataType==Float32Array?(y=p.FLOAT,p.getExtension("WEBGL_color_buffer_float"),p.getExtension("OES_texture_float"),p.getExtension("EXT_float_blend"),m=p.getExtension("OES_texture_float_linear")!==null&&this.interpolate):(y=p.UNSIGNED_BYTE,m=this.interpolate);let v=4,x=Math.ceil(f/v);for(let E=x-1;E>=0;--E){let _=[];for(let I=0,B=e.length;I<B;++I){let j=e[I],$=j.pixelSize,V=$[0],q=$[1],D=new j.dataType(v*V*q),Z=j.data,ie=E*v;for(let we=0,_e=D.length;we<_e;we+=v)D[we]=Z[ie],D[we+1]=Z[ie+1],D[we+2]=Z[ie+2],D[we+3]=Z[ie+3],ie+=f;let O=p.createTexture();p.bindTexture(p.TEXTURE_2D,O),m?(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR)):(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST)),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texImage2D(p.TEXTURE_2D,0,g,V,q,0,g,y,D),_.push({extent:j.extent,clipExtent:j.clipExtent,texture:O,width:V,height:q})}let{framebuffer:w,width:b,height:M}=AP(p,o,s,this.pixelRatio_,u,c,d,this.triangulation_,_,this.gutter_,y,this.renderEdges_,m),S=b,C=M*v,R=new e[0].dataType(S*C);p.bindFramebuffer(p.FRAMEBUFFER,w),p.readPixels(0,0,b,M,p.RGBA,y,R);let T=E*v;for(let I=0,B=R.length;I<B;I+=v){let j=(S-1-(I/C|0))*C+I%C;h[T]=R[j],h[T+1]=R[j+1],h[T+2]=R[j+2],h[T+3]=R[j+3],T+=f}}if(RP(p),D1.push(p.canvas),t){let E=be(o,s),_=new ImageData(h,o);E.putImageData(_,0,0),this.reprojData_=E.canvas}else this.reprojData_=h;this.reprojSize_=[Math.round(a),Math.round(l)],this.state=N.LOADED,this.changed()}load(){if(this.state!==N.IDLE&&this.state!==N.ERROR)return;this.state=N.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:t})=>{let r=t.getState();if(r!==N.IDLE&&r!==N.LOADING)return;e++;let i=te(t,H.CHANGE,()=>{let o=t.getState();(o==N.LOADED||o==N.ERROR||o==N.EMPTY)&&(ce(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:t}){t.getState()==N.IDLE&&t.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(ce),this.sourcesListenerKeys_=null}},PP=R1;var A1=class extends Ag{constructor(e){let t=e.projection===void 0?"EPSG:3857":e.projection,r=e.tileGrid;r===void 0&&t&&(r=vo({extent:_o(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),super({cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:t,tileGrid:r,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.tileSize_=e.tileSize?Ge(e.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=e.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=e.bandCount===void 0?4:e.bandCount,this.tileGridForProjection_={},this.crossOrigin_=e.crossOrigin||"anonymous",this.transformMatrix=null}setTileSizes(e){this.tileSizes_=e}getTileSize(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;let t=this.getTileGrid();return t?Ge(t.getTileSize(e)):[256,256]}getGutterForProjection(e){let t=this.getProjection();return(!t||qn(t,e))&&!this.transformMatrix?this.gutter_:0}setLoader(e){this.loader_=e}getReprojTile_(e,t,r,i,o){let s=this.tileGrid||this.getTileGridForProjection(o||i),a=Math.max.apply(null,s.getResolutions().map((h,p)=>{let m=Ge(s.getTileSize(p)),g=this.getTileSize(p);return Math.max(g[0]/m[0],g[1]/m[1])})),l=this.getTileGridForProjection(i),c=[e,t,r],u=this.getTileCoordForTileUrlFunction(c,i),d=Object.assign({sourceProj:o||i,sourceTileGrid:s,targetProj:i,targetTileGrid:l,tileCoord:c,wrappedTileCoord:u,pixelRatio:a,gutter:this.gutter_,getTileFunction:(h,p,m,g)=>this.getTile(h,p,m,g),transformMatrix:this.transformMatrix},this.tileOptions),f=new PP(d);return f.key=this.getKey(),f}getTile(e,t,r,i,o){let s=this.getProjection();if(o&&(s&&!qn(s,o)||this.transformMatrix))return this.getReprojTile_(e,t,r,o,s);let a=this.getTileSize(e),l=this.loader_,c=new AbortController,u={signal:c.signal,crossOrigin:this.crossOrigin_},d=this.getTileCoordForTileUrlFunction([e,t,r]);if(!d)return null;let f=d[0],h=d[1],p=d[2],m=this.getTileGrid()?.getFullTileRange(f);m&&(u.maxY=m.getHeight()-1);function g(){return Qi(function(){return l(f,h,p,u)})}let y=Object.assign({tileCoord:[e,t,r],loader:g,size:a,controller:c},this.tileOptions),v=new ul(y);return v.key=this.getKey(),v.addEventListener(H.CHANGE,this.handleTileChange_),v}handleTileChange_(e){let t=e.target,r=X(t),i=t.getState(),o;i==N.LOADING?(this.tileLoadingKeys_[r]=!0,o=ua.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],o=i==N.ERROR?ua.TILELOADERROR:i==N.LOADED?ua.TILELOADEND:void 0),o&&this.dispatchEvent(new Yc(o,t))}getTileGridForProjection(e){let t=this.getProjection();if(this.tileGrid&&(!t||qn(t,e))&&!this.transformMatrix)return this.tileGrid;let r=X(e);return r in this.tileGridForProjection_||(this.tileGridForProjection_[r]=Wc(e)),this.tileGridForProjection_[r]}setTileGridForProjection(e,t){let r=ne(e);if(r){let i=X(r);i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=t)}}},Fg=A1;var k4=new Error("Image failed to load");function kP(n,e,t,r,i){return new Promise((o,s)=>{let a=new Image;a.crossOrigin=i.crossOrigin??null,a.addEventListener("load",()=>o(a)),a.addEventListener("error",()=>s(k4)),a.src=Xc(n,e,t,r,i.maxY)})}function NP(n){return function(e,t,r,i){let o=TP(n,e,t,r);return kP(o,e,t,r,i)}}function j4(n){return function(e,t,r,i){let o=n(e,t,r,i);return kP(o,e,t,r,i)}}function OP(n){let e;if(Array.isArray(n))e=NP(n);else if(typeof n=="string"){let t=Zc(n);e=NP(t)}else if(typeof n=="function")e=j4(n);else throw new Error("The url option must be a single template, an array of templates, or a function for getting a URL");return e}var FP=0;function LP(n){return Array.isArray(n)?n.join(`
`):typeof n=="string"?n:(++FP,"url-function-key-"+FP)}var P1=class extends Fg{constructor(e){e=e||{};let t=e.loader,r;e.url&&(t=OP(e.url),r=LP(e.url));let i=t?e.state:"loading",o=e.wrapX===void 0?!0:e.wrapX;super({loader:t,key:r,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize,gutter:e.gutter,maxResolution:e.maxResolution,projection:e.projection,tileGrid:e.tileGrid,state:i,wrapX:o,transition:e.transition,interpolate:e.interpolate!==!1,crossOrigin:e.crossOrigin,zDirection:e.zDirection})}setUrl(e){let t=OP(e);this.setLoader(t),this.setKey(LP(e)),this.getState()!=="ready"&&this.setState("ready")}},jP=P1;function VP(n,e,t,r){let i=document.createElement("script"),o="olc_"+X(e);function s(){delete window[o],i.parentNode.removeChild(i)}i.async=!0,i.src=n+(n.includes("?")?"&":"?")+(r||"callback")+"="+o;let a=setTimeout(function(){s(),t&&t()},1e4);window[o]=function(l){clearTimeout(a),s(),e(l)},document.head.appendChild(i)}var N1=class extends Pg{constructor(e){let t=e.projection||"EPSG:3857",r=e.extent||_o(t),i=e.tileGrid||vo({extent:r,maxResolution:e.maxResolution,maxZoom:e.maxZoom!==void 0?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,projection:t,state:e.state,tileGrid:i,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:O1,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX===void 0?!0:e.wrapX,transition:e.transition,zDirection:e.zDirection===void 0?1:e.zDirection}),this.format_=e.format?e.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=e.overlaps==null?!0:e.overlaps,this.tileClass=e.tileClass?e.tileClass:uf,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(e,t,r){if(r.getState()===N.IDLE){r.setState(N.LOADING);let i=r.wrappedTileCoord,o=this.getTileGridForProjection(t),s=o.getTileCoordExtent(i),a=i[0],l=o.getResolution(a);Tr(s,-l,s);let c=this.tileGrid,u=c.getExtent();u&&Qt(s,u,s);let d=c.getZForResolution(l,this.zDirection);c.forEachTileCoord(s,d,f=>{let h=this.tileUrlFunction(f,e,t);this.sourceTiles_[h]||(this.sourceTiles_[h]=new this.tileClass(f,h?N.IDLE:N.EMPTY,h,this.format_,this.tileLoadFunction));let p=this.sourceTiles_[h];r.sourceTiles.push(p),this.tileKeysBySourceTileUrl_[h]||(this.tileKeysBySourceTileUrl_[h]=[]),this.tileKeysBySourceTileUrl_[h].push(r.getKey());let m=p.getState();if(m<N.LOADED){let g=y=>{this.handleTileChange(y);let v=p.getState();if(v===N.LOADED||v===N.ERROR){let x=p.getKey();x in r.errorTileKeys?p.getState()===N.LOADED&&delete r.errorTileKeys[x]:r.loadingSourceTiles--,v===N.ERROR?r.errorTileKeys[x]=!0:p.removeEventListener(H.CHANGE,g),r.loadingSourceTiles===0&&r.setState(zn(r.errorTileKeys)?N.LOADED:N.ERROR)}};p.addEventListener(H.CHANGE,g),r.loadingSourceTiles++}m===N.IDLE&&(p.extent=c.getTileCoordExtent(f),p.projection=t,p.resolution=c.getResolution(f[0]),p.load())}),r.loadingSourceTiles||r.setState(r.sourceTiles.some(f=>f.getState()===N.ERROR)?N.ERROR:N.LOADED)}return r.sourceTiles}removeSourceTiles(e){let t=e.getKey(),r=e.sourceTiles;for(let i=0,o=r.length;i<o;++i){let s=r[i].getTileUrl();if(!this.tileKeysBySourceTileUrl_[s])return;let a=this.tileKeysBySourceTileUrl_[s].indexOf(t);a!==-1&&(this.tileKeysBySourceTileUrl_[s].splice(a,1),this.tileKeysBySourceTileUrl_[s].length===0&&(delete this.tileKeysBySourceTileUrl_[s],delete this.sourceTiles_[s]))}}getTile(e,t,r,i,o){let s=[e,t,r],a=this.getTileCoordForTileUrlFunction(s,o),l=this.getTileGrid().getExtent(),c=this.getTileGridForProjection(o);if(a&&l){let f=c.getTileCoordExtent(a);Tr(f,-c.getResolution(e),f),Le(l,f)||(a=null)}let u=!0;if(a!==null){let f=this.tileGrid,h=c.getResolution(e),p=f.getZForResolution(h,1),m=c.getTileCoordExtent(a);Tr(m,-h,m),f.forEachTileCoord(m,p,g=>{u=u&&!this.tileUrlFunction(g,i,o)})}let d=new eP(s,u?N.EMPTY:N.IDLE,a,this.getSourceTiles.bind(this,i,o),this.removeSourceTiles.bind(this));return d.key=this.getKey(),d}getTileGridForProjection(e){let t=e.getCode(),r=this.tileGrids_[t];if(!r){let i=this.getProjection();se(i===null||qn(i,e),"A VectorTile source can only be rendered if it has a projection compatible with the view projection.");let o=this.tileGrid,s=o.getResolutions().slice(),a=s.map(function(u,d){return o.getOrigin(d)}),l=s.map(function(u,d){return o.getTileSize(d)}),c=43;for(let u=s.length;u<c;++u)s.push(s[u-1]/2),a.push(a[u-1]),l.push(l[u-1]);r=new ri({extent:o.getExtent(),origins:a,resolutions:s,tileSizes:l}),this.tileGrids_[t]=r}return r}getTilePixelRatio(e){return e}getTilePixelSize(e,t,r){let i=this.getTileGridForProjection(r),o=Ge(i.getTileSize(e),this.tmpSize);return[Math.round(o[0]*t),Math.round(o[1]*t)]}setOverlaps(e){this.overlaps_=e,this.changed()}},Jc=N1;function O1(n,e){n.setLoader(function(t,r,i){mE(e,n.getFormat(),t,r,i,n.onLoad.bind(n),n.onError.bind(n))})}var V4='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',F1=class extends SP{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[V4];let r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",i=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:i,wrapX:e.wrapX,zDirection:e.zDirection})}},L1=F1;var k1=class extends jP{constructor(e){e=e||{};let t=e.template||"z:{z} x:{x} y:{y}",r=e.source;super({transition:0,wrapX:e.wrapX!==void 0?e.wrapX:r!==void 0?r.getWrapX():void 0});let i=()=>{this.projection=e.projection!==void 0?ne(e.projection):r!==void 0?r.getProjection():this.projection,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:r!==void 0?r.getTileGrid():this.tileGrid,this.zDirection=e.zDirection!==void 0?e.zDirection:r!==void 0?r.zDirection:this.zDirection,r instanceof Fg&&(this.transformMatrix=r.transformMatrix?.slice()||null);let o=this.tileGrid;o&&this.setTileSizes(o.getResolutions().map((s,a)=>Ge(o.getTileSize(a)).map(l=>Math.max(Math.floor(l),1)))),this.setLoader((s,a,l,c)=>{let u=Xc(t,s,a,l,c.maxY),[d,f]=this.getTileSize(s),h=be(d,f);return h.strokeStyle="grey",h.strokeRect(.5,.5,d+.5,f+.5),h.fillStyle="grey",h.strokeStyle="white",h.textAlign="center",h.textBaseline="middle",h.font="24px sans-serif",h.lineWidth=4,h.strokeText(u,d/2,f/2,d),h.fillText(u,d/2,f/2,d),Promise.resolve(h.canvas)}),this.setState("ready")};if(r===void 0||r.getState()==="ready")i();else{let o=()=>{r.getState()==="ready"&&(r.removeEventListener(H.CHANGE,o),i())};r.addEventListener(H.CHANGE,o)}}},BP=k1;var j1=class extends Kc{constructor(e){if(super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:ne("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.tileJSON_=null,this.tileSize_=e.tileSize,e.url)if(e.jsonp)VP(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{let t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",e.url),t.send()}else if(e.tileJSON)this.handleTileJSONResponse(e.tileJSON);else throw new Error("Either `url` or `tileJSON` options must be provided")}onXHRLoad_(e){let t=e.target;if(!t.status||t.status>=200&&t.status<300){let r;try{r=JSON.parse(t.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(r)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(e){let t=ne("EPSG:4326"),r=this.getProjection(),i;if(e.bounds!==void 0){let c=Yo(t,r);i=mm(e.bounds,c)}let o=_o(r),s=e.minzoom||0,a=e.maxzoom||22,l=vo({extent:o,maxZoom:a,minZoom:s,tileSize:this.tileSize_});if(this.tileGrid=l,this.tileUrlFunction=Dg(e.tiles,l),e.attribution&&!this.getAttributions()){let c=i!==void 0?i:o;this.setAttributions(function(u){return Le(c,u.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}handleTileJSONError(){this.setState("error")}},GP=j1;var V1=class extends Kc{constructor(e){let t=e.requestEncoding!==void 0?e.requestEncoding:"KVP",r=e.tileGrid,i=e.urls;i===void 0&&e.url!==void 0&&(i=Zc(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:i,wrapX:e.wrapX!==void 0?e.wrapX:!1,transition:e.transition,zDirection:e.zDirection}),this.version_=e.version!==void 0?e.version:"1.0.0",this.format_=e.format!==void 0?e.format:"image/jpeg",this.dimensions_=e.dimensions!==void 0?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=t,this.setKey(this.getKeyForDimensions_()),i&&i.length>0&&(this.tileUrlFunction=Rg(i.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;let t=e.join(`
`);this.setTileUrlFunction(Rg(e.map(this.createFromWMTSTemplate.bind(this))),t)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){let e=this.urls?this.urls.slice(0):[];for(let t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){let t=this.requestEncoding_,r={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};t=="KVP"&&Object.assign(r,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e=t=="KVP"?b1(e,r):e.replace(/\{(\w+?)\}/g,function(s,a){return a.toLowerCase()in r?r[a.toLowerCase()]:s});let i=this.tileGrid,o=this.dimensions_;return function(s,a,l){if(!s)return;let c={TileMatrix:i.getMatrixId(s[0]),TileCol:s[1],TileRow:s[2]};Object.assign(c,o);let u=e;return t=="KVP"?u=b1(u,c):u=u.replace(/\{(\w+?)\}/g,function(d,f){return encodeURIComponent(c[f])}),u}}},B1=V1;var UP={},B4={};"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("").forEach(function(n,e){UP[n]=e,B4[e]=n});function zP(n){for(var e=[],t=0,r=0,i=0;i<n.length;i+=1){var o=UP[n[i]];if(o===void 0)throw new Error("Invalid character ("+n[i]+")");var s=o&32;if(o&=31,r+=o<<t,s)t+=5;else{var a=r&1;r>>>=1,a?e.push(r===0?-2147483648:-r):e.push(r),r=t=0}}return e}var Lg="TOKEN_LOGGER_CONFIG",G1=class{constructor(e){this.config=this._clone(e)}get level(){return this.config.level}get serverLogLevel(){return this.config.serverLogLevel}updateConfig(e){this.config=this._clone(e)}partialUpdateConfig(e){e&&Object.keys(e).forEach(t=>{this.config[t]=e[t]})}getConfig(){return this._clone(this.config)}_clone(e){let t={level:null};return Object.keys(e).forEach(r=>{t[r]=e[r]}),t}},ff="TOKEN_LOGGER_CONFIG_ENGINE_FACTORY",U1=class{provideConfigEngine(e){return new G1(e)}},hf="TOKEN_LOGGER_MAPPER_SERVICE",U4=(()=>{class n{constructor(t){this.httpBackend=t,this.sourceMapCache=new Map,this.logPositionCache=new Map}getLogPosition(t,r){let i=this.getStackLine(t);if(!i)return tr({fileName:"",lineNumber:0,columnNumber:0});let o=this.getLocalPosition(i);if(!t.enableSourceMaps)return tr(o);let s=this.getSourceMapLocation(i);return this.getSourceMap(s,o)}getStackLine(t){let r=new Error;try{throw r}catch{try{let o=4;return r.stack.split(`
`)[0].includes(".js:")||(o=o+1),r.stack.split(`
`)[o+(t.proxiedSteps||0)]}catch{return null}}}getLocalPosition(t){let r=t.lastIndexOf("/"),i=t.indexOf(")");i<0&&(i=void 0);let s=t.substring(r+1,i).split(":");return s.length===3?{fileName:s[0],lineNumber:+s[1],columnNumber:+s[2]}:{fileName:"unknown",lineNumber:0,columnNumber:0}}getTranspileLocation(t){let r=t.indexOf("(");r<0&&(r=t.lastIndexOf("@"),r<0&&(r=t.lastIndexOf(" ")));let i=t.indexOf(")");return i<0&&(i=void 0),t.substring(r+1,i)}getSourceMapLocation(t){let r=this.getTranspileLocation(t),i=r.substring(0,r.lastIndexOf(":"));return i.substring(0,i.lastIndexOf(":"))+".map"}getMapping(t,r){let i=0,o=0,s=0,a=t.mappings.split(";");for(let l=0;l<a.length;l++){let c=0,u=a[l].split(",");for(let d=0;d<u.length;d++){let f=zP(u[d]);if(f.length>=4&&(c+=f[0],i+=f[1],o+=f[2],s+=f[3]),l===r.lineNumber){if(c===r.columnNumber)return{fileName:t.sources[i],lineNumber:o,columnNumber:s};if(d+1===u.length)return{fileName:t.sources[i],lineNumber:o,columnNumber:0}}}}return{fileName:"unknown",lineNumber:0,columnNumber:0}}getSourceMap(t,r){let i=new Ei("GET",t),o=`${r.fileName}:${r.lineNumber}:${r.columnNumber}`;if(this.logPositionCache.has(o))return this.logPositionCache.get(o);this.sourceMapCache.has(t)||(this.httpBackend?this.sourceMapCache.set(t,this.httpBackend.handle(i).pipe(tt(a=>a instanceof Qe),ue(a=>a.body),P0(3),Ah(1))):(console.error("NGXLogger : Can't get sourcemap because HttpBackend is not provided. You need to import HttpClientModule"),this.sourceMapCache.set(t,tr(null))));let s=this.sourceMapCache.get(t).pipe(ue(a=>a?this.getMapping(a,r):r),Ts(()=>tr(r)),Ah(1));return this.logPositionCache.set(o,s),s}}return n.\u0275fac=function(t){return new(t||n)(U(Ps,8))},n.\u0275prov=Y({token:n,factory:n.\u0275fac}),n})(),pf="TOKEN_LOGGER_METADATA_SERVICE",z4=(()=>{class n{constructor(t){this.datePipe=t}computeTimestamp(t){let r=()=>new Date().toISOString();return t.timestampFormat?this.datePipe?this.datePipe.transform(new Date,t.timestampFormat):(console.error("NGXLogger : Can't use timeStampFormat because DatePipe is not provided. You need to provide DatePipe"),r()):r()}getMetadata(t,r,i,o){let s={level:t,additional:o};return i&&typeof i=="function"?s.message=i():s.message=i,s.timestamp=this.computeTimestamp(r),s}}return n.\u0275fac=function(t){return new(t||n)(U(U_,8))},n.\u0275prov=Y({token:n,factory:n.\u0275fac}),n})();var mf="TOKEN_LOGGER_RULES_SERVICE",$4=(()=>{class n{shouldCallWriter(t,r,i,o){return!r.disableConsoleLogging&&t>=r.level}shouldCallServer(t,r,i,o){return!!r.serverLoggingUrl&&t>=r.serverLogLevel}shouldCallMonitor(t,r,i,o){return this.shouldCallWriter(t,r,i,o)||this.shouldCallServer(t,r,i,o)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Y({token:n,factory:n.\u0275fac}),n})(),gf="TOKEN_LOGGER_SERVER_SERVICE",H4=(()=>{class n{constructor(t,r){this.httpBackend=t,this.ngZone=r,this.serverCallsQueue=[],this.flushingQueue=new Ta(!1)}ngOnDestroy(){this.flushingQueue&&(this.flushingQueue.complete(),this.flushingQueue=null),this.addToQueueTimer&&(this.addToQueueTimer.unsubscribe(),this.addToQueueTimer=null)}secureErrorObject(t){return t?.stack}secureAdditionalParameters(t){return t==null?null:t.map((r,i)=>{try{return r instanceof Error?this.secureErrorObject(r):(typeof r=="object"&&JSON.stringify(r),r)}catch{return`The additional[${i}] value could not be parsed using JSON.stringify().`}})}secureMessage(t){try{if(t instanceof Error)return this.secureErrorObject(t);typeof t!="string"&&(t=JSON.stringify(t,null,2))}catch{t='The provided "message" value could not be parsed with JSON.stringify().'}return t}alterHttpRequest(t){return t}logOnServer(t,r,i){if(!this.httpBackend)return console.error("NGXLogger : Can't log on server because HttpBackend is not provided. You need to import HttpClientModule"),tr(null);let o=new Ei("POST",t,r,i||{}),s=tr(o),a=this.alterHttpRequest(o);return D0(a)?s=a:a?s=tr(a):console.warn("NGXLogger : alterHttpRequest returned an invalid request. Using default one instead"),s.pipe(Fu(l=>l?this.httpBackend.handle(l):(console.warn("NGXLogger : alterHttpRequest returned an invalid request (observable). Using default one instead"),this.httpBackend.handle(o))),tt(l=>l instanceof Qe),ue(l=>l.body))}customiseRequestBody(t){return t}flushQueue(t){this.flushingQueue.next(!0),this.addToQueueTimer&&(this.addToQueueTimer.unsubscribe(),this.addToQueueTimer=null),this.serverCallsQueue&&this.serverCallsQueue.length>0&&this.sendToServerAction(this.serverCallsQueue,t),this.serverCallsQueue=[],this.flushingQueue.next(!1)}sendToServerAction(t,r){let i,o=l=>{let c=xt({},l);return c.additional=this.secureAdditionalParameters(c.additional),c.message=this.secureMessage(c.message),c};Array.isArray(t)?(i=[],t.forEach(l=>{i.push(o(l))})):i=o(t),i=this.customiseRequestBody(i);let s=r.customHttpHeaders||new Sn;s.has("Content-Type")||s.set("Content-Type","application/json");let a=()=>{this.logOnServer(r.serverLoggingUrl,i,{headers:s,params:r.customHttpParams||new Mr,responseType:r.httpResponseType||"json",withCredentials:r.withCredentials||!1}).pipe(Ts(l=>(console.error("NGXLogger: Failed to log on server",l),I0(l)))).subscribe()};if(r.serverCallsOutsideNgZone===!0){if(!this.ngZone){console.error("NGXLogger: NgZone is not provided and serverCallsOutsideNgZone is set to true");return}this.ngZone.runOutsideAngular(a)}else a()}sendToServer(t,r){if((!r.serverCallsBatchSize||r.serverCallsBatchSize<=0)&&(!r.serverCallsTimer||r.serverCallsTimer<=0)){this.sendToServerAction(t,r);return}let i=()=>{this.serverCallsQueue.push(xt({},t)),r.serverCallsBatchSize&&this.serverCallsQueue.length>r.serverCallsBatchSize&&this.flushQueue(r),r.serverCallsTimer>0&&!this.addToQueueTimer&&(this.addToQueueTimer=Ou(r.serverCallsTimer).subscribe(o=>{this.flushQueue(r)}))};this.flushingQueue.value===!0?this.flushingQueue.pipe(tt(o=>o===!1),Fl(1)).subscribe(o=>{i()}):i()}}return n.\u0275fac=function(t){return new(t||n)(U(Ps,8),U(st,8))},n.\u0275prov=Y({token:n,factory:n.\u0275fac}),n})(),yf="TOKEN_LOGGER_WRITER_SERVICE",vt=function(n){return n[n.TRACE=0]="TRACE",n[n.DEBUG=1]="DEBUG",n[n.INFO=2]="INFO",n[n.LOG=3]="LOG",n[n.WARN=4]="WARN",n[n.ERROR=5]="ERROR",n[n.FATAL=6]="FATAL",n[n.OFF=7]="OFF",n}(vt||{}),q4=["purple","teal","gray","gray","red","red","red"],W4=(()=>{class n{constructor(t){this.platformId=t,this.prepareMetaStringFuncs=[this.getTimestampToWrite,this.getLevelToWrite,this.getFileDetailsToWrite,this.getContextToWrite],this.isIE=z_(t)&&navigator&&navigator.userAgent&&!!(navigator.userAgent.indexOf("MSIE")!==-1||navigator.userAgent.match(/Trident\//)||navigator.userAgent.match(/Edge\//)),this.logFunc=this.isIE?this.logIE.bind(this):this.logModern.bind(this)}getTimestampToWrite(t,r){return t.timestamp}getLevelToWrite(t,r){return vt[t.level]}getFileDetailsToWrite(t,r){return r.disableFileDetails===!0?"":`[${t.fileName}:${t.lineNumber}:${t.columnNumber}]`}getContextToWrite(t,r){return r.context?`{${r.context}}`:""}prepareMetaString(t,r){let i="";return this.prepareMetaStringFuncs.forEach(o=>{let s=o(t,r);s&&(i=i+" "+s)}),i.trim()}getColor(t,r){let i=r.colorScheme??q4;if(t.level!==vt.OFF)return i[t.level]}logIE(t,r,i){let o=t.additional||[];switch(t.level){case vt.WARN:console.warn(`${i} `,t.message,...o);break;case vt.ERROR:case vt.FATAL:console.error(`${i} `,t.message,...o);break;case vt.INFO:console.info(`${i} `,t.message,...o);break;default:console.log(`${i} `,t.message,...o)}}logModern(t,r,i){let o=this.getColor(t,r),s=t.additional||[];switch(t.level){case vt.WARN:console.warn(`%c${i}`,`color:${o}`,t.message,...s);break;case vt.ERROR:case vt.FATAL:console.error(`%c${i}`,`color:${o}`,t.message,...s);break;case vt.INFO:console.info(`%c${i}`,`color:${o}`,t.message,...s);break;case vt.DEBUG:console.debug(`%c${i}`,`color:${o}`,t.message,...s);break;default:console.log(`%c${i}`,`color:${o}`,t.message,...s)}}writeMessage(t,r){let i=this.prepareMetaString(t,r);this.logFunc(t,r,i)}}return n.\u0275fac=function(t){return new(t||n)(U(Bo))},n.\u0275prov=Y({token:n,factory:n.\u0275fac}),n})(),Ct=(()=>{class n{constructor(t,r,i,o,s,a,l){this.metadataService=i,this.ruleService=o,this.mapperService=s,this.writerService=a,this.serverService=l,this.configEngine=r.provideConfigEngine(t)}get level(){return this.configEngine.level}get serverLogLevel(){return this.configEngine.serverLogLevel}trace(t,...r){this._log(vt.TRACE,t,r)}debug(t,...r){this._log(vt.DEBUG,t,r)}info(t,...r){this._log(vt.INFO,t,r)}log(t,...r){this._log(vt.LOG,t,r)}warn(t,...r){this._log(vt.WARN,t,r)}error(t,...r){this._log(vt.ERROR,t,r)}fatal(t,...r){this._log(vt.FATAL,t,r)}setCustomHttpHeaders(t){let r=this.getConfigSnapshot();r.customHttpHeaders=t,this.updateConfig(r)}setCustomParams(t){let r=this.getConfigSnapshot();r.customHttpParams=t,this.updateConfig(r)}setWithCredentialsOptionValue(t){let r=this.getConfigSnapshot();r.withCredentials=t,this.updateConfig(r)}registerMonitor(t){this._loggerMonitor=t}updateConfig(t){this.configEngine.updateConfig(t)}partialUpdateConfig(t){this.configEngine.partialUpdateConfig(t)}getConfigSnapshot(){return this.configEngine.getConfig()}flushServerQueue(){this.serverService.flushQueue(this.getConfigSnapshot())}_log(t,r,i=[]){let o=this.configEngine.getConfig(),s=this.ruleService.shouldCallWriter(t,o,r,i),a=this.ruleService.shouldCallServer(t,o,r,i),l=this.ruleService.shouldCallMonitor(t,o,r,i);if(!s&&!a&&!l)return;let c=this.metadataService.getMetadata(t,o,r,i);this.mapperService.getLogPosition(o,c).pipe(Fl(1)).subscribe(u=>{u&&(c.fileName=u.fileName,c.lineNumber=u.lineNumber,c.columnNumber=u.columnNumber),l&&this._loggerMonitor&&this._loggerMonitor.onLog(c,o),s&&this.writerService.writeMessage(c,o),a&&this.serverService.sendToServer(c,o)})}}return n.\u0275fac=function(t){return new(t||n)(U(Lg),U(ff),U(pf),U(mf),U(hf),U(yf),U(gf))},n.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),X4=(()=>{class n{constructor(t,r,i,o,s,a,l){this.logger=t,this.configEngineFactory=r,this.metadataService=i,this.ruleService=o,this.mapperService=s,this.writerService=a,this.serverService=l}create(t,r,i,o){return this.getNewInstance({config:t,serverService:r,logMonitor:i,mapperService:o})}getNewInstance(t){let r=new Ct(t?.config??this.logger.getConfigSnapshot(),t?.configEngineFactory??this.configEngineFactory,t?.metadataService??this.metadataService,t?.ruleService??this.ruleService,t?.mapperService??this.mapperService,t?.writerService??this.writerService,t?.serverService??this.serverService);return t?.partialConfig&&r.partialUpdateConfig(t.partialConfig),t?.logMonitor&&r.registerMonitor(t.logMonitor),r}}return n.\u0275fac=function(t){return new(t||n)(U(Ct),U(ff),U(pf),U(mf),U(hf),U(yf),U(gf))},n.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$P=(()=>{class n{static forRoot(t,r){if(r||(r={}),!r.configProvider)r.configProvider={provide:Lg,useValue:t||{}};else if(r.configProvider.provide!==Lg)throw new Error(`Wrong injection token for configProvider, it should be ${Lg} and you used ${r.configProvider.provide}`);if(!r.configEngineFactoryProvider)r.configEngineFactoryProvider={provide:ff,useClass:U1};else if(r.configEngineFactoryProvider.provide!==ff)throw new Error(`Wrong injection token for configEngineFactoryProvider, it should be '${ff}' and you used '${r.configEngineFactoryProvider.provide}'`);if(!r.metadataProvider)r.metadataProvider={provide:pf,useClass:z4};else if(r.metadataProvider.provide!==pf)throw new Error(`Wrong injection token for metadataProvider, it should be '${pf}' and you used '${r.metadataProvider.provide}'`);if(!r.ruleProvider)r.ruleProvider={provide:mf,useClass:$4};else if(r.ruleProvider.provide!==mf)throw new Error(`Wrong injection token for ruleProvider, it should be '${mf}' and you used '${r.ruleProvider.provide}'`);if(!r.mapperProvider)r.mapperProvider={provide:hf,useClass:U4};else if(r.mapperProvider.provide!==hf)throw new Error(`Wrong injection token for mapperProvider, it should be '${hf}' and you used '${r.mapperProvider.provide}'`);if(!r.writerProvider)r.writerProvider={provide:yf,useClass:W4};else if(r.writerProvider.provide!==yf)throw new Error(`Wrong injection token for writerProvider, it should be '${yf}' and you used '${r.writerProvider.provide}'`);if(!r.serverProvider)r.serverProvider={provide:gf,useClass:H4};else if(r.serverProvider.provide!==gf)throw new Error(`Wrong injection token for serverProvider, it should be '${gf}' and you used '${r.writerProvider.provide}'`);return{ngModule:n,providers:[Ct,r.configProvider,r.configEngineFactoryProvider,r.metadataProvider,r.ruleProvider,r.mapperProvider,r.writerProvider,r.serverProvider,X4]}}static forChild(){return{ngModule:n}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=yi({type:n}),n.\u0275inj=pi({imports:[[Un]]}),n})();var HP={bgtBackgroundUrl:"https://service.pdok.nl/brt/achtergrondkaart/wmts/v2_0?",loglevel:vt.OFF};var z1=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=zt,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let r=t.dataProjection?ne(t.dataProjection):this.readProjection(e);t.extent&&r&&r.getUnits()==="tile-pixels"&&(r=ne(r),r.setWorldExtent(t.extent)),t={dataProjection:r,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return W()}readFeature(e,t){return W()}readFeatures(e,t){return W()}readGeometry(e,t){return W()}readProjection(e){return W()}writeFeature(e,t){return W()}writeFeatures(e,t){return W()}writeGeometry(e,t){return W()}},Qc=z1;function cs(n,e,t){let r=t?ne(t.featureProjection):null,i=t?ne(t.dataProjection):null,o=n;if(r&&i&&!qn(r,i)){e&&(o=n.clone());let s=e?r:i,a=e?i:r;s.getUnits()==="tile-pixels"?o.transform(s,a):o.applyTransform(Ko(s,a))}if(e&&t&&t.decimals!==void 0){let s=Math.pow(10,t.decimals),a=function(l){for(let c=0,u=l.length;c<u;++c)l[c]=Math.round(l[c]*s)/s;return l};o===n&&(o=n.clone()),o.applyTransform(a)}return o}var Z4={Point:dn,LineString:vn,Polygon:An,MultiPoint:Ri,MultiLineString:oo,MultiPolygon:so};function Y4(n,e,t){return Array.isArray(e[0])?(Lm(n,0,e,t)||(n=n.slice(),Od(n,0,e,t)),n):(Nd(n,0,e,t)||(n=n.slice(),xc(n,0,e,t)),n)}function $1(n,e){let t=n.geometry;if(!t)return[];if(Array.isArray(t))return t.map(o=>$1(jn(xt({},n),{geometry:o}))).flat();let r=t.type==="MultiPolygon"?"Polygon":t.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);let i=t.layout.length;return cs(new fn(r,r==="Polygon"?Y4(t.flatCoordinates,t.ends,i):t.flatCoordinates,t.ends?.flat(),i,n.properties||{},n.id).enableSimplifyTransformed(),!1,e)}function kg(n,e){if(!n)return null;if(Array.isArray(n)){let r=n.map(i=>kg(i,e));return new is(r)}let t=Z4[n.type];return cs(new t(n.flatCoordinates,n.layout||"XY",n.ends),!1,e)}var H1=class extends Qc{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(jg(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(jg(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return W()}readFeaturesFromObject(e,t){return W()}readGeometry(e,t){return this.readGeometryFromObject(jg(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return W()}readProjection(e){return this.readProjectionFromObject(jg(e))}readProjectionFromObject(e){return W()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return W()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return W()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return W()}};function jg(n){if(typeof n=="string"){let e=JSON.parse(n);return e||null}return n!==null?n:null}var qP=H1;var q1=class extends qP{constructor(e){e=e||{},super(),this.dataProjection=ne(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=ne(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};let i=X1(r.geometry,t);if(this.featureClass===fn)return $1({geometry:i,id:r.id,properties:r.properties},t);let o=new zt;return this.geometryName_?o.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&o.setGeometryName(r.geometry_name),o.setGeometry(kg(i,t)),"id"in r&&o.setId(r.id),r.properties&&o.setProperties(r.properties,!0),o}readFeaturesFromObject(e,t){let r=e,i=null;if(r.type==="FeatureCollection"){let o=e;i=[];let s=o.features;for(let a=0,l=s.length;a<l;++a){let c=this.readFeatureFromObject(s[a],t);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,t)];return i.flat()}readGeometryFromObject(e,t){return K4(e,t)}readProjectionFromObject(e){let t=e.crs,r;if(t)if(t.type=="name")r=ne(t.properties.name);else if(t.type==="EPSG")r=ne("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,t){t=this.adaptOptions(t);let r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;let o=e.getProperties(),s=e.getGeometry();return s&&(r.geometry=W1(s,t),delete o[e.getGeometryName()]),zn(o)||(r.properties=o),r}writeFeaturesObject(e,t){t=this.adaptOptions(t);let r=[];for(let i=0,o=e.length;i<o;++i)r.push(this.writeFeatureObject(e[i],t));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,t){return W1(e,this.adaptOptions(t))}};function X1(n,e){if(!n)return null;let t;switch(n.type){case"Point":{t=Q4(n);break}case"LineString":{t=e8(n);break}case"Polygon":{t=i8(n);break}case"MultiPoint":{t=n8(n);break}case"MultiLineString":{t=t8(n);break}case"MultiPolygon":{t=r8(n);break}case"GeometryCollection":{t=J4(n);break}default:throw new Error("Unsupported GeoJSON type: "+n.type)}return t}function K4(n,e){let t=X1(n,e);return kg(t,e)}function J4(n,e){return n.geometries.map(function(r){return X1(r,e)})}function Q4(n){let e=n.coordinates;return{type:"Point",flatCoordinates:e,layout:qs(e.length)}}function e8(n){let e=n.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:qs(e[0]?.length||2)}}function t8(n){let e=n.coordinates,t=e[0]?.[0]?.length||2,r=[],i=Ws(r,0,e,t);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:qs(t)}}function n8(n){let e=n.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:qs(e[0]?.length||2)}}function r8(n){let e=n.coordinates,t=[],r=e[0]?.[0]?.[0].length||2,i=Pm(t,0,e,r);return{type:"MultiPolygon",flatCoordinates:t,ends:i,layout:qs(r)}}function i8(n){let e=n.coordinates,t=[],r=e[0]?.[0]?.length,i=Ws(t,0,e,r);return{type:"Polygon",flatCoordinates:t,ends:i,layout:qs(r)}}function W1(n,e){n=cs(n,!0,e);let t=n.getType(),r;switch(t){case"Point":{r=u8(n,e);break}case"LineString":{r=s8(n,e);break}case"Polygon":{r=d8(n,e);break}case"MultiPoint":{r=l8(n,e);break}case"MultiLineString":{r=a8(n,e);break}case"MultiPolygon":{r=c8(n,e);break}case"GeometryCollection":{r=o8(n,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return r}function o8(n,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:n.getGeometriesArray().map(function(r){return W1(r,e)})}}function s8(n,e){return{type:"LineString",coordinates:n.getCoordinates()}}function a8(n,e){return{type:"MultiLineString",coordinates:n.getCoordinates()}}function l8(n,e){return{type:"MultiPoint",coordinates:n.getCoordinates()}}function c8(n,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:n.getCoordinates(t)}}function u8(n,e){return{type:"Point",coordinates:n.getCoordinates()}}function d8(n,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:n.getCoordinates(t)}}var us=q1;var f8=null;function WP(n){f8=n;let e=Object.keys(n.defs),t=e.length,r,i;for(r=0;r<t;++r){let o=e[r];if(!mc(o)){let s=n.defs(o),a=s.units;!a&&s.projName==="longlat"&&(a="degrees"),xd(new un({code:o,axisOrientation:s.axis,metersPerUnit:s.to_meter,units:a}))}}for(r=0;r<t;++r){let o=e[r],s=mc(o);for(i=0;i<t;++i){let a=e[i],l=mc(a);if(!yc(o,a))if(n.defs[o]===n.defs[a])bm([s,l]);else{let c=n(o,a);$D(s,l,Ox(s,l,c.forward),Ox(l,s,c.inverse))}}}}function XP(n){n("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),n("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),n("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)n("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),n("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");n.WGS84=n["EPSG:4326"],n["EPSG:3785"]=n["EPSG:3857"],n.GOOGLE=n["EPSG:3857"],n["EPSG:900913"]=n["EPSG:3857"],n["EPSG:102113"]=n["EPSG:3857"]}var Ni=1,Oi=2,ds=3,ZP=4,vf=5,Z1=6378137,YP=6356752314e-3,Y1=.0066943799901413165,hl=484813681109536e-20,P=Math.PI/2,KP=.16666666666666666,JP=.04722222222222222,QP=.022156084656084655,L=1e-10,bt=.017453292519943295,gr=57.29577951308232,je=Math.PI/4,da=Math.PI*2,Mt=3.14159265359;var Yn={};Yn.greenwich=0;Yn.lisbon=-9.131906111111;Yn.paris=2.337229166667;Yn.bogota=-74.080916666667;Yn.madrid=-3.687938888889;Yn.rome=12.452333333333;Yn.bern=7.439583333333;Yn.jakarta=106.807719444444;Yn.ferro=-17.666666666667;Yn.brussels=4.367975;Yn.stockholm=18.058277777778;Yn.athens=23.7163375;Yn.oslo=10.722916666667;var eN={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var tN=/[\s_\-\/\(\)]/g;function Ar(n,e){if(n[e])return n[e];for(var t=Object.keys(n),r=e.toLowerCase().replace(tN,""),i=-1,o,s;++i<t.length;)if(o=t[i],s=o.toLowerCase().replace(tN,""),s===r)return n[o]}function _f(n){var e={},t=n.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).reduce(function(a,l){var c=l.split("=");return c.push(!0),a[c[0].toLowerCase()]=c[1],a},{}),r,i,o,s={proj:"projName",datum:"datumCode",rf:function(a){e.rf=parseFloat(a)},lat_0:function(a){e.lat0=a*bt},lat_1:function(a){e.lat1=a*bt},lat_2:function(a){e.lat2=a*bt},lat_ts:function(a){e.lat_ts=a*bt},lon_0:function(a){e.long0=a*bt},lon_1:function(a){e.long1=a*bt},lon_2:function(a){e.long2=a*bt},alpha:function(a){e.alpha=parseFloat(a)*bt},gamma:function(a){e.rectified_grid_angle=parseFloat(a)},lonc:function(a){e.longc=a*bt},x_0:function(a){e.x0=parseFloat(a)},y_0:function(a){e.y0=parseFloat(a)},k_0:function(a){e.k0=parseFloat(a)},k:function(a){e.k0=parseFloat(a)},a:function(a){e.a=parseFloat(a)},b:function(a){e.b=parseFloat(a)},r:function(a){e.a=e.b=parseFloat(a)},r_a:function(){e.R_A=!0},zone:function(a){e.zone=parseInt(a,10)},south:function(){e.utmSouth=!0},towgs84:function(a){e.datum_params=a.split(",").map(function(l){return parseFloat(l)})},to_meter:function(a){e.to_meter=parseFloat(a)},units:function(a){e.units=a;var l=Ar(eN,a);l&&(e.to_meter=l.to_meter)},from_greenwich:function(a){e.from_greenwich=a*bt},pm:function(a){var l=Ar(Yn,a);e.from_greenwich=(l||parseFloat(a))*bt},nadgrids:function(a){a==="@null"?e.datumCode="none":e.nadgrids=a},axis:function(a){var l="ewnsud";a.length===3&&l.indexOf(a.substr(0,1))!==-1&&l.indexOf(a.substr(1,1))!==-1&&l.indexOf(a.substr(2,1))!==-1&&(e.axis=a)},approx:function(){e.approx=!0}};for(r in t)i=t[r],r in s?(o=s[r],typeof o=="function"?o(i):e[o]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}var nN=g8,xf=1,rN=2,iN=3,Vg=4,oN=5,K1=-1,h8=/\s/,p8=/[A-Za-z]/,m8=/[A-Za-z84_]/,Bg=/[,\]]/,sN=/[\d\.E\-\+]/;function fs(n){if(typeof n!="string")throw new Error("not a string");this.text=n.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=xf}fs.prototype.readCharicter=function(){var n=this.text[this.place++];if(this.state!==Vg)for(;h8.test(n);){if(this.place>=this.text.length)return;n=this.text[this.place++]}switch(this.state){case xf:return this.neutral(n);case rN:return this.keyword(n);case Vg:return this.quoted(n);case oN:return this.afterquote(n);case iN:return this.number(n);case K1:return}};fs.prototype.afterquote=function(n){if(n==='"'){this.word+='"',this.state=Vg;return}if(Bg.test(n)){this.word=this.word.trim(),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in afterquote yet, index '+this.place)};fs.prototype.afterItem=function(n){if(n===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=xf;return}if(n==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=xf,this.currentObject=this.stack.pop(),this.currentObject||(this.state=K1);return}};fs.prototype.number=function(n){if(sN.test(n)){this.word+=n;return}if(Bg.test(n)){this.word=parseFloat(this.word),this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in number yet, index '+this.place)};fs.prototype.quoted=function(n){if(n==='"'){this.state=oN;return}this.word+=n};fs.prototype.keyword=function(n){if(m8.test(n)){this.word+=n;return}if(n==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=xf;return}if(Bg.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in keyword yet, index '+this.place)};fs.prototype.neutral=function(n){if(p8.test(n)){this.word=n,this.state=rN;return}if(n==='"'){this.word="",this.state=Vg;return}if(sN.test(n)){this.word=n,this.state=iN;return}if(Bg.test(n)){this.afterItem(n);return}throw new Error(`havn't handled "`+n+'" in neutral yet, index '+this.place)};fs.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===K1)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function g8(n){var e=new fs(n);return e.output()}function J1(n,e,t){Array.isArray(e)&&(t.unshift(e),e=null);var r=e?{}:n,i=t.reduce(function(o,s){return pl(s,o),o},r);e&&(n[e]=i)}function pl(n,e){if(!Array.isArray(n)){e[n]=!0;return}var t=n.shift();if(t==="PARAMETER"&&(t=n.shift()),n.length===1){if(Array.isArray(n[0])){e[t]={},pl(n[0],e[t]);return}e[t]=n[0];return}if(!n.length){e[t]=!0;return}if(t==="TOWGS84"){e[t]=n;return}if(t==="AXIS"){t in e||(e[t]=[]),e[t].push(n);return}Array.isArray(t)||(e[t]={});var r;switch(t){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[t]={name:n[0].toLowerCase(),convert:n[1]},n.length===3&&pl(n[2],e[t]);return;case"SPHEROID":case"ELLIPSOID":e[t]={name:n[0],a:n[1],rf:n[2]},n.length===4&&pl(n[3],e[t]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":n[0]=["name",n[0]],J1(e,t,n);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":n[0]=["name",n[0]],J1(e,t,n),e[t].type=t;return;default:for(r=-1;++r<n.length;)if(!Array.isArray(n[r]))return pl(n,e[t]);return J1(e,t,n)}}var y8=.017453292519943295,v8=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function _8(n,e){var t=e[0],r=e[1];!(t in n)&&r in n&&(n[t]=n[r],e.length===3&&(n[t]=e[2](n[t])))}function Eo(n){return n*y8}function aN(n){for(var e=Object.keys(n),t=0,r=e.length;t<r;++t){var i=e[t];v8.indexOf(i)!==-1&&x8(n[i]),typeof n[i]=="object"&&aN(n[i])}}function x8(n){if(n.AUTHORITY){var e=Object.keys(n.AUTHORITY)[0];e&&e in n.AUTHORITY&&(n.title=e+":"+n.AUTHORITY[e])}if(n.type==="GEOGCS"?n.projName="longlat":n.type==="LOCAL_CS"?(n.projName="identity",n.local=!0):typeof n.PROJECTION=="object"?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION,n.AXIS){for(var t="",r=0,i=n.AXIS.length;r<i;++r){var o=[n.AXIS[r][0].toLowerCase(),n.AXIS[r][1].toLowerCase()];o[0].indexOf("north")!==-1||(o[0]==="y"||o[0]==="lat")&&o[1]==="north"?t+="n":o[0].indexOf("south")!==-1||(o[0]==="y"||o[0]==="lat")&&o[1]==="south"?t+="s":o[0].indexOf("east")!==-1||(o[0]==="x"||o[0]==="lon")&&o[1]==="east"?t+="e":(o[0].indexOf("west")!==-1||(o[0]==="x"||o[0]==="lon")&&o[1]==="west")&&(t+="w")}t.length===2&&(t+="u"),t.length===3&&(n.axis=t)}n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),n.units==="metre"&&(n.units="meter"),n.UNIT.convert&&(n.type==="GEOGCS"?n.DATUM&&n.DATUM.SPHEROID&&(n.to_meter=n.UNIT.convert*n.DATUM.SPHEROID.a):n.to_meter=n.UNIT.convert));var s=n.GEOGCS;n.type==="GEOGCS"&&(s=n),s&&(s.DATUM?n.datumCode=s.DATUM.name.toLowerCase():n.datumCode=s.name.toLowerCase(),n.datumCode.slice(0,2)==="d_"&&(n.datumCode=n.datumCode.slice(2)),n.datumCode==="new_zealand_1949"&&(n.datumCode="nzgd49"),(n.datumCode==="wgs_1984"||n.datumCode==="world_geodetic_system_1984")&&(n.PROJECTION==="Mercator_Auxiliary_Sphere"&&(n.sphere=!0),n.datumCode="wgs84"),n.datumCode==="belge_1972"&&(n.datumCode="rnb72"),s.DATUM&&s.DATUM.SPHEROID&&(n.ellps=s.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),n.ellps.toLowerCase().slice(0,13)==="international"&&(n.ellps="intl"),n.a=s.DATUM.SPHEROID.a,n.rf=parseFloat(s.DATUM.SPHEROID.rf,10)),s.DATUM&&s.DATUM.TOWGS84&&(n.datum_params=s.DATUM.TOWGS84),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"),~n.datumCode.indexOf("osni_1952")&&(n.datumCode="osni52"),(~n.datumCode.indexOf("tm65")||~n.datumCode.indexOf("geodetic_datum_of_1965"))&&(n.datumCode="ire65"),n.datumCode==="ch1903+"&&(n.datumCode="ch1903"),~n.datumCode.indexOf("israel")&&(n.datumCode="isr93")),n.b&&!isFinite(n.b)&&(n.b=n.a);function a(u){var d=n.to_meter||1;return u*d}var l=function(u){return _8(n,u)},c=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Eo],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Eo],["x0","false_easting",a],["y0","false_northing",a],["long0","central_meridian",Eo],["lat0","latitude_of_origin",Eo],["lat0","standard_parallel_1",Eo],["lat1","standard_parallel_1",Eo],["lat2","standard_parallel_2",Eo],["azimuth","Azimuth"],["alpha","azimuth",Eo],["srsCode","name"]];c.forEach(l),!n.long0&&n.longc&&(n.projName==="Albers_Conic_Equal_Area"||n.projName==="Lambert_Azimuthal_Equal_Area")&&(n.long0=n.longc),!n.lat_ts&&n.lat1&&(n.projName==="Stereographic_South_Pole"||n.projName==="Polar Stereographic (variant B)")?(n.lat0=Eo(n.lat1>0?90:-90),n.lat_ts=n.lat1):!n.lat_ts&&n.lat0&&n.projName==="Polar_Stereographic"&&(n.lat_ts=n.lat0,n.lat0=Eo(n.lat0>0?90:-90))}function Gg(n){var e=nN(n),t=e[0],r={};return pl(e,r),aN(r),r[t]}function ii(n){var e=this;if(arguments.length===2){var t=arguments[1];typeof t=="string"?t.charAt(0)==="+"?ii[n]=_f(arguments[1]):ii[n]=Gg(arguments[1]):ii[n]=t}else if(arguments.length===1){if(Array.isArray(n))return n.map(function(r){Array.isArray(r)?ii.apply(e,r):ii(r)});if(typeof n=="string"){if(n in ii)return ii[n]}else"EPSG"in n?ii["EPSG:"+n.EPSG]=n:"ESRI"in n?ii["ESRI:"+n.ESRI]=n:"IAU2000"in n?ii["IAU2000:"+n.IAU2000]=n:console.log(n);return}}XP(ii);var eu=ii;function E8(n){return typeof n=="string"}function w8(n){return n in eu}var C8=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function b8(n){return C8.some(function(e){return n.indexOf(e)>-1})}var M8=["3857","900913","3785","102113"];function T8(n){var e=Ar(n,"authority");if(e){var t=Ar(e,"epsg");return t&&M8.indexOf(t)>-1}}function S8(n){var e=Ar(n,"extension");if(e)return Ar(e,"proj4")}function I8(n){return n[0]==="+"}function D8(n){if(E8(n)){if(w8(n))return eu[n];if(b8(n)){var e=Gg(n);if(T8(e))return eu["EPSG:3857"];var t=S8(e);return t?_f(t):e}if(I8(n))return _f(n)}else return n}var lN=D8;function Q1(n,e){n=n||{};var t,r;if(!e)return n;for(r in e)t=e[r],t!==void 0&&(n[r]=t);return n}function Fn(n,e,t){var r=n*e;return t/Math.sqrt(1-r*r)}function wo(n){return n<0?-1:1}function F(n){return Math.abs(n)<=Mt?n:n-wo(n)*da}function Kn(n,e,t){var r=n*t,i=.5*n;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(P-e))/r}function hs(n,e){for(var t=.5*n,r,i,o=P-2*Math.atan(e),s=0;s<=15;s++)if(r=n*Math.sin(o),i=P-2*Math.atan(e*Math.pow((1-r)/(1+r),t))-o,o+=i,Math.abs(i)<=1e-10)return o;return-9999}function R8(){var n=this.b/this.a;this.es=1-n*n,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Fn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function A8(n){var e=n.x,t=n.y;if(t*gr>90&&t*gr<-90&&e*gr>180&&e*gr<-180)return null;var r,i;if(Math.abs(Math.abs(t)-P)<=L)return null;if(this.sphere)r=this.x0+this.a*this.k0*F(e-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(je+.5*t));else{var o=Math.sin(t),s=Kn(this.e,t,o);r=this.x0+this.a*this.k0*F(e-this.long0),i=this.y0-this.a*this.k0*Math.log(s)}return n.x=r,n.y=i,n}function P8(n){var e=n.x-this.x0,t=n.y-this.y0,r,i;if(this.sphere)i=P-2*Math.atan(Math.exp(-t/(this.a*this.k0)));else{var o=Math.exp(-t/(this.a*this.k0));if(i=hs(this.e,o),i===-9999)return null}return r=F(this.long0+e/(this.a*this.k0)),n.x=r,n.y=i,n}var N8=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],cN={init:R8,forward:A8,inverse:P8,names:N8};function O8(){}function uN(n){return n}var F8=["longlat","identity"],dN={init:O8,forward:uN,inverse:uN,names:F8};var L8=[cN,dN],Ug={},zg=[];function fN(n,e){var t=zg.length;return n.names?(zg[t]=n,n.names.forEach(function(r){Ug[r.toLowerCase()]=t}),this):(console.log(e),!0)}function k8(n){if(!n)return!1;var e=n.toLowerCase();if(typeof Ug[e]<"u"&&zg[Ug[e]])return zg[Ug[e]]}function j8(){L8.forEach(fN)}var hN={start:j8,add:fN,get:k8};var le={};le.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};le.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};le.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};le.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};le.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};le.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};le.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};le.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};le.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};le.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};le.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};le.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};le.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};le.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};le.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};le.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};le.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};le.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};le.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};le.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};le.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};le.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};le.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};le.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};le.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};le.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};le.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};le.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};le.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};le.hough={a:6378270,rf:297,ellipseName:"Hough"};le.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};le.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};le.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};le.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};le.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};le.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};le.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};le.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};le.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};le.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};le.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};le.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var pN=le.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};le.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function mN(n,e,t,r){var i=n*n,o=e*e,s=(i-o)/i,a=0;r?(n*=1-s*(KP+s*(JP+s*QP)),i=n*n,s=0):a=Math.sqrt(s);var l=(i-o)/o;return{es:s,e:a,ep2:l}}function gN(n,e,t,r,i){if(!n){var o=Ar(le,r);o||(o=pN),n=o.a,e=o.b,t=o.rf}return t&&!e&&(e=(1-1/t)*n),(t===0||Math.abs(n-e)<L)&&(i=!0,e=n),{a:n,b:e,rf:t,sphere:i}}var $g={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(yN in $g)eC=$g[yN],$g[eC.datumName]=eC;var eC,yN,vN=$g;function V8(n,e,t,r,i,o,s){var a={};return n===void 0||n==="none"?a.datum_type=vf:a.datum_type=ZP,e&&(a.datum_params=e.map(parseFloat),(a.datum_params[0]!==0||a.datum_params[1]!==0||a.datum_params[2]!==0)&&(a.datum_type=Ni),a.datum_params.length>3&&(a.datum_params[3]!==0||a.datum_params[4]!==0||a.datum_params[5]!==0||a.datum_params[6]!==0)&&(a.datum_type=Oi,a.datum_params[3]*=hl,a.datum_params[4]*=hl,a.datum_params[5]*=hl,a.datum_params[6]=a.datum_params[6]/1e6+1)),s&&(a.datum_type=ds,a.grids=s),a.a=t,a.b=r,a.es=i,a.ep2=o,a}var _N=V8;var xN={};function nC(n,e){var t=new DataView(e),r=G8(t),i=U8(t,r),o=z8(t,i,r),s={header:i,subgrids:o};return xN[n]=s,s}function EN(n){if(n===void 0)return null;var e=n.split(",");return e.map(B8)}function B8(n){if(n.length===0)return null;var e=n[0]==="@";return e&&(n=n.slice(1)),n==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:n,mandatory:!e,grid:xN[n]||null,isNull:!1}}function tu(n){return n/3600*Math.PI/180}function G8(n){var e=n.getInt32(8,!1);return e===11?!1:(e=n.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function U8(n,e){return{nFields:n.getInt32(8,e),nSubgridFields:n.getInt32(24,e),nSubgrids:n.getInt32(40,e),shiftType:tC(n,56,64).trim(),fromSemiMajorAxis:n.getFloat64(120,e),fromSemiMinorAxis:n.getFloat64(136,e),toSemiMajorAxis:n.getFloat64(152,e),toSemiMinorAxis:n.getFloat64(168,e)}}function tC(n,e,t){return String.fromCharCode.apply(null,new Uint8Array(n.buffer.slice(e,t)))}function z8(n,e,t){for(var r=176,i=[],o=0;o<e.nSubgrids;o++){var s=H8(n,r,t),a=q8(n,r,s,t),l=Math.round(1+(s.upperLongitude-s.lowerLongitude)/s.longitudeInterval),c=Math.round(1+(s.upperLatitude-s.lowerLatitude)/s.latitudeInterval);i.push({ll:[tu(s.lowerLongitude),tu(s.lowerLatitude)],del:[tu(s.longitudeInterval),tu(s.latitudeInterval)],lim:[l,c],count:s.gridNodeCount,cvs:$8(a)}),r+=176+s.gridNodeCount*16}return i}function $8(n){return n.map(function(e){return[tu(e.longitudeShift),tu(e.latitudeShift)]})}function H8(n,e,t){return{name:tC(n,e+8,e+16).trim(),parent:tC(n,e+24,e+24+8).trim(),lowerLatitude:n.getFloat64(e+72,t),upperLatitude:n.getFloat64(e+88,t),lowerLongitude:n.getFloat64(e+104,t),upperLongitude:n.getFloat64(e+120,t),latitudeInterval:n.getFloat64(e+136,t),longitudeInterval:n.getFloat64(e+152,t),gridNodeCount:n.getInt32(e+168,t)}}function q8(n,e,t,r){for(var i=e+176,o=16,s=[],a=0;a<t.gridNodeCount;a++){var l={latitudeShift:n.getFloat32(i+a*o,r),longitudeShift:n.getFloat32(i+a*o+4,r),latitudeAccuracy:n.getFloat32(i+a*o+8,r),longitudeAccuracy:n.getFloat32(i+a*o+12,r)};s.push(l)}return s}function nu(n,e){if(!(this instanceof nu))return new nu(n);e=e||function(c){if(c)throw c};var t=lN(n);if(typeof t!="object"){e("Could not parse to valid json: "+n);return}var r=nu.projections.get(t.projName);if(!r){e("Could not get projection name from: "+n);return}if(t.datumCode&&t.datumCode!=="none"){var i=Ar(vN,t.datumCode);i&&(t.datum_params=t.datum_params||(i.towgs84?i.towgs84.split(","):null),t.ellps=i.ellipse,t.datumName=i.datumName?i.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84",t.lat1=t.lat1||t.lat0;var o=gN(t.a,t.b,t.rf,t.ellps,t.sphere),s=mN(o.a,o.b,o.rf,t.R_A),a=EN(t.nadgrids),l=t.datum||_N(t.datumCode,t.datum_params,o.a,o.b,s.es,s.ep2,a);Q1(this,t),Q1(this,r),this.a=o.a,this.b=o.b,this.rf=o.rf,this.sphere=o.sphere,this.es=s.es,this.e=s.e,this.ep2=s.ep2,this.datum=l,this.init(),e(null,this)}nu.projections=hN;nu.projections.start();var fa=nu;function wN(n,e){return n.datum_type!==e.datum_type||n.a!==e.a||Math.abs(n.es-e.es)>5e-11?!1:n.datum_type===Ni?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]:n.datum_type===Oi?n.datum_params[0]===e.datum_params[0]&&n.datum_params[1]===e.datum_params[1]&&n.datum_params[2]===e.datum_params[2]&&n.datum_params[3]===e.datum_params[3]&&n.datum_params[4]===e.datum_params[4]&&n.datum_params[5]===e.datum_params[5]&&n.datum_params[6]===e.datum_params[6]:!0}function Hg(n,e,t){var r=n.x,i=n.y,o=n.z?n.z:0,s,a,l,c;if(i<-P&&i>-1.001*P)i=-P;else if(i>P&&i<1.001*P)i=P;else{if(i<-P)return{x:-1/0,y:-1/0,z:n.z};if(i>P)return{x:1/0,y:1/0,z:n.z}}return r>Math.PI&&(r-=2*Math.PI),a=Math.sin(i),c=Math.cos(i),l=a*a,s=t/Math.sqrt(1-e*l),{x:(s+o)*c*Math.cos(r),y:(s+o)*c*Math.sin(r),z:(s*(1-e)+o)*a}}function qg(n,e,t,r){var i=1e-12,o=i*i,s=30,a,l,c,u,d,f,h,p,m,g,y,v,x,E=n.x,_=n.y,w=n.z?n.z:0,b,M,S;if(a=Math.sqrt(E*E+_*_),l=Math.sqrt(E*E+_*_+w*w),a/t<i){if(b=0,l/t<i)return M=P,S=-r,{x:n.x,y:n.y,z:n.z}}else b=Math.atan2(_,E);c=w/l,u=a/l,d=1/Math.sqrt(1-e*(2-e)*u*u),p=u*(1-e)*d,m=c*d,x=0;do x++,h=t/Math.sqrt(1-e*m*m),S=a*p+w*m-h*(1-e*m*m),f=e*h/(h+S),d=1/Math.sqrt(1-f*(2-f)*u*u),g=u*(1-f)*d,y=c*d,v=y*p-g*m,p=g,m=y;while(v*v>o&&x<s);return M=Math.atan(y/Math.abs(g)),{x:b,y:M,z:S}}function CN(n,e,t){if(e===Ni)return{x:n.x+t[0],y:n.y+t[1],z:n.z+t[2]};if(e===Oi){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6];return{x:c*(n.x-l*n.y+a*n.z)+r,y:c*(l*n.x+n.y-s*n.z)+i,z:c*(-a*n.x+s*n.y+n.z)+o}}}function bN(n,e,t){if(e===Ni)return{x:n.x-t[0],y:n.y-t[1],z:n.z-t[2]};if(e===Oi){var r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=(n.x-r)/c,d=(n.y-i)/c,f=(n.z-o)/c;return{x:u+l*d-a*f,y:-l*u+d+s*f,z:a*u-s*d+f}}}function Wg(n){return n===Ni||n===Oi}function SN(n,e,t){if(wN(n,e)||n.datum_type===vf||e.datum_type===vf)return t;var r=n.a,i=n.es;if(n.datum_type===ds){var o=MN(n,!1,t);if(o!==0)return;r=Z1,i=Y1}var s=e.a,a=e.b,l=e.es;if(e.datum_type===ds&&(s=Z1,a=YP,l=Y1),i===l&&r===s&&!Wg(n.datum_type)&&!Wg(e.datum_type))return t;if(t=Hg(t,i,r),Wg(n.datum_type)&&(t=CN(t,n.datum_type,n.datum_params)),Wg(e.datum_type)&&(t=bN(t,e.datum_type,e.datum_params)),t=qg(t,l,s,a),e.datum_type===ds){var c=MN(e,!0,t);if(c!==0)return}return t}function MN(n,e,t){if(n.grids===null||n.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-t.x,y:t.y},i={x:Number.NaN,y:Number.NaN},o=!1,s=[];e:for(var a=0;a<n.grids.length;a++){var l=n.grids[a];if(s.push(l.name),l.isNull){i=r;break}if(o=l.mandatory,l.grid===null){if(l.mandatory)return console.log("Unable to find mandatory grid '"+l.name+"'"),-1;continue}for(var c=l.grid.subgrids,u=0,d=c.length;u<d;u++){var f=c[u],h=(Math.abs(f.del[1])+Math.abs(f.del[0]))/1e4,p=f.ll[0]-h,m=f.ll[1]-h,g=f.ll[0]+(f.lim[0]-1)*f.del[0]+h,y=f.ll[1]+(f.lim[1]-1)*f.del[1]+h;if(!(m>r.y||p>r.x||y<r.y||g<r.x)&&(i=W8(r,e,f),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*gr+" "+r.y*gr+" tried: '"+s+"'"),-1):(t.x=-i.x,t.y=i.y,0)}function W8(n,e,t){var r={x:Number.NaN,y:Number.NaN};if(isNaN(n.x))return r;var i={x:n.x,y:n.y};i.x-=t.ll[0],i.y-=t.ll[1],i.x=F(i.x-Math.PI)+Math.PI;var o=TN(i,t);if(e){if(isNaN(o.x))return r;o.x=i.x-o.x,o.y=i.y-o.y;var s=9,a=1e-12,l,c;do{if(c=TN(o,t),isNaN(c.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l={x:i.x-(c.x+o.x),y:i.y-(c.y+o.y)},o.x+=l.x,o.y+=l.y}while(s--&&Math.abs(l.x)>a&&Math.abs(l.y)>a);if(s<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=F(o.x+t.ll[0]),r.y=o.y+t.ll[1]}else isNaN(o.x)||(r.x=n.x+o.x,r.y=n.y+o.y);return r}function TN(n,e){var t={x:n.x/e.del[0],y:n.y/e.del[1]},r={x:Math.floor(t.x),y:Math.floor(t.y)},i={x:t.x-1*r.x,y:t.y-1*r.y},o={x:Number.NaN,y:Number.NaN},s;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return o;s=r.y*e.lim[0]+r.x;var a={x:e.cvs[s][0],y:e.cvs[s][1]};s++;var l={x:e.cvs[s][0],y:e.cvs[s][1]};s+=e.lim[0];var c={x:e.cvs[s][0],y:e.cvs[s][1]};s--;var u={x:e.cvs[s][0],y:e.cvs[s][1]},d=i.x*i.y,f=i.x*(1-i.y),h=(1-i.x)*(1-i.y),p=(1-i.x)*i.y;return o.x=h*a.x+f*l.x+p*u.x+d*c.x,o.y=h*a.y+f*l.y+p*u.y+d*c.y,o}function rC(n,e,t){var r=t.x,i=t.y,o=t.z||0,s,a,l,c={};for(l=0;l<3;l++)if(!(e&&l===2&&t.z===void 0))switch(l===0?(s=r,"ew".indexOf(n.axis[l])!==-1?a="x":a="y"):l===1?(s=i,"ns".indexOf(n.axis[l])!==-1?a="y":a="x"):(s=o,a="z"),n.axis[l]){case"e":c[a]=s;break;case"w":c[a]=-s;break;case"n":c[a]=s;break;case"s":c[a]=-s;break;case"u":t[a]!==void 0&&(c.z=s);break;case"d":t[a]!==void 0&&(c.z=-s);break;default:return null}return c}function Xg(n){var e={x:n[0],y:n[1]};return n.length>2&&(e.z=n[2]),n.length>3&&(e.m=n[3]),e}function DN(n){IN(n.x),IN(n.y)}function IN(n){if(typeof Number.isFinite=="function"){if(Number.isFinite(n))return;throw new TypeError("coordinates must be finite numbers")}if(typeof n!="number"||n!==n||!isFinite(n))throw new TypeError("coordinates must be finite numbers")}function X8(n,e){return(n.datum.datum_type===Ni||n.datum.datum_type===Oi||n.datum.datum_type===ds)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Ni||e.datum.datum_type===Oi||e.datum.datum_type===ds)&&n.datumCode!=="WGS84"}function ml(n,e,t,r){var i;Array.isArray(t)?t=Xg(t):t={x:t.x,y:t.y,z:t.z,m:t.m};var o=t.z!==void 0;if(DN(t),n.datum&&e.datum&&X8(n,e)&&(i=new fa("WGS84"),t=ml(n,i,t,r),n=i),r&&n.axis!=="enu"&&(t=rC(n,!1,t)),n.projName==="longlat")t={x:t.x*bt,y:t.y*bt,z:t.z||0};else if(n.to_meter&&(t={x:t.x*n.to_meter,y:t.y*n.to_meter,z:t.z||0}),t=n.inverse(t),!t)return;if(n.from_greenwich&&(t.x+=n.from_greenwich),t=SN(n.datum,e.datum,t),!!t)return e.from_greenwich&&(t={x:t.x-e.from_greenwich,y:t.y,z:t.z||0}),e.projName==="longlat"?t={x:t.x*gr,y:t.y*gr,z:t.z||0}:(t=e.forward(t),e.to_meter&&(t={x:t.x/e.to_meter,y:t.y/e.to_meter,z:t.z||0})),r&&e.axis!=="enu"?rC(e,!0,t):(t&&!o&&delete t.z,t)}var RN=fa("WGS84");function iC(n,e,t,r){var i,o,s;return Array.isArray(t)?(i=ml(n,e,t,r)||{x:NaN,y:NaN},t.length>2?typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(t.slice(3)):[i.x,i.y,t[2]].concat(t.slice(3)):[i.x,i.y].concat(t.slice(2)):[i.x,i.y]):(o=ml(n,e,t,r),s=Object.keys(t),s.length===2||s.forEach(function(a){if(typeof n.name<"u"&&n.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(a==="x"||a==="y"||a==="z")return}else if(a==="x"||a==="y")return;o[a]=t[a]}),o)}function AN(n){return n instanceof fa?n:n.oProj?n.oProj:fa(n)}function Z8(n,e,t){n=AN(n);var r=!1,i;return typeof e>"u"?(e=n,n=RN,r=!0):(typeof e.x<"u"||Array.isArray(e))&&(t=e,e=n,n=RN,r=!0),e=AN(e),t?iC(n,e,t):(i={forward:function(o,s){return iC(n,e,o,s)},inverse:function(o,s){return iC(e,n,o,s)}},r&&(i.oProj=e),i)}var yr=Z8;var PN=6,ON="AJSAJS",FN="AFAFAF",ru=65,vr=73,oi=79,Ef=86,wf=90,LN={forward:sC,inverse:Y8,toPoint:aC};function sC(n,e){return e=e||5,Q8(K8({lat:n[1],lon:n[0]}),e)}function Y8(n){var e=lC(jN(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function aC(n){var e=lC(jN(n.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function oC(n){return n*(Math.PI/180)}function NN(n){return 180*(n/Math.PI)}function K8(n){var e=n.lat,t=n.lon,r=6378137,i=.00669438,o=.9996,s,a,l,c,u,d,f,h=oC(e),p=oC(t),m,g;g=Math.floor((t+180)/6)+1,t===180&&(g=60),e>=56&&e<64&&t>=3&&t<12&&(g=32),e>=72&&e<84&&(t>=0&&t<9?g=31:t>=9&&t<21?g=33:t>=21&&t<33?g=35:t>=33&&t<42&&(g=37)),s=(g-1)*6-180+3,m=oC(s),a=i/(1-i),l=r/Math.sqrt(1-i*Math.sin(h)*Math.sin(h)),c=Math.tan(h)*Math.tan(h),u=a*Math.cos(h)*Math.cos(h),d=Math.cos(h)*(p-m),f=r*((1-i/4-3*i*i/64-5*i*i*i/256)*h-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*h)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*h)-35*i*i*i/3072*Math.sin(6*h));var y=o*l*(d+(1-c+u)*d*d*d/6+(5-18*c+c*c+72*u-58*a)*d*d*d*d*d/120)+5e5,v=o*(f+l*Math.tan(h)*(d*d/2+(5-c+9*u+4*u*u)*d*d*d*d/24+(61-58*c+c*c+600*u-330*a)*d*d*d*d*d*d/720));return e<0&&(v+=1e7),{northing:Math.round(v),easting:Math.round(y),zoneNumber:g,zoneLetter:J8(e)}}function lC(n){var e=n.northing,t=n.easting,r=n.zoneLetter,i=n.zoneNumber;if(i<0||i>60)return null;var o=.9996,s=6378137,a=.00669438,l,c=(1-Math.sqrt(1-a))/(1+Math.sqrt(1-a)),u,d,f,h,p,m,g,y,v,x=t-5e5,E=e;r<"N"&&(E-=1e7),g=(i-1)*6-180+3,l=a/(1-a),m=E/o,y=m/(s*(1-a/4-3*a*a/64-5*a*a*a/256)),v=y+(3*c/2-27*c*c*c/32)*Math.sin(2*y)+(21*c*c/16-55*c*c*c*c/32)*Math.sin(4*y)+151*c*c*c/96*Math.sin(6*y),u=s/Math.sqrt(1-a*Math.sin(v)*Math.sin(v)),d=Math.tan(v)*Math.tan(v),f=l*Math.cos(v)*Math.cos(v),h=s*(1-a)/Math.pow(1-a*Math.sin(v)*Math.sin(v),1.5),p=x/(u*o);var _=v-u*Math.tan(v)/h*(p*p/2-(5+3*d+10*f-4*f*f-9*l)*p*p*p*p/24+(61+90*d+298*f+45*d*d-252*l-3*f*f)*p*p*p*p*p*p/720);_=NN(_);var w=(p-(1+2*d+f)*p*p*p/6+(5-2*f+28*d-3*f*f+8*l+24*d*d)*p*p*p*p*p/120)/Math.cos(v);w=g+NN(w);var b;if(n.accuracy){var M=lC({northing:n.northing+n.accuracy,easting:n.easting+n.accuracy,zoneLetter:n.zoneLetter,zoneNumber:n.zoneNumber});b={top:M.lat,right:M.lon,bottom:_,left:w}}else b={lat:_,lon:w};return b}function J8(n){var e="Z";return 84>=n&&n>=72?e="X":72>n&&n>=64?e="W":64>n&&n>=56?e="V":56>n&&n>=48?e="U":48>n&&n>=40?e="T":40>n&&n>=32?e="S":32>n&&n>=24?e="R":24>n&&n>=16?e="Q":16>n&&n>=8?e="P":8>n&&n>=0?e="N":0>n&&n>=-8?e="M":-8>n&&n>=-16?e="L":-16>n&&n>=-24?e="K":-24>n&&n>=-32?e="J":-32>n&&n>=-40?e="H":-40>n&&n>=-48?e="G":-48>n&&n>=-56?e="F":-56>n&&n>=-64?e="E":-64>n&&n>=-72?e="D":-72>n&&n>=-80&&(e="C"),e}function Q8(n,e){var t="00000"+n.easting,r="00000"+n.northing;return n.zoneNumber+n.zoneLetter+ez(n.easting,n.northing,n.zoneNumber)+t.substr(t.length-5,e)+r.substr(r.length-5,e)}function ez(n,e,t){var r=kN(t),i=Math.floor(n/1e5),o=Math.floor(e/1e5)%20;return tz(i,o,r)}function kN(n){var e=n%PN;return e===0&&(e=PN),e}function tz(n,e,t){var r=t-1,i=ON.charCodeAt(r),o=FN.charCodeAt(r),s=i+n-1,a=o+e,l=!1;s>wf&&(s=s-wf+ru-1,l=!0),(s===vr||i<vr&&s>vr||(s>vr||i<vr)&&l)&&s++,(s===oi||i<oi&&s>oi||(s>oi||i<oi)&&l)&&(s++,s===vr&&s++),s>wf&&(s=s-wf+ru-1),a>Ef?(a=a-Ef+ru-1,l=!0):l=!1,(a===vr||o<vr&&a>vr||(a>vr||o<vr)&&l)&&a++,(a===oi||o<oi&&a>oi||(a>oi||o<oi)&&l)&&(a++,a===vr&&a++),a>Ef&&(a=a-Ef+ru-1);var c=String.fromCharCode(s)+String.fromCharCode(a);return c}function jN(n){if(n&&n.length===0)throw"MGRSPoint coverting from nothing";for(var e=n.length,t=null,r="",i,o=0;!/[A-Z]/.test(i=n.charAt(o));){if(o>=2)throw"MGRSPoint bad conversion from: "+n;r+=i,o++}var s=parseInt(r,10);if(o===0||o+3>e)throw"MGRSPoint bad conversion from: "+n;var a=n.charAt(o++);if(a<="A"||a==="B"||a==="Y"||a>="Z"||a==="I"||a==="O")throw"MGRSPoint zone letter "+a+" not handled: "+n;t=n.substring(o,o+=2);for(var l=kN(s),c=nz(t.charAt(0),l),u=rz(t.charAt(1),l);u<iz(a);)u+=2e6;var d=e-o;if(d%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+n;var f=d/2,h=0,p=0,m,g,y,v,x;return f>0&&(m=1e5/Math.pow(10,f),g=n.substring(o,o+f),h=parseFloat(g)*m,y=n.substring(o+f),p=parseFloat(y)*m),v=h+c,x=p+u,{easting:v,northing:x,zoneLetter:a,zoneNumber:s,accuracy:m}}function nz(n,e){for(var t=ON.charCodeAt(e-1),r=1e5,i=!1;t!==n.charCodeAt(0);){if(t++,t===vr&&t++,t===oi&&t++,t>wf){if(i)throw"Bad character: "+n;t=ru,i=!0}r+=1e5}return r}function rz(n,e){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var t=FN.charCodeAt(e-1),r=0,i=!1;t!==n.charCodeAt(0);){if(t++,t===vr&&t++,t===oi&&t++,t>Ef){if(i)throw"Bad character: "+n;t=ru,i=!0}r+=1e5}return r}function iz(n){var e;switch(n){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+n}function iu(n,e,t){if(!(this instanceof iu))return new iu(n,e,t);if(Array.isArray(n))this.x=n[0],this.y=n[1],this.z=n[2]||0;else if(typeof n=="object")this.x=n.x,this.y=n.y,this.z=n.z||0;else if(typeof n=="string"&&typeof e>"u"){var r=n.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=n,this.y=e,this.z=t||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}iu.fromMGRS=function(n){return new iu(aC(n))};iu.prototype.toMGRS=function(n){return sC([this.x,this.y],n)};var VN=iu;var oz=1,sz=.25,BN=.046875,GN=.01953125,UN=.01068115234375,az=.75,lz=.46875,cz=.013020833333333334,uz=.007120768229166667,dz=.3645833333333333,fz=.005696614583333333,hz=.3076171875;function ou(n){var e=[];e[0]=oz-n*(sz+n*(BN+n*(GN+n*UN))),e[1]=n*(az-n*(BN+n*(GN+n*UN)));var t=n*n;return e[2]=t*(lz-n*(cz+n*uz)),t*=n,e[3]=t*(dz-n*fz),e[4]=t*n*hz,e}function Co(n,e,t,r){return t*=e,e*=e,r[0]*n-t*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var pz=20;function su(n,e,t){for(var r=1/(1-e),i=n,o=pz;o;--o){var s=Math.sin(i),a=1-e*s*s;if(a=(Co(i,s,Math.cos(i),t)-n)*(a*Math.sqrt(a))*r,i-=a,Math.abs(a)<L)return i}return i}function mz(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=ou(this.es),this.ml0=Co(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function gz(n){var e=n.x,t=n.y,r=F(e-this.long0),i,o,s,a=Math.sin(t),l=Math.cos(t);if(this.es){var u=l*r,d=Math.pow(u,2),f=this.ep2*Math.pow(l,2),h=Math.pow(f,2),p=Math.abs(l)>L?Math.tan(t):0,m=Math.pow(p,2),g=Math.pow(m,2);i=1-this.es*Math.pow(a,2),u=u/Math.sqrt(i);var y=Co(t,a,l,this.en);o=this.a*(this.k0*u*(1+d/6*(1-m+f+d/20*(5-18*m+g+14*f-58*m*f+d/42*(61+179*g-g*m-479*m)))))+this.x0,s=this.a*(this.k0*(y-this.ml0+a*r*u/2*(1+d/12*(5-m+9*f+4*h+d/30*(61+g-58*m+270*f-330*m*f+d/56*(1385+543*g-g*m-3111*m))))))+this.y0}else{var c=l*Math.sin(r);if(Math.abs(Math.abs(c)-1)<L)return 93;if(o=.5*this.a*this.k0*Math.log((1+c)/(1-c))+this.x0,s=l*Math.cos(r)/Math.sqrt(1-Math.pow(c,2)),c=Math.abs(s),c>=1){if(c-1>L)return 93;s=0}else s=Math.acos(s);t<0&&(s=-s),s=this.a*this.k0*(s-this.lat0)+this.y0}return n.x=o,n.y=s,n}function yz(n){var e,t,r,i,o=(n.x-this.x0)*(1/this.a),s=(n.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+s/this.k0,t=su(e,this.es,this.en),Math.abs(t)<P){var d=Math.sin(t),f=Math.cos(t),h=Math.abs(f)>L?Math.tan(t):0,p=this.ep2*Math.pow(f,2),m=Math.pow(p,2),g=Math.pow(h,2),y=Math.pow(g,2);e=1-this.es*Math.pow(d,2);var v=o*Math.sqrt(e)/this.k0,x=Math.pow(v,2);e=e*h,r=t-e*x/(1-this.es)*.5*(1-x/12*(5+3*g-9*p*g+p-4*m-x/30*(61+90*g-252*p*g+45*y+46*p-x/56*(1385+3633*g+4095*y+1574*y*g)))),i=F(this.long0+v*(1-x/6*(1+2*g+p-x/20*(5+28*g+24*y+8*p*g+6*p-x/42*(61+662*g+1320*y+720*y*g))))/f)}else r=P*wo(s),i=0;else{var a=Math.exp(o/this.k0),l=.5*(a-1/a),c=this.lat0+s/this.k0,u=Math.cos(c);e=Math.sqrt((1-Math.pow(u,2))/(1+Math.pow(l,2))),r=Math.asin(e),s<0&&(r=-r),l===0&&u===0?i=0:i=F(Math.atan2(l,u)+this.long0)}return n.x=i,n.y=r,n}var vz=["Fast_Transverse_Mercator","Fast Transverse Mercator"],au={init:mz,forward:gz,inverse:yz,names:vz};function Zg(n){var e=Math.exp(n);return e=(e-1/e)/2,e}function Yt(n,e){n=Math.abs(n),e=Math.abs(e);var t=Math.max(n,e),r=Math.min(n,e)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))}function zN(n){var e=1+n,t=e-1;return t===0?n:n*Math.log(e)/t}function $N(n){var e=Math.abs(n);return e=zN(e*(1+e/(Yt(1,e)+1))),n<0?-e:e}function Yg(n,e){for(var t=2*Math.cos(2*e),r=n.length-1,i=n[r],o=0,s;--r>=0;)s=-o+t*i+n[r],o=i,i=s;return e+s*Math.sin(2*e)}function HN(n,e){for(var t=2*Math.cos(e),r=n.length-1,i=n[r],o=0,s;--r>=0;)s=-o+t*i+n[r],o=i,i=s;return Math.sin(e)*s}function qN(n){var e=Math.exp(n);return e=(e+1/e)/2,e}function cC(n,e,t){for(var r=Math.sin(e),i=Math.cos(e),o=Zg(t),s=qN(t),a=2*i*s,l=-2*r*o,c=n.length-1,u=n[c],d=0,f=0,h=0,p,m;--c>=0;)p=f,m=d,f=u,d=h,u=-p+a*f-l*d+n[c],h=-m+l*f+a*d;return a=r*s,l=i*o,[a*u-l*h,a*h+l*u]}function _z(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(au.init.apply(this),this.forward=au.forward,this.inverse=au.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var n=this.es/(1+Math.sqrt(1-this.es)),e=n/(2-n),t=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),t=t*e,this.cgb[1]=t*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=t*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),t=t*e,this.cgb[2]=t*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=t*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),t=t*e,this.cgb[3]=t*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=t*(1237/630+e*(-12/5+e*(-24832/14175))),t=t*e,this.cgb[4]=t*(4174/315+e*(-144838/6237)),this.cbg[4]=t*(-734/315+e*(109598/31185)),t=t*e,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=t*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=t*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),t=t*e,this.utg[2]=t*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=t*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),t=t*e,this.utg[3]=t*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=t*(49561/161280+e*(-179/168+e*(6601661/7257600))),t=t*e,this.utg[4]=t*(-4583/161280+e*(108847/3991680)),this.gtu[4]=t*(34729/80640+e*(-3418889/1995840)),t=t*e,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=t*(212378941/319334400);var r=Yg(this.cbg,this.lat0);this.Zb=-this.Qn*(r+HN(this.gtu,2*r))}function xz(n){var e=F(n.x-this.long0),t=n.y;t=Yg(this.cbg,t);var r=Math.sin(t),i=Math.cos(t),o=Math.sin(e),s=Math.cos(e);t=Math.atan2(r,s*i),e=Math.atan2(o*i,Yt(r,i*s)),e=$N(Math.tan(e));var a=cC(this.gtu,2*t,2*e);t=t+a[0],e=e+a[1];var l,c;return Math.abs(e)<=2.623395162778?(l=this.a*(this.Qn*e)+this.x0,c=this.a*(this.Qn*t+this.Zb)+this.y0):(l=1/0,c=1/0),n.x=l,n.y=c,n}function Ez(n){var e=(n.x-this.x0)*(1/this.a),t=(n.y-this.y0)*(1/this.a);t=(t-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var o=cC(this.utg,2*t,2*e);t=t+o[0],e=e+o[1],e=Math.atan(Zg(e));var s=Math.sin(t),a=Math.cos(t),l=Math.sin(e),c=Math.cos(e);t=Math.atan2(s*c,Yt(l,c*a)),e=Math.atan2(l,c*a),r=F(e+this.long0),i=Yg(this.cgb,t)}else r=1/0,i=1/0;return n.x=r,n.y=i,n}var wz=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"],lu={init:_z,forward:xz,inverse:Ez,names:wz};function WN(n,e){if(n===void 0){if(n=Math.floor((F(e)+Math.PI)*30/Math.PI)+1,n<0)return 0;if(n>60)return 60}return n}var Cz="etmerc";function bz(){var n=WN(this.zone,this.long0);if(n===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(n)-183)*bt,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,lu.init.apply(this),this.forward=lu.forward,this.inverse=lu.inverse}var Mz=["Universal Transverse Mercator System","utm"],XN={init:bz,names:Mz,dependsOn:Cz};function Kg(n,e){return Math.pow((1-n)/(1+n),e)}var Tz=20;function Sz(){var n=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*n*n),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(n/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+je)/(Math.pow(Math.tan(.5*this.lat0+je),this.C)*Kg(this.e*n,this.ratexp))}function Iz(n){var e=n.x,t=n.y;return n.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+je),this.C)*Kg(this.e*Math.sin(t),this.ratexp))-P,n.x=this.C*e,n}function Dz(n){for(var e=1e-14,t=n.x/this.C,r=n.y,i=Math.pow(Math.tan(.5*r+je)/this.K,1/this.C),o=Tz;o>0&&(r=2*Math.atan(i*Kg(this.e*Math.sin(n.y),-.5*this.e))-P,!(Math.abs(r-n.y)<e));--o)n.y=r;return o?(n.x=t,n.y=r,n):null}var Rz=["gauss"],Jg={init:Sz,forward:Iz,inverse:Dz,names:Rz};function Az(){Jg.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function Pz(n){var e,t,r,i;return n.x=F(n.x-this.long0),Jg.forward.apply(this,[n]),e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*t*r),n.x=i*t*Math.sin(n.x),n.y=i*(this.cosc0*e-this.sinc0*t*r),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function Nz(n){var e,t,r,i,o;if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,o=Yt(n.x,n.y)){var s=2*Math.atan2(o,this.R2);e=Math.sin(s),t=Math.cos(s),i=Math.asin(t*this.sinc0+n.y*e*this.cosc0/o),r=Math.atan2(n.x*e,o*this.cosc0*t-n.y*this.sinc0*e)}else i=this.phic0,r=0;return n.x=r,n.y=i,Jg.inverse.apply(this,[n]),n.x=F(n.x+this.long0),n}var Oz=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"],ZN={init:Az,forward:Pz,inverse:Nz,names:Oz};function Fz(n,e,t){return e*=t,Math.tan(.5*(P+n))*Math.pow((1-e)/(1+e),.5*t)}function Lz(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=L&&(this.k0=.5*(1+wo(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=L&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=L&&Math.abs(Math.cos(this.lat_ts))>L&&(this.k0=.5*this.cons*Fn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Kn(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Fn(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-P,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function kz(n){var e=n.x,t=n.y,r=Math.sin(t),i=Math.cos(t),o,s,a,l,c,u,d=F(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=L&&Math.abs(t+this.lat0)<=L?(n.x=NaN,n.y=NaN,n):this.sphere?(o=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(d)),n.x=this.a*o*i*Math.sin(d)+this.x0,n.y=this.a*o*(this.coslat0*r-this.sinlat0*i*Math.cos(d))+this.y0,n):(s=2*Math.atan(this.ssfn_(t,r,this.e))-P,l=Math.cos(s),a=Math.sin(s),Math.abs(this.coslat0)<=L?(c=Kn(this.e,t*this.con,this.con*r),u=2*this.a*this.k0*c/this.cons,n.x=this.x0+u*Math.sin(e-this.long0),n.y=this.y0-this.con*u*Math.cos(e-this.long0),n):(Math.abs(this.sinlat0)<L?(o=2*this.a*this.k0/(1+l*Math.cos(d)),n.y=o*a):(o=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*a+this.cosX0*l*Math.cos(d))),n.y=o*(this.cosX0*a-this.sinX0*l*Math.cos(d))+this.y0),n.x=o*l*Math.sin(d)+this.x0,n))}function jz(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,o,s=Math.sqrt(n.x*n.x+n.y*n.y);if(this.sphere){var a=2*Math.atan(s/(2*this.a*this.k0));return e=this.long0,t=this.lat0,s<=L?(n.x=e,n.y=t,n):(t=Math.asin(Math.cos(a)*this.sinlat0+n.y*Math.sin(a)*this.coslat0/s),Math.abs(this.coslat0)<L?this.lat0>0?e=F(this.long0+Math.atan2(n.x,-1*n.y)):e=F(this.long0+Math.atan2(n.x,n.y)):e=F(this.long0+Math.atan2(n.x*Math.sin(a),s*this.coslat0*Math.cos(a)-n.y*this.sinlat0*Math.sin(a))),n.x=e,n.y=t,n)}else if(Math.abs(this.coslat0)<=L){if(s<=L)return t=this.lat0,e=this.long0,n.x=e,n.y=t,n;n.x*=this.con,n.y*=this.con,r=s*this.cons/(2*this.a*this.k0),t=this.con*hs(this.e,r),e=this.con*F(this.con*this.long0+Math.atan2(n.x,-1*n.y))}else i=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=L?o=this.X0:(o=Math.asin(Math.cos(i)*this.sinX0+n.y*Math.sin(i)*this.cosX0/s),e=F(this.long0+Math.atan2(n.x*Math.sin(i),s*this.cosX0*Math.cos(i)-n.y*this.sinX0*Math.sin(i)))),t=-1*hs(this.e,Math.tan(.5*(P+o)));return n.x=e,n.y=t,n}var Vz=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],YN={init:Lz,forward:kz,inverse:jz,names:Vz,ssfn_:Fz};function Bz(){var n=this.lat0;this.lambda0=this.long0;var e=Math.sin(n),t=this.a,r=this.rf,i=1/r,o=2*i-Math.pow(i,2),s=this.e=Math.sqrt(o);this.R=this.k0*t*Math.sqrt(1-o)/(1-o*Math.pow(e,2)),this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(n),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+n/2)),c=Math.log((1+s*e)/(1-s*e));this.K=a-this.alpha*l+this.alpha*s/2*c}function Gz(n){var e=Math.log(Math.tan(Math.PI/4-n.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(n.y))/(1-this.e*Math.sin(n.y))),r=-this.alpha*(e+t)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),o=this.alpha*(n.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(o));return n.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,n.x=this.R*s+this.x0,n}function Uz(n){for(var e=n.x-this.x0,t=n.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),s=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),a=this.lambda0+s/this.alpha,l=0,c=o,u=-1e3,d=0;Math.abs(c-u)>1e-7;){if(++d>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),u=c,c=2*Math.atan(Math.exp(l))-Math.PI/2}return n.x=a,n.y=c,n}var zz=["somerc"],KN={init:Bz,forward:Gz,inverse:Uz,names:zz};var cu=1e-7;function $z(n){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],t=typeof n.PROJECTION=="object"?Object.keys(n.PROJECTION)[0]:n.PROJECTION;return"no_uoff"in n||"no_off"in n||e.indexOf(t)!==-1}function Hz(){var n,e,t,r,i,o,s,a,l,c,u=0,d,f=0,h=0,p=0,m=0,g=0,y=0,v;this.no_off=$z(this),this.no_rot="no_rot"in this;var x=!1;"alpha"in this&&(x=!0);var E=!1;if("rectified_grid_angle"in this&&(E=!0),x&&(y=this.alpha),E&&(u=this.rectified_grid_angle*bt),x||E)f=this.longc;else if(h=this.long1,m=this.lat1,p=this.long2,g=this.lat2,Math.abs(m-g)<=cu||(n=Math.abs(m))<=cu||Math.abs(n-P)<=cu||Math.abs(Math.abs(this.lat0)-P)<=cu||Math.abs(Math.abs(g)-P)<=cu)throw new Error;var _=1-this.es;e=Math.sqrt(_),Math.abs(this.lat0)>L?(a=Math.sin(this.lat0),t=Math.cos(this.lat0),n=1-this.es*a*a,this.B=t*t,this.B=Math.sqrt(1+this.es*this.B*this.B/_),this.A=this.B*this.k0*e/n,r=this.B*e/(t*Math.sqrt(n)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(Kn(this.e,this.lat0,a),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),x||E?(x?(d=Math.asin(Math.sin(y)/r),E||(u=y)):(d=u,y=Math.asin(r*Math.sin(d))),this.lam0=f-Math.asin(.5*(i-1/i)*Math.tan(d))/this.B):(o=Math.pow(Kn(this.e,m,Math.sin(m)),this.B),s=Math.pow(Kn(this.e,g,Math.sin(g)),this.B),i=this.E/o,l=(s-o)/(s+o),c=this.E*this.E,c=(c-s*o)/(c+s*o),n=h-p,n<-Math.pi?p-=da:n>Math.pi&&(p+=da),this.lam0=F(.5*(h+p)-Math.atan(c*Math.tan(.5*this.B*(h-p))/l)/this.B),d=Math.atan(2*Math.sin(this.B*F(h-this.lam0))/(i-1/i)),u=y=Math.asin(r*Math.sin(d))),this.singam=Math.sin(d),this.cosgam=Math.cos(d),this.sinrot=Math.sin(u),this.cosrot=Math.cos(u),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,v=this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(y))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*d,this.v_pole_n=this.ArB*Math.log(Math.tan(je-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(je+i))}function qz(n){var e={},t,r,i,o,s,a,l,c;if(n.x=n.x-this.lam0,Math.abs(Math.abs(n.y)-P)>L){if(s=this.E/Math.pow(Kn(this.e,n.y,Math.sin(n.y)),this.B),a=1/s,t=.5*(s-a),r=.5*(s+a),o=Math.sin(this.B*n.x),i=(t*this.singam-o*this.cosgam)/r,Math.abs(Math.abs(i)-1)<L)throw new Error;c=.5*this.ArB*Math.log((1-i)/(1+i)),a=Math.cos(this.B*n.x),Math.abs(a)<cu?l=this.A*n.x:l=this.ArB*Math.atan2(t*this.cosgam+o*this.singam,a)}else c=n.y>0?this.v_pole_n:this.v_pole_s,l=this.ArB*n.y;return this.no_rot?(e.x=l,e.y=c):(l-=this.u_0,e.x=c*this.cosrot+l*this.sinrot,e.y=l*this.cosrot-c*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Wz(n){var e,t,r,i,o,s,a,l={};if(n.x=(n.x-this.x0)*(1/this.a),n.y=(n.y-this.y0)*(1/this.a),this.no_rot?(t=n.y,e=n.x):(t=n.x*this.cosrot-n.y*this.sinrot,e=n.y*this.cosrot+n.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*t),i=.5*(r-1/r),o=.5*(r+1/r),s=Math.sin(this.BrA*e),a=(s*this.cosgam+i*this.singam)/o,Math.abs(Math.abs(a)-1)<L)l.x=0,l.y=a<0?-P:P;else{if(l.y=this.E/Math.sqrt((1+a)/(1-a)),l.y=hs(this.e,Math.pow(l.y,1/this.B)),l.y===1/0)throw new Error;l.x=-this.rB*Math.atan2(i*this.cosgam-s*this.singam,Math.cos(this.BrA*e))}return l.x+=this.lam0,l}var Xz=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"],JN={init:Hz,forward:qz,inverse:Wz,names:Xz};function Zz(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<L)){var n=this.b/this.a;this.e=Math.sqrt(1-n*n);var e=Math.sin(this.lat1),t=Math.cos(this.lat1),r=Fn(this.e,e,t),i=Kn(this.e,this.lat1,e),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=Fn(this.e,o,s),l=Kn(this.e,this.lat2,o),c=Kn(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>L?this.ns=Math.log(r/a)/Math.log(i/l):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Yz(n){var e=n.x,t=n.y;Math.abs(2*Math.abs(t)-Math.PI)<=L&&(t=wo(t)*(P-2*L));var r=Math.abs(Math.abs(t)-P),i,o;if(r>L)i=Kn(this.e,t,Math.sin(t)),o=this.a*this.f0*Math.pow(i,this.ns);else{if(r=t*this.ns,r<=0)return null;o=0}var s=this.ns*F(e-this.long0);return n.x=this.k0*(o*Math.sin(s))+this.x0,n.y=this.k0*(this.rh-o*Math.cos(s))+this.y0,n}function Kz(n){var e,t,r,i,o,s=(n.x-this.x0)/this.k0,a=this.rh-(n.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(s*s+a*a),t=1):(e=-Math.sqrt(s*s+a*a),t=-1);var l=0;if(e!==0&&(l=Math.atan2(t*s,t*a)),e!==0||this.ns>0){if(t=1/this.ns,r=Math.pow(e/(this.a*this.f0),t),i=hs(this.e,r),i===-9999)return null}else i=-P;return o=F(l/this.ns+this.long0),n.x=o,n.y=i,n}var Jz=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"],QN={init:Zz,forward:Yz,inverse:Kz,names:Jz};function Qz(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function e6(n){var e,t,r,i,o,s,a,l=n.x,c=n.y,u=F(l-this.long0);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-u*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),o=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(i)),s=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),n.y=a*Math.cos(s)/1,n.x=a*Math.sin(s)/1,this.czech||(n.y*=-1,n.x*=-1),n}function t6(n){var e,t,r,i,o,s,a,l,c=n.x;n.x=n.y,n.y=c,this.czech||(n.y*=-1,n.x*=-1),s=Math.sqrt(n.x*n.x+n.y*n.y),o=Math.atan2(n.y,n.x),i=o/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),t=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),n.x=this.long0-t/this.alfa,a=e,l=0;var u=0;do n.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-n.y)<1e-10&&(l=1),a=n.y,u+=1;while(l===0&&u<15);return u>=15?null:n}var n6=["Krovak","krovak"],e2={init:Qz,forward:e6,inverse:t6,names:n6};function rn(n,e,t,r,i){return n*i-e*Math.sin(2*i)+t*Math.sin(4*i)-r*Math.sin(6*i)}function ps(n){return 1-.25*n*(1+n/16*(3+1.25*n))}function ms(n){return .375*n*(1+.25*n*(1+.46875*n))}function gs(n){return .05859375*n*n*(1+.75*n)}function ys(n){return n*n*n*(35/3072)}function vs(n,e,t){var r=e*t;return n/Math.sqrt(1-r*r)}function _r(n){return Math.abs(n)<P?n:n-wo(n)*Math.PI}function gl(n,e,t,r,i){var o,s;o=n/e;for(var a=0;a<15;a++)if(s=(n-(e*o-t*Math.sin(2*o)+r*Math.sin(4*o)-i*Math.sin(6*o)))/(e-2*t*Math.cos(2*o)+4*r*Math.cos(4*o)-6*i*Math.cos(6*o)),o+=s,Math.abs(s)<=1e-10)return o;return NaN}function r6(){this.sphere||(this.e0=ps(this.es),this.e1=ms(this.es),this.e2=gs(this.es),this.e3=ys(this.es),this.ml0=this.a*rn(this.e0,this.e1,this.e2,this.e3,this.lat0))}function i6(n){var e,t,r=n.x,i=n.y;if(r=F(r-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var o=Math.sin(i),s=Math.cos(i),a=vs(this.a,this.e,o),l=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),u=c*c,d=this.es*s*s/(1-this.es),f=this.a*rn(this.e0,this.e1,this.e2,this.e3,i);e=a*c*(1-u*l*(1/6-(8-l+8*d)*u/120)),t=f-this.ml0+a*o/s*u*(.5+(5-l+6*d)*u/24)}return n.x=e+this.x0,n.y=t+this.y0,n}function o6(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i;if(this.sphere){var o=t+this.lat0;r=Math.asin(Math.sin(o)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(o))}else{var s=this.ml0/this.a+t,a=gl(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-P)<=L)return n.x=this.long0,n.y=P,t<0&&(n.y*=-1),n;var l=vs(this.a,this.e,Math.sin(a)),c=l*l*l/this.a/this.a*(1-this.es),u=Math.pow(Math.tan(a),2),d=e*this.a/l,f=d*d;r=a-l*Math.tan(a)/c*d*d*(.5-(1+3*u)*d*d/24),i=d*(1-f*(u/3+(1+3*u)*u*f/15))/Math.cos(a)}return n.x=F(i+this.long0),n.y=_r(r),n}var s6=["Cassini","Cassini_Soldner","cass"],t2={init:r6,forward:i6,inverse:o6,names:s6};function Fi(n,e){var t;return n>1e-7?(t=n*e,(1-n*n)*(e/(1-t*t)-.5/n*Math.log((1-t)/(1+t)))):2*e}var a6=1,l6=2,c6=3,u6=4;function d6(){var n=Math.abs(this.lat0);if(Math.abs(n-P)<L?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(n)<L?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=Fi(this.e,1),this.mmf=.5/(1-this.es),this.apa=x6(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Fi(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function f6(n){var e,t,r,i,o,s,a,l,c,u,d=n.x,f=n.y;if(d=F(d-this.long0),this.sphere){if(o=Math.sin(f),u=Math.cos(f),r=Math.cos(d),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t=this.mode===this.EQUIT?1+u*r:1+this.sinph0*o+this.cosph0*u*r,t<=L)return null;t=Math.sqrt(2/t),e=t*u*Math.sin(d),t*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*u*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(f+this.lat0)<L)return null;t=je-f*.5,t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)),e=t*Math.sin(d),t*=r}}else{switch(a=0,l=0,c=0,r=Math.cos(d),i=Math.sin(d),o=Math.sin(f),s=Fi(this.e,o),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(a=s/this.qp,l=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:c=1+this.sinb1*a+this.cosb1*l*r;break;case this.EQUIT:c=1+l*r;break;case this.N_POLE:c=P+f,s=this.qp-s;break;case this.S_POLE:c=f-P,s=this.qp+s;break}if(Math.abs(c)<L)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:c=Math.sqrt(2/c),this.mode===this.OBLIQ?t=this.ymf*c*(this.cosb1*a-this.sinb1*l*r):t=(c=Math.sqrt(2/(1+l*r)))*a*this.ymf,e=this.xmf*c*l*i;break;case this.N_POLE:case this.S_POLE:s>=0?(e=(c=Math.sqrt(s))*i,t=r*(this.mode===this.S_POLE?c:-c)):e=t=0;break}}return n.x=this.a*e+this.x0,n.y=this.a*t+this.y0,n}function h6(n){n.x-=this.x0,n.y-=this.y0;var e=n.x/this.a,t=n.y/this.a,r,i,o,s,a,l,c;if(this.sphere){var u=0,d,f=0;if(d=Math.sqrt(e*e+t*t),i=d*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(i),u=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(d)<=L?0:Math.asin(t*f/d),e*=f,t=u*d;break;case this.OBLIQ:i=Math.abs(d)<=L?this.lat0:Math.asin(u*this.sinph0+t*f*this.cosph0/d),e*=f*this.cosph0,t=(u-Math.sin(i)*this.sinph0)*d;break;case this.N_POLE:t=-t,i=P-i;break;case this.S_POLE:i-=P;break}r=t===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,t)}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,t*=this.dd,l=Math.sqrt(e*e+t*t),l<L)return n.x=this.long0,n.y=this.lat0,n;s=2*Math.asin(.5*l/this.rq),o=Math.cos(s),e*=s=Math.sin(s),this.mode===this.OBLIQ?(c=o*this.sinb1+t*s*this.cosb1/l,a=this.qp*c,t=l*this.cosb1*o-t*this.sinb1*s):(c=t*s/l,a=this.qp*c,t=l*o)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(t=-t),a=e*e+t*t,!a)return n.x=this.long0,n.y=this.lat0,n;c=1-a/this.qp,this.mode===this.S_POLE&&(c=-c)}r=Math.atan2(e,t),i=E6(Math.asin(c),this.apa)}return n.x=F(this.long0+r),n.y=i,n}var p6=.3333333333333333,m6=.17222222222222222,g6=.10257936507936508,y6=.06388888888888888,v6=.0664021164021164,_6=.016415012942191543;function x6(n){var e,t=[];return t[0]=n*p6,e=n*n,t[0]+=e*m6,t[1]=e*y6,e*=n,t[0]+=e*g6,t[1]+=e*v6,t[2]=e*_6,t}function E6(n,e){var t=n+n;return n+e[0]*Math.sin(t)+e[1]*Math.sin(t+t)+e[2]*Math.sin(t+t+t)}var w6=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],n2={init:d6,forward:f6,inverse:h6,names:w6,S_POLE:a6,N_POLE:l6,EQUIT:c6,OBLIQ:u6};function xr(n){return Math.abs(n)>1&&(n=n>1?1:-1),Math.asin(n)}function C6(){Math.abs(this.lat1+this.lat2)<L||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Fn(this.e3,this.sin_po,this.cos_po),this.qs1=Fi(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Fn(this.e3,this.sin_po,this.cos_po),this.qs2=Fi(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Fi(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>L?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function b6(n){var e=n.x,t=n.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=Fi(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,o=this.ns0*F(e-this.long0),s=i*Math.sin(o)+this.x0,a=this.rh-i*Math.cos(o)+this.y0;return n.x=s,n.y=a,n}function M6(n){var e,t,r,i,o,s;return n.x-=this.x0,n.y=this.rh-n.y+this.y0,this.ns0>=0?(e=Math.sqrt(n.x*n.x+n.y*n.y),r=1):(e=-Math.sqrt(n.x*n.x+n.y*n.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*n.x,r*n.y)),r=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,s=this.phi1z(this.e3,t)),o=F(i/this.ns0+this.long0),n.x=o,n.y=s,n}function T6(n,e){var t,r,i,o,s,a=xr(.5*e);if(n<L)return a;for(var l=n*n,c=1;c<=25;c++)if(t=Math.sin(a),r=Math.cos(a),i=n*t,o=1-i*i,s=.5*o*o/r*(e/(1-l)-t/o+.5/n*Math.log((1-i)/(1+i))),a=a+s,Math.abs(s)<=1e-7)return a;return null}var S6=["Albers_Conic_Equal_Area","Albers","aea"],r2={init:C6,forward:b6,inverse:M6,names:S6,phi1z:T6};function I6(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function D6(n){var e,t,r,i,o,s,a,l,c=n.x,u=n.y;return r=F(c-this.long0),e=Math.sin(u),t=Math.cos(u),i=Math.cos(r),s=this.sin_p14*e+this.cos_p14*t*i,o=1,s>0||Math.abs(s)<=L?(a=this.x0+this.a*o*t*Math.sin(r)/s,l=this.y0+this.a*o*(this.cos_p14*e-this.sin_p14*t*i)/s):(a=this.x0+this.infinity_dist*t*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*t*i)),n.x=a,n.y=l,n}function R6(n){var e,t,r,i,o,s;return n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,n.x/=this.k0,n.y/=this.k0,(e=Math.sqrt(n.x*n.x+n.y*n.y))?(i=Math.atan2(e,this.rc),t=Math.sin(i),r=Math.cos(i),s=xr(r*this.sin_p14+n.y*t*this.cos_p14/e),o=Math.atan2(n.x*t,e*this.cos_p14*r-n.y*this.sin_p14*t),o=F(this.long0+o)):(s=this.phic0,o=0),n.x=o,n.y=s,n}var A6=["gnom"],i2={init:I6,forward:D6,inverse:R6,names:A6};function o2(n,e){var t=1-(1-n*n)/(2*n)*Math.log((1-n)/(1+n));if(Math.abs(Math.abs(e)-t)<1e-6)return e<0?-1*P:P;for(var r=Math.asin(.5*e),i,o,s,a,l=0;l<30;l++)if(o=Math.sin(r),s=Math.cos(r),a=n*o,i=Math.pow(1-a*a,2)/(2*s)*(e/(1-n*n)-o/(1-a*a)+.5/n*Math.log((1-a)/(1+a))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function P6(){this.sphere||(this.k0=Fn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function N6(n){var e=n.x,t=n.y,r,i,o=F(e-this.long0);if(this.sphere)r=this.x0+this.a*o*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(t)/Math.cos(this.lat_ts);else{var s=Fi(this.e,Math.sin(t));r=this.x0+this.a*this.k0*o,i=this.y0+this.a*s*.5/this.k0}return n.x=r,n.y=i,n}function O6(n){n.x-=this.x0,n.y-=this.y0;var e,t;return this.sphere?(e=F(this.long0+n.x/this.a/Math.cos(this.lat_ts)),t=Math.asin(n.y/this.a*Math.cos(this.lat_ts))):(t=o2(this.e,2*n.y*this.k0/this.a),e=F(this.long0+n.x/(this.a*this.k0))),n.x=e,n.y=t,n}var F6=["cea"],s2={init:P6,forward:N6,inverse:O6,names:F6};function L6(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function k6(n){var e=n.x,t=n.y,r=F(e-this.long0),i=_r(t-this.lat0);return n.x=this.x0+this.a*r*this.rc,n.y=this.y0+this.a*i,n}function j6(n){var e=n.x,t=n.y;return n.x=F(this.long0+(e-this.x0)/(this.a*this.rc)),n.y=_r(this.lat0+(t-this.y0)/this.a),n}var V6=["Equirectangular","Equidistant_Cylindrical","eqc"],a2={init:L6,forward:k6,inverse:j6,names:V6};var l2=20;function B6(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ps(this.es),this.e1=ms(this.es),this.e2=gs(this.es),this.e3=ys(this.es),this.ml0=this.a*rn(this.e0,this.e1,this.e2,this.e3,this.lat0)}function G6(n){var e=n.x,t=n.y,r,i,o,s=F(e-this.long0);if(o=s*Math.sin(t),this.sphere)Math.abs(t)<=L?(r=this.a*s,i=-1*this.a*this.lat0):(r=this.a*Math.sin(o)/Math.tan(t),i=this.a*(_r(t-this.lat0)+(1-Math.cos(o))/Math.tan(t)));else if(Math.abs(t)<=L)r=this.a*s,i=-1*this.ml0;else{var a=vs(this.a,this.e,Math.sin(t))/Math.tan(t);r=a*Math.sin(o),i=this.a*rn(this.e0,this.e1,this.e2,this.e3,t)-this.ml0+a*(1-Math.cos(o))}return n.x=r+this.x0,n.y=i+this.y0,n}function U6(n){var e,t,r,i,o,s,a,l,c;if(r=n.x-this.x0,i=n.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=L)e=F(r/this.a+this.long0),t=0;else{s=this.lat0+i/this.a,a=r*r/this.a/this.a+s*s,l=s;var u;for(o=l2;o;--o)if(u=Math.tan(l),c=-1*(s*(l*u+1)-l-.5*(l*l+a)*u)/((l-s)/u-1),l+=c,Math.abs(c)<=L){t=l;break}e=F(this.long0+Math.asin(r*Math.tan(l)/this.a)/Math.sin(t))}else if(Math.abs(i+this.ml0)<=L)t=0,e=F(this.long0+r/this.a);else{s=(this.ml0+i)/this.a,a=r*r/this.a/this.a+s*s,l=s;var d,f,h,p,m;for(o=l2;o;--o)if(m=this.e*Math.sin(l),d=Math.sqrt(1-m*m)*Math.tan(l),f=this.a*rn(this.e0,this.e1,this.e2,this.e3,l),h=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),p=f/this.a,c=(s*(d*p+1)-p-.5*d*(p*p+a))/(this.es*Math.sin(2*l)*(p*p+a-2*s*p)/(4*d)+(s-p)*(d*h-2/Math.sin(2*l))-h),l-=c,Math.abs(c)<=L){t=l;break}d=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),e=F(this.long0+Math.asin(r*d/this.a)/Math.sin(t))}return n.x=e,n.y=t,n}var z6=["Polyconic","poly"],c2={init:B6,forward:G6,inverse:U6,names:z6};function $6(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function H6(n){var e,t=n.x,r=n.y,i=r-this.lat0,o=t-this.long0,s=i/hl*1e-5,a=o,l=1,c=0;for(e=1;e<=10;e++)l=l*s,c=c+this.A[e]*l;var u=c,d=a,f=1,h=0,p,m,g=0,y=0;for(e=1;e<=6;e++)p=f*u-h*d,m=h*u+f*d,f=p,h=m,g=g+this.B_re[e]*f-this.B_im[e]*h,y=y+this.B_im[e]*f+this.B_re[e]*h;return n.x=y*this.a+this.x0,n.y=g*this.a+this.y0,n}function q6(n){var e,t=n.x,r=n.y,i=t-this.x0,o=r-this.y0,s=o/this.a,a=i/this.a,l=1,c=0,u,d,f=0,h=0;for(e=1;e<=6;e++)u=l*s-c*a,d=c*s+l*a,l=u,c=d,f=f+this.C_re[e]*l-this.C_im[e]*c,h=h+this.C_im[e]*l+this.C_re[e]*c;for(var p=0;p<this.iterations;p++){var m=f,g=h,y,v,x=s,E=a;for(e=2;e<=6;e++)y=m*f-g*h,v=g*f+m*h,m=y,g=v,x=x+(e-1)*(this.B_re[e]*m-this.B_im[e]*g),E=E+(e-1)*(this.B_im[e]*m+this.B_re[e]*g);m=1,g=0;var _=this.B_re[1],w=this.B_im[1];for(e=2;e<=6;e++)y=m*f-g*h,v=g*f+m*h,m=y,g=v,_=_+e*(this.B_re[e]*m-this.B_im[e]*g),w=w+e*(this.B_im[e]*m+this.B_re[e]*g);var b=_*_+w*w;f=(x*_+E*w)/b,h=(E*_-x*w)/b}var M=f,S=h,C=1,R=0;for(e=1;e<=9;e++)C=C*M,R=R+this.D[e]*C;var T=this.lat0+R*hl*1e5,I=this.long0+S;return n.x=I,n.y=T,n}var W6=["New_Zealand_Map_Grid","nzmg"],u2={init:$6,forward:H6,inverse:q6,names:W6};function X6(){}function Z6(n){var e=n.x,t=n.y,r=F(e-this.long0),i=this.x0+this.a*r,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return n.x=i,n.y=o,n}function Y6(n){n.x-=this.x0,n.y-=this.y0;var e=F(this.long0+n.x/this.a),t=2.5*(Math.atan(Math.exp(.8*n.y/this.a))-Math.PI/4);return n.x=e,n.y=t,n}var K6=["Miller_Cylindrical","mill"],d2={init:X6,forward:Z6,inverse:Y6,names:K6};var J6=20;function Q6(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=ou(this.es)}function e$(n){var e,t,r=n.x,i=n.y;if(r=F(r-this.long0),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var o=this.n*Math.sin(i),s=J6;s;--s){var a=(this.m*i+Math.sin(i)-o)/(this.m+Math.cos(i));if(i-=a,Math.abs(a)<L)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),t=this.a*this.C_y*i}else{var l=Math.sin(i),c=Math.cos(i);t=this.a*Co(i,l,c,this.en),e=this.a*r*c/Math.sqrt(1-this.es*l*l)}return n.x=e,n.y=t,n}function t$(n){var e,t,r,i;return n.x-=this.x0,r=n.x/this.a,n.y-=this.y0,e=n.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=xr((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=xr(Math.sin(e)/this.n)),r=F(r+this.long0),e=_r(e)):(e=su(n.y/this.a,this.es,this.en),i=Math.abs(e),i<P?(i=Math.sin(e),t=this.long0+n.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=F(t)):i-L<P&&(r=this.long0)),n.x=r,n.y=e,n}var n$=["Sinusoidal","sinu"],f2={init:Q6,forward:e$,inverse:t$,names:n$};function r$(){}function i$(n){for(var e=n.x,t=n.y,r=F(e-this.long0),i=t,o=Math.PI*Math.sin(t);;){var s=-(i+Math.sin(i)-o)/(1+Math.cos(i));if(i+=s,Math.abs(s)<L)break}i/=2,Math.PI/2-Math.abs(t)<L&&(r=0);var a=.900316316158*this.a*r*Math.cos(i)+this.x0,l=1.4142135623731*this.a*Math.sin(i)+this.y0;return n.x=a,n.y=l,n}function o$(n){var e,t;n.x-=this.x0,n.y-=this.y0,t=n.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),e=Math.asin(t);var r=F(this.long0+n.x/(.900316316158*this.a*Math.cos(e)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*e+Math.sin(2*e))/Math.PI,Math.abs(t)>1&&(t=1);var i=Math.asin(t);return n.x=r,n.y=i,n}var s$=["Mollweide","moll"],h2={init:r$,forward:i$,inverse:o$,names:s$};function a$(){Math.abs(this.lat1+this.lat2)<L||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ps(this.es),this.e1=ms(this.es),this.e2=gs(this.es),this.e3=ys(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Fn(this.e,this.sinphi,this.cosphi),this.ml1=rn(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<L?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Fn(this.e,this.sinphi,this.cosphi),this.ml2=rn(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=rn(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function l$(n){var e=n.x,t=n.y,r;if(this.sphere)r=this.a*(this.g-t);else{var i=rn(this.e0,this.e1,this.e2,this.e3,t);r=this.a*(this.g-i)}var o=this.ns*F(e-this.long0),s=this.x0+r*Math.sin(o),a=this.y0+this.rh-r*Math.cos(o);return n.x=s,n.y=a,n}function c$(n){n.x-=this.x0,n.y=this.rh-n.y+this.y0;var e,t,r,i;this.ns>=0?(t=Math.sqrt(n.x*n.x+n.y*n.y),e=1):(t=-Math.sqrt(n.x*n.x+n.y*n.y),e=-1);var o=0;if(t!==0&&(o=Math.atan2(e*n.x,e*n.y)),this.sphere)return i=F(this.long0+o/this.ns),r=_r(this.g-t/this.a),n.x=i,n.y=r,n;var s=this.g-t/this.a;return r=gl(s,this.e0,this.e1,this.e2,this.e3),i=F(this.long0+o/this.ns),n.x=i,n.y=r,n}var u$=["Equidistant_Conic","eqdc"],p2={init:a$,forward:l$,inverse:c$,names:u$};function d$(){this.R=this.a}function f$(n){var e=n.x,t=n.y,r=F(e-this.long0),i,o;Math.abs(t)<=L&&(i=this.x0+this.R*r,o=this.y0);var s=xr(2*Math.abs(t/Math.PI));(Math.abs(r)<=L||Math.abs(Math.abs(t)-P)<=L)&&(i=this.x0,t>=0?o=this.y0+Math.PI*this.R*Math.tan(.5*s):o=this.y0+Math.PI*this.R*-Math.tan(.5*s));var a=.5*Math.abs(Math.PI/r-r/Math.PI),l=a*a,c=Math.sin(s),u=Math.cos(s),d=u/(c+u-1),f=d*d,h=d*(2/c-1),p=h*h,m=Math.PI*this.R*(a*(d-p)+Math.sqrt(l*(d-p)*(d-p)-(p+l)*(f-p)))/(p+l);r<0&&(m=-m),i=this.x0+m;var g=l+d;return m=Math.PI*this.R*(h*g-a*Math.sqrt((p+l)*(l+1)-g*g))/(p+l),t>=0?o=this.y0+m:o=this.y0-m,n.x=i,n.y=o,n}function h$(n){var e,t,r,i,o,s,a,l,c,u,d,f,h;return n.x-=this.x0,n.y-=this.y0,d=Math.PI*this.R,r=n.x/d,i=n.y/d,o=r*r+i*i,s=-Math.abs(i)*(1+o),a=s-2*i*i+r*r,l=-2*s+1+2*i*i+o*o,h=i*i/l+(2*a*a*a/l/l/l-9*s*a/l/l)/27,c=(s-a*a/3/l)/l,u=2*Math.sqrt(-c/3),d=3*h/c/u,Math.abs(d)>1&&(d>=0?d=1:d=-1),f=Math.acos(d)/3,n.y>=0?t=(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI:t=-(-u*Math.cos(f+Math.PI/3)-a/3/l)*Math.PI,Math.abs(r)<L?e=this.long0:e=F(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(r*r-i*i)+o*o))/2/r),n.x=e,n.y=t,n}var p$=["Van_der_Grinten_I","VanDerGrinten","vandg"],m2={init:d$,forward:f$,inverse:h$,names:p$};function m$(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function g$(n){var e=n.x,t=n.y,r=Math.sin(n.y),i=Math.cos(n.y),o=F(e-this.long0),s,a,l,c,u,d,f,h,p,m,g,y,v,x,E,_,w,b,M,S,C,R,T;return this.sphere?Math.abs(this.sin_p12-1)<=L?(n.x=this.x0+this.a*(P-t)*Math.sin(o),n.y=this.y0-this.a*(P-t)*Math.cos(o),n):Math.abs(this.sin_p12+1)<=L?(n.x=this.x0+this.a*(P+t)*Math.sin(o),n.y=this.y0+this.a*(P+t)*Math.cos(o),n):(b=this.sin_p12*r+this.cos_p12*i*Math.cos(o),_=Math.acos(b),w=_?_/Math.sin(_):1,n.x=this.x0+this.a*w*i*Math.sin(o),n.y=this.y0+this.a*w*(this.cos_p12*r-this.sin_p12*i*Math.cos(o)),n):(s=ps(this.es),a=ms(this.es),l=gs(this.es),c=ys(this.es),Math.abs(this.sin_p12-1)<=L?(u=this.a*rn(s,a,l,c,P),d=this.a*rn(s,a,l,c,t),n.x=this.x0+(u-d)*Math.sin(o),n.y=this.y0-(u-d)*Math.cos(o),n):Math.abs(this.sin_p12+1)<=L?(u=this.a*rn(s,a,l,c,P),d=this.a*rn(s,a,l,c,t),n.x=this.x0+(u+d)*Math.sin(o),n.y=this.y0+(u+d)*Math.cos(o),n):(f=r/i,h=vs(this.a,this.e,this.sin_p12),p=vs(this.a,this.e,r),m=Math.atan((1-this.es)*f+this.es*h*this.sin_p12/(p*i)),g=Math.atan2(Math.sin(o),this.cos_p12*Math.tan(m)-this.sin_p12*Math.cos(o)),g===0?M=Math.asin(this.cos_p12*Math.sin(m)-this.sin_p12*Math.cos(m)):Math.abs(Math.abs(g)-Math.PI)<=L?M=-Math.asin(this.cos_p12*Math.sin(m)-this.sin_p12*Math.cos(m)):M=Math.asin(Math.sin(o)*Math.cos(m)/Math.sin(g)),y=this.e*this.sin_p12/Math.sqrt(1-this.es),v=this.e*this.cos_p12*Math.cos(g)/Math.sqrt(1-this.es),x=y*v,E=v*v,S=M*M,C=S*M,R=C*M,T=R*M,_=h*M*(1-S*E*(1-E)/6+C/8*x*(1-2*E)+R/120*(E*(4-7*E)-3*y*y*(1-7*E))-T/48*x),n.x=this.x0+_*Math.sin(g),n.y=this.y0+_*Math.cos(g),n))}function y$(n){n.x-=this.x0,n.y-=this.y0;var e,t,r,i,o,s,a,l,c,u,d,f,h,p,m,g,y,v,x,E,_,w,b,M;return this.sphere?(e=Math.sqrt(n.x*n.x+n.y*n.y),e>2*P*this.a?void 0:(t=e/this.a,r=Math.sin(t),i=Math.cos(t),o=this.long0,Math.abs(e)<=L?s=this.lat0:(s=xr(i*this.sin_p12+n.y*r*this.cos_p12/e),a=Math.abs(this.lat0)-P,Math.abs(a)<=L?this.lat0>=0?o=F(this.long0+Math.atan2(n.x,-n.y)):o=F(this.long0-Math.atan2(-n.x,n.y)):o=F(this.long0+Math.atan2(n.x*r,e*this.cos_p12*i-n.y*this.sin_p12*r))),n.x=o,n.y=s,n)):(l=ps(this.es),c=ms(this.es),u=gs(this.es),d=ys(this.es),Math.abs(this.sin_p12-1)<=L?(f=this.a*rn(l,c,u,d,P),e=Math.sqrt(n.x*n.x+n.y*n.y),h=f-e,s=gl(h/this.a,l,c,u,d),o=F(this.long0+Math.atan2(n.x,-1*n.y)),n.x=o,n.y=s,n):Math.abs(this.sin_p12+1)<=L?(f=this.a*rn(l,c,u,d,P),e=Math.sqrt(n.x*n.x+n.y*n.y),h=e-f,s=gl(h/this.a,l,c,u,d),o=F(this.long0+Math.atan2(n.x,n.y)),n.x=o,n.y=s,n):(e=Math.sqrt(n.x*n.x+n.y*n.y),g=Math.atan2(n.x,n.y),p=vs(this.a,this.e,this.sin_p12),y=Math.cos(g),v=this.e*this.cos_p12*y,x=-v*v/(1-this.es),E=3*this.es*(1-x)*this.sin_p12*this.cos_p12*y/(1-this.es),_=e/p,w=_-x*(1+x)*Math.pow(_,3)/6-E*(1+3*x)*Math.pow(_,4)/24,b=1-x*w*w/2-_*w*w*w/6,m=Math.asin(this.sin_p12*Math.cos(w)+this.cos_p12*Math.sin(w)*y),o=F(this.long0+Math.asin(Math.sin(g)*Math.sin(w)/Math.cos(m))),M=Math.sin(m),s=Math.atan2((M-this.es*b*this.sin_p12)*Math.tan(m),M*(1-this.es)),n.x=o,n.y=s,n))}var v$=["Azimuthal_Equidistant","aeqd"],g2={init:m$,forward:g$,inverse:y$,names:v$};function _$(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function x$(n){var e,t,r,i,o,s,a,l,c=n.x,u=n.y;return r=F(c-this.long0),e=Math.sin(u),t=Math.cos(u),i=Math.cos(r),s=this.sin_p14*e+this.cos_p14*t*i,o=1,(s>0||Math.abs(s)<=L)&&(a=this.a*o*t*Math.sin(r),l=this.y0+this.a*o*(this.cos_p14*e-this.sin_p14*t*i)),n.x=a,n.y=l,n}function E$(n){var e,t,r,i,o,s,a;return n.x-=this.x0,n.y-=this.y0,e=Math.sqrt(n.x*n.x+n.y*n.y),t=xr(e/this.a),r=Math.sin(t),i=Math.cos(t),s=this.long0,Math.abs(e)<=L?(a=this.lat0,n.x=s,n.y=a,n):(a=xr(i*this.sin_p14+n.y*r*this.cos_p14/e),o=Math.abs(this.lat0)-P,Math.abs(o)<=L?(this.lat0>=0?s=F(this.long0+Math.atan2(n.x,-n.y)):s=F(this.long0-Math.atan2(-n.x,n.y)),n.x=s,n.y=a,n):(s=F(this.long0+Math.atan2(n.x*r,e*this.cos_p14*i-n.y*this.sin_p14*r)),n.x=s,n.y=a,n))}var w$=["ortho"],y2={init:_$,forward:x$,inverse:E$,names:w$};var Tt={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},We={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function C$(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=P-je/2?this.face=Tt.TOP:this.lat0<=-(P-je/2)?this.face=Tt.BOTTOM:Math.abs(this.long0)<=je?this.face=Tt.FRONT:Math.abs(this.long0)<=P+je?this.face=this.long0>0?Tt.RIGHT:Tt.LEFT:this.face=Tt.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function b$(n){var e={x:0,y:0},t,r,i,o,s,a,l={value:0};if(n.x-=this.long0,this.es!==0?t=Math.atan(this.one_minus_f_squared*Math.tan(n.y)):t=n.y,r=n.x,this.face===Tt.TOP)o=P-t,r>=je&&r<=P+je?(l.value=We.AREA_0,i=r-P):r>P+je||r<=-(P+je)?(l.value=We.AREA_1,i=r>0?r-Mt:r+Mt):r>-(P+je)&&r<=-je?(l.value=We.AREA_2,i=r+P):(l.value=We.AREA_3,i=r);else if(this.face===Tt.BOTTOM)o=P+t,r>=je&&r<=P+je?(l.value=We.AREA_0,i=-r+P):r<je&&r>=-je?(l.value=We.AREA_1,i=-r):r<-je&&r>=-(P+je)?(l.value=We.AREA_2,i=-r-P):(l.value=We.AREA_3,i=r>0?-r+Mt:-r-Mt);else{var c,u,d,f,h,p,m;this.face===Tt.RIGHT?r=uu(r,+P):this.face===Tt.BACK?r=uu(r,+Mt):this.face===Tt.LEFT&&(r=uu(r,-P)),f=Math.sin(t),h=Math.cos(t),p=Math.sin(r),m=Math.cos(r),c=h*m,u=h*p,d=f,this.face===Tt.FRONT?(o=Math.acos(c),i=Qg(o,d,u,l)):this.face===Tt.RIGHT?(o=Math.acos(u),i=Qg(o,d,-c,l)):this.face===Tt.BACK?(o=Math.acos(-c),i=Qg(o,d,-u,l)):this.face===Tt.LEFT?(o=Math.acos(-u),i=Qg(o,d,c,l)):(o=i=0,l.value=We.AREA_0)}return a=Math.atan(12/Mt*(i+Math.acos(Math.sin(i)*Math.cos(je))-P)),s=Math.sqrt((1-Math.cos(o))/(Math.cos(a)*Math.cos(a))/(1-Math.cos(Math.atan(1/Math.cos(i))))),l.value===We.AREA_1?a+=P:l.value===We.AREA_2?a+=Mt:l.value===We.AREA_3&&(a+=1.5*Mt),e.x=s*Math.cos(a),e.y=s*Math.sin(a),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,n.x=e.x,n.y=e.y,n}function M$(n){var e={lam:0,phi:0},t,r,i,o,s,a,l,c,u,d={value:0};if(n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a,r=Math.atan(Math.sqrt(n.x*n.x+n.y*n.y)),t=Math.atan2(n.y,n.x),n.x>=0&&n.x>=Math.abs(n.y)?d.value=We.AREA_0:n.y>=0&&n.y>=Math.abs(n.x)?(d.value=We.AREA_1,t-=P):n.x<0&&-n.x>=Math.abs(n.y)?(d.value=We.AREA_2,t=t<0?t+Mt:t-Mt):(d.value=We.AREA_3,t+=P),u=Mt/12*Math.tan(t),s=Math.sin(u)/(Math.cos(u)-1/Math.sqrt(2)),a=Math.atan(s),i=Math.cos(t),o=Math.tan(r),l=1-i*i*o*o*(1-Math.cos(Math.atan(1/Math.cos(a)))),l<-1?l=-1:l>1&&(l=1),this.face===Tt.TOP)c=Math.acos(l),e.phi=P-c,d.value===We.AREA_0?e.lam=a+P:d.value===We.AREA_1?e.lam=a<0?a+Mt:a-Mt:d.value===We.AREA_2?e.lam=a-P:e.lam=a;else if(this.face===Tt.BOTTOM)c=Math.acos(l),e.phi=c-P,d.value===We.AREA_0?e.lam=-a+P:d.value===We.AREA_1?e.lam=-a:d.value===We.AREA_2?e.lam=-a-P:e.lam=a<0?-a-Mt:-a+Mt;else{var f,h,p;f=l,u=f*f,u>=1?p=0:p=Math.sqrt(1-u)*Math.sin(a),u+=p*p,u>=1?h=0:h=Math.sqrt(1-u),d.value===We.AREA_1?(u=h,h=-p,p=u):d.value===We.AREA_2?(h=-h,p=-p):d.value===We.AREA_3&&(u=h,h=p,p=-u),this.face===Tt.RIGHT?(u=f,f=-h,h=u):this.face===Tt.BACK?(f=-f,h=-h):this.face===Tt.LEFT&&(u=f,f=h,h=-u),e.phi=Math.acos(-p)-P,e.lam=Math.atan2(h,f),this.face===Tt.RIGHT?e.lam=uu(e.lam,-P):this.face===Tt.BACK?e.lam=uu(e.lam,-Mt):this.face===Tt.LEFT&&(e.lam=uu(e.lam,+P))}if(this.es!==0){var m,g,y;m=e.phi<0?1:0,g=Math.tan(e.phi),y=this.b/Math.sqrt(g*g+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-y*y)/(this.one_minus_f*y)),m&&(e.phi=-e.phi)}return e.lam+=this.long0,n.x=e.lam,n.y=e.phi,n}function Qg(n,e,t,r){var i;return n<L?(r.value=We.AREA_0,i=0):(i=Math.atan2(e,t),Math.abs(i)<=je?r.value=We.AREA_0:i>je&&i<=P+je?(r.value=We.AREA_1,i-=P):i>P+je||i<=-(P+je)?(r.value=We.AREA_2,i=i>=0?i-Mt:i+Mt):(r.value=We.AREA_3,i+=P)),i}function uu(n,e){var t=n+e;return t<-Mt?t+=da:t>+Mt&&(t-=da),t}var T$=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"],v2={init:C$,forward:b$,inverse:M$,names:T$};var uC=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Cf=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],_2=.8487,x2=1.3523,E2=gr/5,S$=1/E2,du=18,ey=function(n,e){return n[0]+e*(n[1]+e*(n[2]+e*n[3]))},I$=function(n,e){return n[1]+e*(2*n[2]+e*3*n[3])};function D$(n,e,t,r){for(var i=e;r;--r){var o=n(i);if(i-=o,Math.abs(o)<t)break}return i}function R$(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function A$(n){var e=F(n.x-this.long0),t=Math.abs(n.y),r=Math.floor(t*E2);r<0?r=0:r>=du&&(r=du-1),t=gr*(t-S$*r);var i={x:ey(uC[r],t)*e,y:ey(Cf[r],t)};return n.y<0&&(i.y=-i.y),i.x=i.x*this.a*_2+this.x0,i.y=i.y*this.a*x2+this.y0,i}function P$(n){var e={x:(n.x-this.x0)/(this.a*_2),y:Math.abs(n.y-this.y0)/(this.a*x2)};if(e.y>=1)e.x/=uC[du][0],e.y=n.y<0?-P:P;else{var t=Math.floor(e.y*du);for(t<0?t=0:t>=du&&(t=du-1);;)if(Cf[t][0]>e.y)--t;else if(Cf[t+1][0]<=e.y)++t;else break;var r=Cf[t],i=5*(e.y-r[0])/(Cf[t+1][0]-r[0]);i=D$(function(o){return(ey(r,o)-e.y)/I$(r,o)},i,L,100),e.x/=ey(uC[t],i),e.y=(5*t+i)*bt,n.y<0&&(e.y=-e.y)}return e.x=F(e.x+this.long0),e}var N$=["Robinson","robin"],w2={init:R$,forward:A$,inverse:P$,names:N$};function O$(){this.name="geocent"}function F$(n){var e=Hg(n,this.es,this.a);return e}function L$(n){var e=qg(n,this.es,this.a,this.b);return e}var k$=["Geocentric","geocentric","geocent","Geocent"],C2={init:O$,forward:F$,inverse:L$,names:k$};var Ln={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},bf={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function j$(){if(Object.keys(bf).forEach(function(t){if(typeof this[t]>"u")this[t]=bf[t].def;else{if(bf[t].num&&isNaN(this[t]))throw new Error("Invalid parameter value, must be numeric "+t+" = "+this[t]);bf[t].num&&(this[t]=parseFloat(this[t]))}bf[t].degrees&&(this[t]=this[t]*bt)}.bind(this)),Math.abs(Math.abs(this.lat0)-P)<L?this.mode=this.lat0<0?Ln.S_POLE:Ln.N_POLE:Math.abs(this.lat0)<L?this.mode=Ln.EQUIT:(this.mode=Ln.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var n=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(n),this.sw=Math.sin(n)}function V$(n){n.x-=this.long0;var e=Math.sin(n.y),t=Math.cos(n.y),r=Math.cos(n.x),i,o;switch(this.mode){case Ln.OBLIQ:o=this.sinph0*e+this.cosph0*t*r;break;case Ln.EQUIT:o=t*r;break;case Ln.S_POLE:o=-e;break;case Ln.N_POLE:o=e;break}switch(o=this.pn1/(this.p-o),i=o*t*Math.sin(n.x),this.mode){case Ln.OBLIQ:o*=this.cosph0*e-this.sinph0*t*r;break;case Ln.EQUIT:o*=e;break;case Ln.N_POLE:o*=-(t*r);break;case Ln.S_POLE:o*=t*r;break}var s,a;return s=o*this.cg+i*this.sg,a=1/(s*this.sw*this.h1+this.cw),i=(i*this.cg-o*this.sg)*this.cw*a,o=s*a,n.x=i*this.a,n.y=o*this.a,n}function B$(n){n.x/=this.a,n.y/=this.a;var e={x:n.x,y:n.y},t,r,i;i=1/(this.pn1-n.y*this.sw),t=this.pn1*n.x*i,r=this.pn1*n.y*this.cw*i,n.x=t*this.cg+r*this.sg,n.y=r*this.cg-t*this.sg;var o=Yt(n.x,n.y);if(Math.abs(o)<L)e.x=0,e.y=n.y;else{var s,a;switch(a=1-o*o*this.pfact,a=(this.p-Math.sqrt(a))/(this.pn1/o+o/this.pn1),s=Math.sqrt(1-a*a),this.mode){case Ln.OBLIQ:e.y=Math.asin(s*this.sinph0+n.y*a*this.cosph0/o),n.y=(s-this.sinph0*Math.sin(e.y))*o,n.x*=a*this.cosph0;break;case Ln.EQUIT:e.y=Math.asin(n.y*a/o),n.y=s*o,n.x*=a;break;case Ln.N_POLE:e.y=Math.asin(s),n.y=-n.y;break;case Ln.S_POLE:e.y=-Math.asin(s);break}e.x=Math.atan2(n.x,n.y)}return n.x=e.x+this.long0,n.y=e.y,n}var G$=["Tilted_Perspective","tpers"],b2={init:j$,forward:V$,inverse:B$,names:G$};function U$(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var n=1-this.es,e=1/n;this.radius_p=Math.sqrt(n),this.radius_p2=n,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function z$(n){var e=n.x,t=n.y,r,i,o,s;if(e=e-this.long0,this.shape==="ellipse"){t=Math.atan(this.radius_p2*Math.tan(t));var a=this.radius_p/Yt(this.radius_p*Math.cos(t),Math.sin(t));if(i=a*Math.cos(e)*Math.cos(t),o=a*Math.sin(e)*Math.cos(t),s=a*Math.sin(t),(this.radius_g-i)*i-o*o-s*s*this.radius_p_inv2<0)return n.x=Number.NaN,n.y=Number.NaN,n;r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(o/Yt(s,r)),n.y=this.radius_g_1*Math.atan(s/r)):(n.x=this.radius_g_1*Math.atan(o/r),n.y=this.radius_g_1*Math.atan(s/Yt(o,r)))}else this.shape==="sphere"&&(r=Math.cos(t),i=Math.cos(e)*r,o=Math.sin(e)*r,s=Math.sin(t),r=this.radius_g-i,this.flip_axis?(n.x=this.radius_g_1*Math.atan(o/Yt(s,r)),n.y=this.radius_g_1*Math.atan(s/r)):(n.x=this.radius_g_1*Math.atan(o/r),n.y=this.radius_g_1*Math.atan(s/Yt(o,r))));return n.x=n.x*this.a,n.y=n.y*this.a,n}function $$(n){var e=-1,t=0,r=0,i,o,s,a;if(n.x=n.x/this.a,n.y=n.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Yt(1,r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Yt(1,t));var l=r/this.radius_p;if(i=t*t+l*l+e*e,o=2*this.radius_g*e,s=o*o-4*i*this.C,s<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-o-Math.sqrt(s))/(2*i),e=this.radius_g+a*e,t*=a,r*=a,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e),n.y=Math.atan(this.radius_p_inv2*Math.tan(n.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(n.y/this.radius_g_1),t=Math.tan(n.x/this.radius_g_1)*Math.sqrt(1+r*r)):(t=Math.tan(n.x/this.radius_g_1),r=Math.tan(n.y/this.radius_g_1)*Math.sqrt(1+t*t)),i=t*t+r*r+e*e,o=2*this.radius_g*e,s=o*o-4*i*this.C,s<0)return n.x=Number.NaN,n.y=Number.NaN,n;a=(-o-Math.sqrt(s))/(2*i),e=this.radius_g+a*e,t*=a,r*=a,n.x=Math.atan2(t,e),n.y=Math.atan(r*Math.cos(n.x)/e)}return n.x=n.x+this.long0,n}var H$=["Geostationary Satellite View","Geostationary_Satellite","geos"],M2={init:U$,forward:z$,inverse:$$,names:H$};var Mf=1.340264,Tf=-.081106,Sf=893e-6,If=.003796,ty=Math.sqrt(3)/2;function q$(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function W$(n){var e=F(n.x-this.long0),t=n.y,r=Math.asin(ty*Math.sin(t)),i=r*r,o=i*i*i;return n.x=e*Math.cos(r)/(ty*(Mf+3*Tf*i+o*(7*Sf+9*If*i))),n.y=r*(Mf+Tf*i+o*(Sf+If*i)),n.x=this.a*n.x+this.x0,n.y=this.a*n.y+this.y0,n}function X$(n){n.x=(n.x-this.x0)/this.a,n.y=(n.y-this.y0)/this.a;var e=1e-9,t=12,r=n.y,i,o,s,a,l,c;for(c=0;c<t&&(i=r*r,o=i*i*i,s=r*(Mf+Tf*i+o*(Sf+If*i))-n.y,a=Mf+3*Tf*i+o*(7*Sf+9*If*i),r-=l=s/a,!(Math.abs(l)<e));++c);return i=r*r,o=i*i*i,n.x=ty*n.x*(Mf+3*Tf*i+o*(7*Sf+9*If*i))/Math.cos(r),n.y=Math.asin(Math.sin(r)/ty),n.x=F(n.x+this.long0),n}var Z$=["eqearth","Equal Earth","Equal_Earth"],T2={init:q$,forward:W$,inverse:X$,names:Z$};var Df=1e-10;function Y$(){var n;if(this.phi1=this.lat1,Math.abs(this.phi1)<Df)throw new Error;this.es?(this.en=ou(this.es),this.m1=Co(this.phi1,this.am1=Math.sin(this.phi1),n=Math.cos(this.phi1),this.en),this.am1=n/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=J$,this.forward=K$):(Math.abs(this.phi1)+Df>=P?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=eH,this.forward=Q$)}function K$(n){var e=F(n.x-(this.long0||0)),t=n.y,r,i,o;return r=this.am1+this.m1-Co(t,i=Math.sin(t),o=Math.cos(t),this.en),i=o*e/(r*Math.sqrt(1-this.es*i*i)),n.x=r*Math.sin(i),n.y=this.am1-r*Math.cos(i),n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function J$(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r,i;if(t=Yt(n.x,n.y=this.am1-n.y),i=su(this.am1+this.m1-t,this.es,this.en),(e=Math.abs(i))<P)e=Math.sin(i),r=t*Math.atan2(n.x,n.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-P)<=Df)r=0;else throw new Error;return n.x=F(r+(this.long0||0)),n.y=_r(i),n}function Q$(n){var e=F(n.x-(this.long0||0)),t=n.y,r,i;return i=this.cphi1+this.phi1-t,Math.abs(i)>Df?(n.x=i*Math.sin(r=e*Math.cos(t)/i),n.y=this.cphi1-i*Math.cos(r)):n.x=n.y=0,n.x=this.a*n.x+(this.x0||0),n.y=this.a*n.y+(this.y0||0),n}function eH(n){n.x=(n.x-(this.x0||0))/this.a,n.y=(n.y-(this.y0||0))/this.a;var e,t,r=Yt(n.x,n.y=this.cphi1-n.y);if(t=this.cphi1+this.phi1-r,Math.abs(t)>P)throw new Error;return Math.abs(Math.abs(t)-P)<=Df?e=0:e=r*Math.atan2(n.x,n.y)/Math.cos(t),n.x=F(e+(this.long0||0)),n.y=_r(t),n}var tH=["bonne","Bonne (Werner lat_1=90)"],S2={init:Y$,names:tH};function I2(n){n.Proj.projections.add(au),n.Proj.projections.add(lu),n.Proj.projections.add(XN),n.Proj.projections.add(ZN),n.Proj.projections.add(YN),n.Proj.projections.add(KN),n.Proj.projections.add(JN),n.Proj.projections.add(QN),n.Proj.projections.add(e2),n.Proj.projections.add(t2),n.Proj.projections.add(n2),n.Proj.projections.add(r2),n.Proj.projections.add(i2),n.Proj.projections.add(s2),n.Proj.projections.add(a2),n.Proj.projections.add(c2),n.Proj.projections.add(u2),n.Proj.projections.add(d2),n.Proj.projections.add(f2),n.Proj.projections.add(h2),n.Proj.projections.add(p2),n.Proj.projections.add(m2),n.Proj.projections.add(g2),n.Proj.projections.add(y2),n.Proj.projections.add(v2),n.Proj.projections.add(w2),n.Proj.projections.add(C2),n.Proj.projections.add(b2),n.Proj.projections.add(M2),n.Proj.projections.add(T2),n.Proj.projections.add(S2)}yr.defaultDatum="WGS84";yr.Proj=fa;yr.WGS84=new yr.Proj("WGS84");yr.Point=VN;yr.toPoint=Xg;yr.defs=eu;yr.nadgrid=nC;yr.transform=ml;yr.mgrs=LN;yr.version="__VERSION__";I2(yr);var Rf=yr;var ny="NetherlandsRDNewQuad",dC="EuropeanETRS89_LAEAQuad";function fC(){Rf.defs("EPSG:28992","+proj=sterea +lat_0=52.15616055555555 +lon_0=5.38763888888889 +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +towgs84=565.417,50.3319,465.552,-0.398957,0.343988,-1.8774,4.0725 +units=m +no_defs"),Rf.defs("EPSG:3035","+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs"),Rf.defs("EPSG:4258","+proj=longlat +ellps=GRS80 +no_defs +type=crs"),WP(Rf)}function D2(){let n=[-285401.92,22598.08,595401.9199999999,903401.9199999999],e=new un({code:"EPSG:28992",units:"m",extent:n}),t=[3440.64,1720.32,860.16,430.08,215.04,107.52,53.76,26.88,13.44,6.72,3.36,1.68,.84,.42,.21],r=new Array(15);for(let i=0;i<15;++i)r[i]="EPSG:28992:"+i;return{projection:e,resolutions:t,matrixIds:r}}var Af=class{constructor(e){fC(),this._tileUrl=e}get Projection(){let e=new un({code:"EPSG:28992",units:"m",extent:[-285401.92,22598.08,595401.92,903401.92],axisOrientation:"enu",global:!1}),t=new un({code:"EPSG:3857",units:"m",extent:[-20037508342789244e-9,-20037508342789244e-9,20037508342789244e-9,20037508342789244e-9],worldExtent:[-180,-85,180,85],axisOrientation:"enu",global:!0}),r=new un({axisOrientation:"neu",code:"EPSG:3035",units:"m",extent:[2e6,2.1649406031185603e6,5394791161618613e-9,55e5]});return this._tileUrl.includes(ny)?e:this._tileUrl.includes(dC)?r:t}};var Pf={dataProjection:"EPSG:4326",visualProjection:"EPSG:3857"},R2=(()=>{class n{constructor(t,r){this.logger=t,this.http=r}getFeatures(t){return this.logger.log(JSON.stringify(t)),this.http.get(t.url).pipe(ue(r=>new us().readFeatures(r,{dataProjection:t.dataMapping.dataProjection,featureProjection:t.dataMapping.visualProjection})),Ts(r=>(this.logger.error("Error fetching features:",r),tr([]))))}getProjectionMapping(t="http://www.opengis.net/def/crs/OGC/1.3/CRS84"){if(fC(),t){if(t.substring(t.lastIndexOf("/")+1).toLocaleUpperCase()==="CRS84")return Pf;if(t.toLowerCase().startsWith("http://www.opengis.net/def/crs/epsg/")){let r="EPSG:"+t.substring(t.lastIndexOf("/")+1);return r==="EPSG:3035"||r==="EPSG:4258"?{dataProjection:r,visualProjection:"EPSG:3857"}:{dataProjection:r,visualProjection:r}}return{dataProjection:t,visualProjection:t}}return{dataProjection:t,visualProjection:t}}static{this.\u0275fac=function(r){return new(r||n)(U(Ct),U(lr))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ry={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"},fu=class extends Ut{constructor(e,t){super(e),this.feature=t}};function rH(n,e){let t=[];for(let r=0;r<e.length;++r){let o=e[r].getGeometry();A2(n,o,t)}return t}function iy(n,e){return ur(n[0],n[1],e[0],e[1])}function hu(n,e){let t=n.length;return e<0?n[e+t]:e>=t?n[e-t]:n[e]}function oy(n,e,t){let r,i;e<t?(r=e,i=t):(r=t,i=e);let o=Math.ceil(r),s=Math.floor(i);if(o>s){let l=pu(n,r),c=pu(n,i);return iy(l,c)}let a=0;if(r<o){let l=pu(n,r),c=hu(n,o);a+=iy(l,c)}if(s<i){let l=hu(n,s),c=pu(n,i);a+=iy(l,c)}for(let l=o;l<s-1;++l){let c=hu(n,l),u=hu(n,l+1);a+=iy(c,u)}return a}function A2(n,e,t){if(e instanceof vn){sy(n,e.getCoordinates(),!1,t);return}if(e instanceof oo){let r=e.getCoordinates();for(let i=0,o=r.length;i<o;++i)sy(n,r[i],!1,t);return}if(e instanceof An){let r=e.getCoordinates();for(let i=0,o=r.length;i<o;++i)sy(n,r[i],!0,t);return}if(e instanceof so){let r=e.getCoordinates();for(let i=0,o=r.length;i<o;++i){let s=r[i];for(let a=0,l=s.length;a<l;++a)sy(n,s[a],!0,t)}return}if(e instanceof is){let r=e.getGeometries();for(let i=0;i<r.length;++i)A2(n,r[i],t);return}}var hC={index:-1,endIndex:NaN};function iH(n,e,t,r){let i=n[0],o=n[1],s=1/0,a=-1,l=NaN;for(let d=0;d<e.targets.length;++d){let f=e.targets[d],h=f.coordinates,p=1/0,m;for(let g=0;g<h.length-1;++g){let y=h[g],v=h[g+1],x=P2(i,o,y,v);x.squaredDistance<p&&(p=x.squaredDistance,m=g+x.along)}p<s&&(s=p,f.ring&&e.targetIndex===d&&(f.endIndex>f.startIndex?m<f.startIndex&&(m+=h.length):f.endIndex<f.startIndex&&m>f.startIndex&&(m-=h.length)),l=m,a=d)}let c=e.targets[a],u=c.ring;if(e.targetIndex===a&&u){let d=pu(c.coordinates,l),f=t.getPixelFromCoordinate(d);Ex(f,e.startPx)>r&&(u=!1)}if(u){let d=c.coordinates,f=d.length,h=c.startIndex,p=l;if(h<p){let m=oy(d,h,p);oy(d,h,p-f)<m&&(l-=f)}else{let m=oy(d,h,p);oy(d,h,p+f)<m&&(l+=f)}}return hC.index=a,hC.endIndex=l,hC}function sy(n,e,t,r){let i=n[0],o=n[1];for(let s=0,a=e.length-1;s<a;++s){let l=e[s],c=e[s+1],u=P2(i,o,l,c);if(u.squaredDistance===0){let d=s+u.along;r.push({coordinates:e,ring:t,startIndex:d,endIndex:d});return}}}var pC={along:0,squaredDistance:0};function P2(n,e,t,r){let i=t[0],o=t[1],s=r[0],a=r[1],l=s-i,c=a-o,u=0,d=i,f=o;return(l!==0||c!==0)&&(u=xe(((n-i)*l+(e-o)*c)/(l*l+c*c),0,1),d+=l*u,f+=c*u),pC.along=u,pC.squaredDistance=Gs(ur(n,e,d,f),10),pC}function pu(n,e){let t=n.length,r=Math.floor(e),i=e-r;r>=t?r-=t:r<0&&(r+=t);let o=r+1;o>=t&&(o-=t);let s=n[r],a=s[0],l=s[1],c=n[o],u=c[0]-a,d=c[1]-l;return[a+u*i,l+d*i]}var mC=class extends ni{constructor(e){let t=e;t.stopDown||(t.stopDown=$r),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=sH(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Ci,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let r=e.geometryFunction;if(!r){let i=this.mode_;if(i==="Circle")r=(o,s,a)=>{let l=s||new kR([NaN,NaN]),c=Wn(o[0],a),u=xx(c,Wn(o[o.length-1],a));l.setCenterAndRadius(c,Math.sqrt(u),this.geometryLayout_);let d=Xr();return d&&l.transform(a,d),l};else{let o;i==="Point"?o=dn:i==="LineString"?o=vn:i==="Polygon"&&(o=An),r=(s,a,l)=>(a?i==="Polygon"?s[0].length?a.setCoordinates([s[0].concat([s[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(s,this.geometryLayout_):a=new o(s,this.geometryLayout_),a)}}this.geometryFunction_=r,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new ho({source:new Ir({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:oH(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:Bc,this.freehandCondition_,e.freehand?this.freehandCondition_=lf:this.freehandCondition_=e.freehandCondition?e.freehandCondition:_g,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(sf.ACTIVE,this.updateState_)}setTrace(e){let t;e?e===!0?t=lf:t=e:t=FA,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===H.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let t=e.type===ke.POINTERMOVE,r=!0;return!this.freehand_&&this.lastDragTime_&&e.type===ke.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===ke.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),r=!1):this.freehand_&&e.type===ke.POINTERDOWN?r=!1:t&&this.getPointerCount()<2?(r=e.type===ke.POINTERMOVE,r&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===ke.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===ke.DBLCLICK&&(r=!1),super.handleEvent(e)&&r}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new ei(ke.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}let t=this.getMap(),r=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),i=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),o=Fs([r,i]),s=this.traceSource_.getFeaturesInExtent(o);if(s.length===0)return;let a=rH(e.coordinate,s);a.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){let r=e.startIndex<=e.endIndex,i=e.startIndex<=t;r===i?r&&t>e.endIndex||!r&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(r&&t<e.endIndex||!r&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let r=0;if(e<t){let i=Math.ceil(e),o=Math.floor(t);o===t&&(o-=1),r=o-i+1}else{let i=Math.floor(e),o=Math.ceil(t);o===t&&(o+=1),r=i-o+1}r>0&&this.removeLastPoints_(r)}addTracedCoordinates_(e,t,r){if(t===r)return;let i=[];if(t<r){let o=Math.ceil(t),s=Math.floor(r);s===r&&(s-=1);for(let a=o;a<=s;++a)i.push(hu(e.coordinates,a))}else{let o=Math.floor(t),s=Math.ceil(r);s===r&&(s+=1);for(let a=o;a>=s;--a)i.push(hu(e.coordinates,a))}i.length&&this.appendCoordinates(i)}updateTrace_(e){let t=this.traceState_;if(!t.active||t.targetIndex===-1&&Ex(t.startPx,e.pixel)<this.snapTolerance_)return;let r=iH(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==r.index){if(t.targetIndex!==-1){let l=t.targets[t.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}let a=t.targets[r.index];this.addTracedCoordinates_(a,a.startIndex,r.endIndex)}else{let a=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(a,r.endIndex)}t.targetIndex=r.index;let i=t.targets[t.targetIndex];i.endIndex=r.endIndex;let o=pu(i.coordinates,i.endIndex),s=this.getMap().getPixelFromCoordinate(o);e.coordinate=o,e.pixel=[Math.round(s[0]),Math.round(s[1])]}handleUpEvent(e){let t=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);let r=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){let i=!this.finishCoordinate_;i&&this.startDrawing_(e.coordinate),!i&&this.freehand_?this.finishDrawing():!this.freehand_&&(!i||this.mode_==="Point")&&(this.atFinish_(e.pixel,r)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){let t=this.downPx_,r=e.pixel,i=t[0]-r[0],o=t[1]-r[1],s=i*i+o*o;if(this.shouldHandle_=this.freehand_?s>this.squaredClickTolerance_:s<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,t){let r=!1;if(this.sketchFeature_){let i=!1,o=[this.finishCoordinate_],s=this.mode_;if(s==="Point")r=!0;else if(s==="Circle")r=this.sketchCoords_.length===2;else if(s==="LineString")i=!t&&this.sketchCoords_.length>this.minPoints_;else if(s==="Polygon"){let a=this.sketchCoords_;i=a[0].length>this.minPoints_,o=[a[0][0],a[0][a[0].length-2]],t?o=[a[0][0]]:o=[a[0][0],a[0][a[0].length-2]]}if(i){let a=this.getMap();for(let l=0,c=o.length;l<c;l++){let u=o[l],d=a.getPixelFromCoordinate(u),f=e[0]-d[0],h=e[1]-d[1],p=this.freehand_?1:this.snapTolerance_;if(r=Math.sqrt(f*f+h*h)<=p,r){this.finishCoordinate_=u;break}}}}return r}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new zt(new dn(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new zt);let t=e.getLinearRing(0),r=this.sketchLine_.getGeometry();r?(r.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),r.changed()):(r=new vn(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(r))}startDrawing_(e){let t=this.getMap().getView().getProjection(),r=Cd(this.geometryLayout_);for(;e.length<r;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new zt(new vn(this.sketchLineCoords_)));let i=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new zt,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new fu(ry.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){let t=this.getMap(),r=this.sketchFeature_.getGeometry(),i=t.getView().getProjection(),o=Cd(this.geometryLayout_),s,a;for(;e.length<o;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(s=this.sketchCoords_[0],a=s[s.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(s=this.sketchCoords_,a=s[s.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,r,i),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),r.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(r):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){let t=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),i,o,s=this.mode_;return s==="LineString"||s==="Circle"?(this.finishCoordinate_=e.slice(),o=this.sketchCoords_,o.length>=this.maxPoints_&&(this.freehand_?o.pop():i=!0),o.push(e.slice()),this.geometryFunction_(o,t,r)):s==="Polygon"&&(o=this.sketchCoords_[0],o.length>=this.maxPoints_&&(this.freehand_?o.pop():i=!0),o.push(e.slice()),i&&(this.finishCoordinate_=o[0]),this.geometryFunction_(this.sketchCoords_,t,r)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),i?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;let t=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),i=this.mode_;for(let o=0;o<e;++o){let s;if(i==="LineString"||i==="Circle"){if(s=this.sketchCoords_,s.splice(-2,1),s.length>=2){this.finishCoordinate_=s[s.length-2].slice();let a=this.finishCoordinate_.slice();s[s.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(s,t,r),t.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if(i==="Polygon"){s=this.sketchCoords_[0],s.splice(-2,1);let a=this.sketchLine_.getGeometry();if(s.length>=2){let l=s[s.length-2].slice();s[s.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(s),this.geometryFunction_(this.sketchCoords_,t,r)}if(s.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){let e=this.abortDrawing_();if(!e)return null;let t=this.sketchCoords_,r=e.getGeometry(),i=this.getMap().getView().getProjection();return this.mode_==="LineString"?(t.pop(),this.geometryFunction_(t,r,i)):this.mode_==="Polygon"&&(t[0].pop(),this.geometryFunction_(t,r,i),t=r.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new Ri([t])):this.type_==="MultiLineString"?e.setGeometry(new oo([t])):this.type_==="MultiPolygon"&&e.setGeometry(new so([t])),this.dispatchEvent(new fu(ry.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;let e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){let e=this.abortDrawing_();e&&this.dispatchEvent(new fu(ry.DRAWABORT,e))}appendCoordinates(e){let t=this.mode_,r=!this.sketchFeature_;r&&this.startDrawing_(e[0]);let i;if(t==="LineString"||t==="Circle")i=this.sketchCoords_;else if(t==="Polygon")i=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;r&&i.shift(),i.pop();for(let s=0;s<e.length;s++)this.addToDrawing_(e[s]);let o=e[e.length-1];this.sketchFeature_=this.addToDrawing_(o),this.modifyDrawing_(o)}extend(e){let r=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=r.getCoordinates();let i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new zt(new dn(i)),this.updateSketchFeatures_(),this.dispatchEvent(new fu(ry.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){let e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);let t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){let e=this.getMap(),t=this.getActive();(!e||!t)&&this.abortDrawing(),this.overlay_.setMap(t?e:null)}};function oH(){let n=$R();return function(e,t){return n[e.getGeometry().getType()]}}function N2(){return function(n,e,t){let r=Fs([n[0],n[n.length-1]].map(function(s){return Wn(s,t)})),i=[[Xo(r),js(r),Vs(r),ut(r),Xo(r)]];e?e.setCoordinates(i):e=new An(i);let o=Xr();return o&&e.transform(t,o),e}}function sH(n){switch(n){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+n)}}var gC=mC;function Nf(n,e,t){let i=e.transform(n.getView().getProjection(),"EPSG:4326").getExtent().join(",");t.emit(i)}var ay=class extends Rr{constructor(e,t){let r=t||{},i=document.createElement("button"),o=document.createElement("div");o.className="boundingboxcontrol ol-unselectable ol-control",i.title="Draw boundingbox",o.appendChild(i),super({element:o,target:r.target}),this.boxEmitter=e,i.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" class = "innersvg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M368 80h32v32H368V80zM352 32c-17.7 0-32 14.3-32 32H128c0-17.7-14.3-32-32-32H32C14.3 32 0 46.3 0 64v64c0 17.7 14.3 32 32 32V352c-17.7 0-32 14.3-32 32v64c0 17.7 14.3 32 32 32H96c17.7 0 32-14.3 32-32H320c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32V384c0-17.7-14.3-32-32-32V160c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32H352zM96 160c17.7 0 32-14.3 32-32H320c0 17.7 14.3 32 32 32V352c-17.7 0-32 14.3-32 32H128c0-17.7-14.3-32-32-32V160zM48 400H80v32H48V400zm320 32V400h32v32H368zM48 112V80H80v32H48z"/></svg>
      `,i.addEventListener("click",this.addBox.bind(this),!1)}addBox(){let e=new gC({source:new Ir({}),type:"Circle",geometryFunction:N2()});e.on("drawend",t=>{let r=this.getMap(),i=t.feature,o=i.getGeometry();if(o){Nf(r,o,this.boxEmitter);let s=new Xt({stroke:new tn({color:"blue",width:3}),fill:new Wt({color:"rgba(0, 0, 255, 0.06)"})}),a=new Ir({});a.addFeature(i);let l=new ho({source:a,style:s});r.addLayer(l),r.removeInteraction(e)}}),this.getMap().addInteraction(e)}};var ly=class extends Rr{constructor(e,t){let r=t||{},i=document.createElement("button"),o=document.createElement("div");o.className="fullboxcontrol ol-unselectable ol-control",i.title="Get Features in map",o.appendChild(i),super({element:o,target:r.target}),this.boxEmitter=e,i.innerHTML=`
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M86.6 9.4C74.1-3.1 53.9-3.1 41.4 9.4s-12.5 32.8 0 45.3L122.7 136 30.6 228.1c-37.5 37.5-37.5 98.3 0 135.8L148.1 481.4c37.5 37.5 98.3 37.5 135.8 0L474.3 290.9c28.1-28.1 28.1-73.7 0-101.8L322.9 37.7c-28.1-28.1-73.7-28.1-101.8 0L168 90.7 86.6 9.4zM168 181.3l49.4 49.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L213.3 136l53.1-53.1c3.1-3.1 8.2-3.1 11.3 0L429.1 234.3c3.1 3.1 3.1 8.2 0 11.3L386.7 288H67.5c1.4-5.4 4.2-10.4 8.4-14.6L168 181.3z"/></svg>      `,i.addEventListener("click",this.addFullBox.bind(this),!1)}addFullBox(){let e=this.getMap(),t=e.getView().calculateExtent(e.getSize()),r=to(t);Nf(e,r,this.boxEmitter)}};function O2(n){return n!=null&&`${n}`!="false"}function aH(n){throw new Error(`ERROR! Reached forbidden guard function with unexpected value: ${JSON.stringify(n)}`)}var F2=(()=>{class n{set showBoundingBoxButton(t){this._showBoundingBoxButton=O2(t),this.showButtons()}get showBoundingBoxButton(){return this._showBoundingBoxButton}set showFillExtentButton(t){this._showFillExtentButton=O2(t),this.showButtons()}get showFillExtentButton(){return this._showFillExtentButton}set projection(t){this._projection=this.featureService.getProjectionMapping(t)}set drawFeature(t){this._drawFeature=t}constructor(t,r,i){this.el=t,this.featureService=r,this.logger=i,this._showBoundingBoxButton=!0,this.initial=!0,this._drawFeature=void 0,this._showFillExtentButton=!1,this._projection=Pf,this.backgroundMap="OSM",this.minFitScale=1e3,this.maxFitScale=void 0,this.fillColor="rgba(0,0,255)",this.strokeColor="#3399CC",this.mode="default",this.labelField=void 0,this.labelOptions=void 0,this.box=new Rt,this.activeFeature=new Rt,this.mapHeight=400,this.mapWidth=600,this.map=this.getMap(),this._view=new nn({projection:this._projection.visualProjection,zoom:1}),this.features=[]}isFeatureLike(t){return t instanceof zt||t instanceof fn}drawExtraFeature(){if(this.isFeatureLike(this._drawFeature)){let t=[];t.push(this._drawFeature);let r=new Ir({features:t}),i=new ho({source:r,zIndex:9,properties:{id:"drawFeatureLayer"}});return this.map.addLayer(i),this.logger.log("drawlayer added"),r.getExtent()}else this.map.getLayers().forEach(t=>{t.get("id")==="drawFeatureLayer"&&this.map.removeLayer(t)})}getMap(){return new go({view:this._view,controls:[]})}init(){this.mapWidth=this.el.nativeElement.offsetWidth*.99,this.mapHeight=this.mapWidth*.75;let t=this.el.nativeElement.querySelector("#featuremap");this.map.setTarget(t);let r={url:this.itemsUrl,dataMapping:this._projection};this.featureService.getFeatures(r).pipe(Fl(1)).subscribe(i=>{this.features=i,this.map.getLayers().clear(),this.changeView(),this.loadFeatures(this.features),this.loadBackground(),this.logger.log(this.map.getView().getProjection()),this.logger.log("resolution"+this.map.getView().getResolution())})}ngAfterViewInit(){this.changeMode()}changeMode(){this.features=[],this.showButtons(),this.addFeatureEmit()}showButtons(){this.map.getControls().forEach(t=>{this.map.removeControl(t)}),al({attribution:!1,zoom:!0}).forEach(t=>this.map.addControl(t)),this.mode==="default"&&(this._showBoundingBoxButton&&this.map.addControl(new ay(this.box,{})),this._showFillExtentButton&&this.map.addControl(new ly(this.box,{})))}ngOnChanges(t){(t.itemsUrl?.previousValue!==t.itemsUrl?.currentValue||t.projection?.previousValue!==t.projection?.currentValue||t.drawFeature?.previousValue!==t.drawFeature?.currentValue)&&t.itemsUrl?.currentValue&&this.init(),t.mode?.previousValue&&t.mode?.previousValue!=t.mode?.currentValue&&t.mode?.currentValue&&this.changeMode()}loadBackground(){switch(this.backgroundMap){case"OSM":{let t=new fl({source:new L1});this.map.addLayer(t);return}case"BRT":{this.map.addLayer(this.brtLayer(D2()));return}default:aH(this.backgroundMap)}}loadFeatures(t){let r=new Ir({features:t});this.map.addLayer(new ho({source:r,style:a=>this.getStyle(a),zIndex:10}));let i=r.getExtent(),o=this.drawExtraFeature(),s=i;o?(s=Ls(i,o),this.setViewExtent(s,2)):this.mode==="default"?t.length>0&&(t.length<3?this.setViewExtent(s,10):this.setViewExtent(s,1.05)):this.initial&&(this.setViewExtent(s,1),this.initial=!1)}getStyle(t){let r=new Wt({color:this.fillColor}),i=new tn({color:this.strokeColor,width:1.25}),o;if(this.labelField)if(this.labelOptions!=null){let s=JSON.parse(this.labelOptions);o=new ea(s),o.setText(t.get(this.labelField))}else o=new ea({text:t.get(this.labelField)});return[new Xt({image:new lo({fill:r,stroke:i,radius:5}),fill:r,stroke:i,text:o})]}changeView(){let t=this._view.getProjection(),r=ne(this._projection.visualProjection);if(!r)throw new Error("New projection is not defined");let i=p=>{throw new Error(p)},o=this._view.getResolution()??i("Current resolution is not defined"),s=this._view.getCenter()??[0,0],a=Jo(s,t,r)??[0,0],l=this._view.getRotation()??0,c=t?.getMetersPerUnit()??i("Current meters-per-unit is not defined"),u=r?.getMetersPerUnit()??i("New meters-per-unit is not defined"),d=$s(t,1/c,s,"m")*c,f=$s(r,1/u,a,"m")*u,h=o*d/f;this._view=new nn({center:a,resolution:h,rotation:l,projection:r}),this.map.setView(this._view)}setViewExtent(t,r){let i={size:this.map.getSize(),minResolution:this.getResolutionForScale(this.minFitScale)},o=to(t);if(o.scale(r),this._view.fit(o,i),this.maxFitScale){let s=Math.min(this._view.getResolution(),this.getResolutionForScale(this.maxFitScale));this._view.setResolution(s)}this.map.setView(this._view)}brtLayer(t){return new fl({source:new B1({attributions:'Kaartgegevens: &copy; <a href="https://www.kadaster.nl">Kadaster</a>',url:HP.bgtBackgroundUrl,layer:"grijs",matrixSet:t.projection.getCode(),format:"image/png",projection:t.projection,tileGrid:new CP({origin:ut(t.projection.getExtent()),resolutions:t.resolutions,matrixIds:t.matrixIds}),style:"default",wrapX:!1})})}addFeatureEmit(){let t=this.el.nativeElement.querySelector("[id='tooltip']");t.style.visibility="hidden";let r=this.el.nativeElement.querySelector("[id='tooltip-content']"),i=new n1({element:t,autoPan:{duration:250}});this.map.addOverlay(i);let o="pointermove";this.labelField&&(o="click"),this.map.on(o,s=>{this.map.forEachFeatureAtPixel(s.pixel,a=>{if(a){let l=a.getId();if(l){let c="items",u=this.itemsUrl,d=new URL(u.substring(0,u.indexOf(c)+c.length)),f=d.protocol+"//"+d.host+d.pathname+"/"+l;r.innerHTML='<a href="'+f+'">'+l+"</a>";let h=a.getGeometry();h&&(i.setPosition(Ht(h.getExtent())),this.labelField||(t.style.visibility="visible")),this.activeFeature.emit(a)}}},{hitTolerance:3})}),this.map.on("moveend",()=>{let s=this.map.getSize(),a=this.map.getView().calculateExtent(s),l=to(a);this.mode==="auto"&&Nf(this.map,l,this.box)})}getResolutionForScale(t){let r=this.map.getView(),i=96,o=39.3701,s=r.getCenter();if(!s)throw new Error("No centre for view");let a=$s(r.getProjection(),1,s),l=t/(a*o*i);return parseFloat(l.toFixed(6))}static{this.\u0275fac=function(r){return new(r||n)(pe(Zi),pe(R2),pe(Ct))}}static{this.\u0275cmp=bn({type:n,selectors:[["app-feature-view"]],inputs:{showBoundingBoxButton:"showBoundingBoxButton",showFillExtentButton:"showFillExtentButton",itemsUrl:"itemsUrl",backgroundMap:"backgroundMap",minFitScale:"minFitScale",maxFitScale:"maxFitScale",fillColor:"fillColor",strokeColor:"strokeColor",mode:"mode",labelField:"labelField",labelOptions:"labelOptions",projection:"projection",drawFeature:"drawFeature"},outputs:{box:"box",activeFeature:"activeFeature"},features:[Ba],decls:3,vars:4,consts:[["id","featuremap",1,"featuremaparea"],["id","tooltip",1,"maptooltip"],["id","tooltip-content"]],template:function(r,i){r&1&&(Gn(0,"div",0),Fe(1,"div",1),Gn(2,"div",2),Re()),r&2&&$a("width",i.mapWidth,"px")("height",i.mapHeight,"px")},styles:[".featuremaparea[_ngcontent-%COMP%]{height:100vh}.maptooltip[_ngcontent-%COMP%]{visibility:hidden;font-weight:700;margin:1px;text-decoration:none;text-align:center;border-radius:2px;font-size:16px;background-color:#fff;border:1px solid rgb(26,30,79);padding:5px 10px}"],changeDetection:0})}}return n})();var lH=8,cH={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},uH={"*":{type:"source"}},dH=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],fH={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},hH={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},pH={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},mH={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},gH={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},yH={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},vH={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},_H=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],xH={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},EH={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},wH={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},CH={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},bH={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},MH={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},TH={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},SH={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},IH={type:"array",value:"*"},DH={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},RH={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},AH={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},PH={type:"array",value:"*",minimum:1},NH={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},OH={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},FH={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},LH={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},kH=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],jH={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},VH={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},BH={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},GH={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},UH={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},zH={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},$H={"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},HH={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},qH={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},WH={"*":{type:"string"}},rO={$version:lH,$root:cH,sources:uH,source:dH,source_vector:fH,source_raster:hH,source_raster_dem:pH,source_geojson:mH,source_video:gH,source_image:yH,layer:vH,layout:_H,layout_background:xH,layout_fill:EH,layout_circle:wH,layout_heatmap:CH,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:bH,layout_symbol:MH,layout_raster:TH,layout_hillshade:SH,"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:IH,filter_operator:DH,geometry_type:RH,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:AH,expression:PH,light:NH,sky:OH,terrain:FH,projection:LH,paint:kH,paint_fill:jH,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:VH,paint_circle:BH,paint_heatmap:GH,paint_symbol:UH,paint_raster:zH,paint_hillshade:$H,"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:HH,transition:qH,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:WH},XH=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ZH(n,e){let t={};for(let r in n)r!=="ref"&&(t[r]=n[r]);return XH.forEach(r=>{r in e&&(t[r]=e[r])}),t}function iO(n){n=n.slice();let e=Object.create(null);for(let t=0;t<n.length;t++)e[n[t].id]=n[t];for(let t=0;t<n.length;t++)"ref"in n[t]&&(n[t]=ZH(n[t],e[n[t].ref]));return n}var k=class{constructor(e,t,r,i){this.message=(e?`${e}: `:"")+r,i&&(this.identifier=i),t!=null&&t.__line__&&(this.line=t.__line__)}};function py(n,...e){for(let t of e)for(let r in t)n[r]=t[r];return n}var si=class extends Error{constructor(e,t){super(t),this.message=t,this.key=e}},TC=class n{constructor(e,t=[]){this.parent=e,this.bindings={};for(let[r,i]of t)this.bindings[r]=i}concat(e){return new n(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}},Py={kind:"null"},G={kind:"number"},Ee={kind:"string"},me={kind:"boolean"},bo={kind:"color"},Ny={kind:"projectionDefinition"},_l={kind:"object"},fe={kind:"value"},YH={kind:"error"},Oy={kind:"collator"},Fy={kind:"formatted"},Ly={kind:"padding"},kf={kind:"colorArray"},ky={kind:"numberArray"},Yf={kind:"resolvedImage"},jy={kind:"variableAnchorOffsetCollection"};function Pr(n,e){return{kind:"array",itemType:n,N:e}}function _t(n){if(n.kind==="array"){let e=_t(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}else return n.kind}var KH=[Py,G,Ee,me,bo,Ny,Fy,_l,Pr(fe),Ly,ky,kf,Yf,jy];function jf(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!jf(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(let t of KH)if(!jf(t,e))return null}}return`Expected ${_t(n)} but found ${_t(e)} instead.`}function qC(n,e){return e.some(t=>t.kind===n.kind)}function xl(n,e){return e.some(t=>t==="null"?n===null:t==="array"?Array.isArray(n):t==="object"?n&&!Array.isArray(n)&&typeof n=="object":t===typeof n)}function ha(n,e){return n.kind==="array"&&e.kind==="array"?n.itemType.kind===e.itemType.kind&&typeof n.N=="number":n.kind===e.kind}var oO=.96422,sO=1,aO=.82521,lO=4/29,yu=6/29,cO=3*yu*yu,JH=yu*yu*yu,QH=Math.PI/180,e9=180/Math.PI;function uO(n){return n=n%360,n<0&&(n+=360),n}function dO([n,e,t,r]){n=yC(n),e=yC(e),t=yC(t);let i,o,s=vC((.2225045*n+.7168786*e+.0606169*t)/sO);n===e&&e===t?i=o=s:(i=vC((.4360747*n+.3850649*e+.1430804*t)/oO),o=vC((.0139322*n+.0971045*e+.7141733*t)/aO));let a=116*s-16;return[a<0?0:a,500*(i-s),200*(s-o),r]}function yC(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function vC(n){return n>JH?Math.pow(n,1/3):n/cO+lO}function fO([n,e,t,r]){let i=(n+16)/116,o=isNaN(e)?i:i+e/500,s=isNaN(t)?i:i-t/200;return i=sO*xC(i),o=oO*xC(o),s=aO*xC(s),[_C(3.1338561*o-1.6168667*i-.4906146*s),_C(-.9787684*o+1.9161415*i+.033454*s),_C(.0719453*o-.2289914*i+1.4052427*s),r]}function _C(n){return n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055,n<0?0:n>1?1:n}function xC(n){return n>yu?n*n*n:cO*(n-lO)}function t9(n){let[e,t,r,i]=dO(n),o=Math.sqrt(t*t+r*r);return[Math.round(o*1e4)?uO(Math.atan2(r,t)*e9):NaN,o,e,i]}function n9([n,e,t,r]){return n=isNaN(n)?0:n*QH,fO([t,Math.cos(n)*e,Math.sin(n)*e,r])}function r9([n,e,t,r]){n=uO(n),e/=100,t/=100;function i(o){let s=(o+n/30)%12,a=e*Math.min(t,1-t);return t-a*Math.max(-1,Math.min(s-3,9-s,1))}return[i(0),i(8),i(4),r]}var i9=Object.hasOwn||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function Ff(n,e){return i9(n,e)?n[e]:void 0}function o9(n){if(n=n.toLowerCase().trim(),n==="transparent")return[0,0,0,0];let e=Ff(s9,n);if(e){let[i,o,s]=e;return[i/255,o/255,s/255,1]}if(n.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(n)){let o=n.length<6?1:2,s=1;return[cy(n.slice(s,s+=o)),cy(n.slice(s,s+=o)),cy(n.slice(s,s+=o)),cy(n.slice(s,s+o)||"ff")]}if(n.startsWith("rgb")){let i=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,o=n.match(i);if(o){let[s,a,l,c,u,d,f,h,p,m,g,y]=o,v=[c||" ",f||" ",m].join("");if(v==="  "||v==="  /"||v===",,"||v===",,,"){let x=[l,d,p].join(""),E=x==="%%%"?100:x===""?255:0;if(E){let _=[mu(+a/E,0,1),mu(+u/E,0,1),mu(+h/E,0,1),g?L2(+g,y):1];if(k2(_))return _}}return}}let t=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,r=n.match(t);if(r){let[i,o,s,a,l,c,u,d,f]=r,h=[s||" ",l||" ",u].join("");if(h==="  "||h==="  /"||h===",,"||h===",,,"){let p=[+o,mu(+a,0,100),mu(+c,0,100),d?L2(+d,f):1];if(k2(p))return r9(p)}}}function cy(n){return parseInt(n.padEnd(2,n),16)/255}function L2(n,e){return mu(e?n/100:n,0,1)}function mu(n,e,t){return Math.min(Math.max(e,n),t)}function k2(n){return!n.some(Number.isNaN)}var s9={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ma(n,e,t){return n+t*(e-n)}function _u(n,e,t){return n.map((r,i)=>ma(r,e[i],t))}var Ye=class n{constructor(e,t,r,i=1,o=!0){this.r=e,this.g=t,this.b=r,this.a=i,o||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[e,t,r,i]))}static parse(e){if(e instanceof n)return e;if(typeof e!="string")return;let t=o9(e);if(t)return new n(...t,!1)}get rgb(){let{r:e,g:t,b:r,a:i}=this,o=i||1/0;return this.overwriteGetter("rgb",[e/o,t/o,r/o,i])}get hcl(){return this.overwriteGetter("hcl",t9(this.rgb))}get lab(){return this.overwriteGetter("lab",dO(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){let[e,t,r,i]=this.rgb;return`rgba(${[e,t,r].map(o=>Math.round(o*255)).join(",")},${i})`}static interpolate(e,t,r,i="rgb"){switch(i){case"rgb":{let[o,s,a,l]=_u(e.rgb,t.rgb,r);return new n(o,s,a,l,!1)}case"hcl":{let[o,s,a,l]=e.hcl,[c,u,d,f]=t.hcl,h,p;if(!isNaN(o)&&!isNaN(c)){let x=c-o;c>o&&x>180?x-=360:c<o&&o-c>180&&(x+=360),h=o+r*x}else isNaN(o)?isNaN(c)?h=NaN:(h=c,(a===1||a===0)&&(p=u)):(h=o,(d===1||d===0)&&(p=s));let[m,g,y,v]=n9([h,p??ma(s,u,r),ma(a,d,r),ma(l,f,r)]);return new n(m,g,y,v,!1)}case"lab":{let[o,s,a,l]=fO(_u(e.lab,t.lab,r));return new n(o,s,a,l,!1)}}}};Ye.black=new Ye(0,0,0,1);Ye.white=new Ye(1,1,1,1);Ye.transparent=new Ye(0,0,0,0);Ye.red=new Ye(1,0,0,1);var Vf=class{constructor(e,t,r){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}},a9=["bottom","center","top"],Bf=class{constructor(e,t,r,i,o,s){this.text=e,this.image=t,this.scale=r,this.fontStack=i,this.textColor=o,this.verticalAlign=s}},El=class n{constructor(e){this.sections=e}static fromString(e){return new n([new Bf(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof n?e:n.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}},xs=class n{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof n)return e;if(typeof e=="number")return new n([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let t of e)if(typeof t!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new n(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new n(_u(e.values,t.values,r))}},Es=class n{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof n)return e;if(typeof e=="number")return new n([e]);if(Array.isArray(e)){for(let t of e)if(typeof t!="number")return;return new n(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){return new n(_u(e.values,t.values,r))}},ki=class n{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof n)return e;if(typeof e=="string"){let r=Ye.parse(e);return r?new n([r]):void 0}if(!Array.isArray(e))return;let t=[];for(let r of e){if(typeof r!="string")return;let i=Ye.parse(r);if(!i)return;t.push(i)}return new n(t)}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r,i="rgb"){let o=[];if(e.values.length!=t.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${t.values.length}), cannot interpolate.`);for(let s=0;s<e.values.length;s++)o.push(Ye.interpolate(e.values[s],t.values[s],r,i));return new n(o)}},ft=class extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}},l9=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),ws=class n{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof n)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let t=0;t<e.length;t+=2){let r=e[t],i=e[t+1];if(typeof r!="string"||!l9.has(r)||!Array.isArray(i)||i.length!==2||typeof i[0]!="number"||typeof i[1]!="number")return}return new n(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,t,r){let i=e.values,o=t.values;if(i.length!==o.length)throw new ft(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);let s=[];for(let a=0;a<i.length;a+=2){if(i[a]!==o[a])throw new ft(`Cannot interpolate values containing mismatched anchors. from[${a}]: ${i[a]}, to[${a}]: ${o[a]}`);s.push(i[a]);let[l,c]=i[a+1],[u,d]=o[a+1];s.push([ma(l,u,r),ma(c,d,r)])}return new n(s)}},ga=class n{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new n({name:e,available:!1}):null}},wl=class n{constructor(e,t,r){this.from=e,this.to=t,this.transition=r}static interpolate(e,t,r){return new n(e,t,r)}static parse(e){if(e instanceof n)return e;if(Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number")return new n(e[0],e[1],e[2]);if(typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number")return new n(e.from,e.to,e.transition);if(typeof e=="string")return new n(e,e,1)}};function hO(n,e,t,r){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255?typeof r>"u"||typeof r=="number"&&r>=0&&r<=1?null:`Invalid rgba value [${[n,e,t,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof r=="number"?[n,e,t,r]:[n,e,t]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Gf(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof wl||n instanceof Ye||n instanceof Vf||n instanceof El||n instanceof xs||n instanceof Es||n instanceof ki||n instanceof ws||n instanceof ga)return!0;if(Array.isArray(n)){for(let e of n)if(!Gf(e))return!1;return!0}else if(typeof n=="object"){for(let e in n)if(!Gf(n[e]))return!1;return!0}else return!1}function Kt(n){if(n===null)return Py;if(typeof n=="string")return Ee;if(typeof n=="boolean")return me;if(typeof n=="number")return G;if(n instanceof Ye)return bo;if(n instanceof wl)return Ny;if(n instanceof Vf)return Oy;if(n instanceof El)return Fy;if(n instanceof xs)return Ly;if(n instanceof Es)return ky;if(n instanceof ki)return kf;if(n instanceof ws)return jy;if(n instanceof ga)return Yf;if(Array.isArray(n)){let e=n.length,t;for(let r of n){let i=Kt(r);if(!t)t=i;else{if(t===i)continue;t=fe;break}}return Pr(t||fe,e)}else return _l}function Lf(n){let e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof Ye||n instanceof wl||n instanceof El||n instanceof xs||n instanceof Es||n instanceof ki||n instanceof ws||n instanceof ga?n.toString():JSON.stringify(n)}var xu=class n{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(e.length!==2)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Gf(e[1]))return t.error("invalid value");let r=e[1],i=Kt(r),o=t.expectedType;return i.kind==="array"&&i.N===0&&o&&o.kind==="array"&&(typeof o.N!="number"||o.N===0)&&(i=o),new n(i,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}},uy={string:Ee,number:G,boolean:me,object:_l},Li=class n{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=1,i,o=e[0];if(o==="array"){let a;if(e.length>2){let c=e[1];if(typeof c!="string"||!(c in uy)||c==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);a=uy[c],r++}else a=fe;let l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);l=e[2],r++}i=Pr(a,l)}else{if(!uy[o])throw new Error(`Types doesn't contain name = ${o}`);i=uy[o]}let s=[];for(;r<e.length;r++){let a=t.parse(e[r],r,fe);if(!a)return null;s.push(a)}return new n(i,s)}evaluate(e){for(let t=0;t<this.args.length;t++){let r=this.args[t].evaluate(e);if(jf(this.type,Kt(r))){if(t===this.args.length-1)throw new ft(`Expected value to be of type ${_t(this.type)}, but found ${_t(Kt(r))} instead.`)}else return r}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},j2={"to-boolean":me,"to-color":bo,"to-number":G,"to-string":Ee},pa=class n{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[0];if(!j2[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");let i=j2[r],o=[];for(let s=1;s<e.length;s++){let a=t.parse(e[s],s,fe);if(!a)return null;o.push(a)}return new n(i,o)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,r;for(let i of this.args){if(t=i.evaluate(e),r=null,t instanceof Ye)return t;if(typeof t=="string"){let o=e.parseColor(t);if(o)return o}else if(Array.isArray(t)&&(t.length<3||t.length>4?r=`Invalid rgba value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:r=hO(t[0],t[1],t[2],t[3]),!r))return new Ye(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ft(r||`Could not parse color from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"padding":{let t;for(let r of this.args){t=r.evaluate(e);let i=xs.parse(t);if(i)return i}throw new ft(`Could not parse padding from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"numberArray":{let t;for(let r of this.args){t=r.evaluate(e);let i=Es.parse(t);if(i)return i}throw new ft(`Could not parse numberArray from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"colorArray":{let t;for(let r of this.args){t=r.evaluate(e);let i=ki.parse(t);if(i)return i}throw new ft(`Could not parse colorArray from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(let r of this.args){t=r.evaluate(e);let i=ws.parse(t);if(i)return i}throw new ft(`Could not parse variableAnchorOffsetCollection from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(let r of this.args){if(t=r.evaluate(e),t===null)return 0;let i=Number(t);if(!isNaN(i))return i}throw new ft(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return El.fromString(Lf(this.args[0].evaluate(e)));case"resolvedImage":return ga.fromString(Lf(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return Lf(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}},c9=["Unknown","Point","LineString","Polygon"],my=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?c9[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache.get(e);return t||(t=Ye.parse(e),this._parseColorCache.set(e,t)),t}},gy=class n{constructor(e,t,r=[],i,o=new TC,s=[]){this.registry=e,this.path=r,this.key=r.map(a=>`[${a}]`).join(""),this.scope=o,this.errors=s,this.expectedType=i,this._isConstant=t}parse(e,t,r,i,o={}){return t?this.concat(t,r,i)._parse(e,o):this._parse(e,o)}_parse(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function r(i,o,s){return s==="assert"?new Li(o,[i]):s==="coerce"?new pa(o,[i]):i}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let i=e[0];if(typeof i!="string")return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let o=this.registry[i];if(o){let s=o.parse(e,this);if(!s)return null;if(this.expectedType){let a=this.expectedType,l=s.type;if((a.kind==="string"||a.kind==="number"||a.kind==="boolean"||a.kind==="object"||a.kind==="array")&&l.kind==="value")s=r(s,a,t.typeAnnotation||"assert");else if(a.kind==="projectionDefinition"&&["string","array"].includes(l.kind)||["color","formatted","resolvedImage"].includes(a.kind)&&["value","string"].includes(l.kind)||["padding","numberArray"].includes(a.kind)&&["value","number","array"].includes(l.kind)||a.kind==="colorArray"&&["value","string","array"].includes(l.kind)||a.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(l.kind))s=r(s,a,t.typeAnnotation||"coerce");else if(this.checkSubtype(a,l))return null}if(!(s instanceof xu)&&s.type.kind!=="resolvedImage"&&this._isConstant(s)){let a=new my;try{s=new xu(s.type,s.evaluate(a))}catch(l){return this.error(l.message),null}}return s}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){let i=typeof e=="number"?this.path.concat(e):this.path,o=r?this.scope.concat(r):this.scope;return new n(this.registry,this._isConstant,i,t||null,o,this.errors)}error(e,...t){let r=`${this.key}${t.map(i=>`[${i}]`).join("")}`;this.errors.push(new si(r,e))}checkSubtype(e,t){let r=jf(e,t);return r&&this.error(r),r}},yy=class n{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);let r=[];for(let o=1;o<e.length-1;o+=2){let s=e[o];if(typeof s!="string")return t.error(`Expected string, but found ${typeof s} instead.`,o);if(/[^a-zA-Z0-9_]/.test(s))return t.error("Variable names must contain only alphanumeric characters or '_'.",o);let a=t.parse(e[o+1],o+1);if(!a)return null;r.push([s,a])}let i=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return i?new n(r,i):null}outputDefined(){return this.result.outputDefined()}},vy=class n{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");let r=e[1];return t.scope.has(r)?new n(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}},SC=class n{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,G),i=t.parse(e[2],2,Pr(t.expectedType||fe));if(!r||!i)return null;let o=i.type;return new n(o.itemType,r,i)}evaluate(e){let t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new ft(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new ft(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new ft(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}},IC=class n{constructor(e,t){this.type=me,this.needle=e,this.haystack=t}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,fe),i=t.parse(e[2],2,fe);return!r||!i?null:qC(r.type,[me,Ee,G,Py,fe])?new n(r,i):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${_t(r.type)} instead`)}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!xl(t,["boolean","string","number","null"]))throw new ft(`Expected first argument to be of type boolean, string, number or null, but found ${_t(Kt(t))} instead.`);if(!xl(r,["string","array"]))throw new ft(`Expected second argument to be of type array or string, but found ${_t(Kt(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}},DC=class n{constructor(e,t,r){this.type=G,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,fe),i=t.parse(e[2],2,fe);if(!r||!i)return null;if(!qC(r.type,[me,Ee,G,Py,fe]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${_t(r.type)} instead`);if(e.length===4){let o=t.parse(e[3],3,G);return o?new n(r,i,o):null}else return new n(r,i)}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!xl(t,["boolean","string","number","null"]))throw new ft(`Expected first argument to be of type boolean, string, number or null, but found ${_t(Kt(t))} instead.`);let i;if(this.fromIndex&&(i=this.fromIndex.evaluate(e)),xl(r,["string"])){let o=r.indexOf(t,i);return o===-1?-1:[...r.slice(0,o)].length}else{if(xl(r,["array"]))return r.indexOf(t,i);throw new ft(`Expected second argument to be of type array or string, but found ${_t(Kt(r))} instead.`)}}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}},RC=class n{constructor(e,t,r,i,o,s){this.inputType=e,this.type=t,this.input=r,this.cases=i,this.outputs=o,this.otherwise=s}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!==1)return t.error("Expected an even number of arguments.");let r,i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);let o={},s=[];for(let c=2;c<e.length-1;c+=2){let u=e[c],d=e[c+1];Array.isArray(u)||(u=[u]);let f=t.concat(c);if(u.length===0)return f.error("Expected at least one branch label.");for(let p of u){if(typeof p!="number"&&typeof p!="string")return f.error("Branch labels must be numbers or strings.");if(typeof p=="number"&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return f.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof p=="number"&&Math.floor(p)!==p)return f.error("Numeric branch labels must be integer values.");if(!r)r=Kt(p);else if(f.checkSubtype(r,Kt(p)))return null;if(typeof o[String(p)]<"u")return f.error("Branch labels must be unique.");o[String(p)]=s.length}let h=t.parse(d,c,i);if(!h)return null;i=i||h.type,s.push(h)}let a=t.parse(e[1],1,fe);if(!a)return null;let l=t.parse(e[e.length-1],e.length-1,i);return!l||a.type.kind!=="value"&&t.concat(1).checkSubtype(r,a.type)?null:new n(r,i,a,o,s,l)}evaluate(e){let t=this.input.evaluate(e);return(Kt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}},AC=class n{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!==0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);let i=[];for(let s=1;s<e.length-1;s+=2){let a=t.parse(e[s],s,me);if(!a)return null;let l=t.parse(e[s+1],s+1,r);if(!l)return null;i.push([a,l]),r=r||l.type}let o=t.parse(e[e.length-1],e.length-1,r);if(!o)return null;if(!r)throw new Error("Can't infer output type");return new n(r,i,o)}evaluate(e){for(let[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}},PC=class n{constructor(e,t,r,i){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,fe),i=t.parse(e[2],2,G);if(!r||!i)return null;if(!qC(r.type,[Pr(fe),Ee,fe]))return t.error(`Expected first argument to be of type array or string, but found ${_t(r.type)} instead`);if(e.length===4){let o=t.parse(e[3],3,G);return o?new n(r.type,r,i,o):null}else return new n(r.type,r,i)}evaluate(e){let t=this.input.evaluate(e),r=this.beginIndex.evaluate(e),i;if(this.endIndex&&(i=this.endIndex.evaluate(e)),xl(t,["string"]))return[...t].slice(r,i).join("");if(xl(t,["array"]))return t.slice(r,i);throw new ft(`Expected first argument to be of type array or string, but found ${_t(Kt(t))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};function pO(n,e){let t=n.length-1,r=0,i=t,o=0,s,a;for(;r<=i;)if(o=Math.floor((r+i)/2),s=n[o],a=n[o+1],s<=e){if(o===t||e<a)return o;r=o+1}else if(s>e)i=o-1;else throw new ft("Input is not a number.");return 0}var _y=class n{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(let[i,o]of r)this.labels.push(i),this.outputs.push(o)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");let r=t.parse(e[1],1,G);if(!r)return null;let i=[],o=null;t.expectedType&&t.expectedType.kind!=="value"&&(o=t.expectedType);for(let s=1;s<e.length;s+=2){let a=s===1?-1/0:e[s],l=e[s+1],c=s,u=s+1;if(typeof a!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',c);if(i.length&&i[i.length-1][0]>=a)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',c);let d=t.parse(l,u,o);if(!d)return null;o=o||d.type,i.push([a,d])}return new n(o,r,i)}evaluate(e){let t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);let i=this.input.evaluate(e);if(i<=t[0])return r[0].evaluate(e);let o=t.length;if(i>=t[o-1])return r[o-1].evaluate(e);let s=pO(t,i);return r[s].evaluate(e)}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function u9(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var EC,V2;function d9(){if(V2)return EC;V2=1,EC=n;function n(e,t,r,i){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=i}return n.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,i=0;i<8;i++){var o=this.sampleCurveX(r)-e;if(Math.abs(o)<t)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r=r-o/s}var a=0,l=1;for(r=e,i=0;i<20&&(o=this.sampleCurveX(r),!(Math.abs(o-e)<t));i++)e>o?a=r:l=r,r=(l-a)*.5+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},EC}var f9=d9(),h9=u9(f9),_s=class n{constructor(e,t,r,i,o){this.type=e,this.operator=t,this.interpolation=r,this.input=i,this.labels=[],this.outputs=[];for(let[s,a]of o)this.labels.push(s),this.outputs.push(a)}static interpolationFactor(e,t,r,i){let o=0;if(e.name==="exponential")o=wC(t,e.base,r,i);else if(e.name==="linear")o=wC(t,1,r,i);else if(e.name==="cubic-bezier"){let s=e.controlPoints;o=new h9(s[0],s[1],s[2],s[3]).solve(wC(t,1,r,i))}return o}static parse(e,t){let[r,i,o,...s]=e;if(!Array.isArray(i)||i.length===0)return t.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){let c=i[1];if(typeof c!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:c}}else if(i[0]==="cubic-bezier"){let c=i.slice(1);if(c.length!==4||c.some(u=>typeof u!="number"||u<0||u>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:c}}else return t.error(`Unknown interpolation type ${String(i[0])}`,1,0);if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(o=t.parse(o,2,G),!o)return null;let a=[],l=null;(r==="interpolate-hcl"||r==="interpolate-lab")&&t.expectedType!=kf?l=bo:t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(let c=0;c<s.length;c+=2){let u=s[c],d=s[c+1],f=c+3,h=c+4;if(typeof u!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',f);if(a.length&&a[a.length-1][0]>=u)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',f);let p=t.parse(d,h,l);if(!p)return null;l=l||p.type,a.push([u,p])}return!ha(l,G)&&!ha(l,Ny)&&!ha(l,bo)&&!ha(l,Ly)&&!ha(l,ky)&&!ha(l,kf)&&!ha(l,jy)&&!ha(l,Pr(G))?t.error(`Type ${_t(l)} is not interpolatable.`):new n(l,r,i,o,a)}evaluate(e){let t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);let i=this.input.evaluate(e);if(i<=t[0])return r[0].evaluate(e);let o=t.length;if(i>=t[o-1])return r[o-1].evaluate(e);let s=pO(t,i),a=t[s],l=t[s+1],c=n.interpolationFactor(this.interpolation,i,a,l),u=r[s].evaluate(e),d=r[s+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ma(u,d,c);case"color":return Ye.interpolate(u,d,c);case"padding":return xs.interpolate(u,d,c);case"colorArray":return ki.interpolate(u,d,c);case"numberArray":return Es.interpolate(u,d,c);case"variableAnchorOffsetCollection":return ws.interpolate(u,d,c);case"array":return _u(u,d,c);case"projectionDefinition":return wl.interpolate(u,d,c)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ye.interpolate(u,d,c,"hcl");case"colorArray":return ki.interpolate(u,d,c,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ye.interpolate(u,d,c,"lab");case"colorArray":return ki.interpolate(u,d,c,"lab")}}}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};function wC(n,e,t,r){let i=r-t,o=n-t;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var Mbe={color:Ye.interpolate,number:ma,padding:xs.interpolate,numberArray:Es.interpolate,colorArray:ki.interpolate,variableAnchorOffsetCollection:ws.interpolate,array:_u},xy=class n{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=null,i=t.expectedType;i&&i.kind!=="value"&&(r=i);let o=[];for(let a of e.slice(1)){let l=t.parse(a,1+o.length,r,void 0,{typeAnnotation:"omit"});if(!l)return null;r=r||l.type,o.push(l)}if(!r)throw new Error("No output type");return i&&o.some(a=>jf(i,a.type))?new n(fe,o):new n(r,o)}evaluate(e){let t=null,r=0,i;for(let o of this.args)if(r++,t=o.evaluate(e),t&&t instanceof ga&&!t.available&&(i||(i=t.name),t=null,r===this.args.length&&(t=i)),t!==null)break;return t}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};function B2(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function p9(n,e,t){return e===t}function m9(n,e,t){return e!==t}function g9(n,e,t){return e<t}function y9(n,e,t){return e>t}function v9(n,e,t){return e<=t}function _9(n,e,t){return e>=t}function mO(n,e,t,r){return r.compare(e,t)===0}function x9(n,e,t,r){return!mO(n,e,t,r)}function E9(n,e,t,r){return r.compare(e,t)<0}function w9(n,e,t,r){return r.compare(e,t)>0}function C9(n,e,t,r){return r.compare(e,t)<=0}function b9(n,e,t,r){return r.compare(e,t)>=0}function wu(n,e,t){let r=n!=="=="&&n!=="!=";return class gO{constructor(o,s,a){this.type=me,this.lhs=o,this.rhs=s,this.collator=a,this.hasUntypedArgument=o.type.kind==="value"||s.type.kind==="value"}static parse(o,s){if(o.length!==3&&o.length!==4)return s.error("Expected two or three arguments.");let a=o[0],l=s.parse(o[1],1,fe);if(!l)return null;if(!B2(a,l.type))return s.concat(1).error(`"${a}" comparisons are not supported for type '${_t(l.type)}'.`);let c=s.parse(o[2],2,fe);if(!c)return null;if(!B2(a,c.type))return s.concat(2).error(`"${a}" comparisons are not supported for type '${_t(c.type)}'.`);if(l.type.kind!==c.type.kind&&l.type.kind!=="value"&&c.type.kind!=="value")return s.error(`Cannot compare types '${_t(l.type)}' and '${_t(c.type)}'.`);r&&(l.type.kind==="value"&&c.type.kind!=="value"?l=new Li(c.type,[l]):l.type.kind!=="value"&&c.type.kind==="value"&&(c=new Li(l.type,[c])));let u=null;if(o.length===4){if(l.type.kind!=="string"&&c.type.kind!=="string"&&l.type.kind!=="value"&&c.type.kind!=="value")return s.error("Cannot use collator to compare non-string types.");if(u=s.parse(o[3],3,Oy),!u)return null}return new gO(l,c,u)}evaluate(o){let s=this.lhs.evaluate(o),a=this.rhs.evaluate(o);if(r&&this.hasUntypedArgument){let l=Kt(s),c=Kt(a);if(l.kind!==c.kind||!(l.kind==="string"||l.kind==="number"))throw new ft(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${l.kind}, ${c.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){let l=Kt(s),c=Kt(a);if(l.kind!=="string"||c.kind!=="string")return e(o,s,a)}return this.collator?t(o,s,a,this.collator.evaluate(o)):e(o,s,a)}eachChild(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)}outputDefined(){return!0}}}var M9=wu("==",p9,mO),T9=wu("!=",m9,x9),S9=wu("<",g9,E9),I9=wu(">",y9,w9),D9=wu("<=",v9,C9),R9=wu(">=",_9,b9),Ey=class n{constructor(e,t,r){this.type=Oy,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(e.length!==2)return t.error("Expected one argument.");let r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");let i=t.parse(r["case-sensitive"]===void 0?!1:r["case-sensitive"],1,me);if(!i)return null;let o=t.parse(r["diacritic-sensitive"]===void 0?!1:r["diacritic-sensitive"],1,me);if(!o)return null;let s=null;return r.locale&&(s=t.parse(r.locale,1,Ee),!s)?null:new n(i,o,s)}evaluate(e){return new Vf(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}},NC=class n{constructor(e,t,r,i,o){this.type=Ee,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(e,t){if(e.length!==3)return t.error("Expected two arguments.");let r=t.parse(e[1],1,G);if(!r)return null;let i=e[2];if(typeof i!="object"||Array.isArray(i))return t.error("NumberFormat options argument must be an object.");let o=null;if(i.locale&&(o=t.parse(i.locale,1,Ee),!o))return null;let s=null;if(i.currency&&(s=t.parse(i.currency,1,Ee),!s))return null;let a=null;if(i["min-fraction-digits"]&&(a=t.parse(i["min-fraction-digits"],1,G),!a))return null;let l=null;return i["max-fraction-digits"]&&(l=t.parse(i["max-fraction-digits"],1,G),!l)?null:new n(r,o,s,a,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}},OC=class n{constructor(e){this.type=Fy,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");let i=[],o=!1;for(let s=1;s<=e.length-1;++s){let a=e[s];if(o&&typeof a=="object"&&!Array.isArray(a)){o=!1;let l=null;if(a["font-scale"]&&(l=t.parse(a["font-scale"],1,G),!l))return null;let c=null;if(a["text-font"]&&(c=t.parse(a["text-font"],1,Pr(Ee)),!c))return null;let u=null;if(a["text-color"]&&(u=t.parse(a["text-color"],1,bo),!u))return null;let d=null;if(a["vertical-align"]){if(typeof a["vertical-align"]=="string"&&!a9.includes(a["vertical-align"]))return t.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${a["vertical-align"]}' instead.`);if(d=t.parse(a["vertical-align"],1,Ee),!d)return null}let f=i[i.length-1];f.scale=l,f.font=c,f.textColor=u,f.verticalAlign=d}else{let l=t.parse(e[s],1,fe);if(!l)return null;let c=l.type.kind;if(c!=="string"&&c!=="value"&&c!=="null"&&c!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,i.push({content:l,scale:null,font:null,textColor:null,verticalAlign:null})}}return new n(i)}evaluate(e){let t=r=>{let i=r.content.evaluate(e);return Kt(i)===Yf?new Bf("",i,null,null,null,r.verticalAlign?r.verticalAlign.evaluate(e):null):new Bf(Lf(i),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null,r.verticalAlign?r.verticalAlign.evaluate(e):null)};return new El(this.sections.map(t))}eachChild(e){for(let t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor),t.verticalAlign&&e(t.verticalAlign)}outputDefined(){return!1}},FC=class n{constructor(e){this.type=Yf,this.input=e}static parse(e,t){if(e.length!==2)return t.error("Expected two arguments.");let r=t.parse(e[1],1,Ee);return r?new n(r):t.error("No image name provided.")}evaluate(e){let t=this.input.evaluate(e),r=ga.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}},LC=class n{constructor(e){this.type=G,this.input=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);let r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error(`Expected argument of type string or array, but found ${_t(r.type)} instead.`):new n(r):null}evaluate(e){let t=this.input.evaluate(e);if(typeof t=="string")return[...t].length;if(Array.isArray(t))return t.length;throw new ft(`Expected value to be of type string or array, but found ${_t(Kt(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}},Mo=8192;function A9(n,e){let t=P9(n[0]),r=O9(n[1]),i=Math.pow(2,e.z);return[Math.round(t*i*Mo),Math.round(r*i*Mo)]}function WC(n,e){let t=Math.pow(2,e.z),r=(n[0]/Mo+e.x)/t,i=(n[1]/Mo+e.y)/t;return[N9(r),F9(i)]}function P9(n){return(180+n)/360}function N9(n){return n*360-180}function O9(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function F9(n){return 360/Math.PI*Math.atan(Math.exp((180-n*360)*Math.PI/180))-90}function Kf(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function Uf(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function L9(n,e,t){return e[1]>n[1]!=t[1]>n[1]&&n[0]<(t[0]-e[0])*(n[1]-e[1])/(t[1]-e[1])+e[0]}function k9(n,e,t){let r=n[0]-e[0],i=n[1]-e[1],o=n[0]-t[0],s=n[1]-t[1];return r*s-o*i===0&&r*o<=0&&i*s<=0}function Vy(n,e,t,r){let i=[e[0]-n[0],e[1]-n[1]],o=[r[0]-t[0],r[1]-t[1]];return G9(o,i)===0?!1:!!(G2(n,e,t,r)&&G2(t,r,n,e))}function j9(n,e,t){for(let r of t)for(let i=0;i<r.length-1;++i)if(Vy(n,e,r[i],r[i+1]))return!0;return!1}function Cu(n,e,t=!1){let r=!1;for(let i of e)for(let o=0;o<i.length-1;o++){if(k9(n,i[o],i[o+1]))return t;L9(n,i[o],i[o+1])&&(r=!r)}return r}function V9(n,e){for(let t of e)if(Cu(n,t))return!0;return!1}function yO(n,e){for(let t of n)if(!Cu(t,e))return!1;for(let t=0;t<n.length-1;++t)if(j9(n[t],n[t+1],e))return!1;return!0}function B9(n,e){for(let t of e)if(yO(n,t))return!0;return!1}function G9(n,e){return n[0]*e[1]-n[1]*e[0]}function G2(n,e,t,r){let i=n[0]-t[0],o=n[1]-t[1],s=e[0]-t[0],a=e[1]-t[1],l=r[0]-t[0],c=r[1]-t[1],u=i*c-l*o,d=s*c-l*a;return u>0&&d<0||u<0&&d>0}function XC(n,e,t){let r=[];for(let i=0;i<n.length;i++){let o=[];for(let s=0;s<n[i].length;s++){let a=A9(n[i][s],t);Kf(e,a),o.push(a)}r.push(o)}return r}function vO(n,e,t){let r=[];for(let i=0;i<n.length;i++){let o=XC(n[i],e,t);r.push(o)}return r}function _O(n,e,t,r){if(n[0]<t[0]||n[0]>t[2]){let i=r*.5,o=n[0]-t[0]>i?-r:t[0]-n[0]>i?r:0;o===0&&(o=n[0]-t[2]>i?-r:t[2]-n[0]>i?r:0),n[0]+=o}Kf(e,n)}function U9(n){n[0]=n[1]=1/0,n[2]=n[3]=-1/0}function U2(n,e,t,r){let i=Math.pow(2,r.z)*Mo,o=[r.x*Mo,r.y*Mo],s=[];for(let a of n)for(let l of a){let c=[l.x+o[0],l.y+o[1]];_O(c,e,t,i),s.push(c)}return s}function z2(n,e,t,r){let i=Math.pow(2,r.z)*Mo,o=[r.x*Mo,r.y*Mo],s=[];for(let a of n){let l=[];for(let c of a){let u=[c.x+o[0],c.y+o[1]];Kf(e,u),l.push(u)}s.push(l)}if(e[2]-e[0]<=i/2){U9(e);for(let a of s)for(let l of a)_O(l,e,t,i)}return s}function z9(n,e){let t=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=n.canonicalID();if(e.type==="Polygon"){let o=XC(e.coordinates,r,i),s=U2(n.geometry(),t,r,i);if(!Uf(t,r))return!1;for(let a of s)if(!Cu(a,o))return!1}if(e.type==="MultiPolygon"){let o=vO(e.coordinates,r,i),s=U2(n.geometry(),t,r,i);if(!Uf(t,r))return!1;for(let a of s)if(!V9(a,o))return!1}return!0}function $9(n,e){let t=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=n.canonicalID();if(e.type==="Polygon"){let o=XC(e.coordinates,r,i),s=z2(n.geometry(),t,r,i);if(!Uf(t,r))return!1;for(let a of s)if(!yO(a,o))return!1}if(e.type==="MultiPolygon"){let o=vO(e.coordinates,r,i),s=z2(n.geometry(),t,r,i);if(!Uf(t,r))return!1;for(let a of s)if(!B9(a,o))return!1}return!0}var zf=class n{constructor(e,t){this.type=me,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Gf(e[1])){let r=e[1];if(r.type==="FeatureCollection"){let i=[];for(let o of r.features){let{type:s,coordinates:a}=o.geometry;s==="Polygon"&&i.push(a),s==="MultiPolygon"&&i.push(...a)}if(i.length){let o={type:"MultiPolygon",coordinates:i};return new n(r,o)}}else if(r.type==="Feature"){let i=r.geometry.type;if(i==="Polygon"||i==="MultiPolygon")return new n(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new n(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return z9(e,this.geometries);if(e.geometryType()==="LineString")return $9(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}},wy=class{constructor(e=[],t=(r,i)=>r<i?-1:r>i?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:r}=this,i=t[e];for(;e>0;){let o=e-1>>1,s=t[o];if(r(i,s)>=0)break;t[e]=s,e=o}t[e]=i}_down(e){let{data:t,compare:r}=this,i=this.length>>1,o=t[e];for(;e<i;){let s=(e<<1)+1,a=s+1;if(a<this.length&&r(t[a],t[s])<0&&(s=a),r(t[s],o)>=0)break;t[e]=t[s],e=s}t[e]=o}};function xO(n,e,t=0,r=n.length-1,i=H9){for(;r>t;){if(r-t>600){let l=r-t+1,c=e-t+1,u=Math.log(l),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(l-d)/l)*(c-l/2<0?-1:1),h=Math.max(t,Math.floor(e-c*d/l+f)),p=Math.min(r,Math.floor(e+(l-c)*d/l+f));xO(n,e,h,p,i)}let o=n[e],s=t,a=r;for(Of(n,t,e),i(n[r],o)>0&&Of(n,t,r);s<a;){for(Of(n,s,a),s++,a--;i(n[s],o)<0;)s++;for(;i(n[a],o)>0;)a--}i(n[t],o)===0?Of(n,t,a):(a++,Of(n,a,r)),a<=e&&(t=a+1),e<=a&&(r=a-1)}}function Of(n,e,t){let r=n[e];n[e]=n[t],n[t]=r}function H9(n,e){return n<e?-1:n>e?1:0}function q9(n,e){if(n.length<=1)return[n];let r=[],i,o;for(let s of n){let a=X9(s);a!==0&&(s.area=Math.abs(a),o===void 0&&(o=a<0),o===a<0?(i&&r.push(i),i=[s]):i.push(s))}if(i&&r.push(i),e>1)for(let s=0;s<r.length;s++)r[s].length<=e||(xO(r[s],e,1,r[s].length-1,W9),r[s]=r[s].slice(0,e));return r}function W9(n,e){return e.area-n.area}function X9(n){let e=0;for(let t=0,r=n.length,i=r-1,o,s;t<r;i=t++)o=n[t],s=n[i],e+=(s.x-o.x)*(o.y+s.y);return e}var Z9=6378.137,$2=1/298.257223563,H2=$2*(2-$2),q2=Math.PI/180,$f=class{constructor(e){let t=q2*Z9*1e3,r=Math.cos(e*q2),i=1/(1-H2*(1-r*r)),o=Math.sqrt(i);this.kx=t*o*r,this.ky=t*o*i*(1-H2)}distance(e,t){let r=this.wrap(e[0]-t[0])*this.kx,i=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+i*i)}pointOnLine(e,t){let r=1/0,i,o,s,a;for(let l=0;l<e.length-1;l++){let c=e[l][0],u=e[l][1],d=this.wrap(e[l+1][0]-c)*this.kx,f=(e[l+1][1]-u)*this.ky,h=0;(d!==0||f!==0)&&(h=(this.wrap(t[0]-c)*this.kx*d+(t[1]-u)*this.ky*f)/(d*d+f*f),h>1?(c=e[l+1][0],u=e[l+1][1]):h>0&&(c+=d/this.kx*h,u+=f/this.ky*h)),d=this.wrap(t[0]-c)*this.kx,f=(t[1]-u)*this.ky;let p=d*d+f*f;p<r&&(r=p,i=c,o=u,s=l,a=h)}return{point:[i,o],index:s,t:Math.max(0,Math.min(1,a))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}},kC=100,jC=50;function EO(n,e){return e[0]-n[0]}function Cy(n){return n[1]-n[0]+1}function Cs(n,e){return n[1]>=n[0]&&n[1]<e}function VC(n,e){if(n[0]>n[1])return[null,null];let t=Cy(n);if(e){if(t===2)return[n,null];let i=Math.floor(t/2);return[[n[0],n[0]+i],[n[0]+i,n[1]]]}if(t===1)return[n,null];let r=Math.floor(t/2)-1;return[[n[0],n[0]+r],[n[0]+r+1,n[1]]]}function BC(n,e){if(!Cs(e,n.length))return[1/0,1/0,-1/0,-1/0];let t=[1/0,1/0,-1/0,-1/0];for(let r=e[0];r<=e[1];++r)Kf(t,n[r]);return t}function GC(n){let e=[1/0,1/0,-1/0,-1/0];for(let t of n)for(let r of t)Kf(e,r);return e}function W2(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function ZC(n,e,t){if(!W2(n)||!W2(e))return NaN;let r=0,i=0;return n[2]<e[0]&&(r=e[0]-n[2]),n[0]>e[2]&&(r=n[0]-e[2]),n[1]>e[3]&&(i=n[1]-e[3]),n[3]<e[1]&&(i=e[1]-n[3]),t.distance([0,0],[r,i])}function vl(n,e,t){let r=t.pointOnLine(e,n);return t.distance(n,r.point)}function YC(n,e,t,r,i){let o=Math.min(vl(n,[t,r],i),vl(e,[t,r],i)),s=Math.min(vl(t,[n,e],i),vl(r,[n,e],i));return Math.min(o,s)}function Y9(n,e,t,r,i){if(!(Cs(e,n.length)&&Cs(r,t.length)))return 1/0;let s=1/0;for(let a=e[0];a<e[1];++a){let l=n[a],c=n[a+1];for(let u=r[0];u<r[1];++u){let d=t[u],f=t[u+1];if(Vy(l,c,d,f))return 0;s=Math.min(s,YC(l,c,d,f,i))}}return s}function K9(n,e,t,r,i){if(!(Cs(e,n.length)&&Cs(r,t.length)))return NaN;let s=1/0;for(let a=e[0];a<=e[1];++a)for(let l=r[0];l<=r[1];++l)if(s=Math.min(s,i.distance(n[a],t[l])),s===0)return s;return s}function J9(n,e,t){if(Cu(n,e,!0))return 0;let r=1/0;for(let i of e){let o=i[0],s=i[i.length-1];if(o!==s&&(r=Math.min(r,vl(n,[s,o],t)),r===0))return r;let a=t.pointOnLine(i,n);if(r=Math.min(r,t.distance(n,a.point)),r===0)return r}return r}function Q9(n,e,t,r){if(!Cs(e,n.length))return NaN;for(let o=e[0];o<=e[1];++o)if(Cu(n[o],t,!0))return 0;let i=1/0;for(let o=e[0];o<e[1];++o){let s=n[o],a=n[o+1];for(let l of t)for(let c=0,u=l.length,d=u-1;c<u;d=c++){let f=l[d],h=l[c];if(Vy(s,a,f,h))return 0;i=Math.min(i,YC(s,a,f,h,r))}}return i}function X2(n,e){for(let t of n)for(let r of t)if(Cu(r,e,!0))return!0;return!1}function eq(n,e,t,r=1/0){let i=GC(n),o=GC(e);if(r!==1/0&&ZC(i,o,t)>=r)return r;if(Uf(i,o)){if(X2(n,e))return 0}else if(X2(e,n))return 0;let s=1/0;for(let a of n)for(let l=0,c=a.length,u=c-1;l<c;u=l++){let d=a[u],f=a[l];for(let h of e)for(let p=0,m=h.length,g=m-1;p<m;g=p++){let y=h[g],v=h[p];if(Vy(d,f,y,v))return 0;s=Math.min(s,YC(d,f,y,v,t))}}return s}function Z2(n,e,t,r,i,o){if(!o)return;let s=ZC(BC(r,o),i,t);s<e&&n.push([s,o,[0,0]])}function dy(n,e,t,r,i,o,s){if(!o||!s)return;let a=ZC(BC(r,o),BC(i,s),t);a<e&&n.push([a,o,s])}function by(n,e,t,r,i=1/0){let o=Math.min(r.distance(n[0],t[0][0]),i);if(o===0)return o;let s=new wy([[0,[0,n.length-1],[0,0]]],EO),a=GC(t);for(;s.length>0;){let l=s.pop();if(l[0]>=o)continue;let c=l[1],u=e?jC:kC;if(Cy(c)<=u){if(!Cs(c,n.length))return NaN;if(e){let d=Q9(n,c,t,r);if(isNaN(d)||d===0)return d;o=Math.min(o,d)}else for(let d=c[0];d<=c[1];++d){let f=J9(n[d],t,r);if(o=Math.min(o,f),o===0)return 0}}else{let d=VC(c,e);Z2(s,o,r,n,a,d[0]),Z2(s,o,r,n,a,d[1])}}return o}function My(n,e,t,r,i,o=1/0){let s=Math.min(o,i.distance(n[0],t[0]));if(s===0)return s;let a=new wy([[0,[0,n.length-1],[0,t.length-1]]],EO);for(;a.length>0;){let l=a.pop();if(l[0]>=s)continue;let c=l[1],u=l[2],d=e?jC:kC,f=r?jC:kC;if(Cy(c)<=d&&Cy(u)<=f){if(!Cs(c,n.length)&&Cs(u,t.length))return NaN;let h;if(e&&r)h=Y9(n,c,t,u,i),s=Math.min(s,h);else if(e&&!r){let p=n.slice(c[0],c[1]+1);for(let m=u[0];m<=u[1];++m)if(h=vl(t[m],p,i),s=Math.min(s,h),s===0)return s}else if(!e&&r){let p=t.slice(u[0],u[1]+1);for(let m=c[0];m<=c[1];++m)if(h=vl(n[m],p,i),s=Math.min(s,h),s===0)return s}else h=K9(n,c,t,u,i),s=Math.min(s,h)}else{let h=VC(c,e),p=VC(u,r);dy(a,s,i,n,t,h[0],p[0]),dy(a,s,i,n,t,h[0],p[1]),dy(a,s,i,n,t,h[1],p[0]),dy(a,s,i,n,t,h[1],p[1])}}return s}function tq(n,e){let t=n.geometry(),r=t.flat().map(s=>WC([s.x,s.y],n.canonical));if(t.length===0)return NaN;let i=new $f(r[0][1]),o=1/0;for(let s of e){switch(s.type){case"Point":o=Math.min(o,My(r,!1,[s.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,My(r,!1,s.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,by(r,!1,s.coordinates,i,o));break}if(o===0)return o}return o}function nq(n,e){let t=n.geometry(),r=t.flat().map(s=>WC([s.x,s.y],n.canonical));if(t.length===0)return NaN;let i=new $f(r[0][1]),o=1/0;for(let s of e){switch(s.type){case"Point":o=Math.min(o,My(r,!0,[s.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,My(r,!0,s.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,by(r,!0,s.coordinates,i,o));break}if(o===0)return o}return o}function rq(n,e){let t=n.geometry();if(t.length===0||t[0].length===0)return NaN;let r=q9(t,0).map(s=>s.map(a=>a.map(l=>WC([l.x,l.y],n.canonical)))),i=new $f(r[0][0][0][1]),o=1/0;for(let s of e)for(let a of r){switch(s.type){case"Point":o=Math.min(o,by([s.coordinates],!1,a,i,o));break;case"LineString":o=Math.min(o,by(s.coordinates,!0,a,i,o));break;case"Polygon":o=Math.min(o,eq(a,s.coordinates,i,o));break}if(o===0)return o}return o}function CC(n){return n.type==="MultiPolygon"?n.coordinates.map(e=>({type:"Polygon",coordinates:e})):n.type==="MultiLineString"?n.coordinates.map(e=>({type:"LineString",coordinates:e})):n.type==="MultiPoint"?n.coordinates.map(e=>({type:"Point",coordinates:e})):[n]}var Hf=class n{constructor(e,t){this.type=G,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Gf(e[1])){let r=e[1];if(r.type==="FeatureCollection")return new n(r,r.features.map(i=>CC(i.geometry)).flat());if(r.type==="Feature")return new n(r,CC(r.geometry));if("type"in r&&"coordinates"in r)return new n(r,CC(r))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return tq(e,this.geometries);if(e.geometryType()==="LineString")return nq(e,this.geometries);if(e.geometryType()==="Polygon")return rq(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}},qf=class n{constructor(e){this.type=fe,this.key=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);let r=e[1];return r==null?t.error("Global state property must be defined."):typeof r!="string"?t.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new n(r)}evaluate(e){var t;let r=(t=e.globals)===null||t===void 0?void 0:t.globalState;return!r||Object.keys(r).length===0?null:Ff(r,this.key)}eachChild(){}outputDefined(){return!1}},KC={"==":M9,"!=":T9,">":I9,"<":S9,">=":R9,"<=":D9,array:Li,at:SC,boolean:Li,case:AC,coalesce:xy,collator:Ey,format:OC,image:FC,in:IC,"index-of":DC,interpolate:_s,"interpolate-hcl":_s,"interpolate-lab":_s,length:LC,let:yy,literal:xu,match:RC,number:Li,"number-format":NC,object:Li,slice:PC,step:_y,string:Li,"to-boolean":pa,"to-color":pa,"to-number":pa,"to-string":pa,var:vy,within:zf,distance:Hf,"global-state":qf},ya=class n{constructor(e,t,r,i){this.name=e,this.type=t,this._evaluate=r,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){let r=e[0],i=n.definitions[r];if(!i)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);let o=Array.isArray(i)?i[0]:i.type,s=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,a=s.filter(([c])=>!Array.isArray(c)||c.length===e.length-1),l=null;for(let[c,u]of a){l=new gy(t.registry,Ty,t.path,null,t.scope);let d=[],f=!1;for(let h=1;h<e.length;h++){let p=e[h],m=Array.isArray(c)?c[h-1]:c.type,g=l.parse(p,1+d.length,m);if(!g){f=!0;break}d.push(g)}if(!f){if(Array.isArray(c)&&c.length!==d.length){l.error(`Expected ${c.length} arguments, but found ${d.length} instead.`);continue}for(let h=0;h<d.length;h++){let p=Array.isArray(c)?c[h]:c.type,m=d[h];l.concat(h+1).checkSubtype(p,m.type)}if(l.errors.length===0)return new n(r,o,u,d)}}if(a.length===1)t.errors.push(...l.errors);else{let u=(a.length?a:s).map(([f])=>oq(f)).join(" | "),d=[];for(let f=1;f<e.length;f++){let h=t.parse(e[f],1+d.length);if(!h)return null;d.push(_t(h.type))}t.error(`Expected arguments of type ${u}, but found (${d.join(", ")}) instead.`)}return null}static register(e,t){n.definitions=t;for(let r in t)e[r]=n}};function Y2(n,[e,t,r,i]){e=e.evaluate(n),t=t.evaluate(n),r=r.evaluate(n);let o=i?i.evaluate(n):1,s=hO(e,t,r,o);if(s)throw new ft(s);return new Ye(e/255,t/255,r/255,o,!1)}function K2(n,e){return n in e}function bC(n,e){let t=e[n];return typeof t>"u"?null:t}function iq(n,e,t,r){for(;t<=r;){let i=t+r>>1;if(e[i]===n)return!0;e[i]>n?r=i-1:t=i+1}return!1}function yl(n){return{type:n}}ya.register(KC,{error:[YH,[Ee],(n,[e])=>{throw new ft(e.evaluate(n))}],typeof:[Ee,[fe],(n,[e])=>_t(Kt(e.evaluate(n)))],"to-rgba":[Pr(G,4),[bo],(n,[e])=>{let[t,r,i,o]=e.evaluate(n).rgb;return[t*255,r*255,i*255,o]}],rgb:[bo,[G,G,G],Y2],rgba:[bo,[G,G,G,G],Y2],has:{type:me,overloads:[[[Ee],(n,[e])=>K2(e.evaluate(n),n.properties())],[[Ee,_l],(n,[e,t])=>K2(e.evaluate(n),t.evaluate(n))]]},get:{type:fe,overloads:[[[Ee],(n,[e])=>bC(e.evaluate(n),n.properties())],[[Ee,_l],(n,[e,t])=>bC(e.evaluate(n),t.evaluate(n))]]},"feature-state":[fe,[Ee],(n,[e])=>bC(e.evaluate(n),n.featureState||{})],properties:[_l,[],n=>n.properties()],"geometry-type":[Ee,[],n=>n.geometryType()],id:[fe,[],n=>n.id()],zoom:[G,[],n=>n.globals.zoom],"heatmap-density":[G,[],n=>n.globals.heatmapDensity||0],elevation:[G,[],n=>n.globals.elevation||0],"line-progress":[G,[],n=>n.globals.lineProgress||0],accumulated:[fe,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[G,yl(G),(n,e)=>{let t=0;for(let r of e)t+=r.evaluate(n);return t}],"*":[G,yl(G),(n,e)=>{let t=1;for(let r of e)t*=r.evaluate(n);return t}],"-":{type:G,overloads:[[[G,G],(n,[e,t])=>e.evaluate(n)-t.evaluate(n)],[[G],(n,[e])=>-e.evaluate(n)]]},"/":[G,[G,G],(n,[e,t])=>e.evaluate(n)/t.evaluate(n)],"%":[G,[G,G],(n,[e,t])=>e.evaluate(n)%t.evaluate(n)],ln2:[G,[],()=>Math.LN2],pi:[G,[],()=>Math.PI],e:[G,[],()=>Math.E],"^":[G,[G,G],(n,[e,t])=>Math.pow(e.evaluate(n),t.evaluate(n))],sqrt:[G,[G],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[G,[G],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[G,[G],(n,[e])=>Math.log(e.evaluate(n))],log2:[G,[G],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[G,[G],(n,[e])=>Math.sin(e.evaluate(n))],cos:[G,[G],(n,[e])=>Math.cos(e.evaluate(n))],tan:[G,[G],(n,[e])=>Math.tan(e.evaluate(n))],asin:[G,[G],(n,[e])=>Math.asin(e.evaluate(n))],acos:[G,[G],(n,[e])=>Math.acos(e.evaluate(n))],atan:[G,[G],(n,[e])=>Math.atan(e.evaluate(n))],min:[G,yl(G),(n,e)=>Math.min(...e.map(t=>t.evaluate(n)))],max:[G,yl(G),(n,e)=>Math.max(...e.map(t=>t.evaluate(n)))],abs:[G,[G],(n,[e])=>Math.abs(e.evaluate(n))],round:[G,[G],(n,[e])=>{let t=e.evaluate(n);return t<0?-Math.round(-t):Math.round(t)}],floor:[G,[G],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[G,[G],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[me,[Ee,fe],(n,[e,t])=>n.properties()[e.value]===t.value],"filter-id-==":[me,[fe],(n,[e])=>n.id()===e.value],"filter-type-==":[me,[Ee],(n,[e])=>n.geometryType()===e.value],"filter-<":[me,[Ee,fe],(n,[e,t])=>{let r=n.properties()[e.value],i=t.value;return typeof r==typeof i&&r<i}],"filter-id-<":[me,[fe],(n,[e])=>{let t=n.id(),r=e.value;return typeof t==typeof r&&t<r}],"filter->":[me,[Ee,fe],(n,[e,t])=>{let r=n.properties()[e.value],i=t.value;return typeof r==typeof i&&r>i}],"filter-id->":[me,[fe],(n,[e])=>{let t=n.id(),r=e.value;return typeof t==typeof r&&t>r}],"filter-<=":[me,[Ee,fe],(n,[e,t])=>{let r=n.properties()[e.value],i=t.value;return typeof r==typeof i&&r<=i}],"filter-id-<=":[me,[fe],(n,[e])=>{let t=n.id(),r=e.value;return typeof t==typeof r&&t<=r}],"filter->=":[me,[Ee,fe],(n,[e,t])=>{let r=n.properties()[e.value],i=t.value;return typeof r==typeof i&&r>=i}],"filter-id->=":[me,[fe],(n,[e])=>{let t=n.id(),r=e.value;return typeof t==typeof r&&t>=r}],"filter-has":[me,[fe],(n,[e])=>e.value in n.properties()],"filter-has-id":[me,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[me,[Pr(Ee)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[me,[Pr(fe)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[me,[Ee,Pr(fe)],(n,[e,t])=>t.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[me,[Ee,Pr(fe)],(n,[e,t])=>iq(n.properties()[e.value],t.value,0,t.value.length-1)],all:{type:me,overloads:[[[me,me],(n,[e,t])=>e.evaluate(n)&&t.evaluate(n)],[yl(me),(n,e)=>{for(let t of e)if(!t.evaluate(n))return!1;return!0}]]},any:{type:me,overloads:[[[me,me],(n,[e,t])=>e.evaluate(n)||t.evaluate(n)],[yl(me),(n,e)=>{for(let t of e)if(t.evaluate(n))return!0;return!1}]]},"!":[me,[me],(n,[e])=>!e.evaluate(n)],"is-supported-script":[me,[Ee],(n,[e])=>{let t=n.globals&&n.globals.isSupportedScript;return t?t(e.evaluate(n)):!0}],upcase:[Ee,[Ee],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[Ee,[Ee],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[Ee,yl(fe),(n,e)=>e.map(t=>Lf(t.evaluate(n))).join("")],"resolved-locale":[Ee,[Oy],(n,[e])=>e.evaluate(n).resolvedLocale()]});function oq(n){return Array.isArray(n)?`(${n.map(_t).join(", ")})`:`(${_t(n.type)}...)`}function Ty(n){if(n instanceof vy)return Ty(n.boundExpression);if(n instanceof ya&&n.name==="error")return!1;if(n instanceof Ey)return!1;if(n instanceof zf)return!1;if(n instanceof Hf)return!1;if(n instanceof qf)return!1;let e=n instanceof pa||n instanceof Li,t=!0;return n.eachChild(r=>{e?t=t&&Ty(r):t=t&&r instanceof xu}),t?By(n)&&Gy(n,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"]):!1}function By(n){if(n instanceof ya){if(n.name==="get"&&n.args.length===1)return!1;if(n.name==="feature-state")return!1;if(n.name==="has"&&n.args.length===1)return!1;if(n.name==="properties"||n.name==="geometry-type"||n.name==="id")return!1;if(/^filter-/.test(n.name))return!1}if(n instanceof zf||n instanceof Hf)return!1;let e=!0;return n.eachChild(t=>{e&&!By(t)&&(e=!1)}),e}function Wf(n){if(n instanceof ya&&n.name==="feature-state")return!1;let e=!0;return n.eachChild(t=>{e&&!Wf(t)&&(e=!1)}),e}function Gy(n,e){if(n instanceof ya&&e.indexOf(n.name)>=0)return!1;let t=!0;return n.eachChild(r=>{t&&!Gy(r,e)&&(t=!1)}),t}function UC(n){return{result:"success",value:n}}function gu(n){return{result:"error",value:n}}function Sy(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function wO(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function CO(n){return!!n.expression&&n.expression.interpolated}function Ie(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Jf(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&Kt(n)===_l}var zC=class{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new my,this._defaultValue=t?aq(t):null,this._enumValues=t&&t.type==="enum"?t.values:null}evaluateWithoutErrorHandling(e,t,r,i,o,s){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=s,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,i,o,s){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=s||null;try{let a=this.expression.evaluate(this._evaluator);if(a==null||typeof a=="number"&&a!==a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new ft(`Expected value to be one of ${Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", ")}, but found ${JSON.stringify(a)} instead.`);return a}catch(a){return this._warningHistory[a.message]||(this._warningHistory[a.message]=!0,typeof console<"u"&&console.warn(a.message)),this._defaultValue}}};function Uy(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in KC}function JC(n,e){let t=new gy(KC,Ty,[],e?sq(e):void 0),r=t.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return r?UC(new zC(r,e)):gu(t.errors)}var Iy=class{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!Wf(t.expression),this.globalStateRefs=zy(t.expression)}evaluateWithoutErrorHandling(e,t,r,i,o,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,o,s)}evaluate(e,t,r,i,o,s){return this._styleExpression.evaluate(e,t,r,i,o,s)}},Dy=class{constructor(e,t,r,i){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!Wf(t.expression),this.globalStateRefs=zy(t.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,t,r,i,o,s){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,i,o,s)}evaluate(e,t,r,i,o,s){return this._styleExpression.evaluate(e,t,r,i,o,s)}interpolationFactor(e,t,r){return this.interpolationType?_s.interpolationFactor(this.interpolationType,e,t,r):0}};function QC(n,e){let t=JC(n,e);if(t.result==="error")return t;let r=t.value.expression,i=By(r);if(!i&&!Sy(e))return gu([new si("","data expressions not supported")]);let o=Gy(r,["zoom"]);if(!o&&!wO(e))return gu([new si("","zoom expressions not supported")]);let s=hy(r);if(!s&&!o)return gu([new si("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(s instanceof si)return gu([s]);if(s instanceof _s&&!CO(e))return gu([new si("",'"interpolate" expressions cannot be used with this property')]);if(!s)return UC(i?new Iy("constant",t.value):new Iy("source",t.value));let a=s instanceof _s?s.interpolation:void 0;return UC(i?new Dy("camera",t.value,s.labels,a):new Dy("composite",t.value,s.labels,a))}function hy(n){let e=null;if(n instanceof yy)e=hy(n.result);else if(n instanceof xy){for(let t of n.args)if(e=hy(t),e)break}else(n instanceof _y||n instanceof _s)&&n.input instanceof ya&&n.input.name==="zoom"&&(e=n);return e instanceof si||n.eachChild(t=>{let r=hy(t);r instanceof si?e=r:!e&&r?e=new si("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&r&&e!==r&&(e=new si("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function zy(n,e=new Set){return n instanceof qf&&e.add(n.key),n.eachChild(t=>{zy(t,e)}),e}function sq(n){let e={color:bo,string:Ee,number:G,enum:Ee,boolean:me,formatted:Fy,padding:Ly,numberArray:ky,colorArray:kf,projectionDefinition:Ny,resolvedImage:Yf,variableAnchorOffsetCollection:jy};return n.type==="array"?Pr(e[n.value]||fe,n.length):e[n.type]}function aq(n){if(n.type==="color"&&Jf(n.default))return new Ye(0,0,0,0);switch(n.type){case"color":return Ye.parse(n.default)||null;case"padding":return xs.parse(n.default)||null;case"numberArray":return Es.parse(n.default)||null;case"colorArray":return ki.parse(n.default)||null;case"variableAnchorOffsetCollection":return ws.parse(n.default)||null;case"projectionDefinition":return wl.parse(n.default)||null;default:return n.default===void 0?null:n.default}}function eb(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(let e of n.slice(1))if(!eb(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}var lq={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function bO(n){if(n==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};eb(n)||(n=Ry(n));let e=JC(n,lq);if(e.result==="error")throw new Error(e.value.map(t=>`${t.key}: ${t.message}`).join(", "));{let t=MO(n);return{filter:(r,i,o)=>e.value.evaluate(r,i,{},o),needGeometry:t,getGlobalStateRefs:()=>zy(e.value.expression)}}}function cq(n,e){return n<e?-1:n>e?1:0}function MO(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let e=1;e<n.length;e++)if(MO(n[e]))return!0;return!1}function Ry(n){if(!n)return!0;let e=n[0];return n.length<=1?e!=="any":e==="=="?MC(n[1],n[2],"=="):e==="!="?fy(MC(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?MC(n[1],n[2],e):e==="any"?uq(n.slice(1)):e==="all"?["all"].concat(n.slice(1).map(Ry)):e==="none"?["all"].concat(n.slice(1).map(Ry).map(fy)):e==="in"?J2(n[1],n.slice(2)):e==="!in"?fy(J2(n[1],n.slice(2))):e==="has"?Q2(n[1]):e==="!has"?fy(Q2(n[1])):!0}function MC(n,e,t){switch(n){case"$type":return[`filter-type-${t}`,e];case"$id":return[`filter-id-${t}`,e];default:return[`filter-${t}`,n,e]}}function uq(n){return["any"].concat(n.map(Ry))}function J2(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",n,["literal",e.sort(cq)]]:["filter-in-small",n,["literal",e]]}}function Q2(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function fy(n){return["!",n]}function Xf(n){return typeof n=="object"?["literal",n]:n}function TO(n,e){let t=n.stops;if(!t)return dq(n,e);let r=t&&typeof t[0][0]=="object",i=r||n.property!==void 0,o=r||!i;return t=t.map(s=>!i&&e.tokens&&typeof s[1]=="string"?[s[0],mq(s[1])]:[s[0],Xf(s[1])]),r?fq(n,e,t):o?pq(n,e,t):$C(n,e,t)}function dq(n,e){let t=["get",n.property];if(n.default===void 0)return e.type==="string"?["string",t]:t;if(e.type==="enum")return["match",t,Object.keys(e.values),t,n.default];{let r=[e.type==="color"?"to-color":e.type,t,Xf(n.default)];return e.type==="array"&&r.splice(1,0,e.value,e.length||null),r}}function tb(n){switch(n.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function fq(n,e,t){let r={},i={},o=[];for(let a=0;a<t.length;a++){let l=t[a],c=l[0].zoom;r[c]===void 0&&(r[c]={zoom:c,type:n.type,property:n.property,default:n.default},i[c]=[],o.push(c)),i[c].push([l[0].value,l[1]])}if(rb({},e)==="exponential"){let a=[tb(n),["linear"],["zoom"]];for(let l of o){let c=$C(r[l],e,i[l]);vu(a,l,c,!1)}return a}else{let a=["step",["zoom"]];for(let l of o){let c=$C(r[l],e,i[l]);vu(a,l,c,!0)}return nb(a),a}}function hq(n,e){if(n!==void 0)return n;if(e!==void 0)return e}function eO(n,e){let t=Xf(hq(n.default,e.default));return t===void 0&&e.type==="resolvedImage"?"":t}function $C(n,e,t){let r=rb(n,e),i=["get",n.property];if(r==="categorical"&&typeof t[0][0]=="boolean"){let o=["case"];for(let s of t)o.push(["==",i,s[0]],s[1]);return o.push(eO(n,e)),o}else if(r==="categorical"){let o=["match",i];for(let s of t)vu(o,s[0],s[1],!1);return o.push(eO(n,e)),o}else if(r==="interval"){let o=["step",["number",i]];for(let s of t)vu(o,s[0],s[1],!0);return nb(o),n.default===void 0?o:["case",["==",["typeof",i],"number"],o,Xf(n.default)]}else if(r==="exponential"){let o=n.base!==void 0?n.base:1,s=[tb(n),o===1?["linear"]:["exponential",o],["number",i]];for(let a of t)vu(s,a[0],a[1],!1);return n.default===void 0?s:["case",["==",["typeof",i],"number"],s,Xf(n.default)]}else throw new Error(`Unknown property function type ${r}`)}function pq(n,e,t,r=["zoom"]){let i=rb(n,e),o,s=!1;if(i==="interval")o=["step",r],s=!0;else if(i==="exponential"){let a=n.base!==void 0?n.base:1;o=[tb(n),a===1?["linear"]:["exponential",a],r]}else throw new Error(`Unknown zoom function type "${i}"`);for(let a of t)vu(o,a[0],a[1],s);return nb(o),o}function nb(n){n[0]==="step"&&n.length===3&&(n.push(0),n.push(n[3]))}function vu(n,e,t,r){n.length>3&&e===n[n.length-2]||(r&&n.length===2||n.push(e),n.push(t))}function rb(n,e){return n.type?n.type:e.expression.interpolated?"exponential":"interval"}function mq(n){let e=["concat"],t=/{([^{}]+)}/g,r=0;for(let i=t.exec(n);i!==null;i=t.exec(n)){let o=n.slice(r,t.lastIndex-i[0].length);r=t.lastIndex,o.length>0&&e.push(o),e.push(["get",i[1]])}if(e.length===1)return n;if(r<n.length)e.push(n.slice(r));else if(e.length===2)return["to-string",e[1]];return e}function SO(n){let e=n.key,t=n.value;return t?[new k(e,t,"constants have been deprecated as of v8")]:[]}function Nt(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Cl(n){if(Array.isArray(n))return n.map(Cl);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){let e={};for(let t in n)e[t]=Cl(n[t]);return e}return Nt(n)}function ai(n){let e=n.key,t=n.value,r=n.valueSpec||{},i=n.objectElementValidators||{},o=n.style,s=n.styleSpec,a=n.validateSpec,l=[],c=Ie(t);if(c!=="object")return[new k(e,t,`object expected, ${c} found`)];for(let u in t){let d=u.split(".")[0],f=Ff(r,d)||r["*"],h;if(Ff(i,d))h=i[d];else if(Ff(r,d))h=a;else if(i["*"])h=i["*"];else if(r["*"])h=a;else{l.push(new k(e,t[u],`unknown property "${u}"`));continue}l=l.concat(h({key:(e&&`${e}.`)+u,value:t[u],valueSpec:f,style:o,styleSpec:s,object:t,objectKey:u,validateSpec:a},t))}for(let u in r)i[u]||r[u].required&&r[u].default===void 0&&t[u]===void 0&&l.push(new k(e,t,`missing required property "${u}"`));return l}function ib(n){let e=n.value,t=n.valueSpec,r=n.validateSpec,i=n.style,o=n.styleSpec,s=n.key,a=n.arrayElementValidator||r;if(Ie(e)!=="array")return[new k(s,e,`array expected, ${Ie(e)} found`)];if(t.length&&e.length!==t.length)return[new k(s,e,`array length ${t.length} expected, length ${e.length} found`)];if(t["min-length"]&&e.length<t["min-length"])return[new k(s,e,`array length at least ${t["min-length"]} expected, length ${e.length} found`)];let l={type:t.value,values:t.values};o.$version<7&&(l.function=t.function),Ie(t.value)==="object"&&(l=t.value);let c=[];for(let u=0;u<e.length;u++)c=c.concat(a({array:e,arrayIndex:u,value:e[u],valueSpec:l,validateSpec:n.validateSpec,style:i,styleSpec:o,key:`${s}[${u}]`}));return c}function $y(n){let e=n.key,t=n.value,r=n.valueSpec,i=Ie(t);return i==="number"&&t!==t&&(i="NaN"),i!=="number"?[new k(e,t,`number expected, ${i} found`)]:"minimum"in r&&t<r.minimum?[new k(e,t,`${t} is less than the minimum value ${r.minimum}`)]:"maximum"in r&&t>r.maximum?[new k(e,t,`${t} is greater than the maximum value ${r.maximum}`)]:[]}function IO(n){let e=n.valueSpec,t=Nt(n.value.type),r,i={},o,s,a=t!=="categorical"&&n.value.property===void 0,l=!a,c=Ie(n.value.stops)==="array"&&Ie(n.value.stops[0])==="array"&&Ie(n.value.stops[0][0])==="object",u=ai({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:d,default:p}});return t==="identity"&&a&&u.push(new k(n.key,n.value,'missing required property "property"')),t!=="identity"&&!n.value.stops&&u.push(new k(n.key,n.value,'missing required property "stops"')),t==="exponential"&&n.valueSpec.expression&&!CO(n.valueSpec)&&u.push(new k(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(l&&!Sy(n.valueSpec)?u.push(new k(n.key,n.value,"property functions not supported")):a&&!wO(n.valueSpec)&&u.push(new k(n.key,n.value,"zoom functions not supported"))),(t==="categorical"||c)&&n.value.property===void 0&&u.push(new k(n.key,n.value,'"property" property is required')),u;function d(m){if(t==="identity")return[new k(m.key,m.value,'identity function may not have a "stops" property')];let g=[],y=m.value;return g=g.concat(ib({key:m.key,value:y,valueSpec:m.valueSpec,validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec,arrayElementValidator:f})),Ie(y)==="array"&&y.length===0&&g.push(new k(m.key,y,"array must have at least one stop")),g}function f(m){let g=[],y=m.value,v=m.key;if(Ie(y)!=="array")return[new k(v,y,`array expected, ${Ie(y)} found`)];if(y.length!==2)return[new k(v,y,`array length 2 expected, length ${y.length} found`)];if(c){if(Ie(y[0])!=="object")return[new k(v,y,`object expected, ${Ie(y[0])} found`)];if(y[0].zoom===void 0)return[new k(v,y,"object stop key must have zoom")];if(y[0].value===void 0)return[new k(v,y,"object stop key must have value")];if(s&&s>Nt(y[0].zoom))return[new k(v,y[0].zoom,"stop zoom values must appear in ascending order")];Nt(y[0].zoom)!==s&&(s=Nt(y[0].zoom),o=void 0,i={}),g=g.concat(ai({key:`${v}[0]`,value:y[0],valueSpec:{zoom:{}},validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{zoom:$y,value:h}}))}else g=g.concat(h({key:`${v}[0]`,value:y[0],validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec},y));return Uy(Cl(y[1]))?g.concat([new k(`${v}[1]`,y[1],"expressions are not allowed in function stops.")]):g.concat(m.validateSpec({key:`${v}[1]`,value:y[1],valueSpec:e,validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec}))}function h(m,g){let y=Ie(m.value),v=Nt(m.value),x=m.value!==null?m.value:g;if(!r)r=y;else if(y!==r)return[new k(m.key,x,`${y} stop domain type must match previous stop domain type ${r}`)];if(y!=="number"&&y!=="string"&&y!=="boolean")return[new k(m.key,x,"stop domain value must be a number, string, or boolean")];if(y!=="number"&&t!=="categorical"){let E=`number expected, ${y} found`;return Sy(e)&&t===void 0&&(E+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new k(m.key,x,E)]}return t==="categorical"&&y==="number"&&(!isFinite(v)||Math.floor(v)!==v)?[new k(m.key,x,`integer expected, found ${v}`)]:t!=="categorical"&&y==="number"&&o!==void 0&&v<o?[new k(m.key,x,"stop domain values must appear in ascending order")]:(o=v,t==="categorical"&&v in i?[new k(m.key,x,"stop domain values must be unique")]:(i[v]=!0,[]))}function p(m){return m.validateSpec({key:m.key,value:m.value,valueSpec:e,validateSpec:m.validateSpec,style:m.style,styleSpec:m.styleSpec})}}function Eu(n){let e=(n.expressionContext==="property"?QC:JC)(Cl(n.value),n.valueSpec);if(e.result==="error")return e.value.map(r=>new k(`${n.key}${r.key}`,n.value,r.message));let t=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!t.outputDefined())return[new k(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Wf(t))return[new k(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!Wf(t))return[new k(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!Gy(t,["zoom","feature-state"]))return[new k(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!By(t))return[new k(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function gq(n){let e=n.value,t=n.key,r=Ie(e);return r!=="boolean"?[new k(t,e,`boolean expected, ${r} found`)]:[]}function HC(n){let e=n.key,t=n.value,r=Ie(t);return r!=="string"?[new k(e,t,`color expected, ${r} found`)]:Ye.parse(String(t))?[]:[new k(e,t,`color expected, "${t}" found`)]}function Zf(n){let e=n.key,t=n.value,r=n.valueSpec,i=[];return Array.isArray(r.values)?r.values.indexOf(Nt(t))===-1&&i.push(new k(e,t,`expected one of [${r.values.join(", ")}], ${JSON.stringify(t)} found`)):Object.keys(r.values).indexOf(Nt(t))===-1&&i.push(new k(e,t,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(t)} found`)),i}function ob(n){return eb(Cl(n.value))?Eu(py({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):DO(n)}function DO(n){let e=n.value,t=n.key;if(Ie(e)!=="array")return[new k(t,e,`array expected, ${Ie(e)} found`)];let r=n.styleSpec,i,o=[];if(e.length<1)return[new k(t,e,"filter array must have at least 1 element")];switch(o=o.concat(Zf({key:`${t}[0]`,value:e[0],valueSpec:r.filter_operator,style:n.style,styleSpec:n.styleSpec})),Nt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Nt(e[1])==="$type"&&o.push(new k(t,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&o.push(new k(t,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(i=Ie(e[1]),i!=="string"&&o.push(new k(`${t}[1]`,e[1],`string expected, ${i} found`)));for(let s=2;s<e.length;s++)i=Ie(e[s]),Nt(e[1])==="$type"?o=o.concat(Zf({key:`${t}[${s}]`,value:e[s],valueSpec:r.geometry_type,style:n.style,styleSpec:n.styleSpec})):i!=="string"&&i!=="number"&&i!=="boolean"&&o.push(new k(`${t}[${s}]`,e[s],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let s=1;s<e.length;s++)o=o.concat(DO({key:`${t}[${s}]`,value:e[s],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":i=Ie(e[1]),e.length!==2?o.push(new k(t,e,`filter array for "${e[0]}" operator must have 2 elements`)):i!=="string"&&o.push(new k(`${t}[1]`,e[1],`string expected, ${i} found`));break}return o}function RO(n,e){let t=n.key,r=n.validateSpec,i=n.style,o=n.styleSpec,s=n.value,a=n.objectKey,l=o[`${e}_${n.layerType}`];if(!l)return[];let c=a.match(/^(.*)-transition$/);if(e==="paint"&&c&&l[c[1]]&&l[c[1]].transition)return r({key:t,value:s,valueSpec:o.transition,style:i,styleSpec:o});let u=n.valueSpec||l[a];if(!u)return[new k(t,s,`unknown property "${a}"`)];let d;if(Ie(s)==="string"&&Sy(u)&&!u.tokens&&(d=/^{([^}]+)}$/.exec(s)))return[new k(t,s,`"${a}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(d[1])} }\`.`)];let f=[];return n.layerType==="symbol"&&(a==="text-field"&&i&&!i.glyphs&&f.push(new k(t,s,'use of "text-field" requires a style "glyphs" property')),a==="text-font"&&Jf(Cl(s))&&Nt(s.type)==="identity"&&f.push(new k(t,s,'"text-font" does not support identity functions'))),f.concat(r({key:n.key,value:s,valueSpec:u,style:i,styleSpec:o,expressionContext:"property",propertyType:e,propertyKey:a}))}function AO(n){return RO(n,"paint")}function PO(n){return RO(n,"layout")}function NO(n){let e=[],t=n.value,r=n.key,i=n.style,o=n.styleSpec;if(Ie(t)!=="object")return[new k(r,t,`object expected, ${Ie(t)} found`)];!t.type&&!t.ref&&e.push(new k(r,t,'either "type" or "ref" is required'));let s=Nt(t.type),a=Nt(t.ref);if(t.id){let l=Nt(t.id);for(let c=0;c<n.arrayIndex;c++){let u=i.layers[c];Nt(u.id)===l&&e.push(new k(r,t.id,`duplicate layer id "${t.id}", previously used at line ${u.id.__line__}`))}}if("ref"in t){["type","source","source-layer","filter","layout"].forEach(c=>{c in t&&e.push(new k(r,t[c],`"${c}" is prohibited for ref layers`))});let l;i.layers.forEach(c=>{Nt(c.id)===a&&(l=c)}),l?l.ref?e.push(new k(r,t.ref,"ref cannot reference another ref layer")):s=Nt(l.type):e.push(new k(r,t.ref,`ref layer "${a}" not found`))}else if(s!=="background")if(!t.source)e.push(new k(r,t,'missing required property "source"'));else{let l=i.sources&&i.sources[t.source],c=l&&Nt(l.type);l?c==="vector"&&s==="raster"?e.push(new k(r,t.source,`layer "${t.id}" requires a raster source`)):c!=="raster-dem"&&s==="hillshade"?e.push(new k(r,t.source,`layer "${t.id}" requires a raster-dem source`)):c!=="raster-dem"&&s==="color-relief"?e.push(new k(r,t.source,`layer "${t.id}" requires a raster-dem source`)):c==="raster"&&s!=="raster"?e.push(new k(r,t.source,`layer "${t.id}" requires a vector source`)):c==="vector"&&!t["source-layer"]?e.push(new k(r,t,`layer "${t.id}" must specify a "source-layer"`)):c==="raster-dem"&&s!=="hillshade"&&s!=="color-relief"?e.push(new k(r,t.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):s==="line"&&t.paint&&t.paint["line-gradient"]&&(c!=="geojson"||!l.lineMetrics)&&e.push(new k(r,t,`layer "${t.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new k(r,t.source,`source "${t.source}" not found`))}return e=e.concat(ai({key:r,value:t,valueSpec:o.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*"(){return[]},type(){return n.validateSpec({key:`${r}.type`,value:t.type,valueSpec:o.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:t,objectKey:"type"})},filter:ob,layout(l){return ai({layer:t,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(c){return PO(py({layerType:s},c))}}})},paint(l){return ai({layer:t,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(c){return AO(py({layerType:s},c))}}})}}})),e}function bl(n){let e=n.value,t=n.key,r=Ie(e);return r!=="string"?[new k(t,e,`string expected, ${r} found`)]:[]}function yq(n){var e;let t=(e=n.sourceName)!==null&&e!==void 0?e:"",r=n.value,i=n.styleSpec,o=i.source_raster_dem,s=n.style,a=[],l=Ie(r);if(r===void 0)return a;if(l!=="object")return a.push(new k("source_raster_dem",r,`object expected, ${l} found`)),a;let u=Nt(r.encoding)==="custom",d=["redFactor","greenFactor","blueFactor","baseShift"],f=n.value.encoding?`"${n.value.encoding}"`:"Default";for(let h in r)!u&&d.includes(h)?a.push(new k(h,r[h],`In "${t}": "${h}" is only valid when "encoding" is set to "custom". ${f} encoding found`)):o[h]?a=a.concat(n.validateSpec({key:h,value:r[h],valueSpec:o[h],validateSpec:n.validateSpec,style:s,styleSpec:i})):a.push(new k(h,r[h],`unknown property "${h}"`));return a}var tO={promoteId:vq};function OO(n){let e=n.value,t=n.key,r=n.styleSpec,i=n.style,o=n.validateSpec;if(!e.type)return[new k(t,e,'"type" is required')];let s=Nt(e.type),a;switch(s){case"vector":case"raster":return a=ai({key:t,value:e,valueSpec:r[`source_${s.replace("-","_")}`],style:n.style,styleSpec:r,objectElementValidators:tO,validateSpec:o}),a;case"raster-dem":return a=yq({sourceName:t,value:e,style:n.style,styleSpec:r,validateSpec:o}),a;case"geojson":if(a=ai({key:t,value:e,valueSpec:r.source_geojson,style:i,styleSpec:r,validateSpec:o,objectElementValidators:tO}),e.cluster)for(let l in e.clusterProperties){let[c,u]=e.clusterProperties[l],d=typeof c=="string"?[c,["accumulated"],["get",l]]:c;a.push(...Eu({key:`${t}.${l}.map`,value:u,expressionContext:"cluster-map"})),a.push(...Eu({key:`${t}.${l}.reduce`,value:d,expressionContext:"cluster-reduce"}))}return a;case"video":return ai({key:t,value:e,valueSpec:r.source_video,style:i,validateSpec:o,styleSpec:r});case"image":return ai({key:t,value:e,valueSpec:r.source_image,style:i,validateSpec:o,styleSpec:r});case"canvas":return[new k(t,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zf({key:`${t}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function vq({key:n,value:e}){if(Ie(e)==="string")return bl({key:n,value:e});{let t=[];for(let r in e)t.push(...bl({key:`${n}.${r}`,value:e[r]}));return t}}function FO(n){let e=n.value,t=n.styleSpec,r=t.light,i=n.style,o=[],s=Ie(e);if(e===void 0)return o;if(s!=="object")return o=o.concat([new k("light",e,`object expected, ${s} found`)]),o;for(let a in e){let l=a.match(/^(.*)-transition$/);l&&r[l[1]]&&r[l[1]].transition?o=o.concat(n.validateSpec({key:a,value:e[a],valueSpec:t.transition,validateSpec:n.validateSpec,style:i,styleSpec:t})):r[a]?o=o.concat(n.validateSpec({key:a,value:e[a],valueSpec:r[a],validateSpec:n.validateSpec,style:i,styleSpec:t})):o=o.concat([new k(a,e[a],`unknown property "${a}"`)])}return o}function LO(n){let e=n.value,t=n.styleSpec,r=t.sky,i=n.style,o=Ie(e);if(e===void 0)return[];if(o!=="object")return[new k("sky",e,`object expected, ${o} found`)];let s=[];for(let a in e)r[a]?s=s.concat(n.validateSpec({key:a,value:e[a],valueSpec:r[a],style:i,styleSpec:t})):s=s.concat([new k(a,e[a],`unknown property "${a}"`)]);return s}function kO(n){let e=n.value,t=n.styleSpec,r=t.terrain,i=n.style,o=[],s=Ie(e);if(e===void 0)return o;if(s!=="object")return o=o.concat([new k("terrain",e,`object expected, ${s} found`)]),o;for(let a in e)r[a]?o=o.concat(n.validateSpec({key:a,value:e[a],valueSpec:r[a],validateSpec:n.validateSpec,style:i,styleSpec:t})):o=o.concat([new k(a,e[a],`unknown property "${a}"`)]);return o}function _q(n){return bl(n).length===0?[]:Eu(n)}function xq(n){return bl(n).length===0?[]:Eu(n)}function Eq(n){let e=n.key,t=n.value;if(Ie(t)==="array"){if(t.length<1||t.length>4)return[new k(e,t,`padding requires 1 to 4 values; ${t.length} values found`)];let i={type:"number"},o=[];for(let s=0;s<t.length;s++)o=o.concat(n.validateSpec({key:`${e}[${s}]`,value:t[s],validateSpec:n.validateSpec,valueSpec:i}));return o}else return $y({key:e,value:t,valueSpec:{}})}function wq(n){let e=n.key,t=n.value;if(Ie(t)==="array"){let i={type:"number"};if(t.length<1)return[new k(e,t,"array length at least 1 expected, length 0 found")];let o=[];for(let s=0;s<t.length;s++)o=o.concat(n.validateSpec({key:`${e}[${s}]`,value:t[s],validateSpec:n.validateSpec,valueSpec:i}));return o}else return $y({key:e,value:t,valueSpec:{}})}function Cq(n){let e=n.key,t=n.value;if(Ie(t)==="array"){if(t.length<1)return[new k(e,t,"array length at least 1 expected, length 0 found")];let i=[];for(let o=0;o<t.length;o++)i=i.concat(HC({key:`${e}[${o}]`,value:t[o]}));return i}else return HC({key:e,value:t})}function bq(n){let e=n.key,t=n.value,r=Ie(t),i=n.styleSpec;if(r!=="array"||t.length<1||t.length%2!==0)return[new k(e,t,"variableAnchorOffsetCollection requires a non-empty array of even length")];let o=[];for(let s=0;s<t.length;s+=2)o=o.concat(Zf({key:`${e}[${s}]`,value:t[s],valueSpec:i.layout_symbol["text-anchor"]})),o=o.concat(ib({key:`${e}[${s+1}]`,value:t[s+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:i}));return o}function jO(n){let e=[],t=n.value,r=n.key;if(Array.isArray(t)){let i=[],o=[];for(let s in t){t[s].id&&i.includes(t[s].id)&&e.push(new k(r,t,`all the sprites' ids must be unique, but ${t[s].id} is duplicated`)),i.push(t[s].id),t[s].url&&o.includes(t[s].url)&&e.push(new k(r,t,`all the sprites' URLs must be unique, but ${t[s].url} is duplicated`)),o.push(t[s].url);let a={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(ai({key:`${r}[${s}]`,value:t[s],valueSpec:a,validateSpec:n.validateSpec}))}return e}else return bl({key:r,value:t})}function Mq(n){let e=n.value,t=n.styleSpec,r=t.projection,i=n.style,o=Ie(e);if(e===void 0)return[];if(o!=="object")return[new k("projection",e,`object expected, ${o} found`)];let s=[];for(let a in e)r[a]?s=s.concat(n.validateSpec({key:a,value:e[a],valueSpec:r[a],style:i,styleSpec:t})):s=s.concat([new k(a,e[a],`unknown property "${a}"`)]);return s}function Tq(n){let e=n.key,t=n.value;t=t instanceof String?t.valueOf():t;let r=Ie(t);return r==="array"&&!Iq(t)&&!Sq(t)?[new k(e,t,`projection expected, invalid array ${JSON.stringify(t)} found`)]:["array","string"].includes(r)?[]:[new k(e,t,`projection expected, invalid type "${r}" found`)]}function Sq(n){return!!["interpolate","step","literal"].includes(n[0])}function Iq(n){return Array.isArray(n)&&n.length===3&&typeof n[0]=="string"&&typeof n[1]=="string"&&typeof n[2]=="number"}function Dq(n){return!!n&&n.constructor===Object}function VO(n){return Dq(n.value)?[]:[new k(n.key,n.value,`object expected, ${Ie(n.value)} found`)]}var nO={"*"(){return[]},array:ib,boolean:gq,number:$y,color:HC,constants:SO,enum:Zf,filter:ob,function:IO,layer:NO,object:ai,source:OO,light:FO,sky:LO,terrain:kO,projection:Mq,projectionDefinition:Tq,string:bl,formatted:_q,resolvedImage:xq,padding:Eq,numberArray:wq,colorArray:Cq,variableAnchorOffsetCollection:bq,sprite:jO,state:VO};function Ay(n){let e=n.value,t=n.valueSpec,r=n.styleSpec;return n.validateSpec=Ay,t.expression&&Jf(Nt(e))?IO(n):t.expression&&Uy(Cl(e))?Eu(n):t.type&&nO[t.type]?nO[t.type](n):ai(py({},n,{valueSpec:t.type?r[t.type]:t}))}function BO(n){let e=n.value,t=n.key,r=bl(n);return r.length||(e.indexOf("{fontstack}")===-1&&r.push(new k(t,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&r.push(new k(t,e,'"glyphs" url must include a "{range}" token'))),r}function ji(n,e=rO){let t=[];return t=t.concat(Ay({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,validateSpec:Ay,objectElementValidators:{glyphs:BO,"*"(){return[]}}})),n.constants&&(t=t.concat(SO({key:"constants",value:n.constants}))),GO(t)}ji.source=Bi(Vi(OO));ji.sprite=Bi(Vi(jO));ji.glyphs=Bi(Vi(BO));ji.light=Bi(Vi(FO));ji.sky=Bi(Vi(LO));ji.terrain=Bi(Vi(kO));ji.state=Bi(Vi(VO));ji.layer=Bi(Vi(NO));ji.filter=Bi(Vi(ob));ji.paintProperty=Bi(Vi(AO));ji.layoutProperty=Bi(Vi(PO));function Vi(n){return function(e){return n(jn(xt({},e),{validateSpec:Ay}))}}function GO(n){return[].concat(n).sort((e,t)=>e.line-t.line)}function Bi(n){return function(...e){return GO(n.apply(this,e))}}var UO=rO;var zO={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},Qf=" ",$O=/(italic|oblique)$/i,HO={};function eh(n,e,t){var r=HO[n];if(!r){Array.isArray(n)||(n=[n]);for(var i=400,o="normal",s=[],a,l,c=0,u=n.length;c<u;++c){var d=n[c],f=d.split(" "),h=f[f.length-1].toLowerCase();h=="normal"||h=="italic"||h=="oblique"?(o=l?o:h,l=!0,f.pop(),h=f[f.length-1].toLowerCase()):$O.test(h)&&(h=h.replace($O,""),o=l?o:f[f.length-1].replace(h,""),l=!0);for(var p in zO){var m=f.length>1?f[f.length-2].toLowerCase():"";if(h==p||h==p.replace("-","")||m+"-"+h==p){i=a?i:zO[p],f.pop(),m&&p.startsWith(m)&&f.pop();break}}!a&&typeof h=="number"&&(i=h,a=!0);var g=f.join(Qf).replace("Klokantech Noto Sans","Noto Sans").replace("DIN Pro","Barlow").replace("Arial Unicode MS","Arial");g.indexOf(Qf)!==-1&&(g='"'+g+'"'),s.push(g)}r=HO[n]=[o,i,s]}return r[0]+Qf+r[1]+Qf+e+"px"+(t?"/"+t:"")+Qf+r[2]}var WO="https://api.mapbox.com";function sb(n){let e="mapbox://";return n.indexOf(e)!==0?"":n.slice(e.length)}function XO(n,e,t){if(typeof n=="string")return[{id:"default",url:qO(n,e,t)}];for(let r of n)r.url=qO(r.url,e,t);return n}function qO(n,e,t){let r=sb(n);if(!r)return decodeURI(new URL(n,t).href);let i="sprites/";if(r.indexOf(i)!==0)throw new Error(`unexpected sprites url: ${n}`);let o=r.slice(i.length);return`${WO}/styles/v1/${o}/sprite?access_token=${e}`}function Hy(n,e){let t=sb(n);if(!t)return decodeURI(new URL(n,location.href).href);let r="styles/";if(t.indexOf(r)!==0)throw new Error(`unexpected style url: ${n}`);let i=t.slice(r.length);return`${WO}/styles/v1/${i}?&access_token=${e}`}var Rq=["a","b","c","d"];function bu(n,e,t,r){let i=new URL(n,r||location.href),o=sb(n);if(!o)return e?(i.searchParams.has(t)||i.searchParams.set(t,e),[decodeURI(i.href)]):[decodeURI(i.href)];if(o==="mapbox.satellite"){let s=window.devicePixelRatio>=1.5?"@2x":"";return[`https://api.mapbox.com/v4/${o}/{z}/{x}/{y}${s}.webp?access_token=${e}`]}return Rq.map(s=>`https://${s}.tiles.mapbox.com/v4/${o}/{z}/{x}/{y}.vector.pbf?access_token=${e}`)}var ZO={},YO={},Aq=0;function ab(n){return n.id||(n.id=Aq++),n.id}function lb(n,e){return ab(n)+"."+X(e)}function cb(n){let e=ZO[n.id];return e||(e={},ZO[ab(n)]=e),e}function ub(n){let e=YO[n.id];return e||(e={},YO[ab(n)]=e),e}function qy(n){return n*Math.PI/180}var th=function(){let n=[];for(let e=78271.51696402048;n.length<=24;e/=2)n.push(e);return n}();function Tu(n,e){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof OffscreenCanvas<"u")return new OffscreenCanvas(n,e);let t=document.createElement("canvas");return t.width=n,t.height=e,t}function db(n,e){let t=0,r=e.length;for(;t<r;++t)if(e[t]<n&&t+1<r){let o=e[t]/e[t+1];return t+Math.log(e[t]/n)/Math.log(o)}return r-1}function JO(n,e){let t=Math.floor(n),r=Math.pow(2,n-t);return e[t]/r}var Mu={};function Ml(n,e,t={},r){if(e in Mu)return r&&(r.url=Mu[e][0].url),Mu[e][1];let i=t.transformRequest&&t.transformRequest(e,n)||e,o=function(l){return delete Mu[e],Promise.reject(new Error("Error fetching source "+e))},s=function(l){return delete Mu[e],l.ok?l.json():Promise.reject(new Error("Error fetching source "+e))},a=Qi(()=>i).then(l=>l instanceof Response?(r&&(r.url=l.url),s(l)):(l instanceof Request||(l=new Request(l)),l.headers.get("Accept")||l.headers.set("Accept","application/json"),r&&(r.url=l.url),fetch(l).then(s).catch(o))).catch(o);return Mu[e]=[i,a],a}function QO(n,e){if(typeof n=="string")if(n.trim().startsWith("{"))try{let t=JSON.parse(n);return Promise.resolve(t)}catch(t){return Promise.reject(t)}else return n=Hy(n,e.accessToken),Ml("Style",n,e);else return Promise.resolve(n)}var KO={};function eF(n,e,t={}){let r=[e,JSON.stringify(n)].toString(),i=KO[r];if(!i||t.transformRequest){let o;t.transformRequest&&(o=(a,l)=>{let c=t.transformRequest&&t.transformRequest(l,"Tiles")||l;if(a instanceof uf)a.setLoader((u,d,f)=>{let h=function(p){p.arrayBuffer().then(m=>{let y=a.getFormat().readFeatures(m,{extent:u,featureProjection:f});a.setFeatures(y)})};Qi(()=>c).then(p=>{if(p instanceof Response)return h(p);fetch(p).then(h).catch(m=>a.setState(N.ERROR))}).catch(p=>a.setState(N.ERROR))});else{let u=a.getImage();Qi(()=>c).then(d=>{if(typeof d=="string"){u.src=d;return}let f=h=>h.blob().then(p=>{let m=URL.createObjectURL(p);u.addEventListener("load",()=>URL.revokeObjectURL(m)),u.addEventListener("error",()=>URL.revokeObjectURL(m)),u.src=m});if(d instanceof Response)return f(d);fetch(d).then(f).catch(h=>a.setState(N.ERROR))}).catch(d=>a.setState(N.ERROR))}});let s=n.url;if(s&&!n.tiles){let a=bu(s,t.accessToken,t.accessTokenParam||"access_token",e||location.href);if(s.startsWith("mapbox://"))i=Promise.resolve({tileJson:Object.assign({},n,{url:void 0,tiles:a}),tileLoadFunction:o});else{let l={};i=Ml("Source",a[0],t,l).then(function(c){return c.tiles=c.tiles.map(function(u){return c.scheme==="tms"&&(u=u.replace("{y}","{-y}")),bu(u,t.accessToken,t.accessTokenParam||"access_token",l.url)[0]}),Promise.resolve({tileJson:c,tileLoadFunction:o})})}}else n.tiles?(n=Object.assign({},n,{tiles:n.tiles.map(function(a){return n.scheme==="tms"&&(a=a.replace("{y}","{-y}")),bu(a,t.accessToken,t.accessTokenParam||"access_token",e||location.href)[0]})}),i=Promise.resolve({tileJson:Object.assign({},n),tileLoadFunction:o})):i=Promise.reject(new Error("source has no `tiles` nor `url`"));KO[r]=i}return i}function fb(n,e,t,r){let i=[2*t*e.pixelRatio+e.width,2*t*e.pixelRatio+e.height],o=Tu(i[0],i[1]),s=o.getContext("2d");s.drawImage(n,e.x,e.y,e.width,e.height,t*e.pixelRatio,t*e.pixelRatio,e.width,e.height);let a=s.getImageData(0,0,i[0],i[1]);s.globalCompositeOperation="destination-over",s.fillStyle=`rgba(${r.r*255},${r.g*255},${r.b*255},${r.a})`;let l=a.data;for(let c=0,u=a.width;c<u;++c)for(let d=0,f=a.height;d<f;++d){let h=(d*u+c)*4;l[h+3]>0&&s.arc(c,d,t*e.pixelRatio,0,2*Math.PI)}return s.fill(),o}function Pq(n,e,t){let r=Math.max(0,Math.min(1,(t-n)/(e-n)));return r*r*(3-2*r)}function hb(n,e,t){let r=Tu(e.width,e.height),i=r.getContext("2d");i.drawImage(n,e.x,e.y,e.width,e.height,0,0,e.width,e.height);let o=i.getImageData(0,0,e.width,e.height),s=o.data;for(let a=0,l=o.width;a<l;++a)for(let c=0,u=o.height;c<u;++c){let d=(c*l+a)*4,f=s[d+3]/255,h=.75,p=.1,m=Pq(h-p,h+p,f);m>0?(s[d+0]=Math.round(255*t.r*m),s[d+1]=Math.round(255*t.g*m),s[d+2]=Math.round(255*t.b*m),s[d+3]=Math.round(255*m)):s[d+3]=0}return i.putImageData(o,0,0),r}var Nq=Array(256).join("\u200A");function Xy(n,e){if(e>=.05){let t="",r=n.split(`
`),i=Nq.slice(0,Math.round(e/.1));for(let o=0,s=r.length;o<s;++o)o>0&&(t+=`
`),t+=r[o].split("").join(i);return t}return n}var pb;function nF(){return pb||(pb=Tu(1,1).getContext("2d")),pb}function Tl(n,e){return nF().measureText(n).width+(n.length-1)*e}var tF={};function Zy(n,e,t,r){if(n.indexOf(`
`)!==-1){let s=n.split(`
`),a=[];for(let l=0,c=s.length;l<c;++l)a.push(Zy(s[l],e,t,r));return a.join(`
`)}let i=t+","+e+","+n+","+r,o=tF[i];if(!o){let s=n.split(" ");if(s.length>1){let a=nF();a.font=e;let c=a.measureText("M").width*t,u="",d=[];for(let f=0,h=s.length;f<h;++f){let p=s[f],m=u+(u?" ":"")+p;Tl(m,r)<=c?u=m:(u&&d.push(u),u=p)}u&&d.push(u);for(let f=0,h=d.length;f<h&&h>1;++f){let p=d[f];if(Tl(p,r)<c*.35){let m=f>0?Tl(d[f-1],r):1/0,g=f<h-1?Tl(d[f+1],r):1/0;d.splice(f,1),h-=1,m<g?(d[f-1]+=" "+p,f-=1):d[f]=p+" "+d[f]}}for(let f=0,h=d.length-1;f<h;++f){let p=d[f],m=d[f+1];if(Tl(p,r)>c*.7&&Tl(m,r)<c*.6){let g=p.split(" "),y=g.pop();Tl(y,r)<c*.2&&(d[f]=g.join(" "),d[f+1]=y+" "+m),h-=1}}o=d.join(`
`)}else o=n;o=Xy(o,r),tF[i]=o}return o}var Oq=/font-family: ?([^;]*);/,Fq=/("|')/g,Wy;function Lq(n){if(!Wy){Wy={};let e=document.styleSheets;for(let t=0,r=e.length;t<r;++t){let i=e[t];try{let o=i.rules||i.cssRules;if(o)for(let s=0,a=o.length;s<a;++s){let l=o[s];if(l.type==5){let c=l.cssText.match(Oq);Wy[c[1].replace(Fq,"")]=!0}}}catch{}}}return n in Wy}var mb={};function rF(n,e="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){let t=n.toString();if(t in mb)return mb[t];let r=[];for(let i=0,o=n.length;i<o;++i){n[i]=n[i].replace("Arial Unicode MS","Arial");let s=n[i],a=eh(s,1);Xm(a);let l=a.split(" ");r.push([l.slice(3).join(" ").replace(/"/g,""),l[1],l[0]])}for(let i=0,o=r.length;i<o;++i){let s=r[i],a=s[0];if(!Lq(a)&&Kr.get(`${s[2]}
${s[1]} 
${a}`)!==100){let l=e.replace("{font-family}",a.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",a.replace(/ /g,"+")).replace("{fontweight}",s[1]).replace("{-fontstyle}",s[2].replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",s[2]);if(!document.querySelector('link[href="'+l+'"]')){let c=document.createElement("link");c.href=l,c.rel="stylesheet",document.head.appendChild(c)}}}return mb[t]=n,n}var kq={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},jq={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},Vq=function(n,e){let t=QC(n,e);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return t.value},vb={},Ky={zoom:0},Yy,gb;function J(n,e,t,r,i,o,s){let a=n.id;o||(o={},console.warn("No functionCache provided to getValue()")),o[a]||(o[a]={});let l=o[a];if(!l[t]){let c=(n[e]||vb)[t],u=UO[`${e}_${n.type}`][t];c===void 0&&(c=u.default);let d=Uy(c);if(!d&&Jf(c)&&(c=TO(c,u),d=!0),d){let f=Vq(c,u);l[t]=f.evaluate.bind(f)}else u.type=="color"&&(c=Ye.parse(c)),l[t]=function(){return c}}return Ky.zoom=r,l[t](Ky,i,s)}function iF(n,e,t,r,i){return J(n,"layout",`${r}-allow-overlap`,e,t,i)?J(n,"layout",`${r}-ignore-placement`,e,t,i)?"none":"obstacle":"declutter"}function Bq(n,e,t,r,i){if(i||console.warn("No filterCache provided to evaluateFilter()"),!(n in i))try{i[n]=bO(e).filter}catch(o){console.warn("Filter will evaluate to false: "+o.message),i[n]=function(){return!1}}return Ky.zoom=r,i[n](Ky,t)}var Gq=!1;function va(n,e){if(n){if(!Gq&&(n.a===0||e===0))return;let t=n.a;return e=e===void 0?1:e,t===0?"transparent":"rgba("+Math.round(n.r*255/t)+","+Math.round(n.g*255/t)+","+Math.round(n.b*255/t)+","+t*e+")"}return n}var Uq=/\{[^{}}]*\}/g;function yb(n,e){return n.replace(Uq,function(t){return e[t.slice(1,-1)]||""})}function oF(n,e){let t=n.split(":")[0];return t===n&&(t="default"),e[t]}var sF=!1;function _b(n=!1){sF=n}var aF={};function xb(n,e,t,r=th,i=void 0,o=void 0,s=void 0,a=void 0){if(typeof e=="string"&&(e=JSON.parse(e)),e.version!=8)throw new Error("glStyle version 8 required.");aF[lb(e,n)]=Array.from(arguments);let l={};(typeof o=="string"||o instanceof Request||o instanceof Response||o instanceof Promise)&&(o={default:o});for(let _ in o){let w=o[_];Qi(()=>w).then(b=>bs(null,null,function*(){let M;if(typeof Image<"u"){let S=new Image;if(typeof b=="string")S.crossOrigin="anonymous",S.src=b;else{let C;b instanceof Request?C=yield fetch(b):b instanceof Response&&(C=b);let R=yield C.blob();M=URL.createObjectURL(R),S.src=M}S.addEventListener("load",function C(){S.removeEventListener("load",C),l[_]={image:S,size:[S.width,S.height]},n.changed(),M&&URL.revokeObjectURL(M)}),S.addEventListener("error",function C(){URL.revokeObjectURL(M),S.removeEventListener("error",C)})}else if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){let S=self;S.postMessage({action:"loadImage",src:b}),S.addEventListener("message",function(R){R.data.action==="imageLoaded"&&R.data.src===b&&(l[_]={image:R.data.image,size:[R.data.image.width,R.data.image.height]})})}}))}let c=iO(e.layers),u={},d=[],f={},h={},p=cb(e),m=ub(e),g;for(let _=0,w=c.length;_<w;++_){let b=c[_],M=b.id;if(typeof t=="string"&&b.source==t||Array.isArray(t)&&t.indexOf(M)!==-1){let S=b["source-layer"];if(g){if(b.source!==g)throw new Error(`Layer "${M}" does not use source "${g}`)}else{g=b.source;let R=e.sources[g];if(!R)throw new Error(`Source "${g}" is not defined`);let T=R.type;if(T!=="vector"&&T!=="geojson")throw new Error(`Source "${g}" is not of type "vector" or "geojson", but "${T}"`)}let C=u[S];C||(C=[],u[S]=C),C.push({layer:b,index:_}),d.push(M)}}let y=new tn,v=new Wt,x=[],E=function(_,w,b){let M=_.getProperties(),S=u[M.layer];if(!S)return;let C=r.indexOf(w);C==-1&&(C=db(w,r));let R=kq[_.getGeometry().getType()],T={id:_.getId(),properties:M,type:R},I=n.get("mapbox-featurestate")[_.getId()],B=-1,j;for(let $=0,V=S.length;$<V;++$){let q=S[$],D=q.layer,Z=D.id;if(b!==void 0&&b!==Z)continue;let ie=D.layout||vb,O=D.paint||vb;if(ie.visibility==="none"||"minzoom"in D&&C<D.minzoom||"maxzoom"in D&&C>=D.maxzoom)continue;let we=D.filter;if(!we||Bq(Z,we,T,C,m)){j=D;let _e,ge,rt,Pe,St,z,It=q.index;if(R==3&&(D.type=="fill"||D.type=="fill-extrusion"))if(ge=J(D,"paint",D.type+"-opacity",C,T,p,I),D.type+"-pattern"in O){let he=J(D,"paint",D.type+"-pattern",C,T,p,I);if(he){let Ke=typeof he=="string"?yb(he,M):he.toString(),qe=oF(Ke,l);if(i&&i[Ke]&&qe){++B,z=x[B],(!z||!z.getFill()||z.getStroke()||z.getText())&&(z=new Xt({fill:new Wt}),x[B]=z),rt=z.getFill(),z.setZIndex(It);let Be=Ke+"."+ge,pt=h[Be];if(!pt){let Te=i[Ke],Ve=Tu(Te.width,Te.height),Ft=Ve.getContext("2d");Ft.globalAlpha=ge,Ft.drawImage(qe.image,Te.x,Te.y,Te.width,Te.height,0,0,Te.width,Te.height),pt=Ft.createPattern(Ve,"repeat"),h[Be]=pt}rt.setColor(pt)}}}else _e=va(J(D,"paint",D.type+"-color",C,T,p,I),ge),D.type+"-outline-color"in O&&(St=va(J(D,"paint",D.type+"-outline-color",C,T,p,I),ge)),St||(St=_e),(_e||St)&&(++B,z=x[B],(!z||_e&&!z.getFill()||!_e&&z.getFill()||St&&!z.getStroke()||!St&&z.getStroke()||z.getText())&&(z=new Xt({fill:_e?new Wt:void 0,stroke:St?new tn:void 0}),x[B]=z),_e&&(rt=z.getFill(),rt.setColor(_e)),St&&(Pe=z.getStroke(),Pe.setColor(St),Pe.setWidth(.5)),z.setZIndex(It));if(R!=1&&D.type=="line"){"line-pattern"in O?_e=void 0:_e=va(J(D,"paint","line-color",C,T,p,I),J(D,"paint","line-opacity",C,T,p,I));let he=J(D,"paint","line-width",C,T,p,I);_e&&he>0&&(++B,z=x[B],(!z||!z.getStroke()||z.getFill()||z.getText())&&(z=new Xt({stroke:new tn}),x[B]=z),Pe=z.getStroke(),Pe.setLineCap(J(D,"layout","line-cap",C,T,p,I)),Pe.setLineJoin(J(D,"layout","line-join",C,T,p,I)),Pe.setMiterLimit(J(D,"layout","line-miter-limit",C,T,p,I)),Pe.setColor(_e),Pe.setWidth(he),Pe.setLineDash(O["line-dasharray"]?J(D,"paint","line-dasharray",C,T,p,I).map(function(Ke){return Ke*he}):null),z.setZIndex(It))}let li=!1,Me=null,Gi=0,xn,He,En;if((R==1||R==2)&&"icon-image"in ie){let he=J(D,"layout","icon-image",C,T,p,I);if(he){xn=typeof he=="string"?yb(he,M):he.toString();let Ke,qe=a?a(n,xn):void 0,Be=oF(xn,l);if(i&&i[xn]&&Be||qe){let pt=J(D,"layout","icon-rotation-alignment",C,T,p,I);if(R==2){let Te=_.getGeometry();if(Te.getFlatMidpoint||Te.getFlatMidpoints){let Ve=Te.getExtent();if(Math.sqrt(Math.max(Math.pow((Ve[2]-Ve[0])/w,2),Math.pow((Ve[3]-Ve[1])/w,2)))>150){let Lt=Te.getType()==="MultiLineString"?Te.getFlatMidpoints():Te.getFlatMidpoint();if(gb||(Yy=[NaN,NaN],gb=new fn("Point",Yy,[],2,{},void 0)),Ke=gb,Yy[0]=Lt[0],Yy[1]=Lt[1],J(D,"layout","symbol-placement",C,T,p,I)==="line"&&pt==="map"){let Er=Te.getStride(),on=Te.getFlatCoordinates();for(let Cn=0,it=on.length-Er;Cn<it;Cn+=Er){let Jt=on[Cn],Jn=on[Cn+1],ot=on[Cn+Er],Qn=on[Cn+Er+1],xa=Math.min(Jt,ot),Ea=Math.max(Jt,ot),Dl=Lt[0],oh=Lt[1],er=(Qn-Jn)*(Dl-Jt)-(ot-Jt)*(oh-Jn);if(Math.abs(er)<.001&&Dl<=Ea&&Dl>=xa){Gi=Math.atan2(Jn-Qn,ot-Jt);break}}}}}}if(R!==2||Ke){let Te=J(D,"layout","icon-size",C,T,p,I),Ve=O["icon-color"]!==void 0?J(D,"paint","icon-color",C,T,p,I):null;if(!Ve||Ve.a!==0){let Ft=J(D,"paint","icon-halo-color",C,T,p,I),Lt=J(D,"paint","icon-halo-width",C,T,p,I),Fr=`${xn}.${Te}.${Lt}.${Ft}`;if(Ve!==null&&(Fr+=`.${Ve}`),He=f[Fr],!He){let Er=iF(D,C,T,"icon",p),on;"icon-offset"in ie&&(on=J(D,"layout","icon-offset",C,T,p,I).slice(0),on[0]*=Te,on[1]*=-Te);let Cn=Ve?[Ve.r*255,Ve.g*255,Ve.b*255,Ve.a]:void 0;if(qe){let it={color:Cn,rotateWithView:pt==="map",displacement:on,declutterMode:Er,scale:Te};typeof qe=="string"?it.src=qe:(it.img=qe,it.imgSize=[qe.width,qe.height]),He=new ra(it)}else{let it=i[xn],Jt,Jn,ot;if(Lt)it.sdf?(Jt=fb(hb(Be.image,it,Ve||[0,0,0,1]),{x:0,y:0,width:it.width,height:it.height,pixelRatio:it.pixelRatio},Lt,Ft),Cn=void 0):Jt=fb(Be.image,it,Lt,Ft);else{if(it.sdf&&!Be.unSDFed){let Qn=hb(Be.image,{x:0,y:0,width:Be.size[0],height:Be.size[1]},{r:1,g:1,b:1,a:1});Be.image=Qn,Be.unSDFed=!0}Jt=Be.image,Jn=[it.width,it.height],ot=[it.x,it.y]}He=new ra({color:Cn,img:Jt,imgSize:Be.size,size:Jn,offset:ot,rotateWithView:pt==="map",scale:Te/it.pixelRatio,displacement:on,declutterMode:Er})}f[Fr]=He}}He&&(++B,z=x[B],(!z||!z.getImage()||z.getFill()||z.getStroke())&&(z=new Xt,x[B]=z),z.setGeometry(Ke),He.setRotation(Gi+qy(J(D,"layout","icon-rotate",C,T,p,I))),He.setOpacity(J(D,"paint","icon-opacity",C,T,p,I)),He.setAnchor(jq[J(D,"layout","icon-anchor",C,T,p,I)]),z.setImage(He),Me=z.getText(),z.setText(void 0),z.setZIndex(It),li=!0,En=!1)}else En=!0}}}if(R==1&&D.type==="circle"){++B,z=x[B],(!z||!z.getImage()||z.getFill()||z.getStroke())&&(z=new Xt,x[B]=z);let he="circle-radius"in O?J(D,"paint","circle-radius",C,T,p,I):5,Ke=va(J(D,"paint","circle-stroke-color",C,T,p,I),J(D,"paint","circle-stroke-opacity",C,T,p,I)),qe=J(D,"paint","circle-translate",C,T,p,I),Be=va(J(D,"paint","circle-color",C,T,p,I),J(D,"paint","circle-opacity",C,T,p,I)),pt=J(D,"paint","circle-stroke-width",C,T,p,I),Te=he+"."+Ke+"."+Be+"."+pt+"."+qe[0]+"."+qe[1];He=f[Te],He||(He=new lo({radius:he,displacement:[qe[0],-qe[1]],stroke:Ke&&pt>0?new tn({width:pt,color:Ke}):void 0,fill:Be?new Wt({color:Be}):void 0,declutterMode:"none"}),f[Te]=He),z.setImage(He),Me=z.getText(),z.setText(void 0),z.setGeometry(void 0),z.setZIndex(It),li=!0}let ht,Nr,ci,wn,Or,Ui;if("text-field"in ie){wn=Math.round(J(D,"layout","text-size",C,T,p,I));let he=J(D,"layout","text-font",C,T,p,I);ci=J(D,"layout","text-line-height",C,T,p,I),Nr=eh(s?s(he,e.metadata?e.metadata["ol:webfonts"]:void 0):he,wn,ci),Nr.includes("sans-serif")||(Nr+=",sans-serif"),Or=J(D,"layout","text-letter-spacing",C,T,p,I),Ui=J(D,"layout","text-max-width",C,T,p,I);let Ke=J(D,"layout","text-field",C,T,p,I);typeof Ke=="object"&&Ke.sections?Ke.sections.length===1?ht=Ke.toString():ht=Ke.sections.reduce((qe,Be,pt)=>{let Te=Be.fontStack?Be.fontStack.split(","):he,Ve=eh(s?s(Te):Te,wn*(Be.scale||1),ci),Ft=Be.text;if(Ft===`
`)return qe.push(`
`,""),qe;if(R==2)return qe.push(Xy(Ft,Or),Ve),qe;Ft=Zy(Ft,Ve,Ui,Or).split(`
`);for(let Lt=0,Fr=Ft.length;Lt<Fr;++Lt)Lt>0&&qe.push(`
`,""),qe.push(Ft[Lt],Ve);return qe},[]):ht=yb(Ke,M).trim(),ge=J(D,"paint","text-opacity",C,T,p,I)}if(ht&&ge&&!En){li||(++B,z=x[B],(!z||!z.getText()||z.getFill()||z.getStroke())&&(z=new Xt,x[B]=z),z.setImage(void 0),z.setGeometry(void 0));let he=iF(D,C,T,"text",p);z.getText()||z.setText(Me),Me=z.getText(),(!Me||"getDeclutterMode"in Me&&Me.getDeclutterMode()!==he)&&(Me=new ea({padding:[2,2,2,2],declutterMode:he}),z.setText(Me));let Ke=J(D,"layout","text-transform",C,T,p,I);Ke=="uppercase"?ht=Array.isArray(ht)?ht.map((ot,Qn)=>Qn%2?ot:ot.toUpperCase()):ht.toUpperCase():Ke=="lowercase"&&(ht=Array.isArray(ht)?ht.map((ot,Qn)=>Qn%2?ot:ot.toLowerCase()):ht.toLowerCase());let qe=Array.isArray(ht)?ht:R==2?Xy(ht,Or):Zy(ht,Nr,Ui,Or);if(Me.setText(qe),Me.setFont(Nr),Me.setRotation(qy(J(D,"layout","text-rotate",C,T,p,I))),typeof Me.setKeepUpright=="function"){let ot=J(D,"layout","text-keep-upright",C,T,p,I);Me.setKeepUpright(ot)}let Be=J(D,"layout","text-anchor",C,T,p,I),pt=li||R==1?"point":J(D,"layout","symbol-placement",C,T,p,I),Te;if(pt==="line-center"?(Me.setPlacement("line"),Te="center"):Me.setPlacement(pt),pt==="line"&&typeof Me.setRepeat=="function"){let ot=J(D,"layout","symbol-spacing",C,T,p,I);Me.setRepeat(ot*2)}Me.setOverflow(pt==="point");let Ve=J(D,"paint","text-halo-width",C,T,p,I),Ft=J(D,"layout","text-offset",C,T,p,I),Lt=J(D,"paint","text-translate",C,T,p,I),Fr=0,Er=0;if(pt=="point"){Te="center",Be.indexOf("left")!==-1?(Te="left",Er=Ve):Be.indexOf("right")!==-1&&(Te="right",Er=-Ve);let ot=J(D,"layout","text-rotation-alignment",C,T,p,I);Me.setRotateWithView(ot=="map")}else Me.setMaxAngle(qy(J(D,"layout","text-max-angle",C,T,p,I))*ht.length/qe.length),Me.setRotateWithView(!1);Me.setTextAlign(Te);let on="middle";Be.indexOf("bottom")==0?(on="bottom",Fr=-Ve-.5*(ci-1)*wn):Be.indexOf("top")==0&&(on="top",Fr=Ve+.5*(ci-1)*wn),Me.setTextBaseline(on);let Cn=J(D,"layout","text-justify",C,T,p,I);Me.setJustify(Cn==="auto"?void 0:Cn),Me.setOffsetX(Ft[0]*wn+Er+Lt[0]),Me.setOffsetY(Ft[1]*wn+Fr+Lt[1]),v.setColor(va(J(D,"paint","text-color",C,T,p,I),ge)),Me.setFill(v);let it=va(J(D,"paint","text-halo-color",C,T,p,I),ge);if(it&&Ve>0){y.setColor(it),Ve*=2;let ot=.5*wn;y.setWidth(Ve<=ot?Ve:ot),Me.setStroke(y)}else Me.setStroke(void 0);let Jt=J(D,"layout","text-padding",C,T,p,I),Jn=Me.getPadding();Jt!==Jn[0]&&(Jn[0]=Jt,Jn[1]=Jt,Jn[2]=Jt,Jn[3]=Jt),z.setZIndex(It)}}}if(B>-1)return x.length=B+1,sF&&("set"in _?_.set("mapbox-layer",j):_.getProperties()["mapbox-layer"]=j),x};return n.setStyle(E),n.set("mapbox-source",g),n.set("mapbox-layers",d),n.set("mapbox-featurestate",n.get("mapbox-featurestate")||{}),E}var lF=23283064365386963e-26,zq=12,cF=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),Eb=0,Jy=1,nh=2,Qy=5,e0=class{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,r=this.length){for(;this.pos<r;){let i=this.readVarint(),o=i>>3,s=this.pos;this.type=i&7,e(o,t,this),this.pos===s&&this.skip(i)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){let e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){let e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){let e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*4294967296;return this.pos+=8,e}readSFixed64(){let e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*4294967296;return this.pos+=8,e}readFloat(){let e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){let e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){let t=this.buf,r,i;return i=t[this.pos++],r=i&127,i<128||(i=t[this.pos++],r|=(i&127)<<7,i<128)||(i=t[this.pos++],r|=(i&127)<<14,i<128)||(i=t[this.pos++],r|=(i&127)<<21,i<128)?r:(i=t[this.pos],r|=(i&15)<<28,$q(r,e,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){let e=this.readVarint();return e%2===1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){let e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=zq&&cF?cF.decode(this.buf.subarray(t,e)):r7(this.buf,t,e)}readBytes(){let e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){let r=this.readPackedEnd();for(;this.pos<r;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){let t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===nh?this.readVarint()+this.pos:this.pos+1}skip(e){let t=e&7;if(t===Eb)for(;this.buf[this.pos++]>127;);else if(t===nh)this.pos=this.readVarint()+this.pos;else if(t===Qy)this.pos+=4;else if(t===Jy)this.pos+=8;else throw new Error(`Unimplemented type: ${t}`)}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){let r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.dataView=new DataView(r.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*lF),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*lF),!0),this.pos+=8}writeVarint(e){if(e=+e||0,e>268435455||e<0){Hq(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))}writeSVarint(e){this.writeVarint(e<0?-e*2-1:e*2)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(e.length*4),this.pos++;let t=this.pos;this.pos=i7(this.buf,e,this.pos);let r=this.pos-t;r>=128&&uF(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){let t=e.length;this.writeVarint(t),this.realloc(t);for(let r=0;r<t;r++)this.buf[this.pos++]=e[r]}writeRawMessage(e,t){this.pos++;let r=this.pos;e(t,this);let i=this.pos-r;i>=128&&uF(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i}writeMessage(e,t,r){this.writeTag(e,nh),this.writeRawMessage(t,r)}writePackedVarint(e,t){t.length&&this.writeMessage(e,Xq,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,Zq,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,Jq,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,Yq,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,Kq,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,Qq,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,e7,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,t7,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,n7,t)}writeBytesField(e,t){this.writeTag(e,nh),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,Qy),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,Qy),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,Jy),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,Jy),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,Eb),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,Eb),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,nh),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,Qy),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,Jy),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}};function $q(n,e,t){let r=t.buf,i,o;if(o=r[t.pos++],i=(o&112)>>4,o<128||(o=r[t.pos++],i|=(o&127)<<3,o<128)||(o=r[t.pos++],i|=(o&127)<<10,o<128)||(o=r[t.pos++],i|=(o&127)<<17,o<128)||(o=r[t.pos++],i|=(o&127)<<24,o<128)||(o=r[t.pos++],i|=(o&1)<<31,o<128))return Su(n,i,e);throw new Error("Expected varint not more than 10 bytes")}function Su(n,e,t){return t?e*4294967296+(n>>>0):(e>>>0)*4294967296+(n>>>0)}function Hq(n,e){let t,r;if(n>=0?(t=n%4294967296|0,r=n/4294967296|0):(t=~(-n%4294967296),r=~(-n/4294967296),t^4294967295?t=t+1|0:(t=0,r=r+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),qq(t,r,e),Wq(r,e)}function qq(n,e,t){t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos]=n&127}function Wq(n,e){let t=(n&7)<<4;e.buf[e.pos++]|=t|((n>>>=3)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127)))))}function uF(n,e,t){let r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));t.realloc(r);for(let i=t.pos-1;i>=n;i--)t.buf[i+r]=t.buf[i]}function Xq(n,e){for(let t=0;t<n.length;t++)e.writeVarint(n[t])}function Zq(n,e){for(let t=0;t<n.length;t++)e.writeSVarint(n[t])}function Yq(n,e){for(let t=0;t<n.length;t++)e.writeFloat(n[t])}function Kq(n,e){for(let t=0;t<n.length;t++)e.writeDouble(n[t])}function Jq(n,e){for(let t=0;t<n.length;t++)e.writeBoolean(n[t])}function Qq(n,e){for(let t=0;t<n.length;t++)e.writeFixed32(n[t])}function e7(n,e){for(let t=0;t<n.length;t++)e.writeSFixed32(n[t])}function t7(n,e){for(let t=0;t<n.length;t++)e.writeFixed64(n[t])}function n7(n,e){for(let t=0;t<n.length;t++)e.writeSFixed64(n[t])}function r7(n,e,t){let r="",i=e;for(;i<t;){let o=n[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a>t)break;let l,c,u;a===1?o<128&&(s=o):a===2?(l=n[i+1],(l&192)===128&&(s=(o&31)<<6|l&63,s<=127&&(s=null))):a===3?(l=n[i+1],c=n[i+2],(l&192)===128&&(c&192)===128&&(s=(o&15)<<12|(l&63)<<6|c&63,(s<=2047||s>=55296&&s<=57343)&&(s=null))):a===4&&(l=n[i+1],c=n[i+2],u=n[i+3],(l&192)===128&&(c&192)===128&&(u&192)===128&&(s=(o&15)<<18|(l&63)<<12|(c&63)<<6|u&63,(s<=65535||s>=1114112)&&(s=null))),s===null?(s=65533,a=1):s>65535&&(s-=65536,r+=String.fromCharCode(s>>>10&1023|55296),s=56320|s&1023),r+=String.fromCharCode(s),i+=a}return r}function i7(n,e,t){for(let r=0,i,o;r<e.length;r++){if(i=e.charCodeAt(r),i>55295&&i<57344)if(o)if(i<56320){n[t++]=239,n[t++]=191,n[t++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||r+1===e.length?(n[t++]=239,n[t++]=191,n[t++]=189):o=i;continue}else o&&(n[t++]=239,n[t++]=191,n[t++]=189,o=null);i<128?n[t++]=i:(i<2048?n[t++]=i>>6|192:(i<65536?n[t++]=i>>12|224:(n[t++]=i>>18|240,n[t++]=i>>12&63|128),n[t++]=i>>6&63|128),n[t++]=i&63|128)}return t}var wb=class extends Qc{constructor(e){super(),e=e||{},this.dataProjection=new un({code:"",units:"tile-pixels"}),this.featureClass=e.featureClass?e.featureClass:fn,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,r,i){e.pos=t.geometry;let o=e.readVarint()+e.pos,s=1,a=0,l=0,c=0,u=0,d=0;for(;e.pos<o;){if(!a){let f=e.readVarint();s=f&7,a=f>>3}if(a--,s===1||s===2)l+=e.readSVarint(),c+=e.readSVarint(),s===1&&u>d&&(i.push(u),d=u),r.push(l,c),u+=2;else if(s===7)u>d&&(r.push(r[d],r[d+1]),u+=2);else throw new Error("Invalid command found in the PBF")}u>d&&(i.push(u),d=u)}createFeature_(e,t,r){let i=t.type;if(i===0)return null;let o,s=t.properties,a;this.idProperty_?(a=s[this.idProperty_],delete s[this.idProperty_]):a=t.id,s[this.layerName_]=t.layer.name;let l=[],c=[];this.readRawGeometry_(e,t,l,c);let u=c7(i,c.length);if(this.featureClass===fn)o=new this.featureClass(u,l,c,2,s,a),o.transform(r.dataProjection);else{let d;if(u=="Polygon"){let p=km(l,c);d=p.length>1?new so(l,"XY",p):new An(l,"XY",c)}else d=u==="Point"?new dn(l,"XY"):u==="LineString"?new vn(l,"XY"):u==="MultiPoint"?new Ri(l,"XY"):u==="MultiLineString"?new oo(l,"XY",c):null;let f=this.featureClass;o=new f,this.geometryName_&&o.setGeometryName(this.geometryName_);let h=cs(d,!1,r);o.setGeometry(h),a!==void 0&&o.setId(a),o.setProperties(s,!0)}return o}getType(){return"arraybuffer"}readFeatures(e,t){let r=this.layers_;t=this.adaptOptions(t);let i=ne(t.dataProjection);i.setWorldExtent(t.extent),t.dataProjection=i;let o=new e0(e),s=o.readFields(o7,{}),a=[];for(let l in s){if(r&&!r.includes(l))continue;let c=s[l],u=c?[0,0,c.extent,c.extent]:null;i.setExtent(u);for(let d=0,f=c.length;d<f;++d){let h=l7(o,c,d),p=this.createFeature_(o,h,t);p!==null&&a.push(p)}}return a}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}};function o7(n,e,t){if(n===3){let r={keys:[],values:[],features:[]},i=t.readVarint()+t.pos;t.readFields(s7,r,i),r.length=r.features.length,r.length&&(e[r.name]=r)}}function s7(n,e,t){if(n===15)e.version=t.readVarint();else if(n===1)e.name=t.readString();else if(n===5)e.extent=t.readVarint();else if(n===2)e.features.push(t.pos);else if(n===3)e.keys.push(t.readString());else if(n===4){let r=null,i=t.readVarint()+t.pos;for(;t.pos<i;)n=t.readVarint()>>3,r=n===1?t.readString():n===2?t.readFloat():n===3?t.readDouble():n===4?t.readVarint64():n===5?t.readVarint():n===6?t.readSVarint():n===7?t.readBoolean():null;e.values.push(r)}}function a7(n,e,t){if(n==1)e.id=t.readVarint();else if(n==2){let r=t.readVarint()+t.pos;for(;t.pos<r;){let i=e.layer.keys[t.readVarint()],o=e.layer.values[t.readVarint()];e.properties[i]=o}}else n==3?e.type=t.readVarint():n==4&&(e.geometry=t.pos)}function l7(n,e,t){n.pos=e.features[t];let r=n.readVarint()+n.pos,i={layer:e,type:0,properties:{}};return n.readFields(a7,i,r),i}function c7(n,e){let t;return n===1?t=e===1?"Point":"MultiPoint":n===2?t=e===1?"LineString":"MultiLineString":n===3&&(t="Polygon"),t}var Sl=wb;function u7(n,e=512){return n.getExtent()?vo({extent:n.getExtent(),tileSize:e,maxZoom:22}).getResolutions():th}function d7(n,e){return e.accessToken||(e=Object.assign({},e),new URL(n).searchParams.forEach((r,i)=>{e.accessToken=r,e.accessTokenParam=i})),e}function Iu(n,e,t="",r={},i=void 0){let o,s,a,l,c=!0;return typeof t!="string"&&!Array.isArray(t)?(a=t,l=a.source||a.layers,r=a):l=t,typeof r=="string"?(o=r,a={}):(o=r.styleUrl,a=r),a.updateSource===!1&&(c=!1),i||(i=a.resolutions),!o&&typeof e=="string"&&!e.trim().startsWith("{")&&(o=e),o&&(o=o.startsWith("data:")?location.href:Hy(o,a.accessToken),a=d7(o,a)),new Promise(function(u,d){QO(e,a).then(function(f){if(f.version!=8)return d(new Error("glStyle version 8 required."));if(!(n instanceof ho||n instanceof la))return d(new Error("Can only apply to VectorLayer or VectorTileLayer"));let h=n instanceof la?"vector":"geojson";if(l?Array.isArray(l)?s=f.layers.find(function(E){return E.id===l[0]}).source:s=l:(s=f.layers.find(function(E){return E.source&&f.sources[E.source].type===h}).source,l=s),!s)return d(new Error(`No ${h} source found in the glStyle.`));function p(){if(!c)return Promise.resolve();if(n instanceof la)return p7(f.sources[s],o,a).then(function(b){let M=n.getSource();M?b!==M&&(M.setTileUrlFunction(b.getTileUrlFunction()),typeof M.setUrls=="function"&&typeof b.getUrls=="function"&&M.setUrls(b.getUrls()),M.format_||(M.format_=b.format_),M.getAttributions()||M.setAttributions(b.getAttributions()),M.getTileLoadFunction()===O1&&M.setTileLoadFunction(b.getTileLoadFunction()),qn(M.getProjection(),b.getProjection())&&(M.tileGrid=b.getTileGrid())):n.setSource(b);let S=n.getSource().getTileGrid();!isFinite(n.getMaxResolution())&&!isFinite(n.getMinZoom())&&S.getMinZoom()>0&&n.setMaxResolution(JO(Math.max(0,S.getMinZoom()-1e-12),S.getResolutions()))});let E=f.sources[s],_=n.getSource();(!_||_.get("mapbox-source")!==E)&&(_=g7(E,o,a));let w=n.getSource();return w?_!==w&&(w.getAttributions()||w.setAttributions(_.getAttributions()),w.format_||(w.format_=_.getFormat()),w.url_=_.getUrl()):n.setSource(_),Promise.resolve()}let m,g,y={},v={};function x(){if(!g&&(!f.sprite||y)){if(a.projection&&!i){let _=ne(a.projection).getUnits();_!=="m"&&(i=th.map(w=>w/Ii[_]))}g=xb(n,f,l,i,y,v,(E,_=a.webfonts)=>rF(E,_),a.getImage),n.getStyle()?p().then(u).catch(d):d(new Error(`Nothing to show for source [${s}]`))}else g?(n.setStyle(g),p().then(u).catch(d)):d(new Error("Something went wrong trying to apply style."))}if(f.sprite){let E=XO(f.sprite,a.accessToken,o||location.href);m=window.devicePixelRatio>=1.5?.5:1;let _=m==.5?"@2x":"";Promise.all(E.map(function(w){let b=new URL(w.url),M=b.origin+b.pathname+_+".json"+b.search;return new Promise(function(S,C){Ml("Sprite",M,a).then(S).catch(function(R){M=b.origin+b.pathname+".json"+b.search,Ml("Sprite",M,a).then(S).catch(C)})}).then(function(S){S===void 0&&d(new Error("No sprites found."));let C;if(C=b.origin+b.pathname+_+".png"+b.search,a.transformRequest){let R=a.transformRequest(C,"SpriteImage")||C;(R instanceof Request||R instanceof Promise)&&(C=R)}v[w.id]=C;for(let R in S){let T=w.id=="default"?R:`${w.id}:${R}`;y[T]=S[R]}}).catch(function(S){d(new Error(`Sprites cannot be loaded: ${M}: ${S.message}`))})})).then(x).catch(d)}else x()}).catch(d)})}function f7(n,e){let t=n.bounds;if(t){let r=Nx([t[0],t[1]],e),i=Nx([t[2],t[3]],e);return[r[0],r[1],i[0],i[1]]}return ne(e).getExtent()}function h7(n,e,t){let r=new GP({tileJSON:e,tileSize:n.tileSize||e.tileSize||512}),i=r.getTileJSON(),o=r.getTileGrid(),s=ne(t.projection||"EPSG:3857"),a=f7(i,s),l=s.getExtent(),c=i.minzoom||0,u=i.maxzoom||22,d={attributions:r.getAttributions(),projection:s,tileGrid:new ri({origin:l?ut(l):o.getOrigin(0),extent:a||o.getExtent(),minZoom:c,resolutions:u7(s,e.tileSize).slice(0,u+1),tileSize:o.getTileSize(0)})};return Array.isArray(i.tiles)?d.urls=i.tiles:d.url=i.tiles,d}function p7(n,e,t){return new Promise(function(r,i){eF(n,e,t).then(function({tileJson:o,tileLoadFunction:s}){let a=h7(n,o,t);a.tileLoadFunction=s,a.format=new Sl,r(new Jc(a))}).catch(i)})}function m7(n){return`{bbox-${(n?n.getCode():"EPSG:3857").toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}function g7(n,e,t){let r=t.projection?new us({dataProjection:t.projection}):new us,i=n.data,o={};if(typeof i=="string"){let[a]=bu(i,t.accessToken,t.accessTokenParam||"access_token",e||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(a)){let c=(d,f,h)=>{let p=m7(h);return a.replace(p,`${d.join(",")}`)},u=new Ir({attributions:n.attribution,format:r,loader:(d,f,h,p,m)=>{let g=typeof c=="function"?c(d,f,h):c;Ml("GeoJSON",g,t).then(y=>{let v=u.getFormat().readFeatures(y,{featureProjection:h});u.addFeatures(v),p(v)}).catch(y=>{u.removeLoadedExtent(d),m()})},strategy:LR});return u.set("mapbox-source",n),u}let l=new Ir({attributions:n.attribution,format:r,url:a,loader:(c,u,d,f,h)=>{Ml("GeoJSON",a,t).then(p=>{let m=l.getFormat().readFeatures(p,{featureProjection:d});l.addFeatures(m),f(m)}).catch(p=>{l.removeLoadedExtent(c),h()})}});return l}o.features=r.readFeatures(i,{featureProjection:Xr()||"EPSG:3857"});let s=new Ir(Object.assign({attributions:n.attribution,format:r},o));return s.set("mapbox-source",n),s}var Cb=class extends Qc{constructor(){super()}getType(){return"text"}readFeature(e,t){return this.readFeatureFromText(t0(e),this.adaptOptions(t))}readFeatureFromText(e,t){return W()}readFeatures(e,t){return this.readFeaturesFromText(t0(e),this.adaptOptions(t))}readFeaturesFromText(e,t){return W()}readGeometry(e,t){return this.readGeometryFromText(t0(e),this.adaptOptions(t))}readGeometryFromText(e,t){return W()}readProjection(e){return this.readProjectionFromText(t0(e))}readProjectionFromText(e){return this.dataProjection}writeFeature(e,t){return this.writeFeatureText(e,this.adaptOptions(t))}writeFeatureText(e,t){return W()}writeFeatures(e,t){return this.writeFeaturesText(e,this.adaptOptions(t))}writeFeaturesText(e,t){return W()}writeGeometry(e,t){return this.writeGeometryText(e,this.adaptOptions(t))}writeGeometryText(e,t){return W()}};function t0(n){return typeof n=="string"?n:""}var dF=Cb;var _7={POINT:dn,LINESTRING:vn,POLYGON:An,MULTIPOINT:Ri,MULTILINESTRING:oo,MULTIPOLYGON:so},fF="EMPTY",hF="Z",pF="M",x7="ZM",$e={START:0,TEXT:1,LEFT_PAREN:2,RIGHT_PAREN:3,NUMBER:4,COMMA:5,EOF:6},E7={Point:"POINT",LineString:"LINESTRING",Polygon:"POLYGON",MultiPoint:"MULTIPOINT",MultiLineString:"MULTILINESTRING",MultiPolygon:"MULTIPOLYGON",GeometryCollection:"GEOMETRYCOLLECTION",Circle:"CIRCLE"},bb=class{constructor(e){this.wkt=e,this.index_=-1}isAlpha_(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}isNumeric_(e,t){return t=t!==void 0?t:!1,e>="0"&&e<="9"||e=="."&&!t}isWhiteSpace_(e){return e==" "||e=="	"||e=="\r"||e==`
`}nextChar_(){return this.wkt.charAt(++this.index_)}nextToken(){let e=this.nextChar_(),t=this.index_,r=e,i;if(e=="(")i=$e.LEFT_PAREN;else if(e==",")i=$e.COMMA;else if(e==")")i=$e.RIGHT_PAREN;else if(this.isNumeric_(e)||e=="-")i=$e.NUMBER,r=this.readNumber_();else if(this.isAlpha_(e))i=$e.TEXT,r=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(e==="")i=$e.EOF;else throw new Error("Unexpected character: "+e)}return{position:t,value:r,type:i}}readNumber_(){let e,t=this.index_,r=!1,i=!1;do e=="."?r=!0:(e=="e"||e=="E")&&(i=!0),e=this.nextChar_();while(this.isNumeric_(e,r)||!i&&(e=="e"||e=="E")||i&&(e=="-"||e=="+"));return parseFloat(this.wkt.substring(t,this.index_--))}readText_(){let e,t=this.index_;do e=this.nextChar_();while(this.isAlpha_(e));return this.wkt.substring(t,this.index_--).toUpperCase()}},Mb=class{constructor(e){this.lexer_=e,this.token_={position:0,type:$e.START},this.layout_="XY"}consume_(){this.token_=this.lexer_.nextToken()}isTokenType(e){return this.token_.type==e}match(e){let t=this.isTokenType(e);return t&&this.consume_(),t}parse(){return this.consume_(),this.parseGeometry_()}parseGeometryLayout_(){let e="XY",t=this.token_;if(this.isTokenType($e.TEXT)){let r=t.value;r===hF?e="XYZ":r===pF?e="XYM":r===x7&&(e="XYZM"),e!=="XY"&&this.consume_()}return e}parseGeometryCollectionText_(){if(this.match($e.LEFT_PAREN)){let e=[];do e.push(this.parseGeometry_());while(this.match($e.COMMA));if(this.match($e.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parsePointText_(){if(this.match($e.LEFT_PAREN)){let e=this.parsePoint_();if(this.match($e.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseLineStringText_(){if(this.match($e.LEFT_PAREN)){let e=this.parsePointList_();if(this.match($e.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parsePolygonText_(){if(this.match($e.LEFT_PAREN)){let e=this.parseLineStringTextList_();if(this.match($e.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseMultiPointText_(){if(this.match($e.LEFT_PAREN)){let e;if(this.token_.type==$e.LEFT_PAREN?e=this.parsePointTextList_():e=this.parsePointList_(),this.match($e.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseMultiLineStringText_(){if(this.match($e.LEFT_PAREN)){let e=this.parseLineStringTextList_();if(this.match($e.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parseMultiPolygonText_(){if(this.match($e.LEFT_PAREN)){let e=this.parsePolygonTextList_();if(this.match($e.RIGHT_PAREN))return e}throw new Error(this.formatErrorMessage_())}parsePoint_(){let e=[],t=this.layout_.length;for(let r=0;r<t;++r){let i=this.token_;if(this.match($e.NUMBER))e.push(i.value);else break}if(e.length==t)return e;throw new Error(this.formatErrorMessage_())}parsePointList_(){let e=[this.parsePoint_()];for(;this.match($e.COMMA);)e.push(this.parsePoint_());return e}parsePointTextList_(){let e=[this.parsePointText_()];for(;this.match($e.COMMA);)e.push(this.parsePointText_());return e}parseLineStringTextList_(){let e=[this.parseLineStringText_()];for(;this.match($e.COMMA);)e.push(this.parseLineStringText_());return e}parsePolygonTextList_(){let e=[this.parsePolygonText_()];for(;this.match($e.COMMA);)e.push(this.parsePolygonText_());return e}isEmptyGeometry_(){let e=this.isTokenType($e.TEXT)&&this.token_.value==fF;return e&&this.consume_(),e}formatErrorMessage_(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}parseGeometry_(){let e=this.token_;if(this.match($e.TEXT)){let t=e.value;this.layout_=this.parseGeometryLayout_();let r=this.isEmptyGeometry_();if(t=="GEOMETRYCOLLECTION"){if(r)return new is([]);let s=this.parseGeometryCollectionText_();return new is(s)}let i=_7[t];if(!i)throw new Error("Invalid geometry type: "+t);let o;if(r)t=="POINT"?o=[NaN,NaN]:o=[];else switch(t){case"POINT":{o=this.parsePointText_();break}case"LINESTRING":{o=this.parseLineStringText_();break}case"POLYGON":{o=this.parsePolygonText_();break}case"MULTIPOINT":{o=this.parseMultiPointText_();break}case"MULTILINESTRING":{o=this.parseMultiLineStringText_();break}case"MULTIPOLYGON":{o=this.parseMultiPolygonText_();break}default:break}return new i(o,this.layout_)}throw new Error(this.formatErrorMessage_())}},Tb=class extends dF{constructor(e){super(),e=e||{},this.splitCollection_=e.splitCollection!==void 0?e.splitCollection:!1}parse_(e){let t=new bb(e);return new Mb(t).parse()}readFeatureFromText(e,t){let r=this.readGeometryFromText(e,t),i=new zt;return i.setGeometry(r),i}readFeaturesFromText(e,t){let r=[],i=this.readGeometryFromText(e,t);this.splitCollection_&&i.getType()=="GeometryCollection"?r=i.getGeometriesArray():r=[i];let o=[];for(let s=0,a=r.length;s<a;++s){let l=new zt;l.setGeometry(r[s]),o.push(l)}return o}readGeometryFromText(e,t){let r=this.parse_(e);return cs(r,!1,t)}writeFeatureText(e,t){let r=e.getGeometry();return r?this.writeGeometryText(r,t):""}writeFeaturesText(e,t){if(e.length==1)return this.writeFeatureText(e[0],t);let r=[];for(let o=0,s=e.length;o<s;++o)r.push(e[o].getGeometry());let i=new is(r);return this.writeGeometryText(i,t)}writeGeometryText(e,t){return yF(cs(e,!0,t))}};function mF(n){let e=n.getCoordinates();return e.length===0?"":e.join(" ")}function w7(n){let e=[],t=n.getPoints();for(let r=0,i=t.length;r<i;++r)e.push("("+mF(t[r])+")");return e.join(",")}function C7(n){let e=[],t=n.getGeometries();for(let r=0,i=t.length;r<i;++r)e.push(yF(t[r]));return e.join(",")}function Sb(n){let e=n.getCoordinates(),t=[];for(let r=0,i=e.length;r<i;++r)t.push(e[r].join(" "));return t.join(",")}function b7(n){let e=[],t=n.getLineStrings();for(let r=0,i=t.length;r<i;++r)e.push("("+Sb(t[r])+")");return e.join(",")}function gF(n){let e=[],t=n.getLinearRings();for(let r=0,i=t.length;r<i;++r)e.push("("+Sb(t[r])+")");return e.join(",")}function M7(n){let e=[],t=n.getPolygons();for(let r=0,i=t.length;r<i;++r)e.push("("+gF(t[r])+")");return e.join(",")}function T7(n){let e=n.getLayout(),t="";return(e==="XYZ"||e==="XYZM")&&(t+=hF),(e==="XYM"||e==="XYZM")&&(t+=pF),t}var S7={Point:mF,LineString:Sb,Polygon:gF,MultiPoint:w7,MultiLineString:b7,MultiPolygon:M7,GeometryCollection:C7};function yF(n){let e=n.getType(),t=S7[e],r=t(n),i=E7[e];if(typeof n.getFlatCoordinates=="function"){let o=T7(n);o.length>0&&(i+=" "+o)}return r.length===0?i+" "+fF:i+"("+r+")"}var Ib=Tb;var To=function(n){return n.Circle="circle",n.Fill="fill",n.Line="line",n.Raster="raster",n.Symbol="symbol",n}(To||{});function vF(n){throw new Error(`ERROR! Reached forbidden guard function with unexpected value: ${JSON.stringify(n)}`)}var n0=(()=>{class n{constructor(t,r){this.http=t,this.logger=r}getMapboxStyle(t){return this.http.get(t)}getLayersids(t){let r=[];return t.layers.forEach(i=>{r.push(i.id)}),r}removeRasterLayers(t){return t.layers=t.layers.filter(r=>r.type!==To.Raster),t}isPatternWithStops(t){return t.stops!==void 0}isPatternWithMatch(t){return!t||typeof t=="string"?!1:!!(t&&t.length>0&&t[0]==="match")}getItems(t,r,i,o){let s=[];return t.layers.forEach(a=>{let l=I7({},a.filter,this.logger);if(a.layout?.["text-field"]&&typeof a.layout["text-field"]=="string"){let c=a.layout["text-field"].replace("{","").replace("}","");l[""+c]=c.substring(0,6);let u=r(a["source-layer"],l,i,a.id,o),d=c[0].toUpperCase()+c.substring(1);this.pushItem(u+" "+d,a,s,l)}else{let c=r(a["source-layer"],l,i,a.id,o);o&&this.pushItem(c,a,s,l);let u;u=a.paint["circle-color"],a.type==To.Line&&(u=a.paint["line-color"]),a.type==To.Fill&&(u=a.paint["fill-color"],u||(u=a.paint["fill-pattern"])),u!==void 0&&(u&&this.isPatternWithStops(u)?u.stops.forEach(d=>{let f={};f[""+u.property]=d[0],c=d[0],this.pushItem(c,a,s,f)}):this.isPatternWithMatch(u)&&(this.isPatternWithMatch(u)?this.domatch(u,a,s):this.logger.warn("Invalid paint pattern detected:",u)))}}),s.sort((a,l)=>a.title.localeCompare(l.title))}domatch(t,r,i){if(this.logger.log("match",t),t.length<3){this.logger.warn("Invalid match pattern:",t);return}let o=t[1].slice(1);this.logger.log("matchField",o);let s="";t.forEach((a,l)=>{if(l<2)this.logger.log("skip",a);else if(a.startsWith("#")){let c={};s!==""&&(c[o]=s,this.pushItem(s,r,i,c),s="")}else s=a+""})}capitalizeFirstLetter(t){return[...t][0].toUpperCase()+t.slice(1)}idTitle(t,r,i,o){return o}customTitle(t,r,i,o){function s(l,c){return r[c]?l+" "+r[c]:l}let a="";return i.forEach(l=>{a=s(a,l)}),o&&a===""&&(a=t+" "),a=a.trimStart(),a=a.replace("_"," "),[...a][0].toUpperCase()+a.slice(1)}pushItem(t,r,i,o={}){if(o.size="1",!i.find(s=>s.title===t)){let s={name:r.id,title:t,geoType:r.type,style:[],sourceLayer:r["source-layer"],feature:void 0,properties:o};i.push(s)}}static{this.\u0275fac=function(r){return new(r||n)(U(lr),U(Ct))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function I7(n,e,t){function r(i){if(Array.isArray(i)){let o=i[0],s=i.slice(1);if(o==="all"||o==="any")s.forEach(r);else if(typeof i[1]=="string"){let a=i[1];typeof i[2]=="string"||typeof i[2]=="number"?n[a]=i[2]:t.warn(`Unexpected filter value type for key "${a}":`,i[2])}else t.warn("Unexpected filter key type:",i[1])}}return r(e),n}var xF=(()=>{class n{constructor(t,r,i){this.logger=t,this.mapboxStyleService=r,this.elementRef=i,this._itemHeight=40,this._itemWidth=60,this.itemLeft=10,this.itemRight=50,this.extent=[0,0,this.itemWidth,this.itemHeight],this.projection=new un({code:"pixel-map",units:"pixels",extent:this.extent}),this.map=new go({}),this.vectorSource=new Jc({format:new Sl,projection:this.projection}),this.vectorLayer=new la({source:this.vectorSource})}get itemHeight(){return this._itemHeight}get itemWidth(){return this._itemWidth}ngOnInit(){let t=this.newFeature(this.item);this.map=new go({controls:[],interactions:[],layers:[this.vectorLayer],view:new nn({projection:this.projection,center:Ht(this.extent),zoom:2,minZoom:2,maxZoom:2})}),this.vectorLayer.getSource()?.setTileLoadFunction(o=>{let s=o;s.setLoader(()=>{let a=[];a.push(t),s.setFeatures(a)})});let r=[];r.push(1);let i=this.mapboxStyleService.getLayersids(this.mapboxStyle);Iu(this.vectorLayer,this.mapboxStyle,i,void 0,r).then(()=>{this.vectorLayer.getSource()?.refresh();let o=this.elementRef.nativeElement.querySelector("[id='itemmap']");this.map.setTarget(o)}).catch(o=>{this.logger.error("error loading legend style:  "+o)})}newFeature(t){switch(t.geoType){case To.Fill:{let r=to(this.extent);r.scale(.05,.05);let i=new zt({geometry:r,layer:t.sourceLayer});return i.setProperties(t.properties),i}case To.Circle:case To.Raster:case To.Symbol:{let r=new zt({geometry:new dn(Ht(this.extent)),layer:t.sourceLayer});return r.setProperties(t.properties),r}case To.Line:{let r=this.itemHeight/2,i=new zt({geometry:new vn([[this.itemLeft,r],[this.itemRight,r]]),layer:t.sourceLayer});return i.setProperties(t.properties),i}default:vF(t.geoType)}}static{this.\u0275fac=function(r){return new(r||n)(pe(Ct),pe(n0),pe(Zi))}}static{this.\u0275cmp=bn({type:n,selectors:[["app-legend-item"]],inputs:{item:"item",mapboxStyle:"mapboxStyle"},decls:1,vars:4,consts:[["id","itemmap",1,"legenditem"]],template:function(r,i){r&1&&Gn(0,"div",0),r&2&&$a("width",i.itemWidth,"px")("height",i.itemHeight,"px")},encapsulation:2,changeDetection:0})}}return n})();function D7(n,e){if(n&1&&(Fe(0,"div",3),Gn(1,"app-legend-item",4),Fe(2,"div",5),ln(3),Re()()),n&2){let t=e.$implicit,r=Bt(2);Ze(),Et("item",t)("mapboxStyle",r.mapboxStyle),Ze(2),vi(t.title)}}function R7(n,e){if(n&1&&(Fe(0,"div",1),Mn(1,D7,4,3,"div",2),Re()),n&2){let t=Bt();Ze(),Et("ngForOf",t.LegendItems)}}var EF=(()=>{class n{constructor(t,r){this.logger=t,this.mapboxStyleService=r,this.LegendItems=[],_b(!0)}ngOnChanges(t){t.styleUrl?.previousValue!==t.styleUrl?.currentValue&&(t.styleUrl.isFirstChange()||this.generateLegend()),this.titleItems&&t.titleItems.previousValue!==t.titleItems.currentValue&&(t.titleItems.isFirstChange()||this.generateLegend())}ngOnInit(){this.generateLegend()}generateLegend(){this.styleUrl?this.mapboxStyleService.getMapboxStyle(this.styleUrl).subscribe(t=>{this.mapboxStyle=this.mapboxStyleService.removeRasterLayers(t),this.mapboxStyle.metadata?.["gokoala:title-items"]&&(this.titleItems=this.mapboxStyle.metadata?.["gokoala:title-items"]);let r=this.titleItems?this.titleItems.split(","):[];this.titleItems?this.titleItems.toLocaleLowerCase()==="id"?this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.idTitle,r,!0):this.titleItems.toLocaleLowerCase().includes("no-id")?this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.customTitle,r,!1):this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.customTitle,r,!0):this.LegendItems=this.mapboxStyleService.getItems(this.mapboxStyle,this.mapboxStyleService.capitalizeFirstLetter,[],!0)}):this.logger.error("no style url supplied")}static{this.\u0275fac=function(r){return new(r||n)(pe(Ct),pe(n0))}}static{this.\u0275cmp=bn({type:n,selectors:[["app-legend-view"]],inputs:{styleUrl:"styleUrl",titleItems:"titleItems"},features:[Ba],decls:1,vars:1,consts:[["class","legendContainer",4,"ngIf"],[1,"legendContainer"],["class","legendItem",4,"ngFor","ngForOf"],[1,"legendItem"],[3,"item","mapboxStyle"],[1,"legendText"]],template:function(r,i){r&1&&Mn(0,R7,2,1,"div",0),r&2&&Et("ngIf",i.LegendItems.length>0)},dependencies:[Un,Ki,xi,xF],styles:[".legendContainer[_ngcontent-%COMP%]{display:flex;flex:0 1 auto;flex-wrap:wrap;flex-direction:column;justify-content:flex-start;align-items:flex-start;max-height:100%;padding:5px;margin:5px;min-height:0}.legendItem[_ngcontent-%COMP%]{max-width:23vw;display:flex;flex-wrap:nowrap;flex-direction:row;align-items:center;flex:0 1 auto}.legendText[_ngcontent-%COMP%]{font-size:calc((var(--h) / 3));margin-left:1em}"]})}}return n})();var wF=(()=>{class n{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustHtml(t)}static{this.\u0275fac=function(r){return new(r||n)(pe(ox,16))}}static{this.\u0275pipe=Qu({name:"safeHtml",type:n,pure:!0})}}return n})();var Il=(()=>{class n{constructor(){this.rootUrl="https://api.pdok.nl/bzk/location-api/autocomplete/v1-preprod"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var rh=(()=>{class n{constructor(t,r){this.config=t,this.http=r}get rootUrl(){return this._rootUrl||this.config.rootUrl}set rootUrl(t){this._rootUrl=t}static{this.\u0275fac=function(r){return new(r||n)(U(Il),U(lr))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})();var Db=class{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}},A7=new Db,ih=class{constructor(e,t,r,i,o){this.name=e,this.value=t,this.options=r,this.options=r||{},(this.options.style===null||this.options.style===void 0)&&(this.options.style=i),(this.options.explode===null||this.options.explode===void 0)&&(this.options.explode=o)}serializeValue(e,t=","){if(e==null)return"";if(e instanceof Array)return e.map(r=>this.serializeValue(r).split(t).join(encodeURIComponent(t))).join(t);if(typeof e=="object"){let r=[];for(let i of Object.keys(e)){let o=e[i];o!=null&&(o=this.serializeValue(o).split(t).join(encodeURIComponent(t)),this.options.explode?r.push(`${i}=${o}`):(r.push(i),r.push(o)))}return r.join(t)}else return String(e)}},Rb=class extends ih{constructor(e,t,r){super(e,t,r,"simple",!1)}append(e){let t=this.value;t==null&&(t="");let r=this.options.style==="label"?".":"",i=this.options.explode?r===""?",":r:",",o=!1;return this.options.style==="matrix"&&(r=`;${this.name}=`,this.options.explode&&typeof t=="object"&&(r=";",t instanceof Array?(t=t.map(s=>`${this.name}=${this.serializeValue(s,";")}`),t=t.join(";"),o=!0):(t=this.serializeValue(t,";"),o=!0))),t=r+(o?t:this.serializeValue(t,i)),e=e.replace(`{${this.name}}`,t),e=e.replace(`{${r}${this.name}${this.options.explode?"*":""}}`,t),e}serializeValue(e,t=","){var r=typeof e=="string"?encodeURIComponent(e):super.serializeValue(e,t);return r=r.replace(/%3D/g,"="),r=r.replace(/%3B/g,";"),r=r.replace(/%2C/g,","),r}},Ab=class extends ih{constructor(e,t,r){super(e,t,r,"form",!0)}append(e){if(this.value instanceof Array)if(this.options.explode)for(let t of this.value)e=e.append(this.name,this.serializeValue(t));else{let t=this.options.style==="spaceDelimited"?" ":this.options.style==="pipeDelimited"?"|":",";return e.append(this.name,this.serializeValue(this.value,t))}else if(this.value!==null&&typeof this.value=="object")if(this.options.style==="deepObject")for(let t of Object.keys(this.value)){let r=this.value[t];r!=null&&(e=e.append(`${this.name}[${t}]`,this.serializeValue(r)))}else if(this.options.explode)for(let t of Object.keys(this.value)){let r=this.value[t];r!=null&&(e=e.append(t,this.serializeValue(r)))}else{let t=[];for(let r of Object.keys(this.value)){let i=this.value[r];i!=null&&(t.push(r),t.push(i))}e=e.append(this.name,this.serializeValue(t))}else this.value!==null&&this.value!==void 0&&(e=e.append(this.name,this.serializeValue(this.value)));return e}},Pb=class extends ih{constructor(e,t,r){super(e,t,r,"simple",!1)}append(e){if(this.value!==null&&this.value!==void 0)if(this.value instanceof Array)for(let t of this.value)e=e.append(this.name,this.serializeValue(t));else e=e.append(this.name,this.serializeValue(this.value));return e}},Ot=class{constructor(e,t,r){this.rootUrl=e,this.operationPath=t,this.method=r,this._path=new Map,this._query=new Map,this._header=new Map}path(e,t,r){this._path.set(e,new Rb(e,t,r||{}))}query(e,t,r){this._query.set(e,new Ab(e,t,r||{}))}header(e,t,r){this._header.set(e,new Pb(e,t,r||{}))}body(e,t="application/json"){if(e instanceof Blob?this._bodyContentType=e.type:this._bodyContentType=t,this._bodyContentType==="application/x-www-form-urlencoded"&&e!==null&&typeof e=="object"){let r=[];for(let i of Object.keys(e)){let o=e[i];o instanceof Array||(o=[o]);for(let s of o){let a=this.formDataValue(s);a!==null&&r.push([i,a])}}this._bodyContent=r.map(i=>`${encodeURIComponent(i[0])}=${encodeURIComponent(i[1])}`).join("&")}else if(this._bodyContentType==="multipart/form-data"){let r=new FormData;if(e!=null)for(let i of Object.keys(e)){let o=e[i];if(o instanceof Array)for(let s of o){let a=this.formDataValue(s);a!==null&&r.append(i,a)}else{let s=this.formDataValue(o);s!==null&&r.set(i,s)}}this._bodyContent=r}else this._bodyContent=e}formDataValue(e){return e==null?null:e instanceof Blob?e:typeof e=="object"?new Blob([JSON.stringify(e)],{type:"application/json"}):String(e)}build(e){e=e||{};let t=this.operationPath;for(let s of this._path.values())t=s.append(t);let r=this.rootUrl+t,i=new Mr({encoder:A7});for(let s of this._query.values())i=s.append(i);let o=new Sn;e.accept&&(o=o.append("Accept",e.accept));for(let s of this._header.values())o=s.append(o);return this._bodyContentType&&!(this._bodyContent instanceof FormData)&&(o=o.set("Content-Type",this._bodyContentType)),new Ei(this.method.toUpperCase(),r,this._bodyContent,{params:i,headers:o,responseType:e.responseType,reportProgress:e.reportProgress,context:e.context})}};function Nb(n,e,t,r){let i=new Ot(e,Nb.PATH,"get");return t&&i.query("f",t.f,{style:"form",explode:!1}),n.request(i.build({responseType:"text",accept:"text/html",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o))}Nb.PATH="/conformance";function Ob(n,e,t,r){let i=new Ot(e,Ob.PATH,"get");return t&&i.query("f",t.f,{style:"form",explode:!1}),n.request(i.build({responseType:"json",accept:"application/json",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o))}Ob.PATH="/conformance";function Fb(n,e,t,r){let i=new Ot(e,Fb.PATH,"get");return t&&i.query("f",t.f,{style:"form",explode:!1}),n.request(i.build({responseType:"text",accept:"text/html",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o))}Fb.PATH="/";function Lb(n,e,t,r){let i=new Ot(e,Lb.PATH,"get");return t&&i.query("f",t.f,{style:"form",explode:!1}),n.request(i.build({responseType:"json",accept:"application/json",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o))}Lb.PATH="/";function kb(n,e,t,r){let i=new Ot(e,kb.PATH,"get");return t&&i.query("f",t.f,{style:"form",explode:!1}),n.request(i.build({responseType:"json",accept:"application/vnd.oai.openapi+json;version=3.0",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o))}kb.PATH="/";function jb(n,e,t,r){let i=new Ot(e,jb.PATH,"get");return t&&i.query("f",t.f,{style:"form",explode:!1}),n.request(i.build({responseType:"text",accept:"*/*",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o.clone({body:void 0})))}jb.PATH="/api";function i0(n,e,t,r){let i=new Ot(e,i0.PATH,"get");return t&&i.query("f",t.f,{style:"form",explode:!1}),n.request(i.build({responseType:"text",accept:"text/html",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o))}i0.PATH="/collections";function o0(n,e,t,r){let i=new Ot(e,o0.PATH,"get");return t&&i.query("f",t.f,{style:"form",explode:!1}),n.request(i.build({responseType:"json",accept:"application/json",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o))}o0.PATH="/collections";var Vb=(()=>{class n extends rh{constructor(t,r){super(t,r)}static{this.GetCollectionsPath="/collections"}getCollections$Json$Response(t,r){return o0(this.http,this.rootUrl,t,r)}getCollections$Json(t,r){return this.getCollections$Json$Response(t,r).pipe(ue(i=>i.body))}getCollections$Html$Response(t,r){return i0(this.http,this.rootUrl,t,r)}getCollections$Html(t,r){return this.getCollections$Html$Response(t,r).pipe(ue(i=>i.body))}static{this.\u0275fac=function(r){return new(r||n)(U(Il),U(lr))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function s0(n,e,t,r){let i=new Ot(e,s0.PATH,"get");return t&&(i.query("q",t.q,{style:"form",explode:!1}),i.query("functioneel_gebied",t.functioneel_gebied,{style:"deepObject",explode:!0}),i.query("gemeentegebied",t.gemeentegebied,{style:"deepObject",explode:!0}),i.query("geografisch_gebied",t.geografisch_gebied,{style:"deepObject",explode:!0}),i.query("ligplaats",t.ligplaats,{style:"deepObject",explode:!0}),i.query("perceel",t.perceel,{style:"deepObject",explode:!0}),i.query("provinciegebied",t.provinciegebied,{style:"deepObject",explode:!0}),i.query("standplaats",t.standplaats,{style:"deepObject",explode:!0}),i.query("verblijfsobject",t.verblijfsobject,{style:"deepObject",explode:!0}),i.query("woonplaats",t.woonplaats,{style:"deepObject",explode:!0}),i.query("limit",t.limit,{style:"form",explode:!1}),i.query("bbox",t.bbox,{style:"form",explode:!1}),i.query("bbox-crs",t["bbox-crs"],{style:"form",explode:!1}),i.query("crs",t.crs,{style:"form",explode:!1})),n.request(i.build({responseType:"text",accept:"text/html",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o))}s0.PATH="/search";function a0(n,e,t,r){let i=new Ot(e,a0.PATH,"get");return t&&(i.query("q",t.q,{style:"form",explode:!1}),i.query("functioneel_gebied",t.functioneel_gebied,{style:"deepObject",explode:!0}),i.query("gemeentegebied",t.gemeentegebied,{style:"deepObject",explode:!0}),i.query("geografisch_gebied",t.geografisch_gebied,{style:"deepObject",explode:!0}),i.query("ligplaats",t.ligplaats,{style:"deepObject",explode:!0}),i.query("perceel",t.perceel,{style:"deepObject",explode:!0}),i.query("provinciegebied",t.provinciegebied,{style:"deepObject",explode:!0}),i.query("standplaats",t.standplaats,{style:"deepObject",explode:!0}),i.query("verblijfsobject",t.verblijfsobject,{style:"deepObject",explode:!0}),i.query("woonplaats",t.woonplaats,{style:"deepObject",explode:!0}),i.query("limit",t.limit,{style:"form",explode:!1}),i.query("bbox",t.bbox,{style:"form",explode:!1}),i.query("bbox-crs",t["bbox-crs"],{style:"form",explode:!1}),i.query("crs",t.crs,{style:"form",explode:!1})),n.request(i.build({responseType:"json",accept:"application/json",context:r})).pipe(tt(o=>o instanceof Qe),ue(o=>o))}a0.PATH="/search";var Bb=(()=>{class n extends rh{constructor(t,r){super(t,r)}static{this.SearchPath="/search"}search$Json$Response(t,r){return a0(this.http,this.rootUrl,t,r)}search$Json(t,r){return this.search$Json$Response(t,r).pipe(ue(i=>i.body))}search$Html$Response(t,r){return s0(this.http,this.rootUrl,t,r)}search$Html(t,r){return this.search$Html$Response(t,r).pipe(ue(i=>i.body))}static{this.\u0275fac=function(r){return new(r||n)(U(Il),U(lr))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function P7(n,e){if(n&1){let t=td();Fe(0,"tr")(1,"td")(2,"label")(3,"input",7),zo("change",function(i){let o=Ds(t).$implicit,s=Bt(3);return Rs(s.checboxChanged(o.title,i))}),Re(),ln(4),Re()(),Fe(5,"td")(6,"label")(7,"input",8),zo("input",function(i){let o=Ds(t).$implicit,s=Bt(3);return Rs(s.relevanceChanged(o.title,i))}),Re()()()()}if(n&2){let t=e.$implicit,r=Bt(3);Ze(3),nd("title","Include or excluse results from ",t.title,""),Et("checked",r.isActiveCollection(t.title)),Ze(),rd(" ",t.title," "),Ze(3),nd("title","Relevance to boost or decrease results from ",t.title,""),nd("placeholder","Enter Relevance for ",t.title,""),Et("value",r.getRelevance(t.title))}}function N7(n,e){if(n&1&&(Vp(0),Fe(1,"div",5)(2,"table")(3,"thead")(4,"tr")(5,"th"),ln(6,"Collection"),Re(),Fe(7,"th"),ln(8,"Relevance"),Re()()(),Fe(9,"tbody"),Mn(10,P7,8,9,"tr",6),Re()()(),Bp()),n&2){let t=Bt(2);Ze(10),Et("ngForOf",t.collections)}}function O7(n,e){if(n&1){let t=td();Vp(0),Fe(1,"div",1)(2,"button",2),zo("click",function(){Ds(t);let i=Bt();return Rs(i.toggleVisible())}),QT(),Fe(3,"svg",3),Gn(4,"path",4),Re()(),Mn(5,N7,11,1,"ng-container",0),Re(),Bp()}if(n&2){let t=Bt();Ze(5),Et("ngIf",t.visible)}}var bF=(()=>{class n{constructor(t,r){this.logger=t,this.collectionService=r,this.url=void 0,this.defaultColparams={relevance:.5,version:1},this.searchParams={q:""},this.searchParamsEvent=new Rt,this.collections=void 0,this.infomessage=void 0,this.active=[],this.visible=!1}ngOnInit(){this.url?(this.collectionService.rootUrl=this.url,this.collectionService.getCollections$Json().subscribe(t=>{this.collections=t.collections,this.collections.forEach(r=>{this.active.push({name:r.id,enabled:!0,relevance:.5,version:1})}),this.logger.log(this.collections)})):this.infomessage="please provide url to location url "}isActiveCollection(t){if(t){let r=this.active.find(i=>i.name===t);return r?r.enabled:!1}else return!1}getRelevance(t){if(t){let r=this.active.find(i=>i.name===t);return r?r.relevance:.5}else return .5}SetActiveCollection(t,r){if(t){let i=this.active.find(o=>o.name===t);i?i.enabled=r:this.logger.error(t+" collection not found")}}SetRelevance(t,r){if(t){let i=this.active.find(o=>o.name===t);i?i.relevance=r:this.logger.error(t+" collection not found")}}toggleVisible(){this.visible=!this.visible}checboxChanged(t,r){t&&(this.SetActiveCollection(t,r.target.checked),this.emit())}relevanceChanged(t,r){t&&(this.SetRelevance(t,Number(r.target.value)),this.emit())}emit(){let t={q:this.searchParams.q};this.active.forEach(r=>{r.name==="functioneel_gebied"&&r.enabled&&(t.functioneel_gebied={relevance:r.relevance,version:r.version}),r.name==="geografisch_gebied"&&r.enabled&&(t.geografisch_gebied={relevance:r.relevance,version:r.version}),r.name==="ligplaats"&&r.enabled&&(t.ligplaats={relevance:r.relevance,version:r.version}),r.name==="standplaats"&&r.enabled&&(t.standplaats={relevance:r.relevance,version:r.version}),r.name==="verblijfsobject"&&r.enabled&&(t.verblijfsobject={relevance:r.relevance,version:r.version}),r.name==="woonplaats"&&r.enabled&&(t.woonplaats={relevance:r.relevance,version:r.version}),r.name==="gemeentegebied"&&r.enabled&&(t.gemeentegebied={relevance:r.relevance,version:r.version}),r.name==="provinciegebied"&&r.enabled&&(t.provinciegebied={relevance:r.relevance,version:r.version}),r.name==="perceel"&&r.enabled&&(t.perceel={relevance:r.relevance,version:r.version})}),this.logger.log(JSON.stringify(t)),this.searchParamsEvent.emit(t)}static{this.\u0275fac=function(r){return new(r||n)(pe(Ct),pe(Vb))}}static{this.\u0275cmp=bn({type:n,selectors:[["app-search-options"]],inputs:{url:"url",searchParams:"searchParams"},outputs:{searchParamsEvent:"searchParamsEvent"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"search-options"],["title","show/hide search options",1,"search-options-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","preserveAspectRatio","none","viewBox","0 0 512 512","width","16","height","16"],["d","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"],[1,"collections"],[4,"ngFor","ngForOf"],["type","checkbox",3,"change","checked","title"],["type","number","min","0","max","1","step","0.1",3,"input","value","title","placeholder"]],template:function(r,i){r&1&&(Mn(0,O7,6,1,"ng-container",0),ln(1)),r&2&&(Et("ngIf",i.url),Ze(),rd(" ",i.infomessage,`
`))},dependencies:[Un,Ki,xi],styles:[".search-options-button[_ngcontent-%COMP%]{padding:var(--ls-searchbox-padding, 2px);margin:var(--ls-searchbox-margin, 2px);border:var(--ls-search-box-border, thin)}svg[_ngcontent-%COMP%]{height:var(--ls-searchbox-height, auto);width:var(--ls-searchbox-height, auto)}.collections[_ngcontent-%COMP%]{position:absolute;z-index:var(--ls-searchbox-collections-z-index, 9999);left:var(--ls-searchbox-collections-left, 40vw);background-color:var(--ls-options-background-color, rgba(245, 245, 245, .6))}"]})}}return n})();function F7(n,e){if(n&1){let t=td();Fe(0,"div",7)(1,"div",8)(2,"button",9),zo("mouseover",function(){let i=Ds(t).$implicit,o=Bt(2);return Rs(o.selectResultHover(i))})("focus",function(){let i=Ds(t).$implicit,o=Bt(2);return Rs(o.selectResultHover(i))})("click",function(){let i=Ds(t).$implicit,o=Bt(2);return Rs(o.selectResultClick(i))}),Gn(3,"div",10),R_(4,"safeHtml"),Gn(5,"div"),Re()()()}if(n&2){let t=e.$implicit,r=Bt(2);Ze(2),D_("title","",r.getProperty(t,"collectionId"),": ",r.getDisplayname(t),""),Ze(),Et("innerHTML",A_(4,4,r.getHighLight(t)),BS)}}function L7(n,e){if(n&1&&(Fe(0,"div"),Mn(1,F7,6,6,"div",6),R_(2,"async"),Re()),n&2){let t=Bt();Ze(),Et("ngForOf",t.getResults(A_(2,1,t.results)))}}var MF=(()=>{class n{constructor(t,r,i){this.logger=t,this.featuresService=r,this.elementRef=i,this.selectedResultUrl=void 0,this.activeFeatureHovered=new Rt,this.activeFeatureSelected=new Rt,this.activeSearchUrl=new Rt,this.activeSearchText=new Rt,this.url=void 0,this.label="Search location",this.title="Enter the location you want to search for",this.placeholder="Enter location to search",this.backgroundmap="OSM",this.defaultColparams={relevance:.5,version:1},this.searchParams={q:"",functioneel_gebied:this.defaultColparams,geografisch_gebied:this.defaultColparams,ligplaats:this.defaultColparams,standplaats:this.defaultColparams,verblijfsobject:this.defaultColparams,woonplaats:this.defaultColparams,perceel:this.defaultColparams,gemeentegebied:this.defaultColparams,provinciegebied:this.defaultColparams,limit:10,"bbox-crs":"http://www.opengis.net/def/crs/OGC/1.3/CRS84",crs:"http://www.opengis.net/def/crs/OGC/1.3/CRS84"},this.searchLocation="",this.projection=Pf,this.results=void 0,this.activeSearchUrlEmited={url:"",headers:new Sn}}ngOnInit(){this.logger.debug("LocationSearchComponent initialized with URL:",this.url),this.activeSearchUrl.emit(_a)}updateSearchField(t){let r=t.target.value;r.length>1?(this.searchParams.q=r,this.logger.debug(r),this.activeSearchText.emit(r),this.deSelectResult(),this.lookup()):this.results=void 0}emitCurrentUrl(){_a.url.includes("search")&&this.activeSearchUrlEmited!==_a&&(this.activeSearchUrlEmited=_a,this.activeSearchUrl.emit(_a))}lookup(){this.url&&(this.featuresService.rootUrl=this.url,this.results=this.featuresService.search$Json(this.searchParams))}selectResultHover(t){let i=new us().readFeature(t);this.activeFeatureHovered.emit(i)}selectResultClick(t){let i=new us().readFeature(t);this.activeFeatureSelected.emit(i)}deSelectResult(){this.activeFeatureHovered.emit(void 0)}getHighLight(t){return this.getProperty(t,"highlight")}getDisplayname(t){return this.getProperty(t,"displayName")}getProperty(t,r){let i=t.properties;return i[r]?i[r]:""}paramChanged(t){this.deSelectResult(),this.logger.debug("paramchanged:"),this.logger.debug(JSON.stringify(t)),this.searchParams=t,this.lookup()}getResults(t){return this.emitCurrentUrl(),t?t?.features:[]}static{this.\u0275fac=function(r){return new(r||n)(pe(Ct),pe(Bb),pe(Zi))}}static{this.\u0275cmp=bn({type:n,selectors:[["app-location-search"]],inputs:{url:"url",label:"label",title:"title",placeholder:"placeholder",backgroundmap:"backgroundmap",searchParams:"searchParams"},outputs:{activeFeatureHovered:"activeFeatureHovered",activeFeatureSelected:"activeFeatureSelected",activeSearchUrl:"activeSearchUrl",activeSearchText:"activeSearchText"},decls:7,vars:7,consts:[[1,"location-search"],["role","search",1,"search-box"],["id","searchboxlabel","for","searchBox"],["role","textbox","autoComplete","off","id","searchBox","type","text","list","locatie-auto-complete","aria-label","Search for a location",1,"search-input-box",3,"keyup","value","placeholder","title"],[3,"searchParamsEvent","url","searchParams"],[4,"ngIf"],["role","list",4,"ngFor","ngForOf"],["role","list"],["role","listitem"],["part","rbutton",1,"result-button",3,"mouseover","focus","click","title"],[3,"innerHTML"]],template:function(r,i){r&1&&(Fe(0,"div",0)(1,"div",1)(2,"label",2),ln(3),Re(),Fe(4,"input",3),zo("keyup",function(s){return i.updateSearchField(s)}),Re(),Fe(5,"app-search-options",4),zo("searchParamsEvent",function(s){return i.paramChanged(s)}),Re()(),Mn(6,L7,3,3,"div",5),Re()),r&2&&(Ze(3),vi(i.label),Ze(),Et("value",i.searchLocation)("placeholder",i.placeholder)("title",i.title),Ze(),Et("url",i.url)("searchParams",i.searchParams),Ze(),Et("ngIf",i.results))},dependencies:[Un,Ki,xi,G_,wF,bF],styles:['.location-search[_ngcontent-%COMP%]{max-width:var(--ls-searchbox-width, 50%);font-size:var(--ls-searchbox-font-size);text-align:var(--ls-searchbox-text-align, top)}.search-box[_ngcontent-%COMP%]{display:flex;background-color:var(--ls-options-background-color, transparant)}.search-box[_ngcontent-%COMP%]   #searchBox[_ngcontent-%COMP%]{padding:var(--ls-searchbox-padding, 2px);margin:var(--ls-searchbox-margin, 2px);border:var(--ls-searchbox-border, inset, rgb(118, 118, 118));border-radius:var(--ls-searchbox-border-radius, 1);text-align:var(--ls-searchbox-text-align, top);width:var(--ls-search-textbox-width, 100%);height:var(--ls-searchbox-height, 20px);font-size:var(--ls-searchbox-font-size)}.result-button[_ngcontent-%COMP%]{margin-top:.5vh;height:var(--ls-selectbox-buttonheight, 2em);min-height:var(--ls-selectbox-buttonheight, 2em);font-size:var(--ls-selectbox-fontsize, auto);font-family:var(--ls-selectbox-font-family, "Roboto");min-width:var(--ls-selectbox-width, 100%)}']})}}return n})();function k7(n,e){if(n&1&&(Fe(0,"tr")(1,"td"),ln(2),Re(),Fe(3,"td"),ln(4),Re()()),n&2){let t=e.$implicit;Ze(2),vi(t.title),Ze(2),vi(t.value)}}function j7(n,e){if(n&1&&(Fe(0,"table",2)(1,"caption",3),ln(2," Object Informatie: "),Re(),Fe(3,"thead")(4,"th",4),ln(5,"Veld"),Re(),Fe(6,"th",5),ln(7,"Waarde"),Re()(),Fe(8,"tbody"),Mn(9,k7,5,2,"tr",6),Re()()),n&2){let t=Bt();Ze(9),Et("ngForOf",t.getFeatureProperties())}}var TF=(()=>{class n{getFeatureProperties(){let t=[];if(this.feature){let r=this.feature.getProperties();for(let i in r)if(i!=="mapbox-layer")if(i==="geometry"){let s=new Ib().writeGeometry(r[i]),a={title:i,value:s};t.push(a)}else{let o={title:i,value:r[i]};t.push(o)}return t}else return[]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=bn({type:n,selectors:[["app-object-info"]],inputs:{feature:"feature"},decls:2,vars:1,consts:[["tabindex","0",1,"objectinfo"],["class","featuretable",4,"ngIf"],[1,"featuretable"],[1,"featuretablecaption"],["id","Veld"],["id","Waarde"],[4,"ngFor","ngForOf"]],template:function(r,i){r&1&&(Fe(0,"div",0),Mn(1,j7,10,1,"table",1),Re()),r&2&&(Ze(),Et("ngIf",i.getFeatureProperties().length>0))},dependencies:[Un,Ki,xi],styles:[`.objectinfo{margin-top:0;margin-bottom:0;margin-right:0;background-color:#fff;overflow-y:auto;overflow-x:auto;max-height:98%}.featuretable{text-align:left}.featuretablecaption{text-align:left;font-weight:700}
`],encapsulation:3,changeDetection:0})}}return n})();var SF=(()=>{class n{constructor(t){this.http=t}getMatrixSet(t){return this.http.get(t)}getMatrix(t){return this.http.get(t)}static{this.\u0275fac=function(r){return new(r||n)(U(lr))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function B7(n,e){if(n&1&&Gn(0,"app-objectinfo-view",3),n&2){let t=Bt();Et("feature",t.curFeature)}}function IF(n){return n!=null&&`${n}`!="false"}var DF=(()=>{class n{set showGrid(t){this._showGrid=IF(t)}get showGrid(){return this._showGrid}set showObjectInfo(t){this._showObjectInfo=IF(t)}get showObjectInfo(){return this._showObjectInfo}set zoom(t){this._zoom=t,this.map.getView().setZoom(t),this.logger.log("set zoom "+t),this.cdf.detectChanges(),this.currentZoomLevel.next(t)}get zoom(){return this._zoom===void 0&&(this._zoom=this.minZoom??0),this._zoom}constructor(t,r,i,o){this.logger=t,this.elementRef=r,this.matrixsetService=i,this.cdf=o,this.title="view-component",this.map=new go({}),this.xyzSelector="/{z}/{y}/{x}?f=mvt",this._showGrid=!1,this._showObjectInfo=!1,this._zoom=void 0,this.tileUrl=ny,this.currentZoomLevel=new Rt,this.activeFeature=new Rt,this.activeTileUrl=new Rt,this.mapHeight=600,this.mapWidth=800}ngOnChanges(t){t.styleUrl?.previousValue!==t.styleUrl?.currentValue&&(this.logger.log(this.id+" style changed"),t.styleUrl.isFirstChange()||this.vectorTileLayer&&this.setStyle(this.vectorTileLayer)),t.tileUrl?.previousValue!==t.tileUrl?.currentValue&&(this.maxZoom=void 0,this.minZoom=void 0,this._zoom=void 0,this.checkParams(),this.initialize())}initialize(){this.vectorTileLayer=void 0;let t=this.tileUrl.replace("tiles","tileMatrixSets")+"?f=json";this.matrixsetService.getMatrix(this.tileUrl).subscribe({next:r=>{let i=this.findMatrixUrl(r.links);i?t=i:this.logger.log("tileurl :"+this.tileUrl+"not found"),this.drawFromMatrixUrl(r,t),this.setZoomLevel(r),this.cdf.detectChanges()},error:r=>{this.logger.log(this.id+"error: "+JSON.stringify(r))}})}setZoomLevel(t){t.tileMatrixSetLimits.forEach(r=>{this.minZoom||(this.minZoom=parseFloat(r.tileMatrix)+.01,(this._zoom===void 0||this._zoom<this.minZoom)&&(this.zoom=this.minZoom),this.logger.log("setZoomlevel zoom"+this.zoom)),this.maxZoom=parseFloat(r.tileMatrix)+5})}findMatrixUrl(t){let r;return t.forEach(i=>{if(i.rel=="http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme"){let o=new URL(this.tileUrl);this.isFullURL(i.href)?r=i.href:r=new URL(o.origin+i.href).href}}),r}drawFromMatrixUrl(t,r){this.matrixsetService.getMatrixSet(r).subscribe({next:i=>{let o=[],s=[],a=[];i.tileMatrices.forEach(l=>{o[l.id]=l.cellSize,this.tileUrl.includes(dC)?s[l.id]=[l.pointOfOrigin[1],l.pointOfOrigin[0]]:s[l.id]=l.pointOfOrigin,a[l.id]=[l.tileWidth,l.tileHeight]}),this.tileGrid=new ri({resolutions:o,tileSizes:a,origins:s}),this.drawMap(t)},error:i=>{this.logger.log(this.id+"tilematrixset not found: "+r,i),this.projection=new Af(this.tileUrl).Projection,this.tileGrid=new ri({extent:this.projection.getExtent(),resolutions:this.calcResolutions(this.projection),tileSize:[256,256],origin:ut(this.projection.getExtent())}),this.drawMap(t)}})}drawMap(t){this.map.setTarget(void 0),this.map=new go({});let r=this.getMap();r.on("pointermove",o=>{r.forEachFeatureAtPixel(o.pixel,s=>{s&&(this._showObjectInfo&&(this.curFeature=s,this.cdf.detectChanges()),this.activeFeature.emit(s))},{hitTolerance:3})}),r.getView().on("change:resolution",()=>{let o=this.map.getView().getZoom();this.logger.log("change: resolution zoom"+o),o&&(this._zoom=o,this.currentZoomLevel.next(o))}),this.setZoomLevel(t);let i=this.elementRef.nativeElement.querySelector("[id='map']");this.mapWidth=this.elementRef.nativeElement.offsetWidth,this.mapHeight=this.elementRef.nativeElement.offsetWidth*.75,r.setTarget(i),this.cdf.detectChanges()}checkParams(){this.logger.log(this.id),this.tileUrl||this.logger.error("No TilteUrl was provided for the app-vectortile-view"),this.styleUrl||this.logger.log("No StyleUrl was provided for the app-vectortile-view"),this.centerX?this.logger.log("center-x="+this.centerX):this.logger.error("No zoom center-x was provided for the app-vectortile-view"),this.centerY?this.logger.log("center-y="+this.centerY):this.logger.error("No center-y was provided for the app-vectortile-view")}getMap(){HD();let t=this.generateLayers(),r=t.layers,i=[this.centerX,this.centerY];this.vectorTileLayer=t.vectorTileLayer;let o=al({zoom:this.maxZoom-this.minZoom>1}).extend([new s1]);return this.map=new go({controls:o,layers:r,view:new nn({center:i,zoom:this.zoom,maxZoom:this.maxZoom,minZoom:this.minZoom,enableRotation:!1,projection:this.projection})}),this.logger.log("map created"),this.logger.log("zoom"+this.zoom),this.logger.log("maxzoom"+this.maxZoom),this.logger.log("minzoom"+this.minZoom),this.map}generateLayers(){this.projection=new Af(this.tileUrl).Projection;let t=this.getVectorTileLayer(this.projection);this.setStyle(t);let r=[t];if(this.showGrid){let i=t.getSource();if(i){let o=i.getTileGrid();if(o){let s=new fl({source:new BP({template:"z:{z} y:{y} x:{x}",projection:this.projection,tileGrid:o,wrapX:i.getWrapX(),zDirection:1})});r=[t,s]}}}return{vectorTileLayer:t,layers:r}}setStyle(t){if(this.styleUrl){let r=t.getSource()?.getProjection();Iu(t,this.styleUrl,void 0,void 0,this.calcResolutions(this.projection)).then(()=>{this.tileUrl!==ny&&t.setSource(this.getVectorTileSource(r,this.tileUrl))}).catch(i=>this.logger.error("error loading: "+this.id+" "+this.styleUrl+" "+i))}else{let r=new Xt({fill:new Wt({color:"rgba(255,255,255,0.4)"}),stroke:new tn({color:"#3399CC",width:1.25})});t.setStyle(r)}}getVectorTileLayer(t){return new la({source:this.getVectorTileSource(t,this.tileUrl),renderMode:"hybrid",declutter:!0,useInterimTilesOnError:!1,minZoom:void 0})}calcResolutions(t){let i=ee(t.getExtent())/256,o=[];for(let s=0;s<=21;s++)o[s]=i/Math.pow(2,s);return o}getVectorTileSource(t,r){let i=new Jc({format:new Sl,projection:t,tileGrid:this.tileGrid,url:r+this.xyzSelector,cacheSize:0});return i.on(["tileloadend"],o=>{let s=o;this.activeTileUrl.next(s.tile.key)}),i}isFullURL(t){return t.toLowerCase().startsWith("http://")||t.toLowerCase().startsWith("https://")}static{this.\u0275fac=function(r){return new(r||n)(pe(Ct),pe(Zi),pe(SF),pe(Up))}}static{this.\u0275cmp=bn({type:n,selectors:[["app-vectortile-view"]],inputs:{showGrid:"showGrid",showObjectInfo:"showObjectInfo",tileUrl:"tileUrl",styleUrl:"styleUrl",id:"id",zoom:"zoom",centerX:"centerX",centerY:"centerY"},outputs:{currentZoomLevel:"currentZoomLevel",activeFeature:"activeFeature",activeTileUrl:"activeTileUrl"},features:[Ba],decls:3,vars:5,consts:[["id","map",1,"maparea"],[1,"toprightpanel"],["class","objectinfopanel","id","objectinfo",3,"feature",4,"ngIf"],["id","objectinfo",1,"objectinfopanel",3,"feature"]],template:function(r,i){r&1&&(Fe(0,"div",0)(1,"div",1),Mn(2,B7,1,1,"app-objectinfo-view",2),Re()()),r&2&&($a("width",i.mapWidth,"px")("height",i.mapHeight,"px"),Ze(2),Et("ngIf",i.showObjectInfo))},dependencies:[Un,xi],styles:[".maparea[_ngcontent-%COMP%]{z-index:1;position:relative;display:flex;background:#fff}.toprightpanel[_ngcontent-%COMP%]{position:absolute;flex:1;top:6%;right:1%;z-index:2;max-height:90%;max-width:40%;height:100%}"],changeDetection:0})}}return n})();var Du=(()=>{class n{constructor(t){this.logger=t,this.initialErrorDetail={title:"unknown error",detail:"unknown error",error:void 0,type:"unknownError"},this._errorDetailSource=new wr,this.errorDetailStream$=this._errorDetailSource.asObservable(),this._errorDetailSource.next(this.initialErrorDetail)}handleError(t){let r=JSON.parse(JSON.stringify(this.initialErrorDetail));if(t instanceof Wa){this.logger.log("http error detected");let i=t;this.logger.log(i.error),r.detail=i.error?.detail??"No detail available",r.title=i.error?.title??"No title available",r.type="httpError"}else this.logger.error("error detected"),this.logger.error(t),r.type="unknownError";this._errorDetailSource.next(r)}static{this.\u0275fac=function(r){return new(r||n)(U(Ct))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var RF=(()=>{class n{constructor(t,r){this.logger=t,this.globalErrorHandlerService=r,this.errorDetail=void 0}ngAfterViewInit(){this.globalErrorHandlerService.errorDetailStream$.subscribe(t=>{this.logger.log("errorDetail received in status-box"),this.errorDetail=t})}static{this.\u0275fac=function(r){return new(r||n)(pe(Ct),pe(Du))}}static{this.\u0275cmp=bn({type:n,selectors:[["app-status-box"]],features:[CI([{provide:br,useClass:Du}])],decls:4,vars:2,template:function(r,i){r&1&&(Fe(0,"div"),ln(1),Re(),Fe(2,"div"),ln(3),Re()),r&2&&(Ze(),vi(i.errorDetail==null?null:i.errorDetail.title),Ze(2),vi(i.errorDetail==null?null:i.errorDetail.detail))},encapsulation:2})}}return n})();var U7={url:"",headers:new Sn},_a=U7,Gb=class{static loggingInterceptor(e,t){return t(e).pipe(O0(r=>{r.type===Ji.Response&&(_a={url:e.urlWithParams,headers:r.headers}),r.type===Ji.ResponseHeader&&(_a={url:e.urlWithParams,headers:r.headers})}))}},AF=(()=>{class n{constructor(t){this.injector=t;let r=Za(DF,{injector:t});customElements.define("app-vectortile-view",r);let i=Za(TF,{injector:t});customElements.define("app-objectinfo-view",i);let o=Za(EF,{injector:t});customElements.define("app-legend-view",o);let s=Za(F2,{injector:t});customElements.define("app-feature-view",s);let a=Za(MF,{injector:t});customElements.define("app-location-search",a);let l=Za(RF,{injector:t});customElements.define("app-status-box",l)}ngDoBootstrap(){}static{this.\u0275fac=function(r){return new(r||n)(U(Cr))}}static{this.\u0275mod=yi({type:n})}static{this.\u0275inj=pi({providers:[{provide:br,useClass:Du},rx(ix([Gb.loggingInterceptor]))],imports:[J_,$P.forRoot({serverLoggingUrl:"/api/logs",level:vt.LOG,serverLogLevel:vt.OFF})]})}}return n})();K_().bootstrapModule(AF).catch(n=>console.error(n));
