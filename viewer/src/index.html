<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OGC API Map Component Samples</title>
    <meta name="description" content="Samples of OGC API map components including location search." />
    <!-- Link to external CSS -->

    <!-- Link to external JavaScript -->
    <style>
      .area {
        display: flex;
        flex-direction: row;
      }

      .box {
        width: 35vw;
        --ls-searchbox-width: 90%;

        padding: 0;
      }
    </style>
  </head>

  <body onload="load()">
    <!--h2>Legend sample</h2>
    <app-legend-view id="legendview1" style-url="assets/dkk_standaardvissualisatie.json"> </app-legend-view-->

    <!--app-legend-view id="legendview1" style-url="http://127.0.0.1:4200/styles/brk/dkk_kwaliteitsvissualisatie_nederlandsRDNewQuad.json">
    </app-legend-view-->

    <h2>Location API sample to test <a href="https://api.pdok.nl/bzk/location-api/autocomplete/v1-preprod">location api (preprod)</a></h2>
    Used search url:
    <a id="search-url" href="https://api.pdok.nl/bzk/location-api/autocomplete/v1-preprod"
      >https://api.pdok.nl/bzk/location-api/autocomplete/v1-preprod</a
    >

    <h3>Search</h3>
    <div class="area">
      <div class="box">
        <app-location-search
          id="locationsearch"
          url="https://api.pdok.nl/bzk/location-api/autocomplete/v1-preprod"
          label=""
          aria-label="Location Search"></app-location-search>
      </div>

      <div class="box">
        <app-feature-view
          id="featureview"
          items-url="https://api.pdok.nl/lv/bag/ogc/v1/collections/standplaats/items/d9fc2b92-20fe-5643-b3aa-e03874f7f5e3?f=json"
          show-bounding-box-button="false">
        </app-feature-view>
      </div>
    </div>
    <div>
      <app-objectinfo-view id="objectinfooutside"> </app-objectinfo-view>
    </div>
  </body>
  <script type="text/javascript">
    function load() {
      locationsearch.addEventListener('activeFeatureHovered', e => {
        console.log('activeFeatureHovered')
        console.log(JSON.stringify(e.detail))
        const feature = e.detail
        objectinfooutside.feature = feature
        console.log('href hovered ' + feature.getProperties().href)

        featureview.setAttribute('items-url', feature.getProperties().href)
        featureview.style.visibility = 'visible'
      })

      featureview.style.visibility = 'hidden'
      locationsearch.addEventListener('activeFeatureSelected', e => {
        console.log('activeFeatureSelected')
        console.log(JSON.stringify(e.detail))
        const feature = e.detail
        objectinfooutside.feature = feature
        console.log('href selected ' + feature.getProperties().href)
        featureview.setAttribute('items-url', feature.getProperties().href)
        featureview.style.visibility = 'visible'
      })

      locationsearch.addEventListener('activeSearchUrl', u => {
        console.log(JSON.stringify(u.detail))
        document.getElementById('search-url').innerHTML = u.detail
        document.getElementById('search-url').href = u.detail + '&f=json'
        // history.replaceState(null, '', u.detail)
      })

      locationsearch.addEventListener('activeSearchText', t => {
        console.log(JSON.stringify(t.detail))
        // history.replaceState(null, '', u.detail)
      })
    }
  </script>

  <!--h2>Location API sample to test with CSS styling</h2>

  <app-location-search
    id="styledlocationsearch"
    url="https://api.pdok.nl/bzk/location-api/autocomplete/v1-preprod"
    label=""
    aria-label="Location Search"></app-location-search -->
</html>
